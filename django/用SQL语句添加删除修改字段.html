<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>用SQL语句添加删除修改字段 - 从孑开始 - 博客园</title>
<link type="text/css" rel="stylesheet" href="http://common.cnblogs.com/blog/css/common.css?id=20130323"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="http://common.cnblogs.com/Skins/SimpleBlue/style.css?id=20130323"/>
<link type="text/css" rel="stylesheet" href="http://common.cnblogs.com/blog/css/common2.css"/>
<link type="text/css" rel="stylesheet" href="http://common.cnblogs.com/css/shStyle.css"/>
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/manyeyes/rss"/>
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/manyeyes/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/manyeyes/wlwmanifest.xml"/>
<script src="http://common.cnblogs.com/script/jquery.js" type="text/javascript"></script>  
<script type="text/javascript">
var currentBlogApp = 'manyeyes';
</script>
<script src="http://common.cnblogs.com/blog/script/common.js?id=20130323" type="text/javascript"></script> 
<script src="http://common.cnblogs.com/script/json2.js" type="text/javascript"></script>
<script type="text/javascript" src="http://common.cnblogs.com/script/syntaxHighlighter.js"></script>
</head>
<body>
<a name="top"></a>

<div id="home">
<div id="header">
	<div id="blogTitle">
		
<!--done-->
<div class="title"><a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/manyeyes/">从孑开始</a></div>
<div class="subtitle">众目网：www.manyeyes.net，我们的网，自由的网</div>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<ul id="navList">
<li id="nav_sitehome"><a id="MyLinks1_HomeLink" class="menu" href="http://www.cnblogs.com/">博客园</a></li>
<li id="nav_myhome"><a id="MyLinks1_MyHomeLink" class="menu" href="http://www.cnblogs.com/manyeyes/">首页</a></li>
<li id="nav_q"><a class="menu" href="http://q.cnblogs.com/">博问</a></li>
<li id="nav_ing"><a class="menu" href="http://home.cnblogs.com/ing/">闪存</a></li>
<li id="nav_newpost"><a id="MyLinks1_NewPostLink" class="menu" rel="nofollow" href="http://www.cnblogs.com/manyeyes/admin/EditPosts.aspx?opt=1">新随笔</a></li>
<li id="nav_contact"><a id="MyLinks1_ContactLink" class="menu" rel="nofollow" href="http://space.cnblogs.com/msg/send/%e4%bb%8e%e5%ad%91%e5%bc%80%e5%a7%8b">联系</a></li>
<li id="nav_rss"><a id="MyLinks1_Syndication" class="menu" href="http://www.cnblogs.com/manyeyes/rss">订阅</a>
<!--<a id="MyLinks1_XMLLink" class="aHeaderXML" href="http://www.cnblogs.com/manyeyes/rss"><img src="/Skins/Custom/images/rss.gif" alt="订阅" /></a>--></li>
<li id="nav_admin"><a id="MyLinks1_Admin" class="menu" rel="nofollow" href="http://www.cnblogs.com/manyeyes/admin/EditPosts.aspx">管理</a></li>
</ul>

		<div class="blogStats">
			
			
<!--done-->
随笔-17&nbsp;
文章-1&nbsp;
评论-9&nbsp;

			
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->
<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
	
<!--done-->
<div id="topics">
	<div class = "post">
		<h1 class = "postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/manyeyes/archive/2010/09/29/1838674.html">用SQL语句添加删除修改字段</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body"><div class="tit">&nbsp;</div>
<table style="width: 100%; table-layout: fixed">
<tbody>
<tr>
<td>
<div class="cnt"><br />1.增加字段<br />&nbsp;&nbsp;&nbsp;&nbsp; alter table docdsp&nbsp;&nbsp;&nbsp;&nbsp; add dspcode<br />char(200)<br />2.删除字段<br />&nbsp;&nbsp;&nbsp;&nbsp; ALTER TABLE table_NAME DROP COLUMN<br />column_NAME<br />3.修改字段类型<br />&nbsp;&nbsp;&nbsp;&nbsp; ALTER TABLE table_name&nbsp;&nbsp;&nbsp;&nbsp; ALTER COLUMN<br />column_name new_data_type<br />4.sp_rename 改名<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EXEC sp_rename '[dbo].[Table_1].[filedName1]', 'filedName2', 'COLUMN' <br />更改当前数据库中用户创建对象（如表、列或用户定义数据类型）的名称。<br />&nbsp;&nbsp;&nbsp;&nbsp; 语法<br />&nbsp;&nbsp;&nbsp;&nbsp; sp_rename [ @objname = ] 'object_name' ,[ @newname = ] 'new_name',分类信息; [ , [ @objtype =] 'object_type' ]<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;如：EXEC sp_rename&nbsp; 'newname','PartStock'<br />5.sp_help 显示表的一些基本情况<br />&nbsp;&nbsp;&nbsp;&nbsp; sp_help 'object_name'&nbsp;&nbsp;&nbsp;&nbsp;<br />如：EXEC sp_help&nbsp;&nbsp;&nbsp;&nbsp; 'PartStock'<br />6.判断某一表PartStock中字段PartVelocity是否存在<br />if&nbsp;&nbsp;&nbsp;&nbsp;<br />exists&nbsp;&nbsp;&nbsp;&nbsp; (select&nbsp;&nbsp;&nbsp;&nbsp; *&nbsp;&nbsp;&nbsp;&nbsp; from&nbsp;&nbsp;&nbsp;&nbsp; syscolumns&nbsp;&nbsp;&nbsp;&nbsp; where&nbsp;&nbsp;&nbsp;&nbsp;<br />id=object_id('PartStock')&nbsp;&nbsp;&nbsp;&nbsp; and&nbsp;&nbsp;&nbsp;&nbsp; name='PartVelocity')&nbsp;&nbsp;<br />print&nbsp;&nbsp;&nbsp;&nbsp;<br />'PartVelocity exists'<br />else print 'PartVelocity not<br />exists'<br />另法：<br />判断表的存在性：<br />&nbsp;&nbsp;&nbsp;&nbsp; select count(*) from sysobjects where type='U'<br />and name='你的表名'<br />判断字段的存在性：<br />&nbsp;&nbsp;&nbsp;&nbsp; select count(*) from syscolumns<br />&nbsp;&nbsp;&nbsp;&nbsp; where<br />id&nbsp;&nbsp;&nbsp;&nbsp; = (select id from sysobjects where type='U' and name='你的表名')<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />and&nbsp;&nbsp;&nbsp;&nbsp; name = '你要判断的字段名'<br />&nbsp;&nbsp;<br />一个小例子<br />--假设要处理的表名为:<br />tb<br />--判断要添加列的表中是否有主键<br />if exists(select 1 from sysobjects where<br />parent_obj=object_id('tb') and xtype='PK')<br />begin<br />print<br />'表中已经有主键,列只能做为普通列添加'<br />--添加int类型的列,默认值为0<br />alter table tb add 列名 int default<br />0&nbsp;&nbsp;<br />end<br />else<br />begin<br />print '表中无主键,添加主键列'<br />--添加int类型的列,默认值为0<br />alter<br />table tb add 列名 int primary key default 0&nbsp;&nbsp;<br />end<br />7.随机读取若干条记录<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Access语法：SELECT top 10 * From 表名 ORDER BY<br />Rnd(id)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sql server:select top n * from 表名 order by newid()<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />mysql select * From 表名 Order By rand() Limit n<br />8.说明：日程安排提前五分钟提醒<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; SQL:<br />select * from 日程安排 where datediff(minute,f开始时间,getdate())&gt;5<br />9.前10条记录<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select top 10 * form. table1 where 范围<br />10.包括所有在 TableA 中但不在 TableB和TableC 中的行并消除所有重复行而派生出一个结果表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (select a<br />from tableA ) except (select a from tableB) except (select a from tableC)<br />11.说明：随机取出10条数据<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select top 10 * from tablename order by newid()<br />12.列出数据库里所有的表名<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select name from sysobjects where type=U<br />13.列出表里的所有的字段名<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select name from syscolumns where<br />id=object_id(TableName)<br />14.说明：列示type、vender、pcs字段，以type字段排列，case可以方便地实现多重选择，类似select<br />中的case。<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select type,sum(case vender when A then pcs else 0<br />end),sum(case vender when C then pcs else 0 end),sum(case vender when B then pcs<br />else 0 end) FROM tablename group by type<br />15.说明：初始化表table1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TRUNCATE<br />TABLE table1<br />16.说明：几个高级查询运算词<br />　　A： UNION 运算符<br />　　UNION 运算符通过组合其他两个结果表（例如<br />TABLE1 和 TABLE2）并消去表中任何重复行而派生出一个结果表。当 ALL 随 UNION 一起使用时（即 UNION<br />ALL），不消除重复行。两种情况下，派生表的每一行不是来自 TABLE1 就是来自 TABLE2。<br />　　B： EXCEPT 运算符<br />　　EXCEPT 运算符通过包括所有在 TABLE1 中但不在 TABLE2<br />中的行并消除所有重复行而派生出一个结果表。当 ALL 随 EXCEPT 一起使用时 (EXCEPT ALL)，不消除重复行。<br />　　C： INTERSECT 运算符<br />　　INTERSECT 运算符通过只包括 TABLE1 和 TABLE2<br />中都有的行并消除所有重复行而派生出一个结果表。当 ALL 随 INTERSECT 一起使用时 (INTERSECT<br />ALL)，不消除重复行。<br />　　注：使用运算词的几个查询结果行必须是一致的。<br />17.说明：在线视图查询(表名1：a )<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select * from (SELECT a,b,c FROM a) T where<br />t.a &gt; 1;<br />18.说明：between的用法,between限制查询数据范围时包括了边界值,not between不包括<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select * from<br />table1 where time between time1 and time2<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select a,b,c, from table1<br />where a not between 数值1 and 数值2<br />19.说明：in 的使用方法<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; select * from table1 where a [not] in<br />(&#8216;值1&#8217;,&#8217;值2&#8217;,&#8217;值4&#8217;,&#8217;值6&#8217;)<br />20.说明：两张关联表，删除主表中已经在副表中没有的信息<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; delete from table1 where not exists (<br />select * from table2 where table1.field1=table2.field1<br />)<br />21.　说明：复制表(只复制结构,源表名：a 新表名：b) (Access可用)<br />　　法一：select * into b from a<br />where 1&lt;&gt;1<br />　　法二：select top 0 * into b from a<br />22.说明：拷贝表(拷贝数据,源表名：a 目标表名：b) (Access可用)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; insert into b(a, b, c)<br />select d,e,f from b;<br />23.说明：跨数据库之间表的拷贝(具体数据使用绝对路径) (Access可用)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; insert into b(a, b, c)<br />select d,e,f from b in &#8216;具体数据库&#8217; where 条件<br />　　例子：..from b in<br />"&amp;Server.MapPath(".")&amp;"\data.mdb" &amp;" where..<br />24.创建数据库<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />CREATE DATABASE database-name<br />25.说明：删除数据库<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; drop database dbname<br />26.说明：备份sql server<br />　　--- 创建<br />备份数据的 device<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; USE master<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EXEC sp_addumpdevice disk, testBack,<br />c:\mssql7backup\MyNwind_1.dat<br />　　--- 开始 备份<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BACKUP DATABASE pubs TO testBack<br />27.说明：创建新表<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; create table tabname(col1 type1 [not null] [primary<br />key],col2 type2 [not null],..)<br />　　根据已有的表创建新表：<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; A：create table tab_new<br />like tab_old (使用旧表创建新表)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; B：create table tab_new as select col1,col2&#8230;<br />from tab_old definition only<br />28.说明：<br />　　删除新表：drop table tabname<br />29.说明：<br />　　增加一个列：Alter table tabname add column col<br />type<br />　　注：列增加后将不能删除。DB2中列加上后数据类型也不能改变，唯一能改变的是增加varchar类型的长度。<br />30.说明：<br />　　添加主键：Alter table tabname add primary key(col)<br />　　说明：<br />　　删除主键：Alter table tabname drop primary key(col)<br />31.说明：<br />　　创建索引：create [unique] index idxname on tabname(col&#8230;.)<br />　　删除索引：drop index idxname<br />　　注：索引是不可更改的，想更改必须删除重新建。<br />32.说明：<br />　　创建视图：create view viewname as select statement<br />　　删除视图：drop view<br />viewname<br />33.说明：几个简单的基本的sql语句<br />　　选择：select * from table1 where 范围<br />　　插入：insert into<br />table1(field1,field2) values(value1,value2)<br />　　删除：delete from table1 where<br />范围<br />　　更新：update table1 set field1=value1 where 范围<br />　　查找：select * from table1<br />where field1 like &#8217;%value1%&#8217; ---like的语法很精妙，查资料!<br />　　排序：select * from table1<br />order by field1,field2 [desc]<br />　　总数：select count * as totalcount from<br />table1<br />　　求和：select sum(field1) as sumvalue from table1<br />　　平均：select<br />avg(field1) as avgvalue from table1<br />　　最大：select max(field1) as maxvalue from<br />table1<br />　　最小：select min(field1) as minvalue from table1</div></td></tr></tbody></table></div><div id="MySignature"></div>
<script type="text/javascript">
var isLogined = false;
var cb_blogId = 65282;
var cb_entryId = 1838674;
var cb_blogApp = currentBlogApp;
var cb_blogUserGuid = "9e80a172-73fb-de11-ba8f-001cf0cd104b";
var cb_entryCreatedDate = '2010/9/29 17:24:00';
var enableGoogleAd = true;
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
</script>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>
<script type="text/javascript">
    //SyntaxHighlighter.config.strings.expandSource = '<span><img src="http://static.cnblogs.com/images/expand-code.gif" alt="" class="expand-code-icon"/>View Code</span>';
    $(function () {             
        fixPostBodyFormat();
        loadAdUnderPost();
        loadBlogSignature();
        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);        
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);        
    });
</script>
		</div>
		<div class = "postDesc">posted @ <span id="post-date">2010-09-29 17:24</span> <a href='http://www.cnblogs.com/manyeyes/'>从孑开始</a> 阅读(31542) 评论(<span id="post-comment-count">2</span>)  <a href ="http://www.cnblogs.com/manyeyes/admin/EditPosts.aspx?postid=1838674" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(1838674);return false;">收藏</a></div>
	</div>
	<img src ="http://www.cnblogs.com/manyeyes/aggbug/1838674.html?type=1&amp;webview=1" width="1" height="1" alt=""/>
	
</div><!--end: topics 文章、评论容器-->
<div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.loadComments();</script>
<div id="comment_form" class="commentform">
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" id="lnk_RefreshComments" onclick="return RefreshCommentList();">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
<div id="comment_form_container"></div>

<script type="text/javascript">
    if (typeof commentManager === 'undefined') {
        commentManager = new blogCommentManager();
    }
    commentManager.loadCommentForm();   
</script>

<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="site_nav_under"><a href="http://www.cnblogs.com/" target="_blank" title="程序员的网上家园">博客园首页</a><a href="http://q.cnblogs.com/" target="_blank" title="程序员问答社区">博问</a><a href="http://news.cnblogs.com/" target="_blank" title="IT新闻">新闻</a><a href="http://home.cnblogs.com/ing/" target="_blank">闪存</a><a href="http://job.cnblogs.com/" target="_blank">程序员招聘</a><a href="http://kb.cnblogs.com/" target="_blank">知识库</a></div>
<div id="ad_under_post_holder"></div>
<div id="HistoryToday" class="c_ad_block"></div>
</div>





	</div><!--end: forFlow -->
	</div><!--end: mainContent 主体内容容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"></div>
</div>

			<div id="calendar"><div id="blog-calendar" style="displya:none"></div></div>
			
			<div id="leftcontentcontainer">
				<div id="blog-sidecolumn"></div>
			</div>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
		
<!--done-->
Copyright &copy;2013 从孑开始
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->
<script type="text/javascript" src="http://common.cnblogs.com/script/google-analytics.js"></script>
</body>
</html>
