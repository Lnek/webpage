
<!DOCTYPE html><!--STATUS OK--><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><link rel="apple-touch-icon" href="http://img.baidu.com/img/baike/wap/iphone4_logo.png" /><script>var baidu;var verticalData = null;var doubtBlackList = false;var isRainbow = false;</script><title>Framebuffer Driver_百度百科</title><meta name="Description" content="中文名为：帧缓冲驱动 一、FrameBuffer的原理 FrameBuffer 是出现在 2.2.xx 内核当中的一种驱动程序接口。 Linux是工作在保护模式下，所以用户态进程是无法象DOS那样使用显卡BIOS里提供的中断调用来实现直接写屏，Linux抽象出FrameBuffer这个设备来供用户态进程实现直接写屏。Framebuffer机制模仿显卡的功能，将显..." /><meta name="Keywords" content="Framebuffer Driver 百度百科 百科 baike Framebuffer Driver_百度百科" /><link href="/static/usercenter/css/liteoutput/bk.uc_lemma.css" rel="stylesheet" type="text/css" /><script>var padFlag = /iPad/.exec(navigator.userAgent) && navigator.userAgent.match(/CPU OS ([\d])/)[1];if (padFlag){document.documentElement.className+=' ipad';var pad_viewport = document.createElement('meta');pad_viewport.name ='viewport';pad_viewport.content = 'width=device-width, initial-scale=1.0';document.getElementsByTagName('head')[0].appendChild(pad_viewport);}</script><script>(function(){function b(f){if(f>=0){for(var e=0;e<75;e+=25){if(f>=e&&f<e+25){return e/25}}if(f>=75&&f<500){return 3}return 4}}var d=function(e){this.name=e;this.dataArray=[0,0,0,0,0]};d.prototype.start=function(){var g=50,j,f,i=this;function e(){f=new Date;var k=f-j-g;k=k<0?0:k;i.dataArray[b(k)]++;if(!i.isEnd){h()}else{clearTimeout(i.timer)}}function h(k){j=new Date;if(k){g=0}else{g=50}i.timer=null;i.timer=setTimeout(e,g)}i.isEnd=false;h(true)};d.prototype.end=function(){this.isEnd=true};d.prototype.toString=function(){return'"'+this.name+'":['+this.dataArray.join(",")+"]"};var a={};var c={start:function(e,f){f=f||a;if(f){if(!f[e]){f[e]=new d(e)}f[e].start()}},end:function(e,f){f=f||a;if(f){if(f[e]){f[e].end()}}},toString:function(g){g=g||a;var e=[];if(g){for(var f in g){if(g.hasOwnProperty(f)){e.push(g[f].toString())}}}return"{"+e.join(",")+"}"},length:function(){return a.length}};window.CPU_MONITOR=c})(window);var PDC={_version:"0.9",_render_start:new Date().getTime(),_analyzer:{loaded:false,url:"http://static.tieba.baidu.com/tb/pms/wpo.pda.js?v=0.9",callbacks:[]},_opt:{is_login:false,sample:0,product_id:0,page_id:0,special_pages:[],display:false},_cpupool:{},_timingkey:"start",_timing:{},init:function(d){for(var c in d){if(d.hasOwnProperty(c)){this._opt[c]=d[c]}}},mark:function(b){this._timing[b]=new Date().getTime();if(window.CPU_MONITOR){if(this._lastkey){CPU_MONITOR.end(this._lastkey+"-"+this._timingkey,this._cpupool)}if(b!="let"){CPU_MONITOR.start(this._timingkey+"-"+b,this._cpupool);this._lastkey=this._timingkey;this._timingkey=b}}},view_start:function(){this.mark("vt")},tti:function(){this.mark("tti")},page_ready:function(){this.mark("fvt")},metadata:function(){var c=this._opt;var e={env:{user:(c.is_login==true?1:0),product_id:c.product_id,page_id:PDC._is_sample(c.sample)?c.page_id:0},common_resources:c.common_resources,special_resources:c.special_resources,render_start:this._render_start,timing:this._timing,display:c.display};var a=[];var d=c.special_pages;for(var b=0;b<d.length;b++){if(PDC._is_sample(d[b]["sample"])){a.push(d[b]["id"])}}if(a.length>0){e.env["special_id"]="["+a.join(",")+"]"}return e}};(function(){if(document.attachEvent){window.attachEvent("onload",function(){PDC.mark("let");PDC._load_analyzer()})}else{window.addEventListener("load",function(){PDC.mark("lt")},false)}})();</script>
<link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/common/pkg/framework_cc657e93.css" />
<link rel="stylesheet" type="text/css" href="http://baike.bdimg.com/static/lemma/pkg/baseviewcss_f0cc9bd6.css" />
<script type="text/javascript" src="http://baike.bdimg.com/static/common/lib/base_b0ae69b4.js"></script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/common/pkg/framework_77a66cc2.js' : ['/static/common/lib/tangram/base/base.js','/static/common/ui/search/search.js','/static/common/ui/nslog/nslog.js','/static/common/lib/fis/event/event.js','/static/common/ui/enctip/enctip.js','/static/common/ui/util/util.js','/static/common/ui/eventForLemma/eventForLemma.js','/static/common/lib/tangram/ui/Dialog/Dialog.js','/static/common/ui/dialog/dialog.js','/static/common/ui/fillusername/fillusername.js','/static/common/ui/userlogin/userlogin.js','/static/common/ui/delegate/delegate.js','/static/common/ui/fx/fx.js','/static/common/ui/message/message.js','/static/widget/common/footer/footer.js','/static/widget/common/footer_pad/footer_pad.js','/static/widget/common/nav/nav.js','/static/widget/common/nav_pad/nav_pad.js','/static/common/lib/tangram/fx/fx.js','/static/common/lib/tangram/fx/Timeline/Timeline.js','/static/common/lib/tangram/fx/create/create.js','/static/common/lib/tangram/fx/move/move.js','/static/common/lib/tangram/fx/moveBy/moveBy.js','/static/common/lib/fis/template/template.js','/static/common/lib/tangram/uiBase/uiBase.js','/static/common/lib/tangram/ui/Base/Base.js','/static/common/lib/tangram/ui/Dialog/Dialog$autoDispose/Dialog$autoDispose.js','/static/common/lib/tangram/ui/behavior/behavior.js','/static/common/lib/tangram/ui/behavior/statable/statable.js','/static/common/lib/tangram/ui/Button/Button.js','/static/common/lib/tangram/i18n/i18n.js','/static/common/lib/tangram/i18n/string/string.js','/static/common/lib/tangram/i18n/cultures/cultures.js','/static/common/lib/tangram/i18n/cultures/zh-CN/zh-CN.js','/static/common/lib/tangram/ui/Dialog/Dialog$button/Dialog$button.js','/static/common/lib/tangram/ui/Dialog/Dialog$closeButton/Dialog$closeButton.js','/static/common/lib/tangram/ui/behavior/coverable/coverable.js','/static/common/lib/tangram/ui/Dialog/Dialog$coverable/Dialog$coverable.js','/static/common/lib/tangram/ui/behavior/draggable/draggable.js','/static/common/lib/tangram/ui/Dialog/Dialog$draggable/Dialog$draggable.js','/static/common/lib/tangram/ui/Dialog/Dialog$iframe/Dialog$iframe.js','/static/common/lib/tangram/ui/Dialog/Dialog$keyboard/Dialog$keyboard.js','/static/common/lib/tangram/ui/Modal/Modal.js','/static/common/lib/tangram/ui/Modal/Modal$coverable/Modal$coverable.js','/static/common/lib/tangram/ui/Dialog/Dialog$modal/Dialog$modal.js','/static/common/lib/tangram/ui/behavior/resizable/resizable.js','/static/common/lib/tangram/ui/Dialog/Dialog$resizable/Dialog$resizable.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/common/ui/suggest/suggest_2c4328a2.js' : ['/static/common/ui/suggest/suggest.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/pkg/baseviewjs_6371da5f.js' : ['/static/widget/lemma/LNXG/LNXG.js','/static/lemma/ui/view/maad/maad.js','/static/lemma/ui/view/contributors/contributors.js','/static/lemma/ui/view/BKDynamic/BKDynamic.js','/static/lemma/ui/view/lemmaPV/lemmaPV.js','/static/lemma/ui/view/catalog/catalog.js','/static/lemma/ui/view/lemmapic/lemmapic.js','/static/lemma/ui/view/edit/edit.js','/static/lemma/ui/view/sublemma/sublemma.js','/static/lemma/ui/view/sidecatalog/sidecatalog.js','/static/lemma/ui/view/reference/reference.js','/static/lemma/ui/view/lazyLoad/lazyLoad.js','/static/lemma/ui/view/usercard/usercard.js','/static/lemma/ui/view/nslog/nslog.js','/static/lemma/ui/view/updown/updown.js','/static/lemma/ui/view/userRight/userRight.js','/static/lemma/ui/view/usercenter/usercenter.js','/static/lemma/ui/view/reftip/reftip.js','/static/lemma/ui/view/horizonScroll/horizonScroll.js','/static/lemma/ui/view/controller/controller.js','/static/lemma/ui/view/sideToolbar/sideToolbar.js','/static/lemma/ui/view/controller2/controller2.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/extcalendar/extcalendar_bb0774ee.js' : ['/static/lemma/ui/view/extcalendar/extcalendar.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/miss/miss_94b8ad89.js' : ['/static/lemma/ui/view/miss/miss.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/pkg/bottomviewjs_747613cd.js' : ['/static/lemma/ui/view/vote/vote.js','/static/lemma/ui/view/albumcollection/albumcollection.js','/static/lemma/ui/view/share/share.js','/static/lemma/ui/view/coeditor/coeditor.js','/static/lemma/ui/view/ext_mp3/ext_mp3.js','/static/lemma/ui/view/ext_video/ext_video.js','/static/lemma/ui/view/relation/relation.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/ipad/ipad_02bedfd1.js' : ['/static/lemma/ui/view/ipad/ipad.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/pkg/modulejs_80526054.js' : ['/static/lemma/ui/view/shipin/shipin.js','/static/lemma/ui/view/page_commonModule/page_commonModule.js','/static/lemma/ui/view/music/music.js','/static/lemma/ui/view/series/series.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/index/index_ddde7d9e.js' : ['/static/lemma/ui/view/index/index.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/pic/pic_ba3ab51e.js' : ['/static/lemma/ui/view/pic/pic.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/jiaoyu/jiaoyu_816f951a.js' : ['/static/lemma/ui/view/jiaoyu/jiaoyu.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/nba/nba_9758a69c.js' : ['/static/lemma/ui/view/nba/nba.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/olympic/olympic_2c66972e.js' : ['/static/lemma/ui/view/olympic/olympic.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/ouguan_team/ouguan_team_9f7e480d.js' : ['/static/lemma/ui/view/ouguan_team/ouguan_team.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/ouguan/ouguan_56ebf5e4.js' : ['/static/lemma/ui/view/ouguan/ouguan.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/worldcup/worldcup_a5c426df.js' : ['/static/lemma/ui/view/worldcup/worldcup.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/worldcup_team/worldcup_team_dd06821d.js' : ['/static/lemma/ui/view/worldcup_team/worldcup_team.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/authModule/authModule_6c0ca137.js' : ['/static/lemma/ui/view/authModule/authModule.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/vertical/vertical_4e1b8216.js' : ['/static/lemma/ui/view/vertical/vertical.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/preview_albumcollection/preview_albumcollection_238696fc.js' : ['/static/lemma/ui/view/preview_albumcollection/preview_albumcollection.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/describeTips/describeTips_434ed2a8.js' : ['/static/lemma/ui/view/describeTips/describeTips.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/rainbow/rainbow_d79c585c.js' : ['/static/lemma/ui/view/rainbow/rainbow.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/feedSys/feedSys_ff4c44ba.js' : ['/static/lemma/ui/view/feedSys/feedSys.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/doubt/doubt_fc43ace9.js' : ['/static/lemma/ui/view/doubt/doubt.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/cardTab/cardTab_87e5cb63.js' : ['/static/lemma/ui/view/cardTab/cardTab.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/cardTab_yiyao/cardTab_yiyao_dd9a3e81.js' : ['/static/lemma/ui/view/cardTab_yiyao/cardTab_yiyao.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/tipForIE6/tipForIE6_46f823d5.js' : ['/static/lemma/ui/view/tipForIE6/tipForIE6.js']});</script>
<script type="text/javascript">F._fileMap({'http://baike.bdimg.com/static/lemma/ui/view/copyLog/copyLog_026b527b.js' : ['/static/lemma/ui/view/copyLog/copyLog.js']});</script>
</head><script>PDC.mark("ht");(function(){var a=PDC.ready=function(){var g=false,f=[],c;if(document.addEventListener){c=function(){document.removeEventListener("DOMContentLoaded",c,false);d()}}else{if(document.attachEvent){c=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",c);d()}}}}function d(){if(!d.isReady){d.isReady=true;for(var k=0,h=f.length;k<h;k++){f[k]()}}}function b(){try{document.documentElement.doScroll("left")}catch(h){setTimeout(b,1);return}d()}function e(){if(g){return}g=true;if(document.addEventListener){document.addEventListener("DOMContentLoaded",c,false);window.addEventListener("load",d,false)}else{if(document.attachEvent){document.attachEvent("onreadystatechange",c);window.attachEvent("onload",d);var h=false;try{h=window.frameElement==null}catch(i){}if(document.documentElement.doScroll&&h){b()}}}}e();return function(h){d.isReady?h():f.push(h)}}();a.isReady=false})();PDC.ready(function(){PDC.mark("drt")});PDC.mark("vt");</script><body id="view" class=" "><script type="text/javascript">window.baikeInfo = {};if(typeof PDC != 'undefined'){PDC.view_start();}var judgeInfo_data={"sublemmaIds":[2115202],"judgeInfo_multi":{"2115202":[]},"sysDoubt_multi":{"2115202":[]}};var sublemmaIds=judgeInfo_data.sublemmaIds||[],judgeInfo_multi=judgeInfo_data.judgeInfo_multi||{};var currJudgeInfo=judgeInfo_multi["2115202"]||{};</script><div id="wrap"><div id="header"><div id="userbar"></div><div id="search" class="clearfix"> <div id="logo"> <a title="到百科首页" href="/" class="nslog:1008"><img width="137" height="46" src="http://img.baidu.com/img/baike/logo-baike.png" /></a>
 </div> <div id="search-content"> <p class="nv nslog-area:1009" log-data-detail="{page:'index'}"><a wdfield="q" data-href="http://news.baidu.com/?fr=bks0000" href="http://news.baidu.com/ns?tn=news&cl=2&rn=20&ct=1&fr=bks0000&ie=utf-8&word=" >&#26032;&#38395;</a><a wdfield="q" data-href="http://www.baidu.com/?ie=utf-8&fr=bks0000" href="http://www.baidu.com/s?ie=utf-8&fr=bks0000&wd=" >&#32593;&#39029;</a><a wdfield="q" data-href="http://tieba.baidu.com/index.html?fr=bks0000" href="http://tieba.baidu.com/f?ie=utf-8&fr=bks0000&kw=">&#36148;&#21543;</a><a wdfield="q" data-href="http://zhidao.baidu.com/?fr=bks0000" href="http://zhidao.baidu.com/search?pn=0&&rn=10&lm=0&fr=bks0000&word=">&#30693;&#36947;</a><a wdfield="q" data-href="http://mp3.baidu.com/?fr=bks0000" href="http://music.baidu.com/search?f=ms&ct=134217728&ie=utf-8&rn=&lm=-1&pn=30fr=bks0000&key=">&#38899;&#20048;</a><a wdfield="q" data-href="http://image.baidu.com/?fr=bks0000" href="http://image.baidu.com/i?tn=baiduimage&ct=201326592&lm=-1&cl=2&nc=1&ie=utf-8&word=">&#22270;&#29255;</a><a wdfield="q" data-href="http://video.baidu.com/?fr=bks0000" href="http://video.baidu.com/v?ct=301989888&rn=20&pn=0&db=0&s=22&ie=utf-8&fr=bks0000&word=">&#35270;&#39057;</a><a wdfield="q" data-href="http://ditu.baidu.com/?fr=bks0000" href="http://map.baidu.com/m?ie=utf-8&fr=bks0000&word=">&#22320;&#22270;</a><strong>&#30334;&#31185;</strong><a wdfield="q" data-href="http://wenku.baidu.com/?fr=bks0000" href="http://wenku.baidu.com/search?lm=0&od=0&ie=utf-8&fr=bks0000&word=">&#25991;&#24211;</a></p> <form action="/search/word" id="f1" method="get" name="f1" target="_self"><span class="s_ipt_wr"><span><input autocomplete="off" autocorrect="off" class="s_ipt" onwebkitspeechchange="this.form.submit()" lang="zh-CN" x-webkit-grammar="builtin:search" x-webkit-speech="true" id="word" maxlength="100" name="word" tabindex="1" value="Framebuffer Driver"></span></span><span class="s_btn_wr" style="margin-right:6px"><span><input class="s_btn nslog:1010" log-data-detail="{page:'index'}" onclick="this.form.pic.value=1" onmousedown="this.className='s_btn s_btn_h nslog:1010'" onmouseout="this.className='s_btn nslog:1010'" tabindex="2" type="submit" value="&#36827;&#20837;&#35789;&#26465;" style="z-index: 9; position: relative;"></span></span><span class="s_btn_wr"><span><input class="s_btn nslog:1011" log-data-detail="{page:'index'}" onclick="this.form.pic.value=2" onmousedown="this.className='s_btn s_btn_h nslog:1011'" onmouseout="this.className='s_btn nslog:1011'" tabindex="3" type="submit" value="&#25628;&#32034;&#35789;&#26465;" style="z-index: 9; position: relative; "><b style="z-index: 9; position: relative; "></b><b style="z-index: 9; position: relative; "></b></span></span> <input id="sw1" name="pic" type="hidden" value="1"> <input name="sug" type="hidden" value="1"> <input id="search-enc" name="enc" type="hidden" value="utf8"> </form> </div> <div id="help"> <a class="c-help" href="http://www.baidu.com/search/baike_help.html" target="_blank">&#24110;&#21161;</a> </div></div><div id="path" class="nslog-area" data-nslog-type="1000"> 
<ul class="nav f14 clearfix">    
            <li class="home"><a href="/" data-tj="home">首页</a></li>
                <li><a href="/ziran/">自然</a></li>
                 <li><a href="/wenhua/">文化</a></li>
                 <li><a href="/dili/">地理</a></li>
                 <li><a href="/lishi/">历史</a></li>
                 <li><a href="/shenghuo/">生活</a></li>
                 <li><a href="/shehui/">社会</a></li>
                 <li><a href="/yishu/">艺术</a></li>
                 <li><a href="/renwu/">人物</a></li>
                 <li><a href="/jingji/">经济</a></li>
                 <li><a href="/keji/">科技</a></li>
                 <li><a href="/tiyu/">体育</a></li>
                 <li><a href="/tupian/" data-tj="tupian">图片</a></li>
    			<li>		<a href="http://baike.baidu.com/museum/ " target="_blank" onclick="nslog(location.href,3020);" data-tj="szbwg">数字博物馆</a></li>
				<li>		<a href="http://baike.baidu.com/cms/s/core/index.html" target="_blank" onclick="nslog(location.href,3021);">核心用户</a></li>
		            <li class="last-u"><a href="/mall/" data-tj="bksc">百科商城</a></li>
    </ul>
<ul id="category_ipad" style="display:none;"></ul>

<style type="text/css" compress>
#path ul.nav li,ul.nav li{position:relative;}
.lemma-main-content table.table-view a:hover {
	text-decoration:underline;
}
.nav{overflow:visible;position:relative;}
div.nav-channel-hot{
 background:url("http://img.baidu.com/img/baike/icons/hot.png") no-repeat scroll 0 0 transparent;
_background:none;
_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src="http://img.baidu.com/img/baike/icons/hot.png");
 height:15px;
 position:absolute;
 width: 24px;
 top: -7px;
 right:7px
}

#path .nav li{padding-right:12px !important;}


/*for ipad*/
.ipad   #path .nav li{color: #fff;font-size: 18px;}
.ipad #path .nav li{height: 40px;line-height: 40px;}
.ipad  #path  .nav{height: 40px;line-height: 40px;margin: 0;text-align: center;background: #2158a6;font-size: 18px;}
.ipad  #path  .nav > div{display: none !important;}
.ipad  #path  .nav > li{width: 168px;border-right: 1px solid #1c4a8c;border-left: 1px solid #1b5bb5;}
.ipad  #path  .nav li.cur,.ipad  #path  .nav li.cur-long{width: 172px;background: #184787;border-left-color: #184787;}
.ipad  #path  .nav li.cur span,.ipad  #path  .nav li span,.ipad  #path  .nav li.cur-long span{background: none;width: auto;height: auto;padding: 0;margin: 0;border: 0;left:0;right:0;font-weight: bold;}
.ipad  #path  .nav li a,.ipad  #path  .nav .last-u a{color: #fff;padding: 0 10px;width: auto;height: auto;border: 0;font-weight: normal !important;background: none !important;}
.ipad  #path  .nav li a:hover,.ipad  #path  .nav .last-u a:hover{margin: 0;padding: 0;background: none;left:0;right:0;}
.ipad  #path  .nav li ul{position: absolute;}
.ipad  #path  .nav li span .arr{display: inline-block;vertical-align: middle;width: 9px;height: 5px;background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAkAAAAFCAYAAACXU8ZrAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAADBJREFUeNpi3HP64X8GAoDJ2USOEZ8CkDwTjIFLAdgkdAGs/P///6NgkBvRxQACDAC9VSJC4OCHnwAAAABJRU5ErkJggg==) center center no-repeat;-webkit-transition:all 0.3s;}
.ipad  #path  .nav .on span .arr{-webkit-transform:rotate(180deg);}

.ipad #category_ipad{height: 0;overflow: hidden;text-align: center;background: #d8e0eb;font-size: 16px;-webkit-transition:all 0.2s;}
.ipad #category_ipad:after{content:'\20';display:block;height:0;clear:both;visibility: hidden;}
.ipad #category_ipad li{float: none;font-weight: normal;display: inline-block;margin: 7px 16px !important;height: 24px;line-height: 24px;border: 1px solid #d8e0eb;}
.ipad #category_ipad li a{padding: 3px 12px;color: #333;display: inline;border: 0;}
.ipad #category_ipad li a:hover{text-decoration: none;background: none;}
.ipad #category_ipad .cur{background: #bec9d4;border-color: #a6b5c5;color: #333;}

/*临时for 图片 商城*/
.ipad .page-header{position: relative;width: 1024px;}
.ipad #header{margin-top: 0;}

/*ipad竖屏*/
@media only screen and (min-device-width: 481px) and (max-device-width: 1024px) and (orientation:portrait) {
.ipad #category_ipad li{margin: 7px 6px !important;}
.ipad  #path  .nav > li,.ipad  #path  .nav li.cur,.ipad  #path  .nav li.cur-long{width: 126px;}

.ipad #daily-content .history_img{display: none;}/*临时*/
.ipad #path-more-act{display: none;}/*ipad竖屏词条页导航不出现更多*/
}

</style>

<script type="text/javascript" >  

	// baidu.page.loadJsFile('http://baike.baidu.com/cms/s/banner/tmpact.js?r='+Math.random());             





function nslogcms(url,type) {
	var n="baikelog_"+(new Date()).getTime();
	var c=window[n]=new Image();
	c.onload=c.onerror=function(){	window[n]=null; };
	c.src='http://nsclick.baidu.com/v.gif?pid=103&type='+type +'&url='+encodeURIComponent(url) + '&referrer=' + encodeURIComponent(document.referrer) +'&t='+(new Date()).getTime();
	c=null;	
}


//如果是ipad 并且 非强制传统版
if (navigator.userAgent.indexOf('iPad')>=0 && !window.isForce2pc) {
	document.documentElement.className+=' ipad';
	var viewport = document.createElement('meta');
	viewport.name='viewport';
	viewport.content='width=device-width';
	document.getElementsByTagName('head')[0].appendChild(viewport);
	var nav=document.querySelectorAll('.nav li');
	var cate = document.getElementById('category_ipad');
	var li_cate=document.createElement('li');
	cate.style.display='block';
	li_cate.innerHTML='<span>分类频道 <b class="arr"></b></span>'
	document.querySelector('.nav').insertBefore(li_cate,nav[1]);
	for (var i=1; i<12; i++) {
		cate.appendChild(nav[i]);
		if (nav[i].className.indexOf('cur') >=0) {
			li_cate.className+='on cur';
			cate.style.height='40px';

		}
	}

	li_cate.ontouchend=function () {
		if (this.className.indexOf('on')>=0) {
			this.className=this.className.replace(/on/gi,'')
			cate.style.height='0px'
		}else {//展开
						nslogcms(location.href, 5825);
			this.className+=' on';
			cate.style.height='40px'
		}
		return false;
	}
	var li_navs = document.querySelectorAll('.nav li a');
	for (var i=0; i<li_navs.length; i++) {
		li_navs[i].addEventListener('click',function () {
			var logId = this.getAttribute ('data-tj');
			switch (logId) {
				case 'home':
					nslogcms(this.href,5824);
					break;
				case 'tupian':
										nslogcms(this.href,5826);
					break;
				case 'szbwg':
										nslogcms(this.href,5827);
					break;
				case 'bksc':
										nslogcms(this.href,5828);
					break;
			}
		},false);
	}
	

}

</script>

 </div></div><div id="page"><div id="content-wrap" class="layout grid-m0s245"> <div id="content" class="col-main article w1000"> <div class="main-wrap main-shadow" id="main-wrap"> <div class="content-hd"> <div class="content-hd-wrap"></div> </div> <div class="content-bd main-body"><div class="text lazyload" id="sec-content0" lazy-path="/static/lemma/ui/view/describeTips/describeTips.js" lazy-init="e.init('sec-content0')"> <div class="bk-editable-lemma-btns">  <a href="/tpldivideload?lemmaId=2115202" target="_blank" class="tpldivide-lemma lemma-top-link" id="tmpdivide" hidefocus="true" style="display: none;margin-right: 14px;"></a> <a href="/divideload?lemmaid=2115202" class="lemma-top-link" id="polyin" hidefocus="true" data-edit-id="2115202"></a>  <span class="lemma-top-link-divider lemma-top-link" id="link-divider"></span> <span class="throwbtl-link-span"></span><span class="editable-lemma rbedit" id="lemma-edit" data-edit-id="2115202"></span><span style="height:100%;"></span> </div> <h1 class="title" id="2115202">Framebuffer Driver</h1><script>var hash = window.location.hash;baikeInfo.hash = [];baikeInfo.lemmaHashFound = false;if(hash && (/^#sub(\d+)/.test(hash) ||/^#sub(?:\d+)(?:(?:-(\w*))|$)/.test(hash))){hash.indexOf("-")<0?baikeInfo.hash.push(hash):(baikeInfo.hash = hash.split("-"));baikeInfo.hash.unshift(baikeInfo.hash[0].match(/^#sub(\d+)/)[1]);hash = null;if(baikeInfo.hash[0]) {var lemmaDescArray = [{"subLemmaId":2115202,"subLemmaDesc":"Framebuffer Driver"}];for(var i = 0; i < lemmaDescArray.length; i++) {if(lemmaDescArray[i].subLemmaId == baikeInfo.hash[0]) {baikeInfo.lemmaHashFound = true;break;}}}}</script><script type="text/javascript">baikeInfo.expFlag = false;baikeViewInfo ={id:"2115202",versionId:"40667137",subLemmaId:"2115202",subVersionId:"39913078",editable:"true",title:"Framebuffer Driver",expIndex:"0", subLen:"1",isMulit:0,subList:[{"subLemmaDesc":"Framebuffer Driver","subLemmaId":2115202,"subVersionId":"39913078"}],cataList:[]};</script> <script type="text/javascript">(function(){window.rsInsertData = window['rsInsertData']||[];rsdataList = {"top":[],"foot":[]};if(rsdataList.top||rsdataList.foot){if(false) {delete rsdataList.top;window.specialCardType = true;}rsInsertData.push([2115202, rsdataList]);}window.refTipData = window['refTipData']||[];rfdataList = [];refTipData.push([2115202, rfdataList]);})();if(false) {window.specialCardJibing = true;}</script><div class="clear"></div><div id="lemmaContent-0" class="lemma-main-content rainbowlemma-0-"><div class="para">中文名为：帧缓冲驱动</div>
<div class="para">一、FrameBuffer的原理</div>
<div class="para">FrameBuffer 是出现在 2.2.xx 内核当中的一种驱动程序接口。</div>
<div class="para">Linux是工作在保护模式下，所以用户态进程是无法象DOS那样使用<a target=_blank href=/view/121647.htm>显卡BIOS</a>里提供的中断调用来实现直接写屏，Linux抽象出FrameBuffer这个设备来供用户态进程实现直接写屏。Framebuffer机制模仿显卡的功能，将显卡硬件结构抽象掉，可以通过Framebuffer的读写直接对显存进行操作。用户可以将Framebuffer看成是<a target=_blank href=/view/653593.htm>显示内存</a>的一个映像，将其映射到进程<a target=_blank href=/view/1507129.htm>地址空间</a>之后，就可以直接进行读写操作，而写操作可以立即反应在<a target=_blank href=/view/207233.htm>屏幕</a>上。这种操作是抽象的，统一的。用户不必关心<a target=_blank href=/view/6586054.htm>物理显存</a>的位置、换页机制等等具体细节，这些都是由Framebuffer<a target=_blank href=/view/547398.htm>设备驱动</a>来完成的。</div>
<div class="para">但Framebuffer本身不具备任何运算数据的能力,就只好比是一个暂时存放水的水池.CPU将运算后的结果放到这个水池,水池再将结果流到显示器.中间不会对数据做处理. <a target=_blank href=/view/330120.htm>应用程序</a>也可以直接读写这个水池的内容.在这种机制下，尽管Framebuffer需要真正的<a target=_blank href=/view/589085.htm>显卡驱动</a>的支持，但所有显示任务都有CPU完成,因此CPU负担很重</div>
<div class="para">framebuffer的设备文件一般是 /dev/fb0、/dev/fb1 等等。</div>
<div class="para">可以用命令: #dd if=/dev/zero of=/dev/fb 清空屏幕.</div>
<div class="para">如果显示模式是 1024x768-8 位色，用命令：$ dd if=/dev/zero of=/dev/fb0 bs=1024 count=768 清空屏幕；</div>
<div class="para">用命令: #dd if=/dev/fb of=fbfile 可以将fb中的内容保存下来；</div>
<div class="para">可以重新写回屏幕: #dd if=fbfile of=/dev/fb；</div>
<div class="para">在使用Framebuffer时，Linux是将<a target=_blank href=/view/2882.htm>显卡</a>置于图形模式下的．</div>
<div class="para">在<a target=_blank href=/view/330120.htm>应用程序</a>中，一般通过将 FrameBuffer 设备映射到进程<a target=_blank href=/view/1507129.htm>地址空间</a>的方式使用，比如下面的程序就打开 /dev/fb0 设备，并通过 mmap <a target=_blank href=/view/47173.htm>系统调用</a>进行<a target=_blank href=/view/396346.htm>地址映射</a>，随后用 memset 将屏幕清空（这里假设显示模式是 1024x768-8 位色模式，线性内存模式）：</div>
<div class="para">int fb;</div>
<div class="para">unsigned char* fb_mem;</div>
<div class="para">fb = open (&quot;/dev/fb0&quot;, O_RDWR);</div>
<div class="para">fb_mem = mmap (NULL, 1024*768, PROT_READ|PROT_WRITE,MAP_SHARED,fb,0);</div>
<div class="para">memset (fb_mem, 0, 1024*768); //这个命令应该只有在root可以执行</div>
<div class="para">FrameBuffer 设备还提供了若干 ioctl 命令，通过这些命令，可以获得显示设备的一些固定信息（比如显示内存大小）、与显示模式相关的可变信息（比如分辨率、象素结构、每<a target=_blank href=/view/861429.htm>扫描线</a>的字节宽度），以及<a target=_blank href=/view/189623.htm>伪彩色</a>模式下的<a target=_blank href=/view/1120949.htm>调色板</a>信息等等。</div>
<div class="para">通过 FrameBuffer 设备，还可以获得当前<a target=_blank href=/view/1366.htm>内核</a>所支持的加速显示卡的类型（通过固定信息得到），这种类型通常是和特定显示芯片相关的。比如目前最新的内核（2.4.9）中，就包含有对 S3、Matrox、nVidia、3Dfx 等等流行显示芯片的加速支持。在获得了加速芯片类型之后，<a target=_blank href=/view/330120.htm>应用程序</a>就可以将 PCI 设备的内存I/O（memio）映射到进程的<a target=_blank href=/view/1507129.htm>地址空间</a>。这些 memio 一般是用来控制显示卡的<a target=_blank href=/view/6159.htm>寄存器</a>，通过对这些寄存器的操作，<a target=_blank href=/view/330120.htm>应用程序</a>就可以控制特定<a target=_blank href=/view/2882.htm>显卡</a>的加速功能。</div>
<div class="para">PCI 设备可以将自己的<a target=_blank href=/view/4092816.htm>控制寄存器</a>映射到<a target=_blank href=/view/138684.htm>物理内存</a>空间，而后，对这些控制寄存器的访问，给变成了对物理内存的访问。因此，这些<a target=_blank href=/view/6159.htm>寄存器</a>又被称为&quot;memio&quot;。一旦被映射到<a target=_blank href=/view/138684.htm>物理内存</a>，Linux 的普通进程就可以通过 mmap 将这些内存 I/O 映射到进程<a target=_blank href=/view/1507129.htm>地址空间</a>，这样就可以直接访问这些<a target=_blank href=/view/6159.htm>寄存器</a>了。</div>
<div class="para">当然，因为不同的显示芯片具有不同的加速能力，对memio 的使用和定义也各自不同，这时，就需要针对加速芯片的不同类型来编写实现不同的加速功能。比如大多数芯片都提供了对矩形填充的<a target=_blank href=/view/1039397.htm>硬件加速</a>支持，但不同的芯片实现方式不同，这时，就需要针对不同的芯片类型编写不同的用来完成填充矩形的函数。</div>
<div class="para">FrameBuffer 只是一个提供<a target=_blank href=/view/653593.htm>显示内存</a>和<a target=_blank href=/view/7254.htm>显示芯片</a>寄存器从<a target=_blank href=/view/138684.htm>物理内存</a>映射到进程<a target=_blank href=/view/1507129.htm>地址空间</a>中的设备。所以，对于<a target=_blank href=/view/330120.htm>应用程序</a>而言，如果希望在 FrameBuffer 之上进行图形编程，还需要自己动手完成其他许多工作。</div>
<div class="para">二、FrameBuffer在Linux中的实现和机制</div>
<div class="para">Framebuffer对应的源文件在linux/drivers/video/目录下。总的抽象设备文件为fbcon.c，在这个目录下还有与各种<a target=_blank href=/view/589085.htm>显卡驱动</a>相关的源文件。 //这个文件要好好看看</div>
<div class="para">(一)、分析Framebuffer<a target=_blank href=/view/547398.htm>设备驱动</a></div>
<div class="para">需要特别提出的是在INTEL平台上，老式的VESA 1.2 卡，如CGA/EGA卡，是不能支持Framebuffer的，因为Framebuffer要求<a target=_blank href=/view/2882.htm>显卡</a>支持线性帧缓冲，即CPU可以访问显缓冲中的每一位，但是VESA 1.2 卡只能允许CPU一次访问64K的<a target=_blank href=/view/1507129.htm>地址空间</a>。</div>
<div class="para">FrameBuffer<a target=_blank href=/view/547398.htm>设备驱动</a>基于如下两个文件：</div>
<div class="para">1) linux/include/linux/fb.h</div>
<div class="para">2) linux/drivers/video/fbmem.c</div>
<div class="para">下面分析这两个文件。</div>
<div class="para">1、fb.h</div>
<div class="para">几乎主要的结构都是在这个中文件定义的。这些结构包括：</div>
<div class="para">1）fb_var_screeninfo</div>
<div class="para">这个结构描述了显示卡的特性：</div>
<div class="para">NOTE:::: __u32 是表示 unsigned 不带符号的 32 bits 的数据类型，其余类推。这是 Linux <a target=_blank href=/view/1366.htm>内核</a>中所用到的数据类型，如果是开发<a target=_blank href=/view/4274331.htm>用户空间</a>（user-space）的程序，可以根据具体<a target=_blank href=/view/2269685.htm>计算机平台</a>的情况，用 unsigned long 等等来代替</div>
<div class="para">struct fb_var_screeninfo</div>
<div class="para">{</div>
<div class="para">__u32 xres; /* visible resolution */ //可视区域</div>
<div class="para">__u32 yres;</div>
<div class="para">__u32 xres_virtual; /* virtual resolution */ //可视区域</div>
<div class="para">__u32 yres_virtual;</div>
<div class="para">__u32 xoffset; /* offset from virtual to visible resolution */ //可视区域的偏移</div>
<div class="para">__u32 yoffset;</div>
<div class="para">__u32 bits_per_pixel; /* guess what */ //每一象素的bit数</div>
<div class="para">__u32 grayscale; /* != 0 Gray levels instead of colors *///等于零就成黑白</div>
<div class="para">struct fb_<a target=_blank href=/view/817284.htm>bitfield</a> red; /* bitfield in fb mem if true color, */真彩的bit机构</div>
<div class="para">struct fb_bitfield green; /* else only length is significant */</div>
<div class="para">struct fb_bitfield blue; </div>
<div class="para">struct fb_bitfield transp; /* transparency */ 透明</div>
<div class="para">__u32 nonstd; /* != 0 Non standard pixel format */ 不是标准格式</div>
<div class="para">__u32 activate; /* see FB_ACTIVATE_* */ </div>
<div class="para">__u32 height; /* height of picture in mm */ 内存中的图像高度</div>
<div class="para">__u32 width; /* width of picture in mm */ 内存中的图像宽度</div>
<div class="para">__u32 accel_flags; /* acceleration flags (hints) */ 加速标志</div>
<div class="para">/* Timing: All values in pixclocks, except pixclock (of course) */</div>
<div class="para">时序-_-这些部分就是显示器的显示方法了，可以找相关的资料看看</div>
<div class="para">__u32 pixclock; /* pixel clock in ps (pico seconds) */</div>
<div class="para">__u32 left_margin; /* time from sync to picture */</div>
<div class="para">__u32 right_margin; /* time from picture to sync */</div>
<div class="para">__u32 upper_margin; /* time from sync to picture */</div>
<div class="para">__u32 lower_margin;</div>
<div class="para">__u32 hsync_len; /* length of horizontal sync */ 水平可视区域</div>
<div class="para">__u32 vsync_len; /* length of vertical sync */ 垂直可视区域</div>
<div class="para">__u32 sync; /* see FB_SYNC_* */</div>
<div class="para">__u32 vmode; /* see FB_VMODE_* */</div>
<div class="para">__u32 reserved&#91;6&#93;; /* Reserved for future compatibility */ 备用－以后开发</div>
<div class="para">};</div>
<div class="para">2) fb_fix_screeninfon</div>
<div class="para">这个结构在<a target=_blank href=/view/2882.htm>显卡</a>被设定模式后创建，它描述显示卡的属性，并且系统运行时不能被修改；比如FrameBuffer内存的起始地址。它依赖于被设定的模式，当一个模式被设定后，内存信息由显示卡硬件给出，内存的位置等信息就不可以修改。</div>
<div class="para">struct fb_fix_screeninfo {</div>
<div class="para">char id&#91;16&#93;; /* identification string eg &quot;TT Builtin&quot; */ID</div>
<div class="para">unsigned long smem_start; /* Start of frame buffer mem */ 内存起始</div>
<div class="para">/* (physical address) */ <a target=_blank href=/view/883168.htm>物理地址</a></div>
<div class="para">__u32 smem_len; /* Length of frame buffer mem */ 内存大小</div>
<div class="para">__u32 type; /* see FB_TYPE_* */ </div>
<div class="para">__u32 type_aux; /* Interleave for interleaved Planes */插入区域？</div>
<div class="para">__u32 visual; /* see FB_VISUAL_* */</div>
<div class="para">__u16 xpanstep; /* zero if no hardware panning */没有硬件设备就为零</div>
<div class="para">__u16 ypanstep; /* zero if no hardware panning */</div>
<div class="para">__u16 ywrapstep; /* zero if no hardware ywrap */</div>
<div class="para">__u32 line_length; /* length of a line in bytes */ 一行的字节表示</div>
<div class="para">unsigned long mmio_start; /* Start of Memory Mapped I/O */内存映射的I/O起始</div>
<div class="para">/* (physical address) */ </div>
<div class="para">__u32 mmio_len; /* Length of Memory Mapped I/O */ I/O的大小</div>
<div class="para">__u32 accel; /* Type of acceleration available */ 可用的加速类型</div>
<div class="para">__u16 reserved&#91;3&#93;; /* Reserved for future compatibility */</div>
<div class="para">};</div>
<div class="para">3) fb_cmap</div>
<div class="para">描述设备无关的颜色映射信息。可以通过FBIOGETCMAP 和 FBIOPUTCMAP 对应的ioctl操作设定或获取颜色映射信息.</div>
<div class="para">struct fb_cmap {</div>
<div class="para">__u32 start; /* First entry */ 第一个入口</div>
<div class="para">__u32 len; /* Number of entries */ 入口的数字</div>
<div class="para">__u16 *red; /* Red values */ 红</div>
<div class="para">__u16 *green;</div>
<div class="para">__u16 *blue;</div>
<div class="para">__u16 *transp; /* transparency, can be NULL */ 透明，可以为零</div>
<div class="para">};</div>
<div class="para">4) fb_info</div>
<div class="para">定义显卡的当前状态；fb_info结构仅在<a target=_blank href=/view/1366.htm>内核</a>中可见，在这个结构中有一个fb_ops<a target=_blank href=/view/159417.htm>指针</a>， 指向驱动设备工作所需的函数集。</div>
<div class="para">struct fb_info {</div>
<div class="para">char modename&#91;40&#93;; /* default video mode */ 默认的视频卡类型</div>
<div class="para">kdev_t node;</div>
<div class="para">int flags;</div>
<div class="para">int open; /* Has this been open already ? */ 被打开过么？</div>
<div class="para">#define FBINFO_FLAG_MODULE 1 /* Low-level driver is a module */ </div>
<div class="para">struct fb_var_screeninfo var; /* Current var */ 现在的视频信息</div>
<div class="para">struct fb_fix_screeninfo fix; /* Current fix */ 修正的信息</div>
<div class="para">struct fb_monspecs monspecs; /* Current Monitor specs */ 现在的显示器模式</div>
<div class="para">struct fb_cmap cmap; /* Current cmap */ 当前优先级</div>
<div class="para">struct fb_ops *fbops;</div>
<div class="para">char *screen_base; /* Virtual address */ 物理基址</div>
<div class="para">struct display *disp; /* initial display variable */初始化</div>
<div class="para">struct vc_data *display_fg; /* Console visible on this display */</div>
<div class="para">char fontname&#91;40&#93;; /* default font name */默认的<a target=_blank href=/view/285104.htm>字体</a></div>
<div class="para">devfs_handle_t devfs_handle; /* Devfs handle for new name */</div>
<div class="para">devfs_handle_t devfs_lhandle; /* Devfs handle for compat. symlink */兼容</div>
<div class="para">int (*changevar)(int); /* tell console var has changed */ 告诉console变量修改了</div>
<div class="para">int (*switch_con)(int, struct fb_info*);</div>
<div class="para">/* tell fb to switch consoles */ 告诉fb选择consoles</div>
<div class="para">int (*updatevar)(int, struct fb_info*);</div>
<div class="para">/* tell fb to update the vars */ 告诉fb更新<a target=_blank href=/view/296689.htm>变量</a></div>
<div class="para">void (*blank)(int, struct fb_info*); /* tell fb to (un)blank the screen */告诉fb使用黑白模式（或者不黑）</div>
<div class="para">/* arg = 0: unblank */arg=0的时候黑白模式</div>
<div class="para">/* arg &gt; 0: VESA level (arg-1) */ arg&gt;0时候选择VESA模式</div>
<div class="para">void *pseudo_palette; /* Fake palette of 16 colors and</div>
<div class="para">the cursor's color for non</div>
<div class="para">palette mode */ 修正<a target=_blank href=/view/1120949.htm>调色板</a></div>
<div class="para">/* From here on everything is device dependent */ 现在就可以使用了</div>
<div class="para">void *par;</div>
<div class="para">};</div>
<div class="para">5) struct fb_ops</div>
<div class="para">用户应用可以使用ioctl()系统调用来操作设备，这个结构就是用一支持ioctl()的这些操作的。</div>
<div class="para">struct fb_ops {</div>
<div class="para">/* open/release and usage marking */</div>
<div class="para">struct module *owner;</div>
<div class="para">int (*fb_open)(struct fb_info *info, int user);</div>
<div class="para">int (*fb_release)(struct fb_info *info, int user);</div>
<div class="para">/* get non settable parameters */</div>
<div class="para">int (*fb_get_fix)(struct fb_fix_screeninfo *fix, int con,</div>
<div class="para">struct fb_info *info);</div>
<div class="para">/* get settable parameters */</div>
<div class="para">int (*fb_get_var)(struct fb_var_screeninfo *var, int con,</div>
<div class="para">struct fb_info *info);</div>
<div class="para">/* set settable parameters */</div>
<div class="para">int (*fb_set_var)(struct fb_var_screeninfo *var, int con,</div>
<div class="para">struct fb_info *info);</div>
<div class="para">/* get colormap */</div>
<div class="para">int (*fb_get_cmap)(struct fb_cmap *cmap, int kspc, int con,</div>
<div class="para">struct fb_info *info);</div>
<div class="para">/* set colormap */</div>
<div class="para">int (*fb_set_cmap)(struct fb_cmap *cmap, int kspc, int con,</div>
<div class="para">struct fb_info *info);</div>
<div class="para">/* pan display (optional) */</div>
<div class="para">int (*fb_pan_display)(struct fb_var_screeninfo *var, int con,</div>
<div class="para">struct fb_info *info);</div>
<div class="para">/* perform fb specific ioctl (optional) */</div>
<div class="para">int (*fb_ioctl)(struct inode *inode, struct file *file, unsigned int cmd,</div>
<div class="para">unsigned long arg, int con, struct fb_info *info);</div>
<div class="para">/* perform fb specific mmap */</div>
<div class="para">int (*fb_mmap)(struct fb_info *info, struct file *file, struct vm_area_struct *vma);</div>
<div class="para">/* switch to/from raster image mode */</div>
<div class="para">int (*fb_rasterimg)(struct fb_info *info, int start);</div>
<div class="para">};</div>
<div class="para">6) structure map</div>
<div class="para">struct fb_info_gen | struct fb_info | fb_var_screeninfo</div>
<div class="para">| | fb_fix_screeninfo</div>
<div class="para">| | fb_cmap</div>
<div class="para">| | modename&#91;40&#93;</div>
<div class="para">| | fb_ops ---|---&gt;ops on var</div>
<div class="para">| | ... | fb_open</div>
<div class="para">| | | fb_release</div>
<div class="para">| | | fb_ioctl</div>
<div class="para">| | | fb_mmap</div>
<div class="para">| struct fbgen_hwswitch </div>
<div class="para">\-----|-&gt; detect</div>
<div class="para">| encode_fix</div>
<div class="para">| encode_var</div>
<div class="para">| decode_fix</div>
<div class="para">| decode_var</div>
<div class="para">| get_var</div>
<div class="para">| set_var</div>
<div class="para">| getcolreg</div>
<div class="para">| setcolreg</div>
<div class="para">| pan_display</div>
<div class="para">| blank</div>
<div class="para">| set_disp</div>
<div class="para">&#91;编排有点困难，第一行的第一条竖线和下面的第一列竖线对齐，第一行的第二条竖线和下面的第二列竖线对齐就可以了&#93;</div>
<div class="para">这个结构 fbgen_hwswitch抽象了硬件的操作.虽然它不是必需的，但有时候很有用.</div>
<div class="para">2、 fbmem.c</div>
<div class="para">fbmem.c 处于Framebuffer<a target=_blank href=/view/547398.htm>设备驱动</a>技术的中心位置.它为上层<a target=_blank href=/view/330120.htm>应用程序</a>提供系统调用也为下一层的特定硬件驱动提供接口；那些底层硬件驱动需要用到这儿的接口来向系统内核注册它们自己. fbmem.c 为所有支持FrameBuffer的<a target=_blank href=/view/547398.htm>设备驱动</a>提供了通用的接口，避免重复工作.</div>
<div class="para">1) <a target=_blank href=/view/261041.htm>全局变量</a></div>
<div class="para">struct fb_info *registered_fb&#91;FB_MAX&#93;;</div>
<div class="para">int num_registered_fb;</div>
<div class="para">这两<a target=_blank href=/view/296689.htm>变量</a>记录了所有fb_info 结构的实例，fb_info 结构描述显卡的当前状态，所有设备对应的fb_info 结构都保存在这个<a target=_blank href=/view/209670.htm>数组</a>中，当一个FrameBuffer<a target=_blank href=/view/547398.htm>设备驱动</a>向系统注册自己时，其对应的fb_info 结构就会添加到这个结构中，同时num_registered_fb 为自动加1.</div>
<div class="para">static struct {</div>
<div class="para">const char *name;</div>
<div class="para">int (*init)(void);</div>
<div class="para">int (*setup)(void);</div>
<div class="para">} fb_drivers&#91;&#93; __initdata= { ....};</div>
<div class="para">如果FrameBuffer设备被<a target=_blank href=/view/945739.htm>静态链接</a>到内核，其对应的入口就会添加到这个表中；如果是动态加载的，即使用insmod/rmmod,就不需要关心这个表。</div>
<div class="para">static struct file_operations fb_ops ={</div>
<div class="para">owner: THIS_MODULE,</div>
<div class="para">read: fb_read,</div>
<div class="para">write: fb_write,</div>
<div class="para">ioctl: fb_ioctl,</div>
<div class="para">mmap: fb_mmap,</div>
<div class="para">open: fb_open,</div>
<div class="para">release: fb_release</div>
<div class="para">};</div>
<div class="para">这是一个提供给<a target=_blank href=/view/330120.htm>应用程序</a>的接口.</div>
<div class="para">2）fbmem.c 实现了如下函数.</div>
<div class="para">register_framebuffer(struct fb_info *fb_info);</div>
<div class="para">unregister_framebuffer(struct fb_info *fb_info);</div>
<div class="para">这两个是提供给下层FrameBuffer<a target=_blank href=/view/547398.htm>设备驱动</a>的接口，设备驱动通过这两函数向系统注册或注销自己。几乎底层<a target=_blank href=/view/547398.htm>设备驱动</a>所要做的所有事情就是填充fb_info结构然后向系统注册或注销它。</div>
<div class="para">（二）一个LCD显示芯片的驱动实例</div>
<div class="para">以Skeleton LCD 控制器驱动为例，在LINUX中存有一个/fb/skeleton.c的skeleton的Framebuffer驱动程序，很简单，仅仅是填充了 fb_info结构，并且注册/注销自己。设备驱动是向<a target=_blank href=/view/1976812.htm>用户程序</a>提供系统调用接口，所以我们需要实现底层硬件操作并且定义file_operations 结构来向系统提供系统调用接口，从而实现更有效的LCD控制器驱动程序。</div>
<div class="para">1）在<a target=_blank href=/view/404470.htm>系统内存</a>中分配显存</div>
<div class="para">在fbmem.c文件中可以看到, file_operations 结构中的open()和release()操作不需底层支持，但read()、write()和 mmap()操作需要函数fb_get_fix()的支持.因此需要重新实现函数fb_get_fix()。另外还需要在<a target=_blank href=/view/404470.htm>系统内存</a>中分配显存空间，大多数的LCD控制器都没有自己的显存空间，被分配的<a target=_blank href=/view/1507129.htm>地址空间</a>的起始地址与长度将会被填充到fb_fix_screeninfo 结构的smem_start 和smem_len 的两个变量中.被分配的空间必须是物理连续的。</div>
<div class="para">2）实现 fb_ops 中的函数</div>
<div class="para">用户<a target=_blank href=/view/330120.htm>应用程序</a>通过ioctl()系统调用操作硬件，fb_ops 中的函数就用于支持这些操作。（注： fb_ops结构与file_operations 结构不同，fb_ops是底层操作的抽象,而file_operations是提供给上层系统调用的接口，可以直接调用.</div>
<div class="para">ioctl()系统调用在文件fbmem.c中实现，通过观察可以发现ioctl()命令与fb_ops’s 中函数的关系:</div>
<div class="para">FBIOGET_VSCREENINFO fb_get_var</div>
<div class="para">FBIOPUT_VSCREENINFO fb_set_var</div>
<div class="para">FBIOGET_FSCREENINFO fb_get_fix</div>
<div class="para">FBIOPUTCMAP fb_set_cmap</div>
<div class="para">FBIOGETCMAP fb_get_cmap</div>
<div class="para">FBIOPAN_DISPLAY fb_pan_display</div>
<div class="para">如果我们定义了fb_XXX_XXX 方法，<a target=_blank href=/view/1976812.htm>用户程序</a>就可以使用FBIOXXXX宏的ioctl()操作来操作硬件。</div>
<div class="para">文件linux/drivers/video/fbgen.c或者linux/drivers/video目录下的其它<a target=_blank href=/view/547398.htm>设备驱动</a>是比较好的参考资料。在所有的这些函数中fb_set_var()是最重要的，它用于设定显示卡的模式和其它属性，下面是函数fb_set_var()的执行步骤：</div>
<div class="para">1)检测是否必须设定模式</div>
<div class="para">2)设定模式</div>
<div class="para">3)设定颜色映射</div>
<div class="para">4) 根据以前的设定重新设置LCD控制器的各<a target=_blank href=/view/6159.htm>寄存器</a>。</div>
<div class="para">第四步表明了底层操作到底放置在何处。在<a target=_blank href=/view/404470.htm>系统内存</a>中分配显存后，显存的起始地址及长度将被设定到LCD控制器的各<a target=_blank href=/view/6159.htm>寄存器</a>中（一般通过fb_set_var() 函数），显存中的内容将自动被LCD控制器输出到屏幕上。另一方面，<a target=_blank href=/view/1976812.htm>用户程序</a>通过函数mmap()将显存映射到用户进程<a target=_blank href=/view/1507129.htm>地址空间</a>中，然后用户进程向映射空间发送的所有数据都将会被显示到<a target=_blank href=/view/724312.htm>LCD显示器</a>上。 </div>
<div class="para">三、FrameBuffer的应用</div>
<div class="para">（一）、一个使用FrameBuffer的例子</div>
<div class="para">FrameBuffer主要是根据VESA标准的实现的，所以只能实现最简单的功能。 </div>
<div class="para">由于涉及内核的问题，FrameBuffer是不允许在系统起来后修改显示模式等一系列操作。（好象很多人都想要这样干，这是不被允许的，当然如果你自己写驱动的话，是可以实现的）. </div>
<div class="para">对FrameBuffer的操作，会直接影响到本机的所有控制台的输出，包括XWIN的图形界面。 </div>
<div class="para">在struct fb_info 中的char fontname&#91;40&#93;; /* default font name */默认的<a target=_blank href=/view/285104.htm>字体</a></div>
<div class="para">就可以实现显示的中文化－－－－难道 篮点linux就是这样搞得？？</div>
<div class="para">好，现在可以让我们开始实现直接写屏：</div>
<div class="para">1、打开一个FrameBuffer设备</div>
<div class="para">2、通过mmap调用把<a target=_blank href=/view/2882.htm>显卡</a>的<a target=_blank href=/view/138684.htm>物理内存</a>空间映射到<a target=_blank href=/view/4274331.htm>用户空间</a></div>
<div class="para">3、直接写内存。</div>
<div class="para">/********************************</div>
<div class="para">File name : fbtools.h</div>
<div class="para">*/</div>
<div class="para">#ifndef _FBTOOLS_H_</div>
<div class="para">#define _FBTOOLS_H_</div>
<div class="para">#include &lt;linux/fb.h&gt;</div>
<div class="para">//a framebuffer device structure;</div>
<div class="para">typedef struct fbdev{</div>
<div class="para">int fb;</div>
<div class="para">unsigned long fb_mem_offset;</div>
<div class="para">unsigned long fb_mem;</div>
<div class="para">struct fb_fix_screeninfo fb_fix;</div>
<div class="para">struct fb_var_screeninfo fb_var;</div>
<div class="para">char dev&#91;20&#93;;</div>
<div class="para">} FBDEV, *PFBDEV;</div>
<div class="para">//open &amp; init a frame buffer</div>
<div class="para">//to use this function,</div>
<div class="para">//you must set FBDEV.dev=&quot;/dev/fb0&quot;</div>
<div class="para">//or &quot;/dev/fbX&quot;</div>
<div class="para">//it's your frame buffer.</div>
<div class="para">int fb_open(PFBDEV pFbdev);</div>
<div class="para">//close a frame buffer</div>
<div class="para">int fb_close(PFBDEV pFbdev);</div>
<div class="para">//get display depth</div>
<div class="para">int get_display_depth(PFBDEV pFbdev);</div>
<div class="para">//full screen clear</div>
<div class="para">void fb_memset(void *addr, int c, <a target=_blank href=/view/3236587.htm>size_t</a> len);</div>
<div class="para">#endif </div>
<div class="para">/******************</div>
<div class="para">File name : fbtools.c</div>
<div class="para">*/</div>
<div class="para">#include &lt;stdio.h&gt;</div>
<div class="para">#include &lt;stdlib.h&gt;</div>
<div class="para">#include &lt;fcntl.h&gt;</div>
<div class="para">#include &lt;unistd.h&gt;</div>
<div class="para">#include &lt;string.h&gt;</div>
<div class="para">#include &lt;sys/ioctl.h&gt;</div>
<div class="para">#include &lt;sys/mman.h&gt;</div>
<div class="para">#include &lt;asm/page.h&gt;</div>
<div class="para">#include &quot;fbtools.h&quot;</div>
<div class="para">#define TRUE 1</div>
<div class="para">#define FALSE 0</div>
<div class="para">#define MAX(x,y) ((x)&gt;(y)?(x)y))</div>
<div class="para">#define MIN(x,y) ((x)&lt;(y)?(x)y))</div>
<div class="para">//open &amp; init a frame buffer</div>
<div class="para">int fb_open(PFBDEV pFbdev)</div>
<div class="para">{</div>
<div class="para">pFbdev-&gt;fb = open(pFbdev-&gt;dev, O_RDWR);</div>
<div class="para">if(pFbdev-&gt;fb &lt; 0)</div>
<div class="para">{</div>
<div class="para">printf(&quot;Error opening %s: %m. Check kernel config\n&quot;, pFbdev-&gt;dev);</div>
<div class="para">return FALSE;</div>
<div class="para">}</div>
<div class="para">if (-1 == ioctl(pFbdev-&gt;fb,FBIOGET_VSCREENINFO,&amp;(pFbdev-&gt;fb_var)))</div>
<div class="para">{</div>
<div class="para">printf(&quot;ioctl FBIOGET_VSCREENINFO\n&quot;);</div>
<div class="para">return FALSE;</div>
<div class="para">}</div>
<div class="para">if (-1 == ioctl(pFbdev-&gt;fb,FBIOGET_FSCREENINFO,&amp;(pFbdev-&gt;fb_fix)))</div>
<div class="para">{</div>
<div class="para">printf(&quot;ioctl FBIOGET_FSCREENINFO\n&quot;);</div>
<div class="para">return FALSE;</div>
<div class="para">}</div>
<div class="para">//map physics address to virtual address</div>
<div class="para">pFbdev-&gt;fb_mem_offset = (unsigned long)(pFbdev-&gt;fb_fix.smem_start) &amp; (~PAGE_MASK);</div>
<div class="para">pFbdev-&gt;fb_mem = (unsigned long int)mmap(NULL, pFbdev-&gt;fb_fix.smem_len + pFbdev-&gt;fb_mem_offset, PROT_READ | PROT_WRITE, MAP_SHARED, pFbdev-&gt;fb, 0);</div>
<div class="para">if (-1L == (long) pFbdev-&gt;fb_mem)</div>
<div class="para">{</div>
<div class="para">printf(&quot;mmap error! mem:%d offset:%d\n&quot;, pFbdev-&gt;fb_mem, pFbdev-&gt;fb_mem_offset);</div>
<div class="para">return FALSE;</div>
<div class="para">}</div>
<div class="para">return TRUE;</div>
<div class="para">}</div>
<div class="para">//close frame buffer</div>
<div class="para">int fb_close(PFBDEV pFbdev)</div>
<div class="para">{</div>
<div class="para">close(pFbdev-&gt;fb);</div>
<div class="para">pFbdev-&gt;fb=-1;</div>
<div class="para">}</div>
<div class="para">//get display depth</div>
<div class="para">int get_display_depth(PFBDEV pFbdev);</div>
<div class="para">{</div>
<div class="para">if(pFbdev-&gt;fb&lt;=0)</div>
<div class="para">{</div>
<div class="para">printf(&quot;fb device not open, open it first\n&quot;);</div>
<div class="para">return FALSE;</div>
<div class="para">}</div>
<div class="para">return pFbdev-&gt;fb_var.bits_per_pixel;</div>
<div class="para">}</div>
<div class="para">//full screen clear</div>
<div class="para">void fb_memset (void *addr, int c, <a target=_blank href=/view/3236587.htm>size_t</a> len)</div>
<div class="para">{</div>
<div class="para">memset(addr, c, len);</div>
<div class="para">}</div>
<div class="para">//use by test</div>
<div class="para">#define DEBUG</div>
<div class="para">#ifdef DEBUG</div>
<div class="para">main()</div>
<div class="para">{</div>
<div class="para">FBDEV fbdev;</div>
<div class="para">memset(&amp;fbdev, 0, sizeof(FBDEV));</div>
<div class="para">strcpy(fbdev.dev, &quot;/dev/fb0&quot;);</div>
<div class="para">if(fb_open(&amp;fbdev)==FALSE)</div>
<div class="para">{</div>
<div class="para">printf(&quot;open frame buffer error\n&quot;);</div>
<div class="para">return;</div>
<div class="para">}</div>
<div class="para">fb_memset(fbdev.fb_mem + fbdev.fb_mem_offset, 0, fbdev.fb_fix.smem_len);</div>
<div class="para">fb_close(&amp;fbdev);</div>
<div class="para">}</div>
<div class="para">（二）基于Linux核心的汉字显示的尝试</div>
<div class="para">我们以一个简单的例子来说明字符显示的过程。我们假设是在<a target=_blank href=/view/694267.htm>虚拟终端</a>1（/dev/tty1）下运行一个如下的简单程序。</div>
<div class="para">main ( )</div>
<div class="para">{</div>
<div class="para">puts(&quot;hello, world.\n&quot;);</div>
<div class="para">}</div>
<div class="para">puts 函数向缺省输出文件(/dev/tty1)发出写的系统调用write(2)。系统调用到linux核心里面对应的核心函数是console.c中的 con_write()，con_write()最终会调用do_con_write( )。在do_con_write( )中负责把&quot;hello, world.\n&quot;这个字符串放到tty1对应的<a target=_blank href=/view/266782.htm>缓冲区</a>中去。</div>
<div class="para">do_con_write( )还负责处理<a target=_blank href=/view/1112575.htm>控制字符</a>和光标的位置。让我们来看一下do_con_write()这个函数的声明。</div>
<div class="para">static int do_con_write(struct tty_struct * tty, int from_user, const unsigned char *buf, int count)</div>
<div class="para">其中tty是指向tty_struct结构的指针，这个结构里面存放着关于这个tty的所有信息（请参照 linux/include/linux/tty.h）。Tty_struct结构中定义了通用（或高层）tty的属性（例如宽度和高度等）。在do_con_write( )函数中用到了tty_struct结构中的driver_data<a target=_blank href=/view/296689.htm>变量</a>。driver_data是一个vt_struct指针。在vt_struct结构中包含这个tty的序列号（我们正使用tty1，所以这个序号为1）。Vt_struct结构中有一个vc结构的<a target=_blank href=/view/209670.htm>数组</a>vc_cons，这个数组就是各<a target=_blank href=/view/694267.htm>虚拟终端</a>的私有数据。</div>
<div class="para">static int do_con_write(struct tty_struct * tty, int from_user,const unsigned char *buf, int count)</div>
<div class="para">{</div>
<div class="para">struct vt_struct *vt = (struct vt_struct *)tty-&gt;driver_data;//我们用到了driver_data变量</div>
<div class="para">. . . . .</div>
<div class="para">currcons = vt-&gt;vc_num; file://我们在这里的vc_nums就是1</div>
<div class="para">. . . . .</div>
<div class="para">}</div>
<div class="para">要访问<a target=_blank href=/view/694267.htm>虚拟终端</a>的私有数据，需使用vc_cons〔currcons〕.d指针。这个指针指向的结构含有当前<a target=_blank href=/view/694267.htm>虚拟终端</a>上光标的位置、<a target=_blank href=/view/266782.htm>缓冲区</a>的起始地址、缓冲区大小等等。</div>
<div class="para">&quot;hello, world.\n&quot;中的每一个字符都要经过conv_uni_to_pc( )这个函数转换成8位的显示字符。这要做的主要目的是使不同语言的国家能把16位的UniCode码映射到8位的显示<a target=_blank href=/view/51987.htm>字符集</a>上，目前还是主要针对<a target=_blank href=/view/3622.htm>欧洲</a>国家的语言，映射结果为8位，不包含对双字节（double byte）的范围。</div>
<div class="para">这种UNICODE到显示<a target=_blank href=/view/263416.htm>字符</a>的映射关系可以由用户自行定义。在缺省的映射表上，会把中文的<a target=_blank href=/view/263416.htm>字符</a>映射到其他的字符上，这是我们不希望看到也是不需要的。所以我们有两个选择∶</div>
<div class="para">不进行conv_uni_to_pc( )的转换。 </div>
<div class="para">加载符合双<a target=_blank href=/view/60408.htm>字节</a>处理的映射关系，即对非<a target=_blank href=/view/1112575.htm>控制字符</a>进行1对1的不变映射。我们自己定制的符合这种映射关系的UNICODE码表是direct.uni。要想查看/装载当前系统的unicode映射表，可使外部命令loadunimap。 </div>
<div class="para">经过conv_uni_to_pc( )转换之后，&quot;hello, world.\n&quot;中的字符被一个一个地填写到tty1的<a target=_blank href=/view/266782.htm>缓冲区</a>中。然后do_con_write( )调用下层的驱动，把<a target=_blank href=/view/266782.htm>缓冲区</a>中的内容输出到显示器上（也就相当于把缓冲区的内容拷贝到VGA显存中去）。</div>
<div class="para">sw-&gt;con_putcs(vc_cons〔currcons〕.d, (u16 *)draw_from, (u16*)draw_to-(u16 *)draw_from, y, draw_x);</div>
<div class="para">之所以要调用<a target=_blank href=/view/3159752.htm>底层驱动</a>，是因为存在不同的显示设备，其对应VGA显存的存取方式也不一样。</div>
<div class="para">上面的Sw-&gt;con_putcs( )就会调用到fbcon.c中的fbcon_putcs()函数（con_putcs是一个函数的指针，在Framebuffer模式下指向 fbcon_putcs()函数）。也就是说在do_con_write( )函数中是直接调用了fbcon_putcs()函数来进行字符的绘制。比如说在256色模式下，真正负责输出的函数是void fbcon_cfb8_putcs(struct vc_data *conp, struct display *p,const unsigned short *s, int count, int yy, int xx)</div>
<div class="para">显示中文</div>
<div class="para">比如说我们试图输出一句中文∶putcs(你好\n );（你好的<a target=_blank href=/view/943167.htm>内码</a>为0xc4,0xe3,0xba,0xc3）。这时候会怎么样呢，有一点可以肯定，&quot;你好&quot;肯定不会出现在<a target=_blank href=/view/207233.htm>屏幕</a>上，国为核心中没有汉字<a target=_blank href=/view/1127103.htm>字库</a>，中文显示就是无米之炊了．</div>
<div class="para">1 在负责字符显示的void fbcon_cfb8_putcs( )函数中，原有操作如下∶对于每个要显示的字符，依次从<a target=_blank href=/view/694267.htm>虚拟终端</a><a target=_blank href=/view/266782.htm>缓冲区</a>中以WORD为单位读取（低位<a target=_blank href=/view/60408.htm>字节</a>是ASCII码，高8位是字符的属性），由于汉字是双字节编码方式，所以这种操作是不可能显示出汉字的，只能显示出xxxx_putcs()是一个一个VGA字符．</div>
<div class="para">要解决的问题∶</div>
<div class="para">确保在do_con_write( )时uni_pc转换不会改变原有编码。一个很直接的实现方式就是加载一个我们自己定制的UNICODE映射表，loadunimapdirect.uni，或者直接把direct.uni置为核心的缺省映射表。</div>
<div class="para">针对如上问题，我们要做的第一个尝试方案是如下。</div>
<div class="para">首先需要在核心中加载汉字<a target=_blank href=/view/1127103.htm>字库</a>，然后修改fbcon_cfb8_putcs()函数，在fbcon_cfb8_putcs( )中一次读两个WORD，检查这两个WORD的低位字节是否能拼成一个汉字，如果发现能拼成一个汉字，就算出这个汉字在汉字字库中的偏移，然后把它当成一个16 x 16的VGA字符来显示。</div>
<div class="para">试验的结果表明∶</div>
<div class="para">能够输出汉字，但仍有许多不理想的地方，比如说，输出以半个汉字开始的一串汉字，则这半个汉字后面的汉字都会是<a target=_blank href=/view/47.htm>乱码</a>。这是半个汉字的问题。 </div>
<div class="para">光标移动会破坏汉字的显示。表现为，光标移动过的汉字会变成<a target=_blank href=/view/47.htm>乱码</a>。这是因为光标的更新是通过xxxx_putc( )函数来完成的。 </div>
<div class="para">xxxx_putc( )函数与xxxx_putcs( )函数实现的功能类似，但是xxxx_putc()函数只刷新一个字符而不是一个字符串，因而xxxx_putc()的输入参数是一个整数，而不是一个字符串的地址。Xxxx_putc( )函数的声明如下∶void fbcon_cfb8_putc(struct vc_data *conp, struct display *p, int c, int yy, int xx)</div>
<div class="para">下一个尝试方案就是同时修改xxxx_putcs( )函数和xxxx_putc()函数。为了解决半个汉字的问题，每一次输出之前，都从<a target=_blank href=/view/207233.htm>屏幕</a>当前行的起始位置开始扫描，以确定要输出的字符是否落在半个汉字的位置上。如果是半个汉字的位置，则进行相应的调整，即从向前移动一个字节的位置开始输出。</div>
<div class="para">这个方案有一个困难，即xxxx_putc( )函数不用<a target=_blank href=/view/266782.htm>缓冲区</a>的地址，而是用一个整数作为参数。所以xxxx_putc( )无法直接利用相邻的字符来判别该定符是否是汉字。</div>
<div class="para">解决方案是，利用xxxx_putc( )的光标位置参数（yy, xx），可以逆推出该字符在<a target=_blank href=/view/266782.htm>缓冲区</a>中的位置。但仍有一些小麻烦，在Linux的<a target=_blank href=/view/694267.htm>虚拟终端</a>下，用户可能会上卷该屏幕（shift + pageup），导致光标的y坐标和相应字符在<a target=_blank href=/view/266782.htm>缓冲区</a>的行数不一致。相应的解决方案是，在逆推的过程中，考虑卷屏的参量。</div>
<div class="para">这样一来，我们就又进了一步，得到了一个相对更好的版本。但仍有问题没有解决。敲入turbonetcfg，会发现菜单的边框字符也被当成汉字显示。这是因为，这种边框<a target=_blank href=/view/263416.htm>字符</a>是扩展字符，也使用了字符的第8位，因而被当作汉字来显示。例如，单线一的<a target=_blank href=/view/1138182.htm>制表符</a><a target=_blank href=/view/943167.htm>内码</a>为0xC4，当连成一条长线就是由一连串0xC4组成，而0xC4C4正是汉字哪。于是水平的<a target=_blank href=/view/1138182.htm>制表符</a>被一连串的哪字替代了。要解决这个问题就非常不容易了，因为<a target=_blank href=/view/1138182.htm>制表符</a>的种类比较多，而且垂直制表符与其后面字符的组合型式又多种多样，因而很难判断出相应位置的字符是不是制表符，从理论上说，无论采取什么样的排除算法，都必然存在误判的情况，因为总存在二义性，没有充足的条件来推断出当前字符究竟是制表符还是汉字。</div>
<div class="para">我们一方面寻找更好的排除组合算法，一方面试图寻找其它的解决方案。要想从根本上解决定个问题，必须利用其它的<a target=_blank href=/view/1312718.htm>辅助信息</a>，仅仅从<a target=_blank href=/view/266782.htm>缓冲区</a>的字符来判断是不够的。</div>
<div class="para">经过一番努力，我们发现，在UNIX中使用扩展字符时，都要先输出字符转义序列（Escape sequence）来切换当前<a target=_blank href=/view/51987.htm>字符集</a>。字符转义序列是以<a target=_blank href=/view/1112575.htm>控制字符</a>Esc为首的控制命令，在UNIX的<a target=_blank href=/view/694267.htm>虚拟终端</a>中完成终端控制命令，这种命令包括，移动光标坐标、卷屏、删除、切换<a target=_blank href=/view/51987.htm>字符集</a>等等。也就是说在输出代表<a target=_blank href=/view/1138182.htm>制表符</a>的字符串之前，通常是要先输出特定的字符转义序列。在console.c里，有根据字符转义序列命令来记录字符状态的<a target=_blank href=/view/296689.htm>变量</a>。结合该<a target=_blank href=/view/296689.htm>变量</a>提供的信息，就可以非常干净地把<a target=_blank href=/view/1138182.htm>制表符</a>与汉字区别开来。</div>
<div class="para">在如上思路的指引下，我们又产生了新的解决方案。经过改动得到了另一各版本．</div>
<div class="para">在这个新版本上，turbonetcfg在初次绘制的时候，<a target=_blank href=/view/1138182.htm>制表符</a>与汉字被清晰地区分开来，结果是非常正确的。但还有新的问题存在∶turbonetcfg 在重绘的时候（如切换<a target=_blank href=/view/694267.htm>虚拟终端</a>或是移动鼠标光标的时候），<a target=_blank href=/view/1138182.htm>制表符</a>还是变成了汉字，因为重绘完全依赖于<a target=_blank href=/view/266782.htm>缓冲区</a>，而这时用来记录<a target=_blank href=/view/51987.htm>字符集</a>状态的<a target=_blank href=/view/296689.htm>变量</a>并不反映当前字符集状态。问题还是没有最终解决。我们又回到了起点。∶( 看来问题的最终解决手段必须是把<a target=_blank href=/view/51987.htm>字符集</a>的状态伴随每一个字符存在<a target=_blank href=/view/266782.htm>缓冲区</a>中。让我们来研究一下<a target=_blank href=/view/266782.htm>缓冲区</a>的结构。每一个字符占用16bit的<a target=_blank href=/view/266782.htm>缓冲区</a>，低8位是ASCII值，完全被利用，高8位包含前景颜色和背景颜色的属性，也没有多余的空间可以利用。因而只能另外开辟新的<a target=_blank href=/view/266782.htm>缓冲区</a>。为了保持一致性，我们决定在原来的<a target=_blank href=/view/266782.htm>缓冲区</a>后面添加相同大小的缓冲区，用来存放是否是汉字的信息。</div>
<div class="para">也许有读者会问，我们只需要为每个字符添加一bit的信息来标志是否是汉字就足够了，为什么还要开辟与原<a target=_blank href=/view/266782.htm>缓冲区</a>大小相同的双倍缓冲区，是不是太浪费呢？我们先放下这个问题，稍后再作回答。</div>
<div class="para">其实，如果再添加一bit来标志是当前字符是汉字的左半边还是右半边的话，就会省去扫描屏幕上当前整行字符串的工作，这样一来，编程会更简单。但是有读者会问，即使是这样，使用8bit总够用了吧？为什么还要使用16bit呢？</div>
<div class="para">我们的作法是∶用低8位来存放汉字另外一半的<a target=_blank href=/view/943167.htm>内码</a>，用高8位中的2 bit来存放上面所讲的<a target=_blank href=/view/1312718.htm>辅助信息</a>，高8位的剩余6位可以用来存放汉字或其它编码方式（如BIG5或日文、韩文）的信息，从而使我们可以实现同屏显示多种双<a target=_blank href=/view/60408.htm>字节</a>语言的字符而不会有相互干扰。另外，在<a target=_blank href=/view/3281.htm>编程</a>时，双倍缓冲也比较容易计算。这样我们就回答了如上的两个问题。</div>
<div class="para">迄今为止，我们有了一套彻底解决汉字和<a target=_blank href=/view/1138182.htm>制表符</a>相互干扰、半个汉字的刷新、重绘等问题的方案。剩下的就是具体编程实现的问题了。</div>
<div class="para">但是，由于Framebuffer的驱动很多，修改每一个驱动的xxxx_putc()函数和xxxx_putcs( )函数会是一项不小的工作，而且，改动驱动程序后，每种驱动的测试也是很麻烦的，尤其是对于有硬件加速的显卡，修改和测试会更不容易。那么，存不存在一种不需要修改显卡驱动程序的方法呢？</div>
<div class="para">经过努力，我们发现，可以在调用xxxx_putcs( )或xxxx_putc()函数输出汉字之前，修改vga<a target=_blank href=/view/1127103.htm>字库</a>的<a target=_blank href=/view/159417.htm>指针</a>使其指向所需显示的汉字在汉字字库中的位置，即把一个汉字当成两个vga ASCII<a target=_blank href=/view/1309791.htm>字符输出</a>。也就是说，在<a target=_blank href=/view/1366.htm>内核</a>中存在两个<a target=_blank href=/view/1127103.htm>字库</a>，一个是原有的vga字符字库，另一个是汉字字库，当我们需要输出汉字的时候，就把vga字库的<a target=_blank href=/view/159417.htm>指针</a>指向汉字字库的相应位置，汉字输出完之后，再把该指针指向vga字库的原有位置。</div>
<div class="para">这样一来，我们只需要修改fbcon.c和console.c，其中console.c负责维护双倍<a target=_blank href=/view/266782.htm>缓冲区</a>，把每一个字符的信息存入附加的缓冲区；而fbcon.c负责利用双倍缓冲区中附加的信息，调整vga<a target=_blank href=/view/1127103.htm>字库</a>的指针，调用底层的显示<a target=_blank href=/view/1048.htm>驱动程序</a>。这里还有几个需要注意的地方∶</div>
<div class="para">由于屏幕重绘等原因，调用<a target=_blank href=/view/3159752.htm>底层驱动</a>xxxx_putc( )和xxxx_putcs()的地方有多处。我们作了两个函数分别包装这两个调用，完成替换<a target=_blank href=/view/1127103.htm>字库</a>、调用xxxx_putcs( )或xxxx_putc( )、恢复字库等功能。 </div>
<div class="para">为了实现向上滚屏（shift + pageup）时也能看到汉字，我们需要作另外的修改。</div>
<div class="para">Linux 在设计<a target=_blank href=/view/694267.htm>虚拟终端</a>的时候，提供了回顾被卷出屏幕以外的信息的功能，这就是用<a target=_blank href=/view/117942.htm>热键</a>来向上滚屏（shift + pageup）。当前被使用的<a target=_blank href=/view/694267.htm>虚拟终端</a>拥有一个公共的<a target=_blank href=/view/266782.htm>缓冲区</a>（soft back），用来存放被滚出屏幕以外的信息。当切换<a target=_blank href=/view/694267.htm>虚拟终端</a>的时候，公共<a target=_blank href=/view/266782.htm>缓冲区</a>的内容会被清除而被新的虚拟终端使用。向上滚屏的时候，显示的是公共<a target=_blank href=/view/266782.htm>缓冲区</a>中的内容。因此，如果我们想在向上滚屏的时候看到汉字，公共<a target=_blank href=/view/266782.htm>缓冲区</a>也必须加倍，以确保没有信息丢失。当滚出屏幕的信息向公共<a target=_blank href=/view/266782.htm>缓冲区</a>填写的时候，必须把相应的附加信息也填写进公共缓冲区的附加区域。这就要求fbcon.c必须懂得利用公共<a target=_blank href=/view/266782.htm>缓冲区</a>的附加信息。</div>
<div class="para">当然，有另外一种偷懒的方法，那就是不允许用户向上滚屏，从而避免对公区<a target=_blank href=/view/266782.htm>缓冲区</a>的处理。 </div>
<div class="para">把不同的编码方式（GB、BIG5、日文和韩文）写成不同的module，以实现动态加载，从而使得扩展新的编码方式不需要重新编译核心。 </div>
<div class="para">测试</div>
<div class="para">本文实现的Kernel Patch文件（patch.kernel.chinese）可以从http://www.turbolinux.com.cn下载。Cd /usr/src/（该目录下应有Linux核心<a target=_blank href=/view/546605.htm>源程序</a>所在的目录linux/） patch -p0 -b &lt; patch.kernel.chinese make menuconfig 请选择Console drivers选项中的</div>
<div class="para">〔*〕 Double Byte Character Display Support(EXPERIMENTAL)</div>
<div class="para">〔*〕 Double Byte GB encode (module only)</div>
<div class="para">〔*〕 VESA VGA graphics console</div>
<div class="para">&lt;*&gt; Virtual Frame Buffer support (ONLY FOR TESTING!)</div>
<div class="para">&lt;*&gt; 8 bpp packed pixels support</div>
<div class="para">&lt;*&gt; 16 bpp packed pixels support</div>
<div class="para">&lt;*&gt; VGA characters/attributes support</div>
<div class="para">〔*〕 Select compiled-in fonts</div>
<div class="para">〔*〕VGA 8x8 font</div>
<div class="para">〔*〕VGA 8x16 font</div>
<div class="para">make dep</div>
<div class="para">make bzImage</div>
<div class="para">make modules</div>
<div class="para">make install</div>
<div class="para">make modules_install</div>
<div class="para">然后用新的核心启动。</div>
<div class="para">Insmod encode-gb.o </div>
<div class="para">四、其它</div>
<div class="para">（一） 设置FrameBuffer</div>
<div class="para">FrameBuffer，可以译作&quot;帧缓冲&quot;，有时简称为 fbdrv，基于fbdrv的console也被称之为fbcon。这是一种独立于硬件的抽象图形设备。FrameBuffer的优点在于其高度的可移植 性、易使用性、稳定性。使用<a target=_blank href=/view/573460.htm>Linux内核</a>的 FrameBuffer驱动（vesafb），可以轻松支持到1024X768X32bpp以上的分辩率。而且目前可得到的绝大多数linux版本所发行 的内核中，已经<a target=_blank href=/view/176610.htm>预编译</a>了FrameBuffer支持，通常不需要重新编译内核就可以使用。所以FrameBuffer也是zhcon推荐使用的<a target=_blank href=/view/131317.htm>驱动方式</a>。</div>
<div class="para">进入FrameBuffer可以简单地在系统启动时向kernel传送vga=mode-number的参数来激活FrameBuffer设备，如：</div>
<div class="para">lilo:linux vga=305</div>
<div class="para">将会启动1024x768x8bpp模式。</div>
<div class="para">640x480 800x600 1024x768 1280x1024</div>
<div class="para">8 bpp 769 771 773 775</div>
<div class="para">16 bpp 785 788 791 794</div>
<div class="para">32 bpp 786 789 792 795</div>
<div class="para">（二） 要使linux缺省进入FrameBuffer，可以修改/etc/lilo.conf，加入一下语句：</div>
<div class="para">vga=0x303</div>
<div class="para">退出编辑，执行：</div>
<div class="para">lilo -v</div>
<div class="para">重新启动linux，可以使其进入800x600的256色模式。</div>
<div class="para">grub也是一样，在grub.conf中的kernel行后面写上vga=xxx就行了，也可以用vga=ask，让系统启动的时候询问你用多大的分辨率</div>
<div class="para">（三）我编译<a target=_blank href=/view/1366.htm>内核</a>时，选择framebuffer模式，启动时屏幕上有一企鹅图片，不知这是如何造成的这个图片可以去掉或改动吗？</div>
<div class="para">可以将drivers/video/fbcon.c: fbcon_setup()中if (logo) { } 代码去掉。</div>

<script>baikeViewInfo.cataList = baikeViewInfo.cataList.concat([]);</script><div class="clear"></div></div> <div class="clear"></div><div id="lemmaExtend-2115202" class="reinforce lazyload" lazy-path="/static/lemma/ui/view/reference/urlRmoveParentRefer.js" lazy-init="e.init(2115202)"><dl id="viewExtCati"  class="nslog-area log-set-param" log-set-param="module_tag" data-nslog-type="19"> <dt class="open-tag-title">开放分类：</dt> <dd>  <a href="/fenlei/%E6%8A%80%E6%9C%AF%E5%88%86%E6%9E%90" target="_blank" class="open-tag open-tag-mr7 nslog:7336">技术分析</a>   </dd></dl><div class="clear"></div><div class="clear"></div></div><script> if(typeof PDC != 'undefined'){PDC.tti();}</script></div><div class="clear"></div></div><div class="content-ft"><div class="clear"></div><div class="end lazyload" lazy-init="e.init()" lazy-path="/static/lemma/ui/view/vote/vote.js"><p class="declare">百度百科中的词条正文与判断内容均由用户提供，不代表百度百科立场。如果您需要解决具体问题（如法律、医学等领域），建议您咨询相关领域专业人士。</p><div class="text_vote1" id="vote_btn"><b id="vote_num"></b><span id="vote_txt">本词条对我有帮助</span></div></div><div class="layout share lazyload clearfix" lazy-init="e.init()" lazy-path="/static/lemma/ui/view/share/share.js"> <div class="share-item-title"> <a href="http://cang.baidu.com/do/add" class="cang nslog:99" onclick="window.open('http://cang.baidu.com/do/add?it='+encodeURIComponent(document.title)+'&amp;iu='+encodeURIComponent(location.href)+'&amp;tn=%E7%99%BE%E7%A7%91%E8%AF%8D%E6%9D%A1%2C&amp;fr=bk#nw=1','_s','scrollbars=no,width=600,height=450,left=75,top=20,status=no,resizable= yes');return false;" target="_blank" title="添加到搜藏" >添加到搜藏</a> </div> <div class="share-item" id="bdsharebox"> <span class="share-tip">分享到:</span><div id="bdshare" class="bdshare_t bds_tools get-codes-bdshare" data="{'url':'http://baike.baidu.com/view/2115202.htm','text':'【Framebuffer Driver_百度百科】中文名为：帧缓冲驱动 一、FrameBuffer的原理 FrameBuffer 是出现在 2.2.xx 内核当中的一种驱动程序接口。 Linux是工作在保护模式下，所以用户态进程是无法象DOS那样使用显卡BIOS里提供的中断调用来实现直接写屏，Linux抽象出FrameBuffer这个设备来供用户态进程实现直接写屏。Framebuffer机制模仿显卡的功能，将显.....（分享自@百度百科）','pic':''}"><a class="bds_tsina"></a><a class="bds_tqq"></a><a class="bds_douban"></a><a class="bds_tsohu"></a><a class="bds_t163"></a> <a class="bds_renren"></a><a class="bds_mshare"></a><span class="bds_more">更多</span></div><script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=71"></script><script type="text/javascript" id="bdshell_js"></script> </div></div><dl class="lemma-ext-bottom nslog-area"  data-nslog-type="16"> <dt>合作编辑者</dt> <dd> <div class="onelineonly lazyload" lazy-init="e.init()" lazy-path="/static/lemma/ui/view/coeditor/coeditor.js"><span id="co-editors"> <span>   <a title='查看此用户资料' class='usercard' userName='w_ou'  target='_blank' href='http://www.baidu.com/p/w_ou?from=wk'>w_ou</a></span> <span> ，  <a title='查看此用户资料' class='usercard' userName='问问to度百'  target='_blank' href='http://www.baidu.com/p/%E9%97%AE%E9%97%AEto%E5%BA%A6%E7%99%BE?from=wk'>问问to度百</a></span> <span> ，  <a title='查看此用户资料' class='usercard' userName='炯炯炯'  target='_blank' href='http://www.baidu.com/p/%E7%82%AF%E7%82%AF%E7%82%AF?from=wk'>炯炯炯</a></span> <span> ，  <a title='查看此用户资料' class='usercard' userName='百科ROBOT'  target='_blank' href='http://www.baidu.com/p/%E7%99%BE%E7%A7%91ROBOT?from=wk'>百科ROBOT</a></span> <span> ，  <a title='查看此用户资料' class='usercard' userName='海滨涛涛'  target='_blank' href='http://www.baidu.com/p/%E6%B5%B7%E6%BB%A8%E6%B6%9B%E6%B6%9B?from=wk'>海滨涛涛</a></span> <span> ，  <a title='查看此用户资料' class='usercard' userName='lihen3000'  target='_blank' href='http://www.baidu.com/p/lihen3000?from=wk'>lihen3000</a></span>  </span> </div> <a target="_blank" id="more-coeditor" href="/update/id=2115202?from=au" class="f12 ref_more" style="display:none">更多</a> <div class="clear"></div>  <div class="try f12">如果您认为本词条还需进一步完善，百科欢迎您也来参与  <a href="#" class="try-edit nslog:1806" id="try-edit">编辑词条</a> 在开始编辑前，您还可以先学习<a href="http://www.baidu.com/search/baike_help.html#&#32534;&#36753;&#21407;&#21017;" target="_blank">如何编辑词条</a></div>  </dd></dl><p class="bk-feedback">如想投诉，请到<a target="_blank" href="http://tousu.baidu.com/baike" class="nslog:1006">百度百科投诉中心</a>；如想提出意见、建议，请到<a target="_blank" class="nslog:1007" href="http://tieba.baidu.com/f?kw=%b0%d9%b6%c8%b0%d9%bf%c6">百度百科吧</a>。</p><div class="clear"></div> </div></div></div><div id="side" class="col-sub"><style type="text/css">.doc-list{position:relative;background:#e9f3f6;margin:-11px 0 11px -10px;padding:0 5px 18px 10px}.doctor,.sick{border:1px solid #d2dadd;color:#333;margin:0 5px 0 -5px;background:#fbfdfd}.doctor{margin-bottom:16px}.doctor .title,.sick .title{height:38px;line-height:38px;border-bottom:1px solid #d2dadd;padding:0 10px;font-size:14px}.doctor .title span,.sick .title span{font-weight:bold}.doctor .area,.sick .area{height:32px;line-height:32px;padding-left:10px;border-bottom:1px solid #d2dadd}.doctor .area em,.sick .area em{color:#999}.doctor .area .current,.sick .area .current{color:#333;background:#ebeef0}.doctor .area .current,.doctor .area a,.sick .area .current,.sick .area a{padding:3px 4px;display:inner-block;margin:0 1px}.doctor table,.sick table{width:100%;border-spacing:0}.doctor a,.sick a{color:#136ec2}.doctor p,.sick p{height:32px;line-height:32px;padding:0 10px}.doctor p{border-top:1px solid #d2dadd}.sick table tr{border-bottom:1px solid #d2dadd}.doctor td,.sick td{text-align:left;padding:7px 0 7px 10px;line-height:18px;max-width:90px;word-break:break-all}.doctor p a,.sick p a{float:left}.doctor p em,.sick p em{float:right;color:#999}</style><script type="text/javascript">F.use("/static/common/lib/tangram/base/base.js", function(baidu){baidu.dom.ready(function(){baidu("#doctorInfo .area a").on('click',function(e){var index = baidu(this).attr('data-type'),parent = baidu(this).parent(),parent2 = baidu(this).parent().parent(),length = baidu(parent).find('a').length;if(index>=(length-1)){return;}e.preventDefault();e.stopPropagation();baidu(parent).find('a').removeClass('current');baidu( baidu(parent).find('a')[index] ).addClass('current');baidu(parent2).find('table').hide();baidu( baidu(parent2).find('table')[index]).show();});});});</script> <div id="xg-container"><div id="xg-content"><div class="backgroundImage log-set-param" log-set-param="view_LNXG"></div><div class="knowledgePlatform"><h3>百度百科内容方针</h3><ul><li>提倡有可靠依据、权威可信的内容</li><li>鼓励客观、中立、严谨的表达观点</li><li>不欢迎恶意破坏、自我或商业宣传</li></ul></div><div class="icon"><h3>在这里你可以</h3><div id="xg-iconList"><dd id="xg-edit" class="firIcon "><div class="iconlist">编辑</div><div class="xg-bubble-wrapper"></div></dd><dd id="xg-doubt" class="secIcon "><div class="iconlist">质疑</div><div class="xg-bubble-wrapper"></div></dd><dd id="xg-complain" class="thirIcon "><div class="iconlist">投诉</div><div class="xg-bubble-wrapper"></div></dd></div></div><div class="supervision"><h3>全方位的质量监督</h3><ul><li><a href="http://baike.baidu.com/zhuanjia" target="_blank">学术委员会</a>：为亿万网友提供权威意见</li><li><a href="http://baike.baidu.com/collator#1" target="_blank">编修院</a>：把控质量，做更好的知识</li></ul></div></div><div id="themeSplit"></div></div><script>F.use("/static/widget/lemma/LNXG/LNXG.js");</script><div class="userinfo-side"><div id="userInfoDiv"></div></div><div class="box2" id="lemma-overview"><dl class="box2-inner info"><dt class="sidetitle">词条统计</dt><dd>浏览次数：约 <span id="viewPV"></span>次</dd><dd>编辑次数：7次 <a href="/update/id=2115202" class="nslog:1021" target="_blank">历史版本</a></dd><dd>最近更新：<span id="lastModifyTime">2013-03-06</span></dd><dd>创建者：<span class="nslog:1022"><a title='查看此用户资料' class='usercard' userName='lihen3000'  target='_blank' href='http://www.baidu.com/p/lihen3000?from=wk'>lihen3000</a></span></dd></dl></div> <style>.authority-morelink{float:right;text-decoration:underline}</style>  <div class="box2" style="display:none" id="bkDynamic"><dl class="box2-inner"><dt id="profileTitle" class="sidetitle"></dt><dd class="task nslog-area" data-nslog-type="1023" id="task" style="display:none;"></dd><dd class="notice nslog-area" data-nslog-type="1024" id="notice"></dd></dl></div><div class="box2" id="mabox" style="display:none">  <div class="box2-inner" id="box2-inner"> </div><script type="text/javascript"> F.use("/static/lemma/ui/view/maad/maad.js", function(e){e.init("Framebuffer%20Driver");});</script></div><div class="clear"></div></div></div></div><div id="footer" data-nslog-type="1001" class="nslog-area">&copy; 2013 Baidu <a target="_blank" href="http://www.baidu.com/duty/">使用百度前必读</a>&nbsp;|&nbsp;<a target="_blank" href="http://www.baidu.com/search/baike_help.html#百科协议">百科协议</a>&nbsp;|&nbsp;<a target="_blank" href="http://baike.baidu.com/hezuo/">百度百科合作平台</a></div></div><div id="sidecatalog" style="position:absolute;display:none"><div id="sidebar" class="sidebar"></div><a class="gotop" id="gotop" href="#" title="返回顶部"></a></div><div id="side-catalog-content" style="display:none;position:absolute;"></div><img src="http://c.baidu.com/c.gif?t=7&amp;q=Framebuffer+Driver&amp;p=0" style="display:none;"/><input id="titleVal" type="hidden" value="Framebuffer Driver" /><script type="text/javascript">if ((baikeViewInfo.expIndex != 0) && !(window.location.hash)){window.location.hash = '#sub0';}F.use("/static/common/ui/nslog/nslog.js",function(nslog){nslog.set("page","view");nslog.set("lemmaid","2115202");nslog.set("ispolysemy","0");});F.use("/static/common/lib/tangram/base/base.js", function(baidu){baidu.each = baidu.forEach;baidu.array.each = baidu.forEach;window.baidu = baidu;});</script> <script type="text/javascript">(function(){function bknslog(type){var n="baikelog_"+(new Date()).getTime();var c=window[n]=new Image();c.onload=c.onerror=function(){ window[n]=null; };c.src='http://nsclick.baidu.com/v.gif?pid=103&type='+type+'&url='+encodeURIComponent(location.href)+'&t='+(new Date()).getTime();c=null; }if(typeof baidu == 'undefined'){bknslog(3601);} })();</script><script>baikeInfo.panoramaImage = "0";F.use(["/static/lemma/ui/view/controller/controller.js","/static/common/ui/util/util.js","/static/common/lib/tangram/ui/Base/Base.js","/static/common/ui/dialog/dialog.js","/static/common/ui/nslog/nslog.js"],function(controller,util,uiBase,dialog,nslog){window.Dialog = dialog;T = {};window.bk = bk||{};bk.Dialog = Dialog;F.use("/static/common/ui/fillusername/fillusername.js");baidu.sio.callByBrowser("/static/usercenter/js/liteoutput/bk.uc_lemma.js",function(){F.use("/static/common/ui/userlogin/userlogin.js", function(e){e.check(function(){if(typeof PDC != 'undefined'){PDC.init({is_login : (window.curUser==0?false:true),sample : 0.04,product_id : 103,page_id : 1,special_pages:[{id:109,sample:0.04}]});}});});});baidu.page.loadJsFile("http://img.baidu.com/hunter/baike.js?st=" + parseInt(new Date()/864e5));nslog.init();nslog(5102);baidu.dom.ready(function(){if(rsInsertData&&rsInsertData.length>0){F.use('/static/common/lib/tangram/fx/fx.js',function(){baidu.page.loadCssFile( "/guanxi/static/css/lemma_insert.css" );baidu.sio.callByBrowser( "/guanxi/static/js/lemma_insert.js?t=1314",null,{charset:"utf-8"} );});}});});F.use("/static/common/ui/search/search.js", function(e){e.init(false);});</script><div id="refTip" class="refTip-box"><table><tr><td valign="middle" class="refTip-bg"><div class="refTip-content" id="refTip-content"></div></td><td class="refTip-text" valign="middle">参考资料</td></tr></table><div class="refTip-triangle"></div></div><div id="describeTips" class="describeTips clearfix"> <div class="content clearfix"> <div class="describeTips-left-content" id="describeTips-left-content"> <a class="img-link nslog:7496" href="#" id="describeTips-picLink" target="_blank"> <img id="describeTips-img"  src="http://img.baidu.com/img/baike/blank.gif"/> <div class="img-border"></div> </a> </div> <div class="desc" id="describeTips-right-content"> <a class="title nslog:7495" id="describeTips-name" href="#" target="_blank"></a> <p id="describeTips-content"> </p> </div> </div> <div class="list clearfix"> <ul class="clearfix" id="tip-category"></ul> </div></div></body></html><script>PDC._load_js=function(b,c){var a=document.createElement("script");a.setAttribute("type","text/javascript");a.setAttribute("src",b);a.onload=a.onreadystatechange=function(){if(!this.readyState||this.readyState=="loaded"||this.readyState=="complete"){a.onload=a.onreadystatechange=null;if(typeof c==="function"){c(b,true)}}};a.onerror=function(d){if(typeof c==="function"){c(b,false)}};document.getElementsByTagName("head")[0].appendChild(a)};PDC._load_analyzer=function(){var b=this._opt.special_pages;var c=[this._opt.sample];for(var a=0;a<b.length;a++){c.push(b[a]["sample"])}radio=Math.max.apply(null,c);if(PDC._is_sample(radio)==false){return}PDC._analyzer.loaded=true;PDC._load_js(PDC._analyzer.url,function(){var f=PDC._analyzer.callbacks;for(var e=0,d=f.length;e<d;e++){f[e]()}})};PDC.send=function(){if(PDC._analyzer.loaded==true){WPO_PDA.send()}else{PDC._analyzer.callbacks.push(function(){WPO_PDA.send()})}};PDC._is_sample=function(a){if(!PDC._random){PDC._random=Math.random()}return PDC._random<=a};(function(){if(document.attachEvent){window.attachEvent("onload",function(){PDC.mark("lt")},false)}else{window.addEventListener("load",function(){PDC.mark("let");PDC._load_analyzer()})}})();</script>