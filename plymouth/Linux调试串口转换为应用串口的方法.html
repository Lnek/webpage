<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><!-- InstanceBegin template="/Templates/article.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<!-- InstanceBeginEditable name="doctitle" -->
<title>Linux调试串口转换为应用串口的方法--技术天地</title>
<meta name="keywords" content="Linux调试串口">
<meta name="description" content="本文介绍如何将英创嵌入式Linux工控主板的调试串口转换为应用串口。">
<!-- InstanceEndEditable -->
<link href="../prod.css" rel="stylesheet" type="text/css" />
<link href="../style.css" rel="stylesheet" type="text/css">
<link rel="shortcut icon" href="http://www.emtronix.com/emtronix.ico" type="image/x-icon" />
<script src="../js/globals.js" type="text/javascript"></script>
<!-- InstanceBeginEditable name="head" --><!-- InstanceEndEditable -->
</head>
<body id="body">
<div id="container">
<div id="header">
  <div id="container2">
    <div id="header2">
      <div id="logo"><a href="../index.asp"><img src="../images/logo.jpg" alt="英创首页" border="0"></a></div>
      <div id="logo_cen">
        <div id="search">
          <form action="../sou.asp">
            <input name="keyword" type="text" class="keywords" size="26" maxlength="30" id="keyword">
            <input name="imageField" type="image" id="imageField" src="../images/ser.jpg" alt="搜索" align="bottom">
            <input name="type" type="hidden" id="type" value="all">
          </form>
        </div>
        <div id="logo_links">
          <div class="menu">联系我们: <a href="mailto:support@emtronix.com">support@emtronix.com </a></div>
        </div>
      </div>
      <div id="top_line"></div>
      <div id="top_contact" class="menu"> 成都英创信息技术有限公司<br />
        电话：028-86180660　85140028　85145208 <br />
        传真：028-85141028<br />
        地址：成都市高朋大道5号博士创业园B404<br />
    </div>
    </div>
</div>
</div>
<!-- end top     Menu Start-->
    <div id="Nav_menu"> 
      <div id="topmenu" class="menu">
        <ul>
          <li><a href="../emtronix/index.asp" onMouseOver="mouseover(this, 1)" onMouseOut="mouseout()">关于我们</a></li>
          <li><a href="../product/index.asp" onMouseOver="mouseover(this, 2)" onMouseOut="mouseout()">产品及服务</a></li>
          <li><a href="../document/index.asp" onMouseOver="mouseover(this, 3)" onMouseOut="mouseout()">文档资源</a></li>
          <li><a href="../club/index.asp" target="_blank" onMouseOver="mouseover(this, 4)" onMouseOut="mouseout()">交流园地</a></li>
          <li><a href="../faq.asp">常见问题</a></li>
        </ul>
      </div>
      <!--sub menu-->
      <div id="menu1" class="menu-list" onMouseOver="_mouseover()" onMouseOut="_mouseout()">
        <ul>
            <li><a href="../emtronix/index.asp">公司介绍</a></li>
          <li><a href="../news/index.asp">公司新闻</a></li>
          <li><a href="../emtronix/contact.asp">加入我们</a></li>
        </ul>
      </div>
      <div id="menu2" class="menu-list" onMouseOver="_mouseover()" onMouseOut="_mouseout()">
        <ul>
            <li><a href="../product/new-products.asp">新产品</a></li>
            <li><a href="../product/index.asp?caid=3">ARM9嵌入式主板</a></li>
            <li><a href="../product/index.asp?caid=1">X86嵌入式网络模块</a></li>
            <li><a href="../product/dibankaifa.asp">客户应用底板开发</a></li>
            <li><a href="../product/index.asp?caid=5">配套软硬件模块</a></li>
            <li><a href="../product/index.asp?caid=6">免费专项服务</a></li>
            <li><a href="../product/daogou.asp">产品选型指南</a></li>
        </ul>
      </div>
      <div id="menu3" class="menu-list" onMouseOver="_mouseover()" onMouseOut="_mouseout()">
        <ul>
          <li><a href="../case/index.asp">应用方案</a></li>
          <li><a href="index.asp">技术天地</a></li>
          <li><a href="../down/index.asp">资料下载</a></li>
        </ul>
      </div>
      <div id="menu4" class="menu-list" onMouseOver="_mouseover()" onMouseOut="_mouseout()">
        <ul>
          <li><a href="../club/index.asp" target="_blank">技术问答</a></li>
          <li><a href="../blog/index.asp" target="_blank">工程师博客</a>&nbsp;</li>
      </ul></div><div id="topsearch"><form name="search_form1" target="_blank" onSubmit="return go(this)" class="baidusearch1">
     <input name=myselectvalue type=hidden value=0>
     <input name=cl type=hidden value="3">
     <input name=ct type=hidden value="2097152">
     <input name=tn type=hidden value="bds">
     <input name=si type=hidden value="www.emtronix.com">
     <input name=word value="请输入关键字" onMouseOver="this.focus()" onBlur="if (value ==''){value='请输入关键字'}" onFocus="this.select()" onClick="if(this.value=='请输入关键字')this.value=''" class="baidusearch">
<input type="submit" value="Baidu站内搜索"></form></div>
   </div>
    <!---End TopMenu-->
	<div id="spaces"></div>
<!---center-->
  <div id="hcolumn">

<div id="navmenu"><a href="../index.asp">首页</a> &gt; <a href="../document/index.asp">文档资源</a> &gt; <a href="index.asp">技术天地</a></div>
 <!--left-->
    <div id="scolumnA">
            <div class="menu_title1 px12black"><div class="menu_title1_icon"></div>推荐产品</div>
            <div class="listbox1">
            		<div class="left_bg1"><ul class="listicon1">
					  <script src="../showprod.asp" type="text/javascript"></script></ul>
                    </div>
                    <div class="left_bg2"></div>
          </div>
          <div class="hspace6"></div>
          <div class="menu_title1 px12black"><div class="menu_title1_icon"></div>应用方案</div>
            <div class="listbox1">
            		<div class="left_bg1"><ul class="listicon1">
						 <script src="../showarticle.asp?no=14&cid=23&par=0&path=0" type="text/javascript"></script></ul>
                    </div>
                    <div class="left_bg2"></div>
          </div>
    </div>
          <!--end left-- start right-->
          <div id="scolumnB">
           <div id="subtitle">
     		<!-- InstanceBeginEditable name="menu" -->
            <h1>技术天地</h1>
        <!-- InstanceEndEditable -->
          </div>
          <div id="articlelistbox">
      <!-- InstanceBeginEditable name="center" -->
      <div class="articletitle">Linux调试串口转换为应用串口的方法</div>
      <div class="gray line24 center">发布时间:2013-3-19 14:31:17&nbsp;&nbsp;&nbsp;&nbsp;被阅览数:<script src="../count.asp?id=546"></script>次</div>
      <div id="articledesc" class="menublue2"><P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 英创公司的EM9X60系列工控主板（包括 EM9160、EM9360、EM9460、EM9660等）均具有7路物理串口。在Linux系统中，6路串口作为应用串口，剩下的1路作为调试串口。一般情况下调试串口被系统内核所占用，用来显示内核输出信息以及console控制终端。这样的配置可满足大多数应用对串口的需求。 </P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在一些特殊的应用中，需要的串口数超过6路，这时可把缺省作为调试的串口，经过一定的设置，转换为应用串口，其设备名称为“/dev/ttyS0”。在实际操作中，往往是直接通过应用程序来实现这样的转换，具体的代码如下： </P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 利用函数ioctl( fd, TIOCCONS)来重新定义 console终端，应用程序使用完毕后，还可将终端恢复，该部分程序代码已经修改测试好。 </P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 重定向控制台终端console至tty1： </P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; int fd; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf('Close cnsole\n'); <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fd = open('/dev/tty1',O_RDONLY); <FONT style='COLOR: #008000'>// 改变console </FONT><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ioctl( fd, TIOCCONS ); <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; close( fd ); </P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 恢复控制台终端console至缺省设置： </P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fd = open('/dev/tty0',O_RDONLY);<FONT style='COLOR: #008000'> // 恢复console <BR></FONT>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ioctl( fd,TIOCCONS ); <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; close( fd ); <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; printf('change console back: ttyS0\n'); </P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在使用调试口应用时，需要注意的是启动程序必须按照终端模式进行启动，而不能用execlp函数族的方式，因此我们调整了EM9X60系列板卡启动管理程序在运行模式下的策略，应用程序需要按照脚本的方式进行启动，启动的方法就是客户编辑一个名为user.sh的脚本文件，并将该文件复制到EM9X60系列板卡的/mnt/nandflash，user.sh的内容如： </P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; #!/bin/sh <BR><BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; cd /mnt/nandflash/ <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /mnt/nandflash/step2_serialtest </P>
<P>&nbsp;</P>
<P>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 这样在板卡将会自动运行step2_serilatest应用程序。</P></div>
      <div class="center"></div>
	  <div id="articlemorelist"><script src="../showmorearticle.asp?id=546"></script></div>
      <!-- InstanceEndEditable --></div>
     </div>
<!-- ImageReady Slices (index.psd) -->

    <div class="h-line"></div>
    <div id="footer1">
        <div id="footermenu"><a href="../emtronix/index.asp">关于我们</a> | <a href="../product/index.asp">产品及服务</a> | <a href="../document/index.asp">文档资源</a> | <a href="../club/index.asp">交流园地</a> | <a href="../faq.asp">常见问题</a> | <a href="../sitemap.htm">网站导航</a></div>
        <div id="footercopy">版权所有&copy; 2012 成都英创信息技术有限公司&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;蜀ICP备05015790号</div>
    </div>
    <div class="hspace8"></div>
 </div>
</div>
</body>
<!-- InstanceEnd --></html>