<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>使用Nginx负载均衡OpenStack对象存储swift - 服务器之家</title>
<meta name="keywords" content="使用,Nginx,负载,均衡,OpenStack,对象,存储" />
<meta name="description" content="Openstack对象存储swift多代理的安装部署参考上篇《Openstack存储swift多代理节点安装配置》 此文为用Nginx实现负载均衡Openstack对象存储swift多代理的配置 1、下载Nginx cd/usr/local/src/ wget-Shttp://nginx.org/download/nginx-1.2.6.tar.gz 2、创建用" />
<link rel="stylesheet" href="/template/style/style.css" type="text/css" />
<link rel="stylesheet" href="/template/style/page.css" type="text/css" />
<link rel="stylesheet" href="/template/style/layout.css" type="text/css" />
<link type="text/css" rel="stylesheet" href="/template/style/shCoreDefault.css" />
</head>
<body class="server110">
<script type="text/javascript" src="/template/js/shCore.js"></script>
<script type="text/javascript" src="/js/base.js"></script>
<div class="Top">
	<span>
  <a href="http://www.yundaiwei.com/" target='_blank'><font color="red">云主机代维</font></a>
  </span>
    服务器之家，专注于服务器技术!
</div>
<div class="Head">
	<div class="logo FL"><h1><a href="http://www.server110.com"><img src="/template/images/logo.png" alt="服务器之家" /></a></h1></div>
    <div class="ad_468 FR">
      <script type="text/javascript">
      /*全站顶部右侧*/
      var cpro_id = "u1489154";
      </script>
      <script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
    </div>
</div>
<div class="Nav">
    <a href='http://www.server110.com/'>首页</a>
    
    <a href='/cloud/'  rel='dropmenu11'>云和虚拟化</a>
    
    <a href='/database/'  rel='dropmenu1'>数据库服务器</a>
    
    <a href='/web/'  rel='dropmenu2'>Web服务器</a>
    
    <a href='/ftp/'  rel='dropmenu3'>FTP服务器</a>
    
    <a href='/mail/'  rel='dropmenu4'>邮件服务器</a>
    
    <a href='/system/'  rel='dropmenu5'>服务器系统</a>
    
    <a href='/security/'  rel='dropmenu6'>服务器安全</a>
    
    <a href='/script/'  rel='dropmenu7'>脚本编程</a>
    
    <a href='/software/'  rel='dropmenu8'>建站程序</a>
    
    <a href='/webpage/'  rel='dropmenu9'>网页前端</a>
    
    <a href='/operation/'  rel='dropmenu10'>网站运营</a>
    
</div>

<div class="Nav_box">
	<div class="tag FL">
    	<a href='/original/'>本站原创</a>
    </div>
    <div class="so FR">
		<script type="text/javascript">
      /*百度站内搜索*/
			document.write(unescape('%3Cdiv id="bdcs"%3E%3C/div%3E%3Cscript charset="utf-8" src="http://rp.baidu.com/rp3w/3w.js?sid=9149198320401485197') + '&t=' + (Math.ceil(new Date()/3600000)) + unescape('"%3E%3C/script%3E'));
		</script>
    </div>
</div>
<div class="ad_960">
  <script type="text/javascript">
      /*全站顶部通栏1*/
      var cpro_id = "u1399762";
  </script>
  <script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>

  <script type="text/javascript">
    /*全站横幅主题链接*/
    var cpro_id = "u1432304";
  </script>
  <script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
</div>

<!-- /header -->
<div class="main4">
    <div class="m4_left FL">
        <div class="m4_t1">当前位置：<a href='http://www.server110.com/index.html'>首页</a> > <a href='/cloud/'>云和虚拟化</a> > <a href='/openstack/'>OpenStack</a> >  正文</div>
        <div class="m4_box3">
<!-- Baidu Button BEGIN -->
<div id="bdshare" class="bdshare_b" style="line-height: 12px;">
<img src="http://bdimg.share.baidu.com/static/images/type-button-6.jpg?cdnversion=20120831" />
</div>
<script type="text/javascript" id="bdshare_js" data="type=button&amp;uid=6785694" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000);
</script>
<!-- Baidu Button END -->
        </div>
        <h1 class="m4_box4">使用Nginx负载均衡OpenStack对象存储swift</h1>
        <div class="m4_box5">时间：2014-03-26 &nbsp;&nbsp; 来源：服务器之家 &nbsp;&nbsp; 投稿：root</div>

        <div>
          <div id= "left">
            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <ins class="adsbygoogle"
                 style="display:inline-block;width:300px;height:250px"
                 data-ad-client="ca-pub-1892357599595152"
                 data-ad-slot="4531983840"></ins>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
          </div>
          <div id= "right">
            <script type="text/javascript">
            var cpro_id = "u1371555";
            </script>
            <script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
          </div>
        </div>

        <div class="m4_box6">
            <p>
	Openstack对象存储swift多代理的安装部署参考上篇《Openstack存储swift多代理节点安装配置》
</p>
<p>
	此文为用Nginx实现负载均衡Openstack对象存储swift多代理的配置
</p>
<p>
	1、下载Nginx
</p>
cd&nbsp;/usr/local/src/<br />
wget&nbsp;-S&nbsp;http://<a href='http://www.server110.com/nginx/' target='_blank'><u>nginx</u></a>.org/download/<a href='http://www.server110.com/nginx/' target='_blank'><u>nginx</u></a>-1.2.6.tar.gz<br />
<p>
	2、创建用户
</p>
useradd&nbsp;-c&nbsp;"Nginx&nbsp;User"&nbsp;-s&nbsp;/sbin/nologin&nbsp;-r&nbsp;-d&nbsp;/var/lib/nginx&nbsp;nginx<br />
<p>
	3、安装Nginx
</p>
tar&nbsp;xzvf&nbsp;nginx-1.2.6.tar.gz<br />
cd&nbsp;nginx-1.2.6/<br />
./configure&nbsp;\<br />
&nbsp;&nbsp;--user=nginx&nbsp;\<br />
&nbsp;&nbsp;--group=nginx&nbsp;\<br />
&nbsp;&nbsp;--prefix=/usr/share&nbsp;\<br />
&nbsp;&nbsp;--sbin-path=/usr/sbin/nginx&nbsp;\<br />
&nbsp;&nbsp;--conf-path=/etc/nginx/nginx.conf&nbsp;\<br />
&nbsp;&nbsp;--error-log-path=/var/log/nginx/error.log&nbsp;\<br />
&nbsp;&nbsp;--http-log-path=/var/log/nginx/access.log&nbsp;\<br />
&nbsp;&nbsp;--pid-path=/var/log/run/nginx.pid&nbsp;\<br />
&nbsp;&nbsp;--lock-path=/var/log/lock/subsys/nginx&nbsp;\<br />
&nbsp;&nbsp;--with-http_stub_status_module&nbsp;\<br />
&nbsp;&nbsp;--without-poll_module&nbsp;\<br />
&nbsp;&nbsp;--with-http_gzip_static_module&nbsp;\<br />
&nbsp;&nbsp;--with-http_realip_module&nbsp;\<br />
&nbsp;&nbsp;--with-http_ssl_module<br />
make<br />
make&nbsp;install<br />
<p>
	4、修改配置文件/etc/nginx/nginx.conf
</p>
cat&nbsp;/etc/nginx/nginx.conf&nbsp;|&nbsp;grep&nbsp;-v&nbsp;^$&nbsp;|&nbsp;grep&nbsp;-v&nbsp;.*#<br />
worker_processes&nbsp;&nbsp;1;<br />
events&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;worker_connections&nbsp;&nbsp;1024;<br />
}<br />
http&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;include&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;mime.types;<br />
&nbsp;&nbsp;&nbsp;&nbsp;default_type&nbsp;&nbsp;application/octet-stream;<br />
&nbsp;&nbsp;&nbsp;&nbsp;sendfile&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;on;<br />
&nbsp;&nbsp;&nbsp;&nbsp;keepalive_timeout&nbsp;&nbsp;65;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client_max_body_size&nbsp;6024M;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#限制用户上传大小<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_ignore_client_abort&nbsp;on;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#解决499错误，意思是代理服务器不要主动关闭客户端连接<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;upstream&nbsp;swift&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;192.168.100.7:8080;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#此次ip为proxy的swift&nbsp;ip<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;192.168.100.8:8080;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;server&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;listen&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8080;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;server_name&nbsp;&nbsp;swift;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#主机名称<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;/&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;proxy_pass&nbsp;http://swift/;&nbsp;&nbsp;&nbsp;&nbsp;#upstream&nbsp;一致<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;error_page&nbsp;&nbsp;&nbsp;500&nbsp;502&nbsp;503&nbsp;504&nbsp;&nbsp;/50x.html;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;location&nbsp;=&nbsp;/50x.html&nbsp;{<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;root&nbsp;&nbsp;&nbsp;html;<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />
&nbsp;&nbsp;&nbsp;&nbsp;}<br />
}<br />
<p>
	5、启动Nginx
</p>
/usr/sbin/nginx<br />
netstat&nbsp;-ltunp&nbsp;|&nbsp;grep&nbsp;8080<br />
备注：记得只需要在endpoint里指向nginx服务器地址信息，其它proxy节点不需要指定。<br />
            <script type="text/javascript">      
            SyntaxHighlighter.all();       
            </script>
        </div>


        <div>
          <div id= "left">
            <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
            <ins class="adsbygoogle"
                 style="display:inline-block;width:300px;height:250px"
                 data-ad-client="ca-pub-1892357599595152"
                 data-ad-slot="7345849448"></ins>
            <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
            </script>
          </div>
          <div id= "right">
            <script type="text/javascript">
            /*文章下方*/
            var cpro_id = "u1489212";
            </script>
            <script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
          </div>
        </div>


        <div class="dede_pagess">
            <ul class="pagelist">
            
            </ul>
        </div>

        <div class="m4_box7">
            上一篇：<a href='/openstack/201403/8520.html'>OpenStack Swift简介</a> <br />
            下一篇：<a href='/openstack/201403/8522.html'>OpenStack Swift认证系统</a> 
        </div>
        <div class="m4_box8">
            <div class="m4_t2">相关内容</div>
            <ul>
                <li>・<a href="/openstack/201412/11252.html">OpenStack Swift 原理、架构与 API 介</a></li>
<li>・<a href="/openstack/201412/11251.html">OpenStack云计算架构解析</a></li>
<li>・<a href="/openstack/201411/11117.html">30分钟安装OpenStack云计算平台</a></li>
<li>・<a href="/openstack/201411/11116.html">OpenStack安装过程笔记</a></li>
<li>・<a href="/openstack/201411/11115.html">VirtualBox双虚拟机搭建OpenStack平台</a></li>
<li>・<a href="/openstack/201411/11114.html">CentOS系统下一键安装OpenStack教程</a></li>
<li>・<a href="/openstack/201411/11044.html">OpenStack详细安装过程指南</a></li>
<li>・<a href="/openstack/201411/11043.html">Ubuntu 13.10系统安装单节点OpenStack</a></li>
<li>・<a href="/openstack/201411/11042.html">10分钟快速安装OpenStack云计算平台图</a></li>
<li>・<a href="/openstack/201404/10587.html">使用Fuel for OpenStack快速部署OpenS</a></li>
<li>・<a href="/openstack/201404/9031.html">如何将OpenStack私有云部署到Hadoop M</a></li>
<li>・<a href="/openstack/201404/9030.html">OpenStack Nova Service启动过程分析</a></li>
<li>・<a href="/openstack/201404/9029.html">使用pdb调试OpenStack Havana的方法</a></li>
<li>・<a href="/openstack/201404/9027.html">OpenStack-Gizzly-nova-cells官方文档</a></li>
<li>・<a href="/openstack/201404/9026.html">OpenStack Quantum网络架构图片说明</a></li>
<li>・<a href="/openstack/201404/9025.html">Ubuntu13.04系统安装OpenStack Grizzl</a></li>

                <div class="clear"></div>
            </ul>
        </div>
    </div>
    <div class="m4_right FR">
        <div class="ad_300">
          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
          <!-- 文章页右侧上方 -->
          <!-- <img src="/template/images/ad/300X250.gif" width="300" height="250" alt="广告位" /> -->
          <ins class="adsbygoogle"
               style="display:inline-block;width:300px;height:250px"
               data-ad-client="ca-pub-1892357599595152"
               data-ad-slot="3694379047"></ins>
          <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
          </script>
        </div>
        <div class="m4_box2">
            <div class="m4_t2">最新内容</div>
            <ul>
                <li>・<a href="/openstack/201412/11252.html">OpenStack Swift 原理、架构与 API 介绍</a></li>
<li>・<a href="/openstack/201412/11251.html">OpenStack云计算架构解析</a></li>
<li>・<a href="/openstack/201411/11117.html">30分钟安装OpenStack云计算平台</a></li>
<li>・<a href="/openstack/201411/11116.html">OpenStack安装过程笔记</a></li>
<li>・<a href="/openstack/201411/11115.html">VirtualBox双虚拟机搭建OpenStack平台全过</a></li>
<li>・<a href="/openstack/201411/11114.html">CentOS系统下一键安装OpenStack教程</a></li>
<li>・<a href="/openstack/201411/11044.html">OpenStack详细安装过程指南</a></li>
<li>・<a href="/openstack/201411/11043.html">Ubuntu 13.10系统安装单节点OpenStack Hava</a></li>
<li>・<a href="/openstack/201411/11042.html">10分钟快速安装OpenStack云计算平台图文教</a></li>
<li>・<a href="/openstack/201404/10587.html">使用Fuel for OpenStack快速部署OpenStack</a></li>

            </ul>
        </div>

        <div class="ad_300">
          <script type="text/javascript">
          /*文章右侧，最新文章下方*/
          var cpro_id = "u1489206";
          </script>
          <script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
        </div>

        <div class="m4_box2">
            <div class="m4_t2">推荐内容</div>
            <ul>
                <li>・<a href="/openstack/201310/2941.html">CentOS 6.4系统安装配置OpenStack和Essex</a></li>

            </ul>
        </div>
        <div class="m4_box2">
            <div class="m4_t2">热点内容</div>
            <ul>
                <li>・<a href="/openstack/201310/2808.html">CentOS 6.4系统安装配置多节点Openstack Ha</a></li>
<li>・<a href="/openstack/201308/759.html">使用devstack安装部署openstack</a></li>
<li>・<a href="/openstack/201403/6926.html">OpenStack网络组件Neutron的研究</a></li>
<li>・<a href="/openstack/201310/2941.html">CentOS 6.4系统安装配置OpenStack和Essex</a></li>
<li>・<a href="/openstack/201312/4289.html">CentOS 6.5系统部署OpenStack云计算平台</a></li>
<li>・<a href="/openstack/201312/3633.html">CentOS 6.5 系统如何安装openstack essex(</a></li>
<li>・<a href="/openstack/201310/2954.html">CentOS 6.4系统中安装多节点Openstack Hava</a></li>
<li>・<a href="/openstack/201310/2949.html">Ubuntu 12.04系统上使用OneStack快速自动安</a></li>
<li>・<a href="/openstack/201308/756.html">ubuntu12.04系统中安装openstack</a></li>
<li>・<a href="/openstack/201310/2958.html">OpenStack Glance安装配置过程记录</a></li>

            </ul>
        </div>
        <div class="ad_300">
          <script type="text/javascript">
          var cpro_id = "u1390221";
          </script>
          <script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>
        </div>
    </div>

    <script type="text/javascript">
    /*文章页－右下角悬浮*/
    var cpro_id = "u1432314";
    </script>
    <script src="http://cpro.baidustatic.com/cpro/ui/f.js" type="text/javascript"></script>

    <div class="clear"></div>
</div>

<script type="text/javascript">
/*全站对联*/
var cpro_id = "u1489218";
</script>
<script src="http://cpro.baidustatic.com/cpro/ui/f.js" type="text/javascript"></script>

<div class="footer">
	<p>
        <a href="#">关于我们</a>  |  
        <a href="#">网站声明</a>  |  
        <a href="#">意见反馈</a>  |  
        <a href="#">业务合作</a>  |  
        <a href="#">友情链接</a>  |  
        <a href="#">联系我们</a>  |  
        <a href="#">收费服务</a>
    </p>
	<p><span class="en-code" style="font-family: arial;">Copyright &#169; 2002-2014</span>.<a href="http://www.server110.com" target="_blank">服务器之家</a> 版权所有 <a href="http://www.miitbeian.gov.cn/" target="_blank">辽ICP备13009196号</a></p>
	<br/>
  <div style="display:none">
    <script type="text/javascript">
      var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
      document.write(unescape("%3Cdiv id='cnzz_stat_icon_1000036443'%3E%3C/div%3E%3Cscript src='" + cnzz_protocol +	"s22.cnzz.com/z_stat.php%3Fid%3D1000036443' type='text/javascript'%3E%3C/script%3E"));
    </script>
  </div>

</div>
<!-- /footer -->
</body>
</html>
