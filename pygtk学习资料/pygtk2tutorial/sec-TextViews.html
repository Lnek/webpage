<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>13.2. TextViews</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="PyGTK 2.0 Tutorial"><link rel="up" href="ch-TextViewWidget.html" title="Chapter 13. TextView Widget"><link rel="prev" href="ch-TextViewWidget.html" title="Chapter 13. TextView Widget"><link rel="next" href="sec-TextBuffers.html" title="13.3. Text Buffers"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">13.2. TextViews</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch-TextViewWidget.html">Prev</a> </td><th width="60%" align="center">Chapter 13. TextView Widget</th><td width="20%" align="right"> <a accesskey="n" href="sec-TextBuffers.html">Next</a></td></tr></table><hr></div><div class="sect1" title="13.2. TextViews"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sec-TextViews"></a>13.2. TextViews</h2></div></div></div><p>There is only one function for creating a new
<code class="classname">TextView</code> widget.</p><pre class="programlisting">
  textview = gtk.TextView(<strong class="parameter"><code>buffer</code></strong>=None)
</pre><p>When a <code class="classname">TextView</code> is created it will create
an associated <code class="classname">TextBuffer</code> and
<code class="classname">TextTagTable</code> by default. If you want to use an
existing <code class="classname">TextBuffer</code> in a
<code class="classname">TextView</code> specify it in the above method. To change
the <code class="classname">TextBuffer</code> used by a
<code class="classname">TextView</code> use the following method:</p><pre class="programlisting">
  textview.set_buffer(<strong class="parameter"><code>buffer</code></strong>)
</pre><p>Use the following method to retrieve a reference to the
<code class="classname">TextBuffer</code> from a
<code class="classname">TextView</code>:</p><pre class="programlisting">
  buffer = textview.get_buffer()
</pre><p>A <code class="classname">TextView</code> widget doesn't have scrollbars
to adjust the view in case the text is larger than the window. To provide
scrollbars, you add the <code class="classname">TextView</code> to a
<code class="classname">ScrolledWindow</code> (see <a class="xref" href="sec-ScrolledWindows.html" title="10.9. Scrolled Windows">Section 10.9, “Scrolled Windows”</a>).</p><p>A <code class="classname">TextView</code> can be used to allow the user
to edit a body of text, or to display multiple lines of read-only text to
the user. To switch between these modes of operation, the use the following
method:</p><pre class="programlisting">
  textview.set_editable(<strong class="parameter"><code>setting</code></strong>)
</pre><p>The <em class="parameter"><code>setting</code></em> argument is a
<code class="literal">TRUE</code> or <code class="literal">FALSE</code> value that specifies
whether the user is permitted to edit the contents of the
<code class="classname">TextView</code> widget. The editable mode of the
<code class="classname">TextView</code> can be overridden in text ranges within the
<code class="classname">TextBuffer</code> by <code class="classname">TextTag</code>s.</p><p>You can retrieve the current editable setting using the
method:</p><pre class="programlisting">
  setting = textview.get_editable()
</pre><p>When the <code class="classname">TextView</code> is not editable, you
probably should hide the cursor using the method:</p><pre class="programlisting">
  textview.set_cursor_visible(<strong class="parameter"><code>setting</code></strong>)
</pre><p>The <em class="parameter"><code>setting</code></em> argument is a
<code class="literal">TRUE</code> or <code class="literal">FALSE</code> value that specifies
whether the cursor should be visible The <code class="classname">TextView</code> can
wrap lines of text that are too long to fit onto a single line of the
display window. Its default behavior is to not wrap lines. This can be
changed using the next method:</p><pre class="programlisting">
  textview.set_wrap_mode(<strong class="parameter"><code>wrap_mode</code></strong>)
</pre><p>This method allows you to specify that the text widget should
wrap long lines on word or character boundaries. The
<em class="parameter"><code>word_wrap</code></em> argument is one of:</p><pre class="programlisting">
  gtk.WRAP_NONE
  gtk.WRAP_CHAR
  gtk.WRAP_WORD
</pre><p>The default justification of the text in a
<code class="classname">TextView</code> can be set and retrieved using the
methods:</p><pre class="programlisting">
  textview.set_justification(<strong class="parameter"><code>justification</code></strong>)
  justification = textview.get_justification()
</pre><p>where <em class="parameter"><code>justification</code></em> is one of:</p><pre class="programlisting">
  gtk.JUSTIFY_LEFT
  gtk.JUSTIFY_RIGHT
  gtk.JUSTIFY_CENTER
</pre><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The <em class="parameter"><code>justification</code></em> will be
<code class="literal">JUSTIFY_LEFT</code> if the <em class="parameter"><code>wrap_mode</code></em> is
<code class="literal">WRAP_NONE</code>. Tags in the associated
<code class="classname">TextBuffer</code> may override the default
justification.</p></div><p>Other default attributes that can be set and retrieved in a
<code class="classname">TextView</code> are: left margin, right margin, tabs, and
paragraph indentation using the following methods:</p><pre class="programlisting">
  textview.set_left_margin(<strong class="parameter"><code>left_margin</code></strong>)
  left_margin = textview.get_left_margin()
  
  textview.set_right_margin(<strong class="parameter"><code>right_margin</code></strong>)
  right_margin = textview.get_right_margin()
  
  textview.set_indent(<strong class="parameter"><code>indent</code></strong>)
  indent = textview.get_indent()
  
  textview.set_pixels_above_lines(<strong class="parameter"><code>pixels_above_line</code></strong>)
  pixels_above_line = textview.get_pixels_above_lines()
  
  textview.set_pixels_below_lines(<strong class="parameter"><code>pixels_below_line</code></strong>)
  pixels_below_line = textview.get_pixels_below_lines()
  
  textview.set_pixels_inside_wrap(<strong class="parameter"><code>pixels_inside_wrap</code></strong>)
  pixels_inside_wrap = textview.get_pixels_inside_wrap()
  
  textview.set_tabs(<strong class="parameter"><code>tabs</code></strong>)
  tabs = textview.get_tabs()
</pre><p><em class="parameter"><code>left_margin</code></em>,
<em class="parameter"><code>right_margin</code></em>, <em class="parameter"><code>indent</code></em>,
<em class="parameter"><code>pixels_above_lines</code></em>,
<em class="parameter"><code>pixels_below_lines</code></em> and
<em class="parameter"><code>pixels_inside_wrap</code></em> are specified in pixels. These
default values may be overridden by tags in the associated
<code class="classname">TextBuffer</code>.  <em class="parameter"><code>tabs</code></em> is a
<code class="classname">pango.TabArray</code>.</p><p>The <a class="ulink" href="examples/textview-basic.py" target="_top"><span class="command"><strong>textview-basic.py</strong></span></a> 
example program illustrates basic use of the <code class="classname">TextView</code>
widget:</p><div class="figure"><a name="textviewbasicfig"></a><p class="title"><b>Figure 13.1. Basic TextView Example</b></p><div class="figure-contents"><div class="mediaobject" align="center"><img src="figures/textview-basic.png" align="middle" alt="Basic TextView Example"></div></div></div><br class="figure-break"><p>The source code for the program is:</p><pre class="programlisting">
    1	#!/usr/bin/env python
    2	
    3	# example textview-basic.py
    4	
    5	import pygtk
    6	pygtk.require('2.0')
    7	import gtk
    8	
    9	class TextViewExample:
   10	    def toggle_editable(self, checkbutton, textview):
   11	        textview.set_editable(checkbutton.get_active())
   12	
   13	    def toggle_cursor_visible(self, checkbutton, textview):
   14	        textview.set_cursor_visible(checkbutton.get_active())
   15	
   16	    def toggle_left_margin(self, checkbutton, textview):
   17	        if checkbutton.get_active():
   18	            textview.set_left_margin(50)
   19	        else:
   20	            textview.set_left_margin(0)
   21	
   22	    def toggle_right_margin(self, checkbutton, textview):
   23	        if checkbutton.get_active():
   24	            textview.set_right_margin(50)
   25	        else:
   26	            textview.set_right_margin(0)
   27	
   28	    def new_wrap_mode(self, radiobutton, textview, val):
   29	        if radiobutton.get_active():
   30	            textview.set_wrap_mode(val)
   31	
   32	    def new_justification(self, radiobutton, textview, val):
   33	        if radiobutton.get_active():
   34	            textview.set_justification(val)
   35	
   36	    def close_application(self, widget):
   37	        gtk.main_quit()
   38	
   39	    def __init__(self):
   40	        window = gtk.Window(gtk.WINDOW_TOPLEVEL)
   41	        window.set_resizable(True)  
   42	        window.connect("destroy", self.close_application)
   43	        window.set_title("TextView Widget Basic Example")
   44	        window.set_border_width(0)
   45	
   46	        box1 = gtk.VBox(False, 0)
   47	        window.add(box1)
   48	        box1.show()
   49	
   50	        box2 = gtk.VBox(False, 10)
   51	        box2.set_border_width(10)
   52	        box1.pack_start(box2, True, True, 0)
   53	        box2.show()
   54	
   55	        sw = gtk.ScrolledWindow()
   56	        sw.set_policy(gtk.POLICY_AUTOMATIC, gtk.POLICY_AUTOMATIC)
   57	        textview = gtk.TextView()
   58	        textbuffer = textview.get_buffer()
   59	        sw.add(textview)
   60	        sw.show()
   61	        textview.show()
   62	
   63	        box2.pack_start(sw)
   64	        # Load the file textview-basic.py into the text window
   65	        infile = open("textview-basic.py", "r")
   66	
   67	        if infile:
   68	            string = infile.read()
   69	            infile.close()
   70	            textbuffer.set_text(string)
   71	
   72	        hbox = gtk.HButtonBox()
   73	        box2.pack_start(hbox, False, False, 0)
   74	        hbox.show()
   75	
   76	        vbox = gtk.VBox()
   77	        vbox.show()
   78	        hbox.pack_start(vbox, False, False, 0)
   79	        # check button to toggle editable mode
   80	        check = gtk.CheckButton("Editable")
   81	        vbox.pack_start(check, False, False, 0)
   82	        check.connect("toggled", self.toggle_editable, textview)
   83	        check.set_active(True)
   84	        check.show()
   85	        # check button to toggle cursor visiblity
   86	        check = gtk.CheckButton("Cursor Visible")
   87	        vbox.pack_start(check, False, False, 0)
   88	        check.connect("toggled", self.toggle_cursor_visible, textview)
   89	        check.set_active(True)
   90	        check.show()
   91	        # check button to toggle left margin
   92	        check = gtk.CheckButton("Left Margin")
   93	        vbox.pack_start(check, False, False, 0)
   94	        check.connect("toggled", self.toggle_left_margin, textview)
   95	        check.set_active(False)
   96	        check.show()
   97	        # check button to toggle right margin
   98	        check = gtk.CheckButton("Right Margin")
   99	        vbox.pack_start(check, False, False, 0)
  100	        check.connect("toggled", self.toggle_right_margin, textview)
  101	        check.set_active(False)
  102	        check.show()
  103	        # radio buttons to specify wrap mode
  104	        vbox = gtk.VBox()
  105	        vbox.show()
  106	        hbox.pack_start(vbox, False, False, 0)
  107	        radio = gtk.RadioButton(None, "WRAP__NONE")
  108	        vbox.pack_start(radio, False, True, 0)
  109	        radio.connect("toggled", self.new_wrap_mode, textview, gtk.WRAP_NONE)
  110	        radio.set_active(True)
  111	        radio.show()
  112	        radio = gtk.RadioButton(radio, "WRAP__CHAR")
  113	        vbox.pack_start(radio, False, True, 0)
  114	        radio.connect("toggled", self.new_wrap_mode, textview, gtk.WRAP_CHAR)
  115	        radio.show()
  116	        radio = gtk.RadioButton(radio, "WRAP__WORD")
  117	        vbox.pack_start(radio, False, True, 0)
  118	        radio.connect("toggled", self.new_wrap_mode, textview, gtk.WRAP_WORD)
  119	        radio.show()
  120	
  121	        # radio buttons to specify justification
  122	        vbox = gtk.VBox()
  123	        vbox.show()
  124	        hbox.pack_start(vbox, False, False, 0)
  125	        radio = gtk.RadioButton(None, "JUSTIFY__LEFT")
  126	        vbox.pack_start(radio, False, True, 0)
  127	        radio.connect("toggled", self.new_justification, textview,
  128	                      gtk.JUSTIFY_LEFT)
  129	        radio.set_active(True)
  130	        radio.show()
  131	        radio = gtk.RadioButton(radio, "JUSTIFY__RIGHT")
  132	        vbox.pack_start(radio, False, True, 0)
  133	        radio.connect("toggled", self.new_justification, textview,
  134	                      gtk.JUSTIFY_RIGHT)
  135	        radio.show()
  136	        radio = gtk.RadioButton(radio, "JUSTIFY__CENTER")
  137	        vbox.pack_start(radio, False, True, 0)
  138	        radio.connect("toggled", self.new_justification, textview,
  139	                      gtk.JUSTIFY_CENTER)
  140	        radio.show()
  141	
  142	        separator = gtk.HSeparator()
  143	        box1.pack_start(separator, False, True, 0)
  144	        separator.show()
  145	
  146	        box2 = gtk.VBox(False, 10)
  147	        box2.set_border_width(10)
  148	        box1.pack_start(box2, False, True, 0)
  149	        box2.show()
  150	
  151	        button = gtk.Button("close")
  152	        button.connect("clicked", self.close_application)
  153	        box2.pack_start(button, True, True, 0)
  154	        button.set_flags(gtk.CAN_DEFAULT)
  155	        button.grab_default()
  156	        button.show()
  157	        window.show()
  158	
  159	def main():
  160	    gtk.main()
  161	    return 0       
  162	
  163	if __name__ == "__main__":
  164	    TextViewExample()
  165	    main()
</pre><p>Lines 10-34 define the callbacks for the radio and check buttons
used to change the default attributes of the
<code class="classname">TextView</code>. Lines 55-63 create a
<code class="classname">ScrolledWindow</code> to contain the
<code class="classname">TextView</code>. The <code class="classname">ScrolledWindow</code>
is packed into a <code class="classname">VBox</code> with the check and radio
buttons created in lines 72-140. The <code class="classname">TextBuffer</code>
associated with the <code class="classname">TextView</code> is loaded with the
contents of the source file in lines 64-70.</p></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch-TextViewWidget.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="ch-TextViewWidget.html">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="sec-TextBuffers.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter 13. TextView Widget </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> 13.3. Text Buffers</td></tr></table></div></body></html>
