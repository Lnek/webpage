

<!DOCTYPE html>
<html>
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
 <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" >
 
 <meta name="ROBOTS" content="NOARCHIVE">
 
 <link rel="icon" type="image/vnd.microsoft.icon" href="http://www.gstatic.com/codesite/ph/images/phosting.ico">
 
 
 <script type="text/javascript">
 
 
 
 
 var codesite_token = null;
 
 
 var CS_env = {"projectName": "mysql-parallel-replication", "projectHomeUrl": "/p/mysql-parallel-replication", "assetVersionPath": "http://www.gstatic.com/codesite/ph/3427079965498762429", "loggedInUserEmail": null, "relativeBaseUrl": "", "token": null, "profileUrl": null, "domainName": null, "assetHostPath": "http://www.gstatic.com/codesite/ph"};
 var _gaq = _gaq || [];
 _gaq.push(
 ['siteTracker._setAccount', 'UA-18071-1'],
 ['siteTracker._trackPageview']);
 
 (function() {
 var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
 ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
 (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
 })();
 
 </script>
 
 
 <title>
 mysql-parallel-replication -
 
 
 parallel replication feature for mysql - Google Project Hosting
 </title>
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/3427079965498762429/css/core.css">
 
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/3427079965498762429/css/ph_detail.css" >
 
 
 
 
<!--[if IE]>
 <link type="text/css" rel="stylesheet" href="http://www.gstatic.com/codesite/ph/3427079965498762429/css/d_ie.css" >
<![endif]-->
 <style type="text/css">
 .menuIcon.off { background: no-repeat url(http://www.gstatic.com/codesite/ph/images/dropdown_sprite.gif) 0 -42px }
 .menuIcon.on { background: no-repeat url(http://www.gstatic.com/codesite/ph/images/dropdown_sprite.gif) 0 -28px }
 .menuIcon.down { background: no-repeat url(http://www.gstatic.com/codesite/ph/images/dropdown_sprite.gif) 0 0; }
 
 
 .psicon-container {
 min-width:24px;
 }

 
 </style>
</head>
<body class="t1">
<script type="text/javascript">
 window.___gcfg = {lang: 'en'};
 (function() 
 {var po = document.createElement("script");
 po.type = "text/javascript"; po.async = true;po.src = "https://apis.google.com/js/plusone.js";
 var s = document.getElementsByTagName("script")[0];
 s.parentNode.insertBefore(po, s);
 })();
</script>
<div class="headbg">

 <div id="gaia">
 

 <span>
 
 
 <a href="#" id="projects-dropdown" onclick="return false;"><u>My favorites</u> <small>&#9660;</small></a>
 | <a href="https://www.google.com/accounts/ServiceLogin?service=code&amp;ltmpl=phosting&amp;continue=http%3A%2F%2Fcode.google.com%2Fp%2Fmysql-parallel-replication%2F&amp;followup=http%3A%2F%2Fcode.google.com%2Fp%2Fmysql-parallel-replication%2F" onclick="_CS_click('/gb/ph/signin');"><u>Sign in</u></a>
 
 </span>

 </div>

 <div class="gbh" style="left: 0pt;"></div>
 <div class="gbh" style="right: 0pt;"></div>
 
 
 <div style="height: 1px"></div>
<!--[if lte IE 7]>
<div style="text-align:center;">
Your version of Internet Explorer is not supported. Try a browser that
contributes to open source, such as <a href="http://www.firefox.com">Firefox</a>,
<a href="http://www.google.com/chrome">Google Chrome</a>, or
<a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>.
</div>
<![endif]-->



 <table style="padding:0px; margin: 0px 0px 10px 0px; width:100%" cellpadding="0" cellspacing="0"
 itemscope itemtype="http://schema.org/CreativeWork">
 <tr style="height: 58px;">
 
 
 
 <td id="plogo">
 <link itemprop="url" href="/p/mysql-parallel-replication">
 <a href="/p/mysql-parallel-replication/">
 
 <img src="http://www.gstatic.com/codesite/ph/images/defaultlogo.png" alt="Logo" itemprop="image">
 
 </a>
 </td>
 
 <td style="padding-left: 0.5em">
 
 <div id="pname">
 <a href="/p/mysql-parallel-replication/"><span itemprop="name">mysql-parallel-replication</span></a>
 </div>
 
 <div id="psum">
 <a id="project_summary_link"
 href="/p/mysql-parallel-replication/"><span itemprop="description">parallel replication feature for mysql</span></a>
 
 </div>
 
 
 </td>
 <td style="white-space:nowrap;text-align:right; vertical-align:bottom;">
 
 <form action="/hosting/search">
 <input size="30" name="q" value="" type="text">
 
 <input type="submit" name="projectsearch" value="Search projects" >
 </form>
 
 </tr>
 </table>

</div>

 
<div id="mt" class="gtb"> 
 <a href="/p/mysql-parallel-replication/" class="tab active">Project&nbsp;Home</a>
 
 
 
 
 
 
 
 
 <a href="/p/mysql-parallel-replication/issues/list"
 class="tab ">Issues</a>
 
 
 
 
 
 <a href="/p/mysql-parallel-replication/source/checkout"
 class="tab ">Source</a>
 
 
 
 
 
 
 
 
 <div class=gtbc></div>
</div>
<table cellspacing="0" cellpadding="0" width="100%" align="center" border="0" class="st">
 <tr>
 
 
 
 
 
 
 
 <td class="subt">
 <div class="st1">
 <div class="isf">
 <span class="inst1">
 <a href="/p/mysql-parallel-replication/">Summary</a>
 </span>
 
 
 &nbsp;
 <span class="inst3">
 <a href="/p/mysql-parallel-replication/people/list">People</a>
 </span>
 
 
 </div>
</div>

 </td>
 
 
 <td align="right" valign="top" class="bevel-right"></td>
 </tr>
</table>


<script type="text/javascript">
 var cancelBubble = false;
 function _go(url) { document.location = url; }
</script>
<div id="maincol"
 
>

 





<table width="100%">
 <tr class="pscontent">
 <td class="pscolumnl">
 
 <div class="phead">Project Information</div>
 
 
 
 <ul class="pslist">
 
 <li class="psmeta">
 <a href="/p/mysql-parallel-replication/feeds">Project feeds</a>
 </li>
 <li class="psgap"/>
 
 
 
 <li class="psmeta"><b>Code license</b></li>
 <li class="psmeta">
 <a href="http://www.gnu.org/licenses/old-licenses/gpl-2.0.html" rel="nofollow">GNU GPL v2</a>
 
 </li>
 <li class="psgap"/>
 
 
 
 
 
 
 <li class="psmeta">
 <span id="project_labels">
 <b>Labels</b><br/>
 
 <a class="label"
 href="/hosting/search?q=label:MySQL">MySQL</a>, 
 
 <a class="label"
 href="/hosting/search?q=label:parallel-replication">parallel-replication</a>, 
 
 <a class="label"
 href="/hosting/search?q=label:transactional">transactional</a>, 
 
 <a class="label"
 href="/hosting/search?q=label:performance">performance</a>
 
 </span>
 </li>
 <li class="psgap"/>
 
 
 </ul>
 <div class="psicon">
 <div class="psicon-container goog-inline-block">
 <div style="float:right" class="SPRITE_people-y16 goog-inline-block vt"></div>
 </div>
 <span><b>Members</b></span>
 </div>
 <ul class="pslist">
 
 
 
 

 <a class="userlink"
 href="/u/101059753696298884859/">Hickey....@gmail.com</a
>
 
 
 
 <li class="psmeta">
 <a href="people/list">2 committers</a>
 </li>
 
 
 <li class="psgap"/>
 
 
 </ul>
 
 
 
 
 </td>
 <td id="wikicontent" class="psdescription">
 <p><strong>Parallel Replication Feature</strong> is aiming to solve the lag between master and its slaves. It&#x27;s developed based on Percona-5.5.18, and the first version is released and the end of August. </p><p><strong>Why we would develop this feature</strong> </p><p>Oracle MySQL5.6 enhanced parallel replication much, which is based on database level for the sake of keeping transaction consistency feature, but it&#x27;s not fit for the business in our work when using MySQL in my employer company,the Alibaba Corp, as the sharding tables,as well as the sharding databases.  </p><p>At the same time, it&#x27;s hard to use the existing open source replication tools, such as <a href="http://www.continuent.com/solutions/overview" rel="nofollow">Tungsten parallel replication</a>, we just want a transparent and high performance replication for MySQL.  </p><p>The Percona&#x27;s blue print for <a href="http://www.percona.com/docs/wiki/percona-server:blueprints:parallel-replication" rel="nofollow">parallel replication</a> is suspend for a long time, no usable in the counting weeks, neither for the <a href="http://forge.mysql.com/worklog/task.php?id=5569" rel="nofollow">event-based parallel replication</a> instead of the database. </p><p>In the meanwhile, though we developed a smart tool <a href="http://code.google.com/p/relay-fetch/" rel="nofollow">relay-fetch</a> for speeding the slave by pre-fetching relay log and convert them to &#x27;select&#x27;, both for RBR and SBR.In this way, the gap between master and slave is reduced much for most of case. It has many advantages, such as no code injection for MySQL, but, it&#x27;s not transparent, not as effective for large load, and not works well for all scenarios, such as pure inserting case. </p><p>So, we decided to develop a simple but fast replication for MySQL. </p><p><strong> Architecture </strong> </p><p><a href="http://code.google.com/p/mysql-parallel-replication/" rel="nofollow"><img src="http://mysql-parallel-replication.googlecode.com/files/parallel_replication.png" /></a> </p><p>We don&#x27;t want much change to existing slave replication module, therefore, the IO thread is keeping the same, a new relay thread is added, reading events from relay logs and fetching possible keys from engine for the row events, including judging the conflicts for transactions, and dispatch to extended slave_sql_threads number of slave threads for replaying these transaction&#x27;s events, if no conflicts between transactions. </p><p><strong> Performance data</strong> </p><p>For OLTP simple mode, with 10 tables, each with 5,000,000 records, same steps of <a href="https://blogs.oracle.com/MySQL/entry/benchmarking_mysql_replication_with_multi" rel="nofollow">Oracle MySQL Multi_Thread Perf</a>, the performance is shown as below: </p><p><a href="http://code.google.com/p/mysql-parallel-replication/" rel="nofollow"><img src="http://mysql-parallel-replication.googlecode.com/files/oltp_update.png" /></a> </p><p>Note: in simple mode, the insert/delete/update ratio is 1:1:2, we only stats the updates in the chart above.  </p><p><strong>The detail functions include</strong> </p><ol><li>Parallelize as much as possible, based on the primary keys, not database level. </li><li>Strong consistent for transactional level, which means the transaction taken on master is not divided into separated transactions. </li><li>Both RBR and SBR are supported, but RBR could take complete advantage of concurrency. </li><li>Independence for storage engines, not all tables must be InnoDB. </li><li>Recoverable for crash, just like restarted from normal replication. </li><li>No extra parameter for DBA, try keeping most of the behaviors as before. </li></ol><p><strong> Extra Doc (Chinese Version)</strong> </p><p><a href="http://www.slideshare.net/hickeyliu/mysql-13985722" rel="nofollow">SlideShare: MySQL Parallel Replication Feature</a> </p><p><strong>Do you want to try</strong> </p><p>It&#x27;s mainly developed for Taobao&#x27;s MySQL business, therefore, you&#x27;d better think carefully for following: <ol><li>Better to have primary keys for your tables, or else it&#x27;s sequential. </li><li>Better to set binlog format with ROW, or else it&#x27;s sequential. </li><li>Better no primary key updates, or it&#x27;s sequential. (TBD) </li></ol></p><p><a href="http://code.google.com/" rel="nofollow"><img src="http://code.google.com/images/code_sm.png" /></a> </p>
 </td>
 </tr>
</table>
<script src="http://www.gstatic.com/codesite/ph/3427079965498762429/js/prettify/prettify_core_compiled.js"></script>
<script type="text/javascript">
 prettyPrint();
</script>

 
 
 
 <script type="text/javascript" src="http://www.gstatic.com/codesite/ph/3427079965498762429/js/ph_core.js"></script>
 
 
 
 
</div> 

<div id="footer" dir="ltr">
 <div class="text">
 <a href="/projecthosting/terms.html">Terms</a> -
 <a href="http://www.google.com/privacy.html">Privacy</a> -
 <a href="/p/support/">Project Hosting Help</a>
 </div>
</div>
 <div class="hostedBy" style="margin-top: -20px;">
 <span style="vertical-align: top;">Powered by <a href="http://code.google.com/projecthosting/">Google Project Hosting</a></span>
 </div>

 
 


 
 </body>
</html>

