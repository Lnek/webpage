<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15.5-2squeeze5" />
		<meta name="keywords" content="Samba AD DC HOWTO,Authenticating other services against AD,Backup and Recovery,Build Samba,Configure NTP,Configuring a windows client for AD,DNS,Dns-backend bind,Samba,Samba4/HOWTO/Join a domain as a DC,Samba4/InitScript" />
		<link rel="shortcut icon" href="http://www.samba.org/samba/style/2010/grey/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="SambaWiki (en)" />
		<link title="Creative Commons" type="application/rdf+xml" href="/index.php?title=Samba_AD_DC_HOWTO&amp;action=creativecommons" rel="meta" />
		<link rel="copyright" href="/index.php/License" />
		<link rel="alternate" type="application/rss+xml" title="SambaWiki RSS feed" href="/index.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="SambaWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Samba AD DC HOWTO - SambaWiki</title>
		<link rel="stylesheet" href="http://wikistatic.samba.org/skins/common/shared.css?207" type="text/css" media="screen" />
		<link rel="stylesheet" href="http://wikistatic.samba.org/skins/common/commonPrint.css?207" type="text/css" media="print" />
		<link rel="stylesheet" href="http://wikistatic.samba.org/skins/monobook/main.css?207" type="text/css" media="screen" />
		<!--[if lt IE 5.5000]><link rel="stylesheet" href="http://wikistatic.samba.org/skins/monobook/IE50Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 5.5000]><link rel="stylesheet" href="http://wikistatic.samba.org/skins/monobook/IE55Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 6]><link rel="stylesheet" href="http://wikistatic.samba.org/skins/monobook/IE60Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<!--[if IE 7]><link rel="stylesheet" href="http://wikistatic.samba.org/skins/monobook/IE70Fixes.css?207" type="text/css" media="screen" /><![endif]-->
		<link rel="stylesheet" href="/index.php?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="/index.php?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" media="print" />
		<link rel="stylesheet" href="/index.php?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="/index.php?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="http://wikistatic.samba.org/skins/common/IEFixes.js?207"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "http://wikistatic.samba.org/skins";
		var wgArticlePath = "/index.php/$1";
		var wgScriptPath = "";
		var wgScript = "/index.php";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://wiki.samba.org";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Samba_AD_DC_HOWTO";
		var wgTitle = "Samba AD DC HOWTO";
		var wgAction = "view";
		var wgArticleId = "1379";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 7881;
		var wgVersion = "1.15.5-2squeeze5";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="http://wikistatic.samba.org/skins/common/wikibits.js?207"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="http://wikistatic.samba.org/skins/common/ajax.js?207"></script>
		<script type="text/javascript" src="/index.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Samba_AD_DC_HOWTO skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Samba AD DC HOWTO</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From SambaWiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<table id="toc" class="toc" summary="Contents"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#Introduction"><span class="tocnumber">1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-1"><a href="#Versions"><span class="tocnumber">2</span> <span class="toctext">Versions</span></a></li>
<li class="toclevel-1"><a href="#Installing_Samba"><span class="tocnumber">3</span> <span class="toctext">Installing Samba</span></a>
<ul>
<li class="toclevel-2"><a href="#Different_ways_to_install"><span class="tocnumber">3.1</span> <span class="toctext">Different ways to install</span></a></li>
<li class="toclevel-2"><a href="#Paths"><span class="tocnumber">3.2</span> <span class="toctext">Paths</span></a></li>
<li class="toclevel-2"><a href="#Server_information"><span class="tocnumber">3.3</span> <span class="toctext">Server information</span></a></li>
<li class="toclevel-2"><a href="#Provisioning_Samba_.28Setting_up_a_new_domain.29"><span class="tocnumber">3.4</span> <span class="toctext">Provisioning Samba (Setting up a new domain)</span></a></li>
<li class="toclevel-2"><a href="#Classicupgrade_.28Migrating_a_Samba_NT4-style_domain_to_AD.29"><span class="tocnumber">3.5</span> <span class="toctext">Classicupgrade (Migrating a Samba NT4-style domain to AD)</span></a></li>
<li class="toclevel-2"><a href="#Starting_Your_Samba_AD_DC"><span class="tocnumber">3.6</span> <span class="toctext">Starting Your Samba AD DC</span></a></li>
<li class="toclevel-2"><a href="#Testing_Connectivity_to_Your_Samba_AD_DC"><span class="tocnumber">3.7</span> <span class="toctext">Testing Connectivity to Your Samba AD DC</span></a></li>
<li class="toclevel-2"><a href="#Configure_DNS"><span class="tocnumber">3.8</span> <span class="toctext">Configure DNS</span></a>
<ul>
<li class="toclevel-3"><a href="#DNS_Backends"><span class="tocnumber">3.8.1</span> <span class="toctext">DNS Backends</span></a>
<ul>
<li class="toclevel-4"><a href="#Samba_Internal_DNS_Server"><span class="tocnumber">3.8.1.1</span> <span class="toctext">Samba Internal DNS Server</span></a></li>
<li class="toclevel-4"><a href="#BIND_as_DNS_backend"><span class="tocnumber">3.8.1.2</span> <span class="toctext">BIND as DNS backend</span></a></li>
</ul>
</li>
<li class="toclevel-3"><a href="#Configure_.2Fetc.2Fresolv.conf"><span class="tocnumber">3.8.2</span> <span class="toctext">Configure /etc/resolv.conf</span></a></li>
<li class="toclevel-3"><a href="#Testing_DNS"><span class="tocnumber">3.8.3</span> <span class="toctext">Testing DNS</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Configure_Kerberos"><span class="tocnumber">3.9</span> <span class="toctext">Configure Kerberos</span></a>
<ul>
<li class="toclevel-3"><a href="#Testing_Kerberos"><span class="tocnumber">3.9.1</span> <span class="toctext">Testing Kerberos</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#Configure_NTP_.28Optional.2C_but_highly_recommended.29"><span class="tocnumber">3.10</span> <span class="toctext">Configure NTP (Optional, but highly recommended)</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Optional_and_Further_Information"><span class="tocnumber">4</span> <span class="toctext">Optional and Further Information</span></a></li>
<li class="toclevel-1"><a href="#Report_Your_Success.2FFailure.21"><span class="tocnumber">5</span> <span class="toctext">Report Your Success/Failure!</span></a></li>
</ul>
</td></tr></table><script type="text/javascript"> if (window.showTocToggle) { var tocShowText = "show"; var tocHideText = "hide"; showTocToggle(); } </script>
<a name="Introduction" id="Introduction"></a><h1> <span class="mw-headline"> Introduction </span></h1>
<p>This document explains how to setup Samba as a simple Domain Controller that is compatible with Microsoft's Active Directory, for use particularly by Microsoft Windows clients that are joined to the Active Directory domain, for services such as Domain Logon. We refer to this capability as being an AD DC for short. 
</p><p>If you are upgrading an existing AD DC, please consult your distribution upgrade procedure or refer to the <a href="/index.php/Build_Samba#Upgrading_a_source_version" title="Build Samba">upgrading a source version</a> HowTo.
</p><p><br />
</p><p><br />
</p>
<a name="Versions" id="Versions"></a><h1> <span class="mw-headline"> Versions </span></h1>
<p>Samba is developing rapidly. This HowTo is frequently updated to reflect the latest changes. Please see the <a href="/index.php/Samba_Release_Planning" title="Samba Release Planning">Samba Release Planning</a> for 4.0 and later for more specifics.
</p><p>Please review the release notes for the version you have installed. It may contain important information, not yet reflected in this HowTo.
</p><p><br />
</p><p><br />
</p>
<a name="Installing_Samba" id="Installing_Samba"></a><h1> <span class="mw-headline"> Installing Samba </span></h1>
<a name="Different_ways_to_install" id="Different_ways_to_install"></a><h2> <span class="mw-headline"> Different ways to install </span></h2>
<p>You're having two options to install Samba:
</p>
<ul><li> <a href="/index.php/Build_Samba" title="Build Samba"> Build Samba</a> by yourself.
</li></ul>
<ul><li> Installation from your distribution package manager or e. g. <a href="https://portal.enterprisesamba.com/" class="external free" title="https://portal.enterprisesamba.com/" rel="nofollow">https://portal.enterprisesamba.com/</a>.
</li></ul>
<p><br />
</p><p><br />
</p>
<a name="Paths" id="Paths"></a><h2> <span class="mw-headline"> Paths </span></h2>
<p>Take care when running Samba commands, if you also have a previous version of Samba installed.  To avoid inadvertently running the wrong version, you should consider putting the <tt>/usr/local/samba/bin/</tt> and <tt>/usr/local/samba/sbin/</tt> directories in the beginning of your <tt>$PATH</tt> variable!
</p><p>You can see what version of Samba, if any, is in your <tt>PATH</tt> variable by running:
</p>
<pre># samba -V
</pre>
<p><br />
</p><p><br />
</p>
<a name="Server_information" id="Server_information"></a><h2> <span class="mw-headline"> Server information </span></h2>
<p>For the rest of this HowTo, we will be using the following configuration/settings for our example AD DC:
</p>
<pre>Installation Directory: /usr/local/samba/
Server Hostname:        DC1
DNS Domain Name:        samdom.example.com (This will also be your realm)
NT4 Domain Name:        samdom
IP Address:             192.168.1.1
Server Role:            DC
</pre>
<p><br />
</p><p><br />
</p>
<a name="Provisioning_Samba_.28Setting_up_a_new_domain.29" id="Provisioning_Samba_.28Setting_up_a_new_domain.29"></a><h2> <span class="mw-headline"> Provisioning Samba (Setting up a new domain) </span></h2>
<p>The provisioning creates a basic database, and is used when you are configuring your first Samba DC in its own domain. If you instead want to setup your Samba server as an additional domain controller in an existing domain, then please see the <a href="/index.php/Samba4/HOWTO/Join_a_domain_as_a_DC" title="Samba4/HOWTO/Join a domain as a DC">Joining a Windows Domain Controller as an additional DC in a Domain</a> HowTo.
</p><p>The provision step must be run as a user with permission to write to the install directory. Otherwise you're getting permission denied errors.
</p><p>To provision a new domain, run:
</p>
<pre># /usr/local/samba/bin/samba-tool domain provision --use-rfc2307
</pre>
<p>This will run the provision tool interactively. Because some settings can't be set interactively, it's recommended to run <tt>samba-tool domain provision --help</tt> and have a look at the additional possibilities.
</p><p>The <tt>--use-rfc2307</tt> option enables your Samba AD automatically to store posix attributes. It also creates NIS information in the AD, that allows you to administrate UIDs/GIDs and other Unix settings (on the „Unix attributes“ tab in ADUC). It's easier if you enable this feature during provisioning, than setting this up later by hand. And even if you don't required it (yet), it's not affecting your installation.
</p><p><b>Important notes on the provisioning:</b>
</p>
<ul><li> As of Samba 4.0.0rc1 the provision command uses the Samba Internal DNS server by default. If you would like to use <a href="/index.php/Dns-backend_bind" title="Dns-backend bind">Bind as DNS backend</a>, add <tt>--dns-backend=BIND9_DLZ</tt> to the provisioning command. This decission isn't final. You can <a href="/index.php/DNS#Changing_the_DNS_backend" title="DNS">switch the backend</a> whenever it's necessary.
</li></ul>
<ul><li> If you re-run the provisioning, you need to remove the <tt>/usr/local/samba/etc/smb.conf</tt>!
</li></ul>
<ul><li> The admin password need to fulfill the password complexity requirements. This means at least one uppercase letter, one number, and at least eight characters length. If you don't use a complex enough password, the provision script will fail, and you will need to start over with a better password (remove <tt>/usr/local/samba/private/</tt> and <tt>/usr/local/samba/etc/</tt>).
</li></ul>
<p><br />
</p><p><br />
</p>
<a name="Classicupgrade_.28Migrating_a_Samba_NT4-style_domain_to_AD.29" id="Classicupgrade_.28Migrating_a_Samba_NT4-style_domain_to_AD.29"></a><h2> <span class="mw-headline"> Classicupgrade (Migrating a Samba NT4-style domain to AD) </span></h2>
<p>If you plan to migrate an existing Samba NT4 domain to Samba AD, see the <a href="/index.php/Samba4/samba-tool/domain/classicupgrade/HOWTO" title="Samba4/samba-tool/domain/classicupgrade/HOWTO">Classicupgrade HowTo</a>.
</p><p><br />
</p><p><br />
</p>
<a name="Starting_Your_Samba_AD_DC" id="Starting_Your_Samba_AD_DC"></a><h2> <span class="mw-headline"> Starting Your Samba AD DC </span></h2>
<p><b>Note: If you are running any <tt>smbd</tt>, <tt>nmbd</tt> or <tt>winbindd</tt> processes from previous installations, they need to be stopped before starting <tt>samba</tt> from your new installation!</b>
</p><p>If you are planning to run Samba as a production server, then simply run the binary as root:
</p>
<pre># /usr/local/samba/sbin/samba
</pre>
<p>That will run Samba in 'standard' mode, which is suitable for production use. Samba doesn't yet have init scripts included for each platform, but writing one for your platform should not be
difficult. There are some example scripts on the <a href="/index.php/Samba4/InitScript" title="Samba4/InitScript">Samba4 Init-Script</a> page.
</p><p>If you are running Samba as a developer you may find the following more useful:
</p>
<pre># /usr/local/samba/sbin/samba -i -M single
</pre>
<p>This will start Samba with all log messages printed to stdout, and restricting it to a single process. That mode of operation makes debugging Samba with gdb easier. To launch Samba under gdb, run as follows:
</p>
<pre># gdb --args /usr/local/samba/sbin/samba -i -M single
</pre>
<p><br />
</p><p><br />
</p>
<a name="Testing_Connectivity_to_Your_Samba_AD_DC" id="Testing_Connectivity_to_Your_Samba_AD_DC"></a><h2> <span class="mw-headline"> Testing Connectivity to Your Samba AD DC </span></h2>
<p>First check that you have the right version of <tt>smbclient</tt> by running:
</p>
<pre> $ /usr/local/samba/bin/smbclient --version
</pre>
<p>This should show you a version starting with "Version 4.x". 
</p><p>Now run this command to list the shares on your Samba server:
</p>
<pre>$ /usr/local/samba/bin/smbclient -L localhost -U%

       Sharename       Type      Comment
       ---------       ----      -------
       netlogon        Disk
       sysvol          Disk
       IPC$            IPC       IPC Service (Samba 4.x.y)
</pre>
<p>The output of the command should be similar to what is shown. The <tt>netlogon</tt> and <tt>sysvol</tt> shares are default shares needed for Active Directory server operation and created in your <tt>smb.conf</tt> during provisioning/upgrading.
</p><p>If the command failed, restart samba:
</p>
<pre># killall samba
# /usr/local/samba/sbin/samba
</pre>
<p>To test that authentication is working, you should try to connect to the <tt>netlogon</tt> share, using the Administrator account created during provisioning. The output of the command should be similar to what is shown below:
</p>
<pre>$ smbclient //localhost/netlogon -UAdministrator% -c 'ls'

Domain=[SAMDOM] OS=[Unix] Server=[Samba 4.x.y]
  .                                   D        0  Tue Dec 11 20:00:00 2012
  ..                                  D        0  Tue Dec 11 20:00:00 2012
</pre>
<p><br />
</p><p><br />
</p>
<a name="Configure_DNS" id="Configure_DNS"></a><h2> <span class="mw-headline"> Configure DNS </span></h2>
<p>A working DNS setup is essential to the correct operation of Samba and AD. Without the right DNS entries, Kerberos won't work, which in turn means that many of the basic features won't work! It is worth spending some extra time to ensure your DNS setup is correct, as debugging problems caused by mis-configured DNS can take a lot of time later on.
</p><p><br />
</p>
<a name="DNS_Backends" id="DNS_Backends"></a><h3> <span class="mw-headline"> DNS Backends </span></h3>
<p>For additional information on the supported DNS backends and a decission aid, which fits best to your needs, see the <a href="/index.php/DNS#Which_DNS_backend_should_I_choose.3F" title="DNS">DNS</a> page.
</p><p><br />
</p>
<a name="Samba_Internal_DNS_Server" id="Samba_Internal_DNS_Server"></a><h4> <span class="mw-headline"> Samba Internal DNS Server </span></h4>
<p>Per default Samba uses its Internal DNS and no further configuration is required.
</p><p>Typically you want the DNS server to forward requests that it isn't resposible for. Simply add
</p>
<pre>dns forwarder = {IP-Address of the DNS you want to forward to}
</pre>
<p>to your <tt>smb.conf</tt> and restart Samba.
</p><p>To enable the Internal DNS to start, port 53 udp/tcp must not be taken by any other program (like another DNS server, Dnsmasq, etc.). You'll see errors in your samba logfile, if Samba can't bind to port 53:
</p>
<pre>Failed to bind to 0.0.0.0:53 TCP - NT_STATUS_ADDRESS_ALREADY_ASSOCIATED
</pre>
<p>To check, which program is listening on port 53, run as root
</p>
<pre># netstat -tunpe | grep ":53"
</pre>
<p>It should return only <tt>samba</tt> processes, bound to this port.
</p><p>More information about troubleshooting can be found on the <a href="/index.php/Samba_troubleshooting_temp" title="Samba troubleshooting temp">Samba Troubleshooting</a> page.
</p><p><br />
</p>
<a name="BIND_as_DNS_backend" id="BIND_as_DNS_backend"></a><h4> <span class="mw-headline"> BIND as DNS backend </span></h4>
<p>If you chose <tt>BIND9_DLZ</tt> in your provisioning, see the <a href="/index.php/Dns-backend_bind" title="Dns-backend bind">Bind as DNS backend</a> HowTo for additional setup instructions. There you will find much information on how to setup and configure Bind in general and how to configure it with Samba AD. If you provisioned your DC with the Internal DNS, you can <a href="/index.php/DNS#Changing_from_Internal_DNS_to_BIND" title="DNS">switch to BIND</a>, whenever it's necessary.
</p><p><br />
</p>
<a name="Configure_.2Fetc.2Fresolv.conf" id="Configure_.2Fetc.2Fresolv.conf"></a><h3> <span class="mw-headline"> Configure /etc/resolv.conf </span></h3>
<p>For the local DNS lookups to resolve correctly, we need to modify the server's <tt>/etc/resolv.conf</tt>. The following example should be sufficient to have DNS resolve properly (adapt the domain and IP to your environment):
</p>
<pre>domain samdom.example.com
nameserver 192.168.1.1
</pre>
<ul><li> Note: If your server is set up to receive its IP configuration via DHCP, the <tt>/etc/resolv.conf</tt> file might be automatically updated. Refer to your distributions documentation on how to stop/change this behavior, although DHCP is not recommended on a DC.
</li></ul>
<p><br />
</p>
<a name="Testing_DNS" id="Testing_DNS"></a><h3> <span class="mw-headline"> Testing DNS </span></h3>
<p>To test that DNS is working properly, run the following commands and compare the output to what is shown:
</p>
<pre>$ host -t SRV _ldap._tcp.samdom.example.com.
_ldap._tcp.samdom.example.com has SRV record 0 100 389 samba.samdom.example.com.
</pre>
<pre>$ host -t SRV _kerberos._udp.samdom.example.com.
_kerberos._udp.samdom.example.com has SRV record 0 100 88 samba.samdom.example.com.
</pre>
<pre>$ host -t A samba.samdom.example.com.
samba.samdom.example.com has address 192.168.1.1
</pre>
<p>The answers you get, should be similar to the ones above (adjusted for your domain name, hostname and IP). If you get any errors, carefully check your system logs to locate the problem.
</p><p><br />
</p><p><br />
</p>
<a name="Configure_Kerberos" id="Configure_Kerberos"></a><h2> <span class="mw-headline"> Configure Kerberos </span></h2>
<p>Kerberos configuration is handled by the <tt>krb5.conf</tt> file. This file is typically located in the <tt>/etc/</tt> directory. Please refer to your distribution documentation for the location of this file on your system.  There is a sample file created during provisioning located at <tt>/usr/local/samba/share/setup/krb5.conf</tt>, that is a suitable replacement for an existing file. Its default content is:
</p>
<pre>[libdefaults]
        default_realm = ${REALM}
        dns_lookup_realm = false
        dns_lookup_kdc = true
</pre>
<ul><li> Note: If you have forgotten your realm, run <tt>samba-tool testparm --suppress-prompt | grep realm</tt>, to find it out.
</li></ul>
<p><br />
</p>
<a name="Testing_Kerberos" id="Testing_Kerberos"></a><h3> <span class="mw-headline"> Testing Kerberos </span></h3>
<p>The simplest test is to use the <tt>kinit</tt> command as follows:
</p>
<pre>$ kinit administrator@SAMDOM.EXAMPLE.COM
</pre>
<ul><li> Note: You must specify your domain realm in <b>uppercase letters</b>!
</li></ul>
<ul><li> Note: Depending on your distribution, <tt>kinit</tt> may just return you to a prompt, however, some distributions may return something like <tt>Warning: Your password will expire in x days on ...</tt>
</li></ul>
<p>To verify that Kerberos is working, and that you received a ticket, run:
</p>
<pre>$ klist
Ticket cache: FILE:/tmp/krb5cc_1000
Default principal: administrator@SAMDOM.EXAMPLE.COM
 
Valid starting     Expires            Service principal
02/10/13 19:39:48  02/11/13 19:39:46  krbtgt/SAMDOM.EXAMPLE.COM@SAMDOM.EXAMPLE.COM
</pre>
<p>If either <tt>kinit</tt> or <tt>klist</tt> do not exist on your system, refer to <a href="/index.php/Samba_4_OS_Requirements" title="Samba 4 OS Requirements" class="mw-redirect">Samba_4_OS_Requirements</a> on how to install the necessary packages.
</p><p>You can also test Kerberos form a remote client, but you must first configure the client's <tt>krb5.conf</tt> and <tt>resolve.conf</tt> as shown previously.
</p>
<ul><li> Note: If you are using a client behind NAT then you have to add the following to the <tt>krb5.conf</tt> on the domain controller:
</li></ul>
<pre>[kdc]
        check-ticket-addresses = false
</pre>
<ul><li> Note: If provision generated you a password and you forgot it or didn't get it saved in some way, you can use <tt>samba-tool user setpassword administrator</tt> as root to reset it.
</li></ul>
<p><br />
</p><p><br />
</p>
<a name="Configure_NTP_.28Optional.2C_but_highly_recommended.29" id="Configure_NTP_.28Optional.2C_but_highly_recommended.29"></a><h2> <span class="mw-headline"> Configure NTP (Optional, but highly recommended) </span></h2>
<p>Active Directory requires an accurate time synchronization between the clients and the DC(s). It's highly recommended to run NTP or another form of synchronization. The <a href="/index.php/Configure_NTP" title="Configure NTP">Configure NTP</a> page shows the full NTP configuration process including SELinux policies.
</p><p><br />
</p><p><br />
</p>
<a name="Optional_and_Further_Information" id="Optional_and_Further_Information"></a><h1> <span class="mw-headline"> Optional and Further Information </span></h1>
<p>The Samba Wiki provides you many useful further documentation on administrating your DC (<a href="/index.php/Backup_and_Recovery" title="Backup and Recovery">Backup and recovery</a>, <a href="/index.php/Setup_and_configure_file_shares" title="Setup and configure file shares">Setup and configure file shares</a>, etc.), daily work (<a href="/index.php/Configuring_a_windows_client_for_AD" title="Configuring a windows client for AD">Configuring a windows client for AD</a>, <a href="/index.php/Samba_AD_management_from_windows" title="Samba AD management from windows">Samba AD Management from windows</a>, etc.) or <a href="/index.php/Authenticating_other_services_against_AD" title="Authenticating other services against AD">Authenticating other services against AD</a>.
</p><p>See the <a href="/index.php/Samba" title="Samba">Samba Wiki user documentation</a> page for many further HowTos, tutorials and information.
</p><p><br />
</p><p><br />
</p>
<a name="Report_Your_Success.2FFailure.21" id="Report_Your_Success.2FFailure.21"></a><h1> <span class="mw-headline"> Report Your Success/Failure! </span></h1>
<p>Samba as a DC is still developing rapidly. We'd like to hear from users about their successes and failures. We would encourage you to report your successes and failures to the <a href="mailto:samba-technical@lists.samba.org" class="external text" title="mailto:samba-technical@lists.samba.org" rel="nofollow">samba-technical</a> mailing list on <a href="http://lists.samba.org" class="external free" title="http://lists.samba.org" rel="nofollow">http://lists.samba.org</a>
</p>
<!-- 
NewPP limit report
Preprocessor node count: 22/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key samba_wiki:pcache:idhash:1379-0!1!0!!en!2!edit=0 and timestamp 20130728234021 -->
<div class="printfooter">
Retrieved from "<a href="http://wiki.samba.org/index.php/Samba_AD_DC_HOWTO">http://wiki.samba.org/index.php/Samba_AD_DC_HOWTO</a>"</div>
						<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="/index.php/Samba_AD_DC_HOWTO" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk"><a href="/index.php/Talk:Samba_AD_DC_HOWTO" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="/index.php?title=Samba_AD_DC_HOWTO&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="/index.php?title=Samba_AD_DC_HOWTO&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/index.php?title=Special:UserLogin&amp;returnto=Samba_AD_DC_HOWTO" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in / create account</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(http://www.samba.org/samba/style/2010/samba_2010_logo_transparent_151x27.png);" href="/index.php/Main_Page" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="/index.php/Main_Page">Main page</a></li>
				<li id="n-User-documentation"><a href="/index.php/Samba">User documentation</a></li>
				<li id="n-Developer-documentation"><a href="/index.php/Developer_documentation">Developer documentation</a></li>
				<li id="n-portal"><a href="/index.php/SambaWiki:Community_Portal" title="About the project, what you can do, where to find things">Community portal</a></li>
				<li id="n-currentevents"><a href="/index.php/SambaWiki:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="/index.php/Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="/index.php/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="/index.php/Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search SambaWiki [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/index.php/Special:WhatLinksHere/Samba_AD_DC_HOWTO" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="/index.php/Special:RecentChangesLinked/Samba_AD_DC_HOWTO" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="/index.php/Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="/index.php?title=Samba_AD_DC_HOWTO&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="/index.php?title=Samba_AD_DC_HOWTO&amp;oldid=7881" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="http://wikistatic.samba.org/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://creativecommons.org/licenses/GPL/2.0/"><img src="http://wikistatic.samba.org/cc-GPL-a.png" alt='the CC-GNU GPL v2 or later' /></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 25 July 2013, at 23:26.</li>
					<li id="viewcount">This page has been accessed 957,595 times.</li>
					<li id="copyright">Content is available under <a href="/index.php/License" title="License">the CC-GNU GPL v2 or later</a>.</li>
					<li id="privacy"><a href="/index.php/SambaWiki:Privacy_policy" title="SambaWiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="/index.php/SambaWiki:About" title="SambaWiki:About">About SambaWiki</a></li>
					<li id="disclaimer"><a href="/index.php/SambaWiki:General_disclaimer" title="SambaWiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.076 secs. --></body></html>
