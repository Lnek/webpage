<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Framebuffer编程How-to - Mr.Right的专栏 - 博客频道 - CSDN.NET</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="http://xotianhu.bokee.com/2386074.html7.1. framebuffer设备介绍 这是一个关于如何编程的文档，因此，请在你编译或执行例子之前，正确配置你的framebuffer设备。用framebuffer设备，你可以把你的计算机屏幕当成一个真正的图形设备。你可以修改分辨率，刷新率，色彩深度等。最好的一点是，你可以把像素点绘在任何你想" />
<script src="http://static.blog.csdn.net/scripts/jquery.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/ad.js?v=1.1"></script>
<link rel="Stylesheet" type="text/css" href="http://static.blog.csdn.net/skin/dark1/css/style.css?v=1.1" />
<link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="/lanmanck/rss/list" />
<link rel="shortcut icon" href="/favicon.ico" />
<link type="text/css" rel="stylesheet" href="http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/default.css" />
</head>
<body>
<script src="http://csdnimg.cn/pubnav/js/pub_topnav_2011.js"type="text/javascript"></script>

<div id="container">
<div id="header">
    <div class="header">
        <div id="blog_title">
            <h1><a href="http://blog.csdn.net/lanmanck">Mr.Right的专栏</a></h1>
            <h2>山高人为峰，思想决定出路</h2>
            <div class="clear"></div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<div id="navigator">
    <div class="navigator_bg"></div>
    <div class="navigator">
        <ul>
            <li id="btnContents"><a href="http://blog.csdn.net/lanmanck?viewmode=contents"><span><img src="http://static.blog.csdn.net/images/ico_list.gif">目录视图</span></a></li>
            <li id="btnView"><a href="http://blog.csdn.net/lanmanck?viewmode=list"><span><img src="http://static.blog.csdn.net/images/ico_summary.gif">摘要视图</span></a></li>
            <li id="btnRss"><a href="http://blog.csdn.net/lanmanck/rss/list"><span><img src="http://static.blog.csdn.net/images/ico_rss.gif">订阅</span></a></li>
</ul>
    </div>
</div>
<script type="text/javascript">
    var username = "lanmanck";
    var _blogger = username;
    var blog_address = "http://blog.csdn.net/lanmanck";
    var static_host = "http://static.blog.csdn.net";
    var currentUserName = "";
</script>

<div id="body">
<div id="main">
<div class="main">
<div class="notice"> 

<a href="http://blog.csdn.net/blogdevteam/article/details/9819385" target="_blank">
<font color=red>《这些年，我们读过的技术经典图书》主题有奖征文</font></a>



&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<a href="http://www.csdn.net/article/2013-08-06/2816471" target="_blank"><font color=blue>专访李铁军：从医生到金山首席安全专家的转变 
</font></a>

&nbsp;&nbsp;&nbsp;&nbsp;



<a href="http://blog.csdn.net/adali/article/details/9813651"target="_blank">
<font color=blue>独一无二的职位：开源社区经理 
 </font></a>




</div>
<div id="article_details" class="details">
    <div class="article_title">
    <span class="ico ico_type_Repost"></span>
    <h3>
        <span class="link_title"><a href="/lanmanck/article/details/4423360">
        Framebuffer编程How-to
        </a></span>
    </h3>
</div>

        
    <div class="article_manage">
        <span class="link_categories">
        分类：
            <a href="/lanmanck/article/category/557096">linux内核移植/驱动</a> 
        </span>
    <span class="link_postdate">2009-08-07 17:35</span>
    <span class="link_view" title="阅读次数">1775人阅读</span>
    <span class="link_comments" title="评论次数"><a href="#comments">评论</a>(0)</span>
    <span class="link_collect"><a href="javascript:void(0);" onclick="javascript:collectArticle('Framebuffer编程How-to','4423360');return false;" title="收藏">收藏</a></span>
    <span class="link_report"><a href="#report"  onclick="javascript:report(4423360,2);return false;" title="举报">举报</a></span>
    
</div>
<div class="tag2box"><a href='http://blog.csdn.net/tag/details.html?tag=%e7%bc%96%e7%a8%8b' target=_blank>编程</a><a href='http://blog.csdn.net/tag/details.html?tag=struct' target=_blank>struct</a><a href='http://blog.csdn.net/tag/details.html?tag=buffer' target=_blank>buffer</a><a href='http://blog.csdn.net/tag/details.html?tag=colors' target=_blank>colors</a><a href='http://blog.csdn.net/tag/details.html?tag=signal' target=_blank>signal</a><a href='http://blog.csdn.net/tag/details.html?tag=%e5%9b%be%e5%bd%a2' target=_blank>图形</a></div>


    
<div id="article_content" class="article_content">

<h2 class="SECT2">http://xotianhu.bokee.com/2386074.html<br>
</h2>
<h2 class="SECT2"><a name="AEN269">7.1. <span style="color:black; background-color:#ffff66">
framebuffer</span>设备介绍 </a><br>
</h2>
<p>这是一个关于如何编程的文档，因此，请在你编译或执行例子之前，正确配置你的<span style="color:black; background-color:#ffff66">framebuffer</span>设备。
</p>
<p>用<span style="color:black; background-color:#ffff66">framebuffer</span>设备，你可以把你的计算机屏幕当成一个真正的图形设备。你可以修改分辨率，刷新率，色彩深度等。最好的一点是，你可以把像素点绘在任何你想要的地方。<span style="color:black; background-color:#ffff66">framebuffer</span>设备不是一个图形库，而更确切的是一个低级的通用设备。这样创造了巨大的灵活性，但同时也有它的缺点。想使用<span style="color:black; background-color:#ffff66">framebuffer</span>设备，你应该做以下事情：
</p>
<ul>
<li>断定出你使用的设备 </li><li>打开设备 </li><li>取回或改变屏幕设置 </li><li>映射（Map）屏幕内存 </li></ul>
<p>通常要打开的设备是/dev/fb0，但是如果用户有多个视频卡和监视器的话，设备也可能不同。大多数应用通过读取环境变量<span style="color:black; background-color:#ffff66">FRAMEBUFFER</span> (用getenv();)<br>
来决定该使用哪个设备。如果该环境变量不存在，那么就用/dev/fb0。 </p>
<p>通过open()调用打开设备，读设备意味着读取屏幕内存（可称之为显存）。用$cat /dev/fb0 &gt;screenshot将屏幕内存导入一个文件，恢复刚才的屏幕截图则可使用：$cat<br>
screenshot &gt;/dev/fb0。 </p>
<h2 class="SECT2"><a name="AEN287">7.2.?</a>设备的基本用法<br>
</h2>
<p>显然，用上述方法使用屏幕内存并不经济方便。在读或写之前持续的寻址（见<a href="http://www.scit.wlv.ac.uk/cgi-bin/mansec?2&#43;lseek">man<br>
lseek</a>）将会导致很多的开销。这就是为什么你要映射你的屏幕内存。当你将屏幕内存映射到你的应用程序时，你将得到一个直接指向屏幕内存的指针。 </p>
<p>在我们可以映射屏幕内存之前，我们需要知道我们能够映射多少，以及我们需要映射多少。第一件要做的事情就是从我们新得到的<span style="color:black; background-color:#ffff66">framebuffer</span>设备取回信息。有两个结构包含着我们需要的信息，第一个包含固定的屏幕信息，这部分是由硬件和驱动的能力决定的；第二个包含着可变的屏幕信息，这部分是由硬件的当前状态决定的，可以由用户空间的程序调用ioctl()来改变。
</p>
<p><span style="color:#0000ff">struct</span> fb_fix_screeninfo {<br>
<span style="color:#0000ff">char</span> id[16]; ??????????????????????? <span style="color:#008200">
/*<br>
identification string eg </span><span style="color:#848284">&quot;TT Builtin&quot;</span> */<br>
<br>
unsigned <span style="color:#0000ff">long</span> smem_start; <span style="color:#008200">
/*<br>
Start of frame buffer mem */</span><br>
<br>
<span style="color:#008200">/* (physical address) */</span><br>
<br>
__u32 smem_len; <span style="color:#008200">/* Length of frame buffer mem */</span><br>
<br>
__u32 type; <span style="color:#008200">/* see FB_TYPE_* */</span><br>
<br>
__u32 type_aux; <span style="color:#008200">/* Interleave for interleaved Planes<br>
*/</span><br>
<br>
__u32 visual; <span style="color:#008200">/* see FB_VISUAL_* */</span><br>
<br>
__u16 xpanstep; <span style="color:#008200">/* zero if no hardware panning?<br>
*/</span><br>
<br>
__u16 ypanstep; <span style="color:#008200">/* zero if no hardware panning?<br>
*/</span><br>
<br>
__u16 ywrapstep; <span style="color:#008200">/* zero if no hardware ywrap???<br>
*/</span><br>
<br>
__u32 line_length; <span style="color:#008200">/* length of a line in bytes???<br>
*/</span><br>
<br>
unsigned <span style="color:#0000ff">long</span> mmio_start; <span style="color:#008200">
/*<br>
Start of Memory Mapped I/O?? */</span><br>
<br>
<span style="color:#008200">/* (physical address) */</span><br>
<br>
__u32 mmio_len; <span style="color:#008200">/* Length of Memory Mapped I/O?<br>
*/</span><br>
<br>
__u32 accel; <span style="color:#008200">/* Type of acceleration available */</span><br>
<br>
__u16 reserved[3]; <span style="color:#008200">/* Reserved for future compatibility<br>
*/</span><br>
<br>
}; </p>
<p>在这里非常重要的域是smem_len和line-length。smem-len告诉我们<span style="color:black; background-color:#ffff66">framebuffer</span>设备的大小，第二个域告诉我们指针应该前进多少字节去得到下一行的数据。第二个结构则要有意思的多，它给了我们可以改变的信息。
</p>
<p><span style="color:#008200">/* more kernel header files copied shamelessly */</span>
</p>
<p><span style="color:#0000ff">struct</span> fb_bitfield {<br>
__u32 offset; <span style="color:#008200">/* beginning of bitfield */</span><br>
<br>
__u32 length; <span style="color:#008200">/* length of bitfield */</span><br>
<br>
__u32 msb_right; <span>/* != 0 : Most significant bit is */</span><br>
<br>
<span style="color:#008200">/* right */</span><br>
<br>
};</p>
<p><span style="color:#0000ff">struct</span> fb_var_screeninfo {<br>
__u32 <a name="2"></a><span style="color:black; background-color:#99ff99">xres</span>;
<span style="color:#008200">/* visible resolution */</span><br>
<br>
__u32 yres;<br>
__u32 <span style="color:black; background-color:#99ff99">xres</span>_virtual; <span style="color:#008200">
/* virtual resolution */</span><br>
<br>
__u32 yres_virtual;<br>
__u32 xoffset; <span style="color:#008200">/* offset from virtual to visible */</span><br>
<br>
__u32 yoffset; <span style="color:#008200">/* resolution */</span> </p>
<p>__u32 bits_per_pixel; <span style="color:#008200">/* guess what */</span><br>
<br>
__u32 grayscale; <span style="color:#008200">/* != 0 Graylevels instead of colors<br>
*/</span> </p>
<p><span style="color:#0000ff">struct</span> fb_bitfield red; <span style="color:#008200">
/*<br>
bitfield in fb mem if true color, */</span><br>
<br>
<span style="color:#0000ff">struct</span> fb_bitfield green; <span style="color:#008200">
/*<br>
else only length is significant */</span><br>
<br>
<span style="color:#0000ff">struct</span> fb_bitfield blue;<br>
<span style="color:#0000ff">struct</span> fb_bitfield transp; <span style="color:#008200">
/*<br>
transparency */</span> </p>
<p>__u32 nonstd; <span style="color:#008200">/* != 0 Non standard pixel format */</span>
</p>
<p>__u32 activate; <span style="color:#008200">/* see FB_ACTIVATE_* */</span> </p>
<p>__u32 height; <span style="color:#008200">/* height of picture in mm???<br>
*/</span><br>
<br>
__u32 width; <span style="color:#008200">/* width of picture in mm????<br>
*/</span> </p>
<p>__u32 accel_flags; <span style="color:#008200">/* acceleration flags (hints) */</span>
</p>
<p><span style="color:#008200">/* Timing: All values in pixclocks, except pixclock (of<br>
course) */</span><br>
<br>
__u32 pixclock; <span style="color:#008200">/* pixel clock in ps (pico seconds) */</span><br>
<br>
__u32 left_margin; <span style="color:#008200">/* time from sync to picture */</span><br>
<br>
__u32 right_margin; <span style="color:#008200">/* time from picture to sync */</span><br>
<br>
__u32 upper_margin; <span style="color:#008200">/* time from sync to picture */</span><br>
<br>
__u32 lower_margin;<br>
__u32 hsync_len; <span style="color:#008200">/* length of horizontal sync */</span><br>
<br>
__u32 vsync_len; <span style="color:#008200">/* length of vertical sync */</span><br>
<br>
__u32 sync; <span style="color:#008200">/* see FB_SYNC_* */</span><br>
<br>
__u32 vmode; <span style="color:#008200">/* see FB_VMODE_* */</span><br>
<br>
__u32 reserved[6]; <span style="color:#008200">/* Reserved for future compatibility<br>
*/</span><br>
<br>
}; </p>
<p>前几个成员决定了分辨率。<span style="color:black; background-color:#99ff99">xres</span>和yres是在屏幕上可见的实际分辨率，在通常的vga模式将为640和400（也许是480，byhighbar）。*res-virtual决定了构建屏幕时视频卡读取屏幕内存的方式。当实际的垂直分辨率为400，虚拟分辨率可以是800。这意味着800行的数据被保存在了屏幕内存区中。因为只有400行可以被显示，决定从那一行开始显示就是你的事了。这个可以通过设置*offset来实现。给yoffset赋0将显示前400行，赋35将显示第36行到第435行，如此重复。这个功能在许多情形下非常方便实用。它可以用来做双缓冲。双缓冲就是你的程序分配了可以填充两个屏幕的内存。将offset设为0，将显示前400行（假设是标准的vga），同时可以秘密的在400行到799行构建另一个屏幕，当构建结束时，将yoffset设为400，新的屏幕将立刻显示出来。现在将开始在第一块内存区中构建下一个屏幕的数据，如此继续。这在动画中十分有用。
</p>
<p>另外一个应用就是用来平滑的滚动整个屏幕。就像在前面屏幕中一样，在内存分配800行的空间。每隔10毫秒设定一个定时器（timer，见man settimer和man<br>
signal / man sigaction），将offset设为1或是比上次更多，瞧，你看到了一个平滑滚动的屏幕。确保你的信号（signal）不要因为最佳输出的原因被信号处理程序阻塞。
</p>
<p>将<br>
bits_per_pixel设为1，2，4，8，16，24或32来改变颜色深度（colordepth）。不是所有的视频卡和驱动都支持全部颜色深度。当颜色深度改变，驱动将自动改变fb-bitfields。这些指出，在一个特定的颜色基准上，多少和哪些比特被哪种颜色使用。如果bits-per-pixel小于8，则fb-bitfields将无定义而且颜色映射将启用。
</p>
<p>在fb-var-screeninfo结构结尾的定时的设置是当你选择一个新的分辨率的时候用来设定视频定时的。（<br>
EXAMINE AND EXPLAIN TIMINGS! ） </p>
<p>现在我们知道了结构的细节了，但还不清楚如何去获得或设置它们。这里有一些ioctl的命令可以参考。 </p>
<div class="syntax_hilite"><strong>C:</strong><br>
<div id="c-1">
<div>
<ol>
<li></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#339933">#include
</span></span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#993333">int</span> main
<span style="color:#66cc66">(</span><span style="color:#66cc66">)</span> <span style="color:#66cc66">
{</span> </span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#993333">int</span>
<span style="color:black; background-color:#ffff66">framebuffer</span>_handler;</span>
</li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#993333">struct</span> fb_fix_screeninfo fixed_info;</span>
</li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#993333">struct</span> fb_var_screeninfo variable_info;</span>
</li><li></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">open
<span style="color:#66cc66">(</span><span style="color:#ff0000">&quot;/dev/fb0&quot;</span>, O_RDWR<span style="color:#66cc66">)</span>;
<span style="color:#808080"><em>/*in real life, check every ioctl if it returns -1 */</em></span></span>
</li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">ioctl
<span style="color:#66cc66">(</span><span style="color:black; background-color:#ffff66">framebuffer</span>_handler,FBIOGET_VSCREENINFO, &amp;variable_info<span style="color:#66cc66">)</span>; variable_info.bits_per_pixel =
<span style="color:#800000">32</span>; </span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">ioctl<span style="color:#66cc66">(</span><span style="color:black; background-color:#ffff66">framebuffer</span>_handler,
 FBIOPUT_VSCREENINFO, &amp;variable_info<span style="color:#66cc66">)</span>; </span>
</li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">ioctl
<span style="color:#66cc66">(</span><span style="color:black; background-color:#ffff66">framebuffer</span>_handler,FBIOGET_FSCREENINFO, &amp;fixed_info<span style="color:#66cc66">)</span>;
</span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">variable_info.yoffset =
<span style="color:#800000">513</span>; </span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">ioctl
<span style="color:#66cc66">(</span><span style="color:black; background-color:#ffff66">framebuffer</span>_handler,FBIOPAN_DISPLAY, &amp;variable_info<span style="color:#66cc66">)</span>;
</span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospac"><span style="color:#66cc66">}</span>
</span></li></ol>
</div>
</div>
</div>
<p>这些 FBIOGET_*?的ioctl命令将请求的信息写入最后一个变量所指向的结构体中。FBIOPUT_VSCREENINFO将所有提供的信息复制回内核。如果内核不能激活新的设置，将返回-1。而<br>
FBIOPAN_DISPLAY 也从用户复制信息，但并不重新初始化视频模式。最好在只有xoffset或yoffset改变时使用。 </p>
<h2 class="SECT2"><a name="AEN299">7.3. 显示内存管理</a><br>
</h2>
<p class="SECT2">去访问内存本身，它可以被映射，然后直接访问。但这些需要一些步骤： </p>
<ul>
<li>
<div class="SECT2">计算出需要映射多少 </div>
</li><li>
<div class="SECT2">映射内存 </div>
</li><li>
<div class="SECT2">决定如何构建屏幕 </div>
</li><li>
<div class="SECT2">向屏幕中写入数据 </div>
</li></ul>
<p class="SECT2">这里有一个样例：<span style="color:#6699cc"><span style="color:#000000">
</span></span></p>
<div class="syntax_hilite"><strong>C:</strong><br>
<div id="c-2">
<div>
<ol>
<li></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#339933">#include
</span></span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#339933">#include
</span></span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#339933">#include
</span></span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#339933">#include
</span></span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#339933">#include
</span></span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#339933">#include
</span></span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#339933">#include
</span></span></li><li></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#993333">int</span> main<span style="color:#66cc66">(</span><span style="color:#66cc66">)</span>
<span style="color:#66cc66">{</span> </span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#993333">int</span>
<span style="color:black; background-color:#ffff66">framebuffer</span>_device; </span>
</li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#993333">int</span> line_size,buffer_size, *i;
</span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#993333">int</span> *screen_memory;
</span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#993333">struct</span> fb_var_screeninfo var_info;
</span></li><li></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:black; background-color:#ffff66">framebuffer</span>_device = open
<span style="color:#66cc66">(</span> <span style="color:#ff0000">&quot;/dev/fb0&quot;</span> , O_RDWR<span style="color:#66cc66">)</span>;
</span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">ioctl
<span style="color:#66cc66">(</span><span style="color:black; background-color:#ffff66">framebuffer</span>_device, FBIOGET_VSCREENINFO, &amp;var_info<span style="color:#66cc66">)</span>;
</span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">line_size = var_info.<span style="color:black; background-color:#99ff99">xres</span> * var_info.bits_per_pixel /
<span style="color:#800000">8</span>; </span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">buffer_size = line_size * var_info.yres;</span>
</li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">var_info.xoffset =
<span style="color:#800000">0</span>; </span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">var_info.yoffset =
<span style="color:#800000">0</span>; </span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">ioctl
<span style="color:#66cc66">(</span><span style="color:black; background-color:#ffff66">framebuffer</span>_device, FBIOPAN_DISPLAY,&amp;var_info<span style="color:#66cc66">)</span> == -<span style="color:#800000">1</span><span style="color:#66cc66">)</span>;
</span></li><li></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">screen_memory =
<span style="color:#66cc66">(</span><span style="color:#993333">char</span> *<span style="color:#66cc66">)</span> mmap
<span style="color:#66cc66">(</span><span style="color:#800000">513</span>, buffer_size, PROT_READ | PROT_WRITE, MAP_SHARED,
<span style="color:black; background-color:#ffff66">framebuffer</span>_device, <span style="color:#800000">
0</span><span style="color:#66cc66">)</span>; </span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#b1b100">for</span>
<span style="color:#66cc66">(</span>i=<span style="color:#800000">0</span>;i &lt; buffer_size ; i&#43;&#43;
<span style="color:#66cc66">)</span> </span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#66cc66">{</span>
</span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">*<span style="color:#66cc66">(</span>screen_memory&#43;i<span style="color:#66cc66">)</span> = i%<span style="color:#800000">236</span>;
</span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#66cc66">}</span>
</span></li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace">sleep<span style="color:#66cc66">(</span><span style="color:#800000">2</span><span style="color:#66cc66">)</span>;
</span></li><li style="font-weight:bold; color:#770000"><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#b1b100">return</span>
<span style="color:#800000">0</span>;</span> </li><li><span style="font-weight:normal; color:#000000; font-family:'Courier New',Courier,monospace"><span style="color:#66cc66">}</span></span>
</li><li style="font-weight:bold; color:#770000"></li></ol>
</div>
</div>
</div>
<p>你可以看到我们采用了从上一部分提到的信息取回，在这一部分新用到的是mmap函数。第一个变量在这种情形下可以忽略，第二个是映射的内存大小，第三个变量声明我们将共享内存进行读和写。第四个变量表示这段内存将和其他进程共享。在<span style="color:black; background-color:#ffff66">framebuffer</span>上面建一个MAP_PRIVATE是不可能的。 通常这意味着你需要中断控制台的切换去备份和恢复屏幕内容，而且不在自己没有权利的时候向屏幕内存写东西。
</p>
<p class="SECT2">关于mmap的更多信息请见man <a href="http://www.scit.wlv.ac.uk/cgi-bin/mansec?2&#43;mmap">
mmap</a>. </p>
<pre style="color:#000000">highbar,2005-05-01,2:14</pre>

</div>

<div class="share_buttons" id="sharePanel"></div>
<!--192.168.100.33-->
<div class="article_next_prev">
    <li class="prev_article"><span>上一篇：</span><a href="/lanmanck/article/details/4403632">【原】移植madplay到arm linux</a></li>
    <li class="next_article"><span>下一篇：</span><a href="/lanmanck/article/details/4423383">linux framebuffer 例子</a></li>
</div>


    
</div>
<div id="ad_cen">
<script type="text/javascript" >BAIDU_CLB_SLOT_ID = "117306";</script>
<script type="text/javascript" src="http://cbjs.baidu.com/js/o.js"></script>
</div>
<script type="text/javascript">
    //new Ad(4, 'ad_cen');
</script>
<div id="comment_title" class="panel_head">查看评论<a name="comments"></a></div>
<div id="comment_list"></div>
<div id="comment_bar"></div>
<div id="comment_form"></div>
<div class="announce">* 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a name="reply"></a><a name="quote"></a></div>
<script type="text/javascript">
    var fileName = '4423360';
    var commentscount = 0;
    var islock = false
</script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/comment.js"></script>
<div id="ad_bot"></div>
<script type="text/javascript">
    new Ad(5, 'ad_bot');
</script>
<div id="report_dialog"></div>

<div id="d-top" style="display:none;">
<a id="d-top-a" href="#" title="回到顶部">
<img src="http://static.blog.csdn.net/images/top.png" alt="TOP" /></a>
</div>
<script type="text/javascript">
    $(function(){
        var d_top=$('#d-top');
        document.onscroll=function(){
            var scrTop=(document.body.scrollTop||document.documentElement.scrollTop);
            if(scrTop>500){
                d_top.show();
            }else{
                d_top.hide();
            }
        }
        $('#d-top-a').click(function(){
            scrollTo(0,0);
            this.blur();
            return false;
        });
    });
</script>

<div class="clear"></div>
</div>
</div>

<div id="side">
<div class="side">
<div id="panel_Profile" class="panel">
<ul class="panel_head"><span>个人资料</span></ul>
<ul class="panel_body profile">
<div id="blog_userface">
    <a href="http://my.csdn.net/lanmanck" target="_blank">
    <img src="http://avatar.csdn.net/F/6/7/1_lanmanck.jpg" title="访问我的空间" style="max-width:90%"/>
    </a>
    <br />
    <span><a href="http://my.csdn.net/lanmanck" class="user_name" target="_blank">lanmanck</a></span>
</div>
<div class="interact">
<a href="javascript:void(0);" class="attent" id="span_add_follow" title="[加关注]"></a>
<a href="javascript:void(0);" class="letter" onclick="loginto(1)" title="[发私信]"></a>
</div>
<div id="blog_medal">
</div>
<ul id="blog_rank">
    <li>访问：<span>645584次</span></li>
    <li>积分：<span>9189分</span></li>
    <li>排名：<span>第341名</span></li>
</ul>
<ul id="blog_statistics">
    <li>原创：<span>209篇</span></li>
    <li>转载：<span>210篇</span></li>
    <li>译文：<span>0篇</span></li>
    <li>评论：<span>379条</span></li>
</ul>
</ul>
</div>

<div class="panel">
<ul class="panel_body" style="padding:0;">
<script type="text/javascript" src="http://cbjs.baidu.com/js/m.js"></script> 
<script type="text/javascript"> 
BAIDU_CLB_preloadSlots("724643","117306"); 
</script>
<script type="text/javascript">BAIDU_CLB_fillSlot("724643");</script> 
</ul>
</div>
<div class="panel" id="panel_Search">
    <ul class="panel_head"><span>文章搜索</span></ul>
    <ul class="panel_body">
        <form id="frmSearch" action="http://so.csdn.net/search" class="form_search" target="_blank">
        <span><input id="inputSearch" type="text" class="blogsearch" title="请输入关键字" /></span>
        <input id="btnSubmit" type="submit" value="搜索" title="search in blog" />
        <input type="hidden" name="q" id="inputQ" />
        <input type="hidden" name="t" value="blog" />
        <a id="btnSearchBlog" target="_blank"></a>
        </form>
    </ul>
</div><div id="panel_Category" class="panel">
<ul class="panel_head"><span>文章分类</span></ul>
<ul class="panel_body">
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/557096">linux内核移植/驱动</a><span>(66)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/567836">linux文件系统</a><span>(15)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/653213">PowerPC</a><span>(5)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/653214">iOS相关</a><span>(4)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/560042">QT相关</a><span>(45)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/710544">SOC/Davinci相关</a><span>(6)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/545948">UCOS2</a><span>(6)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/504782">VC++/MFC</a><span>(50)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/504784">八卦</a><span>(28)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/504783">嵌入式/Linux/C语言</a><span>(123)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/660085">嵌入式网络</a><span>(14)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/693564">硬件设计</a><span>(20)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/1150343">Android</a><span>(1)</span>
</li>
<li>
<a href="http://blog.csdn.net/lanmanck/article/category/1292997">STM32</a><span>(11)</span>
</li>
</ul>
</div><div id="panel_Archive" class="panel">
<ul class="panel_head"><span>文章存档</span></ul>
<ul class="panel_body">
<div id="archive_list">
<!--归档统计-->
<li><a href="http://blog.csdn.net/lanmanck/article/month/2013/08">2013年08月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2013/07">2013年07月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2013/06">2013年06月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2013/05">2013年05月</a><span>(15)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2013/04">2013年04月</a><span>(6)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2013/03">2013年03月</a><span>(6)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2013/02">2013年02月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2013/01">2013年01月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/12">2012年12月</a><span>(6)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/11">2012年11月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/10">2012年10月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/09">2012年09月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/08">2012年08月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/07">2012年07月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/06">2012年06月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/05">2012年05月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/04">2012年04月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/02">2012年02月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2012/01">2012年01月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/11">2011年11月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/10">2011年10月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/08">2011年08月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/07">2011年07月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/06">2011年06月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/05">2011年05月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/04">2011年04月</a><span>(6)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/03">2011年03月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/02">2011年02月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2011/01">2011年01月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/12">2010年12月</a><span>(8)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/11">2010年11月</a><span>(17)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/10">2010年10月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/09">2010年09月</a><span>(8)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/08">2010年08月</a><span>(17)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/07">2010年07月</a><span>(17)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/06">2010年06月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/05">2010年05月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/04">2010年04月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/03">2010年03月</a><span>(17)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/02">2010年02月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2010/01">2010年01月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/12">2009年12月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/11">2009年11月</a><span>(8)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/10">2009年10月</a><span>(15)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/09">2009年09月</a><span>(23)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/08">2009年08月</a><span>(21)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/07">2009年07月</a><span>(33)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/06">2009年06月</a><span>(30)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/05">2009年05月</a><span>(21)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/04">2009年04月</a><span>(10)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/03">2009年03月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/02">2009年02月</a><span>(15)</span></li><li><a href="http://blog.csdn.net/lanmanck/article/month/2009/01">2009年01月</a><span>(10)</span></li>
</div>
</ul>
</div>
<div id="hotarticls" class="panel">
<ul class="panel_head"><span>阅读排行</span></ul>
<ul class="panel_body itemlist">
<li>
<a href="/lanmanck/article/details/5738337" title="cygwin make:command not found，make命令 找不到">cygwin make:command not found，make命令 找不到</a><span>(13883)</span>
</li>
<li>
<a href="/lanmanck/article/details/5776173" title="gcc 优化选项 -O1 -O2 -O3 -Os 优先级，-fomit-frame-pointer">gcc 优化选项 -O1 -O2 -O3 -Os 优先级，-fomit-frame-pointer</a><span>(11568)</span>
</li>
<li>
<a href="/lanmanck/article/details/4568911" title="linux信号机制之sigaction结构体浅析,signal 函数,信号捕捉">linux信号机制之sigaction结构体浅析,signal 函数,信号捕捉</a><span>(10354)</span>
</li>
<li>
<a href="/lanmanck/article/details/4713978" title="misc_register、 register_chrdev 的区别总结">misc_register、 register_chrdev 的区别总结</a><span>(8587)</span>
</li>
<li>
<a href="/lanmanck/article/details/4580113" title="qt4使用QSettings来保存设置、读取设置">qt4使用QSettings来保存设置、读取设置</a><span>(7755)</span>
</li>
<li>
<a href="/lanmanck/article/details/4455692" title="Linux Platform Device and Driver,platform_add_devices()-&gt;platform_driver_register()">Linux Platform Device and Driver,platform_add_devices()-&gt;platform_driver_register()</a><span>(7577)</span>
</li>
<li>
<a href="/lanmanck/article/details/4230904" title="Nand 的几个名词：oob，bbt，ecc">Nand 的几个名词：oob，bbt，ecc</a><span>(7375)</span>
</li>
<li>
<a href="/lanmanck/article/details/4584051" title="EZ-USB FX2 LP CY7C68013A 开发指南(1)--基本概念">EZ-USB FX2 LP CY7C68013A 开发指南(1)--基本概念</a><span>(6893)</span>
</li>
<li>
<a href="/lanmanck/article/details/4707102" title="关于ioremap，request_mem_region">关于ioremap，request_mem_region</a><span>(6674)</span>
</li>
<li>
<a href="/lanmanck/article/details/4509147" title="QTableview 用法">QTableview 用法</a><span>(6488)</span>
</li>
</ul>
</div>
<div id="hotarticls2" class="panel">
<ul class="panel_head"><span>评论排行</span></ul>
<ul class="panel_body itemlist">
<li>
<a href="/lanmanck/article/details/4713978" title="misc_register、 register_chrdev 的区别总结">misc_register、 register_chrdev 的区别总结</a><span>(14)</span>
</li>
<li>
<a href="/lanmanck/article/details/6407063" title="RTL8201CP问题">RTL8201CP问题</a><span>(14)</span>
</li>
<li>
<a href="/lanmanck/article/details/7836734" title="I2C设备驱动编写,struct i2c_device_id,struct i2c_driver,i2c_add_driver,i2c_register_board_info">I2C设备驱动编写,struct i2c_device_id,struct i2c_driver,i2c_add_driver,i2c_register_board_info</a><span>(13)</span>
</li>
<li>
<a href="/lanmanck/article/details/4509147" title="QTableview 用法">QTableview 用法</a><span>(13)</span>
</li>
<li>
<a href="/lanmanck/article/details/3857896" title="原创vc： 对话框嵌入到对话框 或者：窗口嵌入到窗口，一个窗口嵌入到另一个窗口">原创vc： 对话框嵌入到对话框 或者：窗口嵌入到窗口，一个窗口嵌入到另一个窗口</a><span>(11)</span>
</li>
<li>
<a href="/lanmanck/article/details/4707102" title="关于ioremap，request_mem_region">关于ioremap，request_mem_region</a><span>(11)</span>
</li>
<li>
<a href="/lanmanck/article/details/4580113" title="qt4使用QSettings来保存设置、读取设置">qt4使用QSettings来保存设置、读取设置</a><span>(10)</span>
</li>
<li>
<a href="/lanmanck/article/details/4292340" title="嵌入式Linux之Kernel（裁减移植）启动调试、打印技术 printascii(补充)、内核调试">嵌入式Linux之Kernel（裁减移植）启动调试、打印技术 printascii(补充)、内核调试</a><span>(7)</span>
</li>
<li>
<a href="/lanmanck/article/details/4822698" title="EZ-USB FX2 LP CY7C68013A 开发指南(4)--基于Linux的驱动编写">EZ-USB FX2 LP CY7C68013A 开发指南(4)--基于Linux的驱动编写</a><span>(7)</span>
</li>
<li>
<a href="/lanmanck/article/details/4770103" title="linux内核的 等待队列 使用方法，wait_queue_head_t，进程休眠">linux内核的 等待队列 使用方法，wait_queue_head_t，进程休眠</a><span>(7)</span>
</li>
</ul>
</div>
<div id="homepageArticles" class="panel">
<ul class="panel_head"><span>推荐文章</span></ul>
<ul class="panel_body" id="ad_commend"></ul>
</div>
<script type="text/javascript">
 new Ad(12, 'ad_commend');
</script><div id="newcomments" class="panel">
<ul class="panel_head"><span>最新评论</span></ul>
<ul class="panel_body itemlist">
    <li>
    <a href="/lanmanck/article/details/5738337#comments">cygwin make:command not found，make命令 找不到</a>
    <p style="margin:0px;"><a href="/class2000" class="user_name">class2000</a>:
在cygwin安装过程时，在左上角的输入框中输入make，全部都选择上，最好看看每个的介绍，ok
    </p>
    </li>
    <li>
    <a href="/lanmanck/article/details/7836734#comments">I2C设备驱动编写,struct i2c_device_id,struct i2c_driver,i2c_add_driver,i2c_register_board_info</a>
    <p style="margin:0px;"><a href="/ayaxiaoxin" class="user_name">ayaxiaoxin</a>:
@lanmanck:学习中，  谢谢~
    </p>
    </li>
    <li>
    <a href="/lanmanck/article/details/3901590#comments">vc 获取程序版本号，当前程序路径，文件修改时间 等</a>
    <p style="margin:0px;"><a href="/ShellExecute" class="user_name">ShellExecute</a>:
(VerQueryValue(pBuf,   &quot;//&quot;,(void   **)&amp;pVsInfo,&amp;i...
    </p>
    </li>
    <li>
    <a href="/lanmanck/article/details/7836734#comments">I2C设备驱动编写,struct i2c_device_id,struct i2c_driver,i2c_add_driver,i2c_register_board_info</a>
    <p style="margin:0px;"><a href="/lanmanck" class="user_name">lanmanck</a>:
@RuifDu:因为这个name不是platform_driver的name。
    </p>
    </li>
    <li>
    <a href="/lanmanck/article/details/7836734#comments">I2C设备驱动编写,struct i2c_device_id,struct i2c_driver,i2c_add_driver,i2c_register_board_info</a>
    <p style="margin:0px;"><a href="/lanmanck" class="user_name">lanmanck</a>:
@ayaxiaoxin:用source insight搜索整个内核，你就可以看到别人是怎么调用的，依...
    </p>
    </li>
    <li>
    <a href="/lanmanck/article/details/7836734#comments">I2C设备驱动编写,struct i2c_device_id,struct i2c_driver,i2c_add_driver,i2c_register_board_info</a>
    <p style="margin:0px;"><a href="/RuifDu" class="user_name">RuifDu</a>:
请问博主，用id_table匹配设备的话那么driver下的name还有什么作用呢？不应该是name...
    </p>
    </li>
    <li>
    <a href="/lanmanck/article/details/4713978#comments">misc_register、 register_chrdev 的区别总结</a>
    <p style="margin:0px;"><a href="/RuifDu" class="user_name">RuifDu</a>:
在android的驱动编写中使用 class_create和device_create创建的设备文件...
    </p>
    </li>
    <li>
    <a href="/lanmanck/article/details/9719863#comments">ARM GCC CodeSourcery 下载地址</a>
    <p style="margin:0px;"><a href="/lanmanck" class="user_name">lanmanck</a>:
@paully520:???
    </p>
    </li>
    <li>
    <a href="/lanmanck/article/details/9719863#comments">ARM GCC CodeSourcery 下载地址</a>
    <p style="margin:0px;"><a href="/paully520" class="user_name">paully520</a>:
???????????
    </p>
    </li>
    <li>
    <a href="/lanmanck/article/details/7836734#comments">I2C设备驱动编写,struct i2c_device_id,struct i2c_driver,i2c_add_driver,i2c_register_board_info</a>
    <p style="margin:0px;"><a href="/ayaxiaoxin" class="user_name">ayaxiaoxin</a>:
@lanmanck:另外请问博主，“其中任意一个文件加上该结构体即可”，电路板的文件夹下有很多个.c...
    </p>
    </li>
</ul>
</div>
</div>
<div class="clear"></div>
</div>

<div class="clear"></div>
</div>

<script type="text/javascript" src="http://static.blog.csdn.net/scripts/newblog.min.js?v=1.1"></script>
<script type="text/javascript" src="http://medal.blog.csdn.net/showblogmedal.ashx?blogid=181100"></script>

<script type="text/javascript">
document.write('<script type="text/javascript" src="http://csdnimg.cn/pubfooter/js/publib_footer.js?' + Math.floor(new Date()/120000).toString(36) + '="></'+'script>');
</script>

<script type="text/javascript" src="http://passport.csdn.net/content/loginbox/login.js"></script>
<script type="text/javascript">document.write("<img src=http://counter.csdn.net/pv.aspx?id=24 border=0 width=0 height=0>");</script>
<script type="text/javascript" src="http://www.csdn.net/ui/scripts/Csdn/counter.js?v=1"></script>


<script type="text/javascript" src="http://ad.csdn.net/scripts/ad-blog.js"></script>

<script type="text/javascript" src="http://zz.csdn.net/js/count.js"></script>

</div>
</body>
</html>