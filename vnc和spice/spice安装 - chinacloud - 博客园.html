<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>spice安装 - chinacloud - 博客园</title>
<link type="text/css" rel="stylesheet" href="http://common.cnblogs.com/blog/css/common.css?id=20130704"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="http://common.cnblogs.com/Skins/ChinaHeart/style.css?id=20130704"/>
<link type="text/css" rel="stylesheet" href="http://common.cnblogs.com/blog/css/common2.css"/>
<link type="text/css" rel="stylesheet" href="http://common.cnblogs.com/css/shStyle.css"/>
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/chinacloud/rss"/>
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/chinacloud/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/chinacloud/wlwmanifest.xml"/>
<script src="http://common.cnblogs.com/script/jquery.js" type="text/javascript"></script>  
<script type="text/javascript">
var currentBlogApp = 'chinacloud';
</script>
<script src="http://common.cnblogs.com/blog/script/common.js?id=20130704" type="text/javascript"></script> 
<script src="http://common.cnblogs.com/script/json2.js" type="text/javascript"></script>
<script type="text/javascript" src="http://common.cnblogs.com/script/syntaxHighlighter.js"></script>
</head>
<body>
<a name="top"></a>

<!--done-->
<div id="home">
<div id="header">
	<div id="blogTitle">
	<a id="lnkBlogLogo" href="http://www.cnblogs.com/chinacloud/"></a>			
		
<!--done-->
<h1><a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/chinacloud/">chinacloud</a></h1>
<h2>每天进步一点……</h2>



		
	</div><!--end: blogTitle 博客的标题和副标题 -->
	<div id="navigator">
		
<!--done-->
			<ul id="navList">
				<li><a id="MyLinks1_HomeLink" class="menu" href="http://www.cnblogs.com/">博客园</a></li>
				<li><a id="MyLinks1_SpaceLink" class="menu" href="http://home.cnblogs.com/">园子</a></li>
				<li><a id="MyLinks1_MyHomeLink" class="menu" href="http://www.cnblogs.com/chinacloud/">首页</a></li>
				<li><a id="MyLinks1_NewPostLink" class="menu" rel="nofollow" href="http://www.cnblogs.com/chinacloud/admin/EditPosts.aspx?opt=1">新随笔</a></li>
				<li><a id="MyLinks1_ContactLink" accesskey="9" class="menu" rel="nofollow" href="http://space.cnblogs.com/msg/send/chinacloud">联系</a></li>
				<li><a id="MyLinks1_Admin" class="menu" rel="nofollow" href="http://www.cnblogs.com/chinacloud/admin/EditPosts.aspx">管理</a></li>
				<li><a id="MyLinks1_Syndication" class="menu" href="http://www.cnblogs.com/chinacloud/rss">订阅</a>
				<a id="MyLinks1_XMLLink" class="aHeaderXML" href="http://www.cnblogs.com/chinacloud/rss"><img src="http://www.cnblogs.com/images/xml.gif" alt="订阅" /></a></li>
			</ul>


		<div class="clear"></div>
		<div class="blogStats">
			
			
<!--done-->
随笔- 234&nbsp;
文章- 0&nbsp;
评论- 62&nbsp;
			
						
		</div><!--end: blogStats -->
	</div><!--end: navigator 博客导航栏 -->
</div><!--end: header 头部 -->

<div id="main">
	<div id="topicList">
	<div class="forFlow">
		
	
<!--done-->
<div id="topics">
	<div class = "post">
		<h1 class = "postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/chinacloud/archive/2011/02/23/1962317.html">spice安装</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body"><p>到http://spice-space.org/yum_repo_data/f12/x86_64/上下载依赖包和安装包，安装即可。</p>
<p>或者yum install spice-protocol spice-client spice-server，依赖包也会同时安装。</p>
<p>然后启动虚拟机，我用的是qemu-kvm命令：/usr/bin/qemu-kvm -hda /software/winxp_new.img -m 1024 -vga qxl -spice port=5924,disable-ticketing</p>
<p>然后在客户端就可以远程登录了：spicec -h ip_address -p port</p>
<p>windows的优化可以看这个网址：http://www.linux-kvm.net/content/rhev-spice-guest-drivers-released-windows</p>
<p>试了一下，没感觉出效果来。</p>
<p>在f14上用源码编译还有问题，下一步解决之。</p>
<p>f12上的rpm安装：http://www.linux-kvm.com/content/getting-started-spice-fedora-12</p>
<p>ubuntu上的安装参考:http://docs.cslabs.clarkson.edu/wiki/SPICE，已通过。</p>
<p>利用此文档在fedora上安装，基本正常，缺少的包为：alsa-lib,alsa-lib-devel；libjpeg-turbo-devel，libjpeg-turbo-static，libjpeg-turbo-utils，libpng，libpng-devel。</p>
<p>编译qcairo的一个错误是：configure: error: Cairo requires at least one native font backend.&nbsp; Please install FreeType and fontconfig and try again.</p>
<p>安装cairo-devel就可以了。</p>
<p>编译spice提示：</p>
<p>configure: error: Package requirements (openssl) were not met</p>
<p>安装openssl-devel</p>
<p>configure: error: Package requirements (xrandr) were not met</p>
<p>安装libXrandr-devel</p>
<p>configure: error: Package requirements (xfixes) were not met</p>
<p>安装libXfixes-devel</p>
<p>configure: error: libjpeg not found</p>
<p>安装libjpeg-devel</p>
<p>加入--enable-gui后提示：</p>
<p>configure: error: Package requirements (CEGUI &gt;= 0.6.0 CEGUI &lt; 0.7.0) were not met（未解决）</p>
<p>安装spice-gtk时提示：</p>
<p>configure: error: Your intltool is too old.&nbsp; You need intltool 0.40.0 or later.</p>
<p>安装intltool</p>
<p>configure: error: Package requirements (gtk+-2.0 &gt;= 2.18.0) were not met（未解决）</p>
<p>在spice make时提示：exec: g++: not found</p>
<p>安装gcc-c++</p>
<p>libtool: link: unsupported hardcode properties<br />libtool: link: See the libtool documentation for more information.<br />libtool: link: Fatal configuration error.</p>
<p>重新configure一下即可。</p>
<p>具体过程如下：</p>
<h1 id="firstHeading" class="firstHeading">SPICE</h1>
<h3 id="siteSub">From CSLabsWiki</h3>
<div id="jump-to-nav">Jump to: <a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#column-one">navigation</a>, <a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#searchInput">search</a></div>
<table id="toc" class="toc">
<tbody>
<tr>
<td>
<div id="toctitle">
<h2>Contents</h2>
<span class="toctoggle">[<a class="internal" id="togglelink">hide</a>]</span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#Overview"><span class="tocnumber">1</span> <span class="toctext">Overview</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#SPICE_on_Ubuntu"><span class="tocnumber">2</span> <span class="toctext">SPICE on Ubuntu</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#Initial_set-up"><span class="tocnumber">2.1</span> <span class="toctext">Initial set-up</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#Installing_Dependencies"><span class="tocnumber">2.2</span> <span class="toctext">Installing Dependencies</span></a>
<ul>
<li class="toclevel-3 tocsection-5"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#Spice_protocol_headers"><span class="tocnumber">2.2.1</span> <span class="toctext">Spice protocol headers</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#qpixman_and_pixman"><span class="tocnumber">2.2.2</span> <span class="toctext">qpixman and pixman</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#celt"><span class="tocnumber">2.2.3</span> <span class="toctext">celt</span></a></li>
<li class="toclevel-3 tocsection-8"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#qcairo"><span class="tocnumber">2.2.4</span> <span class="toctext">qcairo</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-9"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#Installing_SPICE"><span class="tocnumber">2.3</span> <span class="toctext">Installing SPICE</span></a>
<ul>
<li class="toclevel-3 tocsection-10"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#libspice_and_the_SPICE_client"><span class="tocnumber">2.3.1</span> <span class="toctext">libspice and the SPICE client</span></a></li>
<li class="toclevel-3 tocsection-11"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#.22Spiced.22_QEMU"><span class="tocnumber">2.3.2</span> <span class="toctext">"Spiced" QEMU</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#Appendix:_Ubuntu_SPICE_PPA"><span class="tocnumber">2.4</span> <span class="toctext">Appendix: Ubuntu SPICE PPA</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#SPICE_on_Fedora"><span class="tocnumber">3</span> <span class="toctext">SPICE on Fedora</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#How_To_Use_SPICE"><span class="tocnumber">4</span> <span class="toctext">How To Use SPICE</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#Client"><span class="tocnumber">4.1</span> <span class="toctext">Client</span></a></li>
<li class="toclevel-2 tocsection-16"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#Server"><span class="tocnumber">4.2</span> <span class="toctext">Server</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#Special_instructions_for_using_a_Windows_guest"><span class="tocnumber">4.3</span> <span class="toctext">Special instructions for using a Windows guest</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-18"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#SPICE_in_COSI"><span class="tocnumber">5</span> <span class="toctext">SPICE in COSI</span></a>
<ul>
<li class="toclevel-2 tocsection-19"><a href="http://docs.cslabs.clarkson.edu/wiki/SPICE#External_Resources"><span class="tocnumber">5.1</span> <span class="toctext">External Resources</span></a></li>
</ul>
</li>
</ul>
</td>
</tr>
</tbody>
</table>
<h1> <span class="mw-headline" id="Overview"> Overview </span></h1>
<p><a href="http://www.spice-space.org/" class="external text" rel="nofollow">SPICE</a>
 is a protocol that allows for high-quality virtual machine access using
 VDI over a network. It could be used as a communication layer between 
thin clients and their associated virtualized operating systems, or it 
could be used as it is in the COSI lab for normal machines to have quick
 access to a variety of different operating systems, or in any other 
configuration where it is better for a virtual machine to be running 
remotely.
</p>
<h1> <span class="mw-headline" id="SPICE_on_Ubuntu"> SPICE on Ubuntu </span></h1>
<p>As SPICE is under development by Red Hat, binary packages are 
rpm-based. However, it is possible to run both the SPICE server and 
client on 64-bit Ubuntu machines, if they are compiled from source. 
There are several dependencies that must be installed before SPICE can 
be compiled; dependencies not already available in the standard Ubuntu 
repositories must also be compiled from source. Please follow the 
instructions below to compile the SPICE server and client.
</p>
<p>These instructions are for installing SPICE 0.6 on 64-bit Ubuntu 10.04. It is <i>not</i>
 possible to install a SPICE server on any 32-bit system due to its 
reliance on 64-bit atomic operations, and the process for installing 
just the client on 32-bit systems no longer appears to be supported.
</p>
<p>Please direct comments or questions about this guide to <a href="http://docs.cslabs.clarkson.edu/wiki/User:Platekme" title="User:Platekme">Mark Platek</a>.
</p>
<h2> <span class="mw-headline" id="Initial_set-up"> Initial set-up </span></h2>
<p>Some standard tools are required:
</p>
<pre>sudo apt-get install build-essential autoconf git-core
</pre>
<p>Also, install some dependencies from the repositories:
</p>
<pre>sudo apt-get install libtool liblog4cpp5-dev libavcodec-dev libssl-dev xlibmesa-glu-dev libasound-dev libpng12-dev libfreetype6-dev libfontconfig1-dev libogg-dev libxrandr-dev kvm libgcrypt-dev libsdl-dev
</pre>
<p>Finally, create a directory to compile from and descend into it:
</p>
<pre>mkdir spice-sources
cd spice-sources
</pre>
<h2> <span class="mw-headline" id="Installing_Dependencies"> Installing Dependencies </span></h2>
<h3> <span class="mw-headline" id="Spice_protocol_headers"> Spice protocol headers </span></h3>
<p>The first dependency to install is the spice protocol headers.
</p>
<pre>wget http://spice-space.org/download/releases/spice-protocol-0.6.0.tar.gz
tar xvf spice-protocol-0.6.0.tar.gz
cd spice-protocol-0.6.0/
./configure
make
sudo make install
cd ..
</pre>
<h3> <span class="mw-headline" id="qpixman_and_pixman"> qpixman and pixman </span></h3>
<p>SPICE requires a special version of pixman unavailable in the Ubuntu repositories. It is available from the SPICE homepage.
</p>
<pre>wget http://spice-space.org/download/stable/qpixman-0.13.3-git20090127.tar.bz2
tar xvf qpixman-0.13.3-git20090127.tar.bz2
cd qpixman-0.13.3-git20090127/
./autogen.sh --includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..
</pre>
<p>We must also install a newer version of the normal pixman library, available from the SPICE project's git repository.
</p>
<pre>git clone git://anongit.freedesktop.org/pixman
cd pixman/
./autogen.sh --includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..
</pre>
<h3> <span class="mw-headline" id="celt"> celt </span></h3>
<p>SPICE requires a specific version of the celt audio codec (0.5.1.3). 
Since it is unavailable in the Ubuntu repositories, it must also be 
compiled.
</p>
<pre>wget http://downloads.us.xiph.org/releases/celt/celt-0.5.1.3.tar.gz
tar xvf celt-0.5.1.3.tar.gz
cd celt-0.5.1.3/
./configure --includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..
</pre>
<h3> <span class="mw-headline" id="qcairo"> qcairo </span></h3>
<p>SPICE requires a modified version of the cairo graphics library, named qcairo. Sources are available on the spice homepage.
</p>
<pre>wget http://spice-space.org/download/stable/qcairo-1.8.7.1-git74d6b5.tar.bz2
tar xvf qcairo-1.8.7.1-git74d6b5.tar.bz2
cd qcairo-1.8.7.1-git74d6b5/
./autogen.sh --disable-xlib --disable-ps --disable-pdf --disable-svg --includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..
</pre>
<h2> <span class="mw-headline" id="Installing_SPICE"> Installing SPICE </span></h2>
<h3> <span class="mw-headline" id="libspice_and_the_SPICE_client"> libspice and the SPICE client </span></h3>
<p>Finally, all of the dependencies are satisfied and we can install the
 SPICE server. It comes in two parts: one part is libspice (we will 
later compile a new version of qemu with spice support to use it), and 
the other is the spice client. They are both installed at the same time.
</p>
<p><i>NOTE</i>: This section can only be performed on a 64-bit 
system! Client-only installation on a 32-bit system no longer appears to
 be supported.
</p>
<pre>wget http://spice-space.org/download/releases/spice-0.6.0.tar.gz
tar xf spice-0.6.0.tar.gz
cd spice-0.6.0/
./configure --includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..
</pre>
<h3> <span class="mw-headline" id=".22Spiced.22_QEMU"> "Spiced" QEMU </span></h3>
<p>Support for SPICE 0.6 is currently included in a late 0.13 release of
 QEMU, we will install that version now. We will be installing this 
"spiced" QEMU alongside the system QEMU, so make sure you perform the 
installation in some permanent location. I chose <tt>/opt/qemu-spice</tt>, but you can do it wherever you want.
</p>
<p>Note that we must switch to a branch of the qemu git tree - v19 
is the latest branch at time of writing (2010-09-23). According to the <a href="http://spice-space.org/page/Building_Instructions" class="external text" rel="nofollow">SPICE documentation</a> the branch number is in flux and is subject to change.
</p>
<p>This whole subsection should be done as root, to avoid exposing <tt>/opt</tt> to ordinary users. If you don't want to work as root, prepend each command with sudo.
</p>
<pre>cd /opt
mkdir qemu-spice
cd qemu-spice/
git clone git://git.freedesktop.org/git/spice/qemu
cd qemu/
git checkout -b spice.v19 origin/spice.v19
</pre>
<p>Now we have to change the configure script to not set the -Werror 
CFLAG. This is dangerous, but I couldn't get qemu to compile without 
forcing the configure script to not set it. Open the configure script in
 your favorite editor and find the part that looks like:
</p>
<pre>if test "$werror" = "yes"&nbsp;; then
    QEMU_CFLAGS="-Werror $QEMU_CFLAGS"
fi
</pre>
<p>Change it to remove the -Werror, like so:
</p>
<pre>if test "$werror" = "yes"&nbsp;; then
    QEMU_CFLAGS="$QEMU_CFLAGS"
fi
</pre>
<p>Now, run the configure script and make QEMU. Please note that 
compiling QEMU in this way will enable it to emulate only a 64-bit host;
 add extra targets if you need other architectures.
</p>
<pre>./configure --target-list=x86_64-softmmu --enable-spice --enable-io-thread
make
</pre>
<p>QEMU needs certain BIOS files to be able to start SPICE VMs, so we have to copy them to a location QEMU expects to find them.
</p>
<pre>cp pc-bios/vgabios-qxl.bin /usr/share/qemu/
cp pc-bios/pxe-e1000.bin /usr/share/qemu/
</pre>
<p>Spiced QEMU is now available, the executable is located at <tt>/opt/qemu-spice/qemu/x86_64-softmmu/qemu-system-x86_64</tt>. Make a symlink for convenient invocation:
</p>
<pre>ln -s /opt/qemu-spice/qemu/x86_64-softmmu/qemu-system-x86_64 /usr/sbin/qemu-spice
</pre>
<p>And that's it! You can invoke <tt>qemu-spice</tt> with the argument 
"-spice" to start a SPICE server. As soon as QEMU 0.14 is released, 
however, you can use the QEMU package available in the Ubuntu 
repositories instead, since it will include SPICE support by default.
</p>
<h2> <span class="mw-headline" id="Appendix:_Ubuntu_SPICE_PPA"> Appendix: Ubuntu SPICE PPA </span></h2>
<p>In past revisions of this page, Adam J. Lincoln's PPA containing 
debian packages for qcairo, qpixman, etc. and the spice client was 
mentioned. It no longer appears to be actively maintained, and almost 
certainly carries an old, incompatible version of SPICE (0.4). If you 
wish to use SPICE, please compile it from source using the method 
described above.
</p>
<h1> <span class="mw-headline" id="SPICE_on_Fedora"> SPICE on Fedora </span></h1>
<p>It is considerably easier to install SPICE on a Fedora system, since rpms are available. Gerd Hoffman maintains a <a href="http://kraxel.fedorapeople.org/spice/" class="external text" rel="nofollow">repository</a>
 that is kept up to date with the latest in SPICE development, and the 
version of QEMU with spice support enabled natively will be available in
 Fedora 14.
</p>
<p>To install SPICE on 64-bit Fedora 13, perform the following steps as root:
</p>
<pre>cd /etc/yum.repos.d
wget http://kraxel.fedorapeople.org/spice/spice-unstable.repo
yum install spice-client qemu-spice
</pre>
<h1> <span class="mw-headline" id="How_To_Use_SPICE"> How To Use SPICE </span></h1>
<h2> <span class="mw-headline" id="Client"> Client </span></h2>
<p>To invoke the spice client, use the command 
</p>
<pre>spicec -h &lt;server hostname&gt; -p &lt;port number&gt;
</pre>
<h2> <span class="mw-headline" id="Server"> Server </span></h2>
<p>Invoking the spice server is rather more complex than the client, 
since you have to set the parameters of the virtualized guest. For 
example,
</p>
<pre>qemu-spice -spice port=5930,disable-ticketing -drive file=/path/to/image -vga qxl <br />-device AC97 -usbdevice tablet -m 1024 -enable-kvm -net nic -net user
</pre>
<p>will start a SPICE server VM on port 5930 from the image at the supplied path, with:
</p>
<ul>
<li> qxl graphics (you need this for spice to be of any use)
</li>
<li> an AC97 sound device
</li>
<li> a tablet input device (using a virtualized tablet generally gives better results than a virtualized mouse)
</li>
<li> 1024M of memory available
</li>
<li> KVM support enabled (you <b>really</b> want this, as the guest is quite slow otherwise)
</li>
<li> a user-controllable virtualized nic
</li>
</ul>
<p>It is also possible to use virtio if your system supports it; doing 
so will lead to significant performance gains for the guest. Modify the <tt>-drive</tt> argument like so:
</p>
<pre>-drive file=/path/to/image,if=virtio
</pre>
<p>And, modify the <tt>-net</tt> argument like so:
</p>
<pre>-net nic,model=virtio
</pre>
<p>When a SPICE server is started, its virtual guest boots and at any 
point until the guest is shut down a client can connect to and interact 
with the guest.
</p>
<h2> <span class="mw-headline" id="Special_instructions_for_using_a_Windows_guest"> Special instructions for using a Windows guest </span></h2>
<p>SPICE aims to provide a high-quality interface between the remote 
client and the guest VM. To this end, a SPICE-specific Windows driver 
has been written to enable smooth operation of the mouse, eliminating 
the "choppiness" that has before been a problem when running an XP 
guest. When you boot the SPICE Windows guest, follow <a href="http://www.linux-kvm.com/content/rhev-spice-guest-drivers-released-windows" class="external text" rel="nofollow">these instructions</a> to enable it. Note that you must start the guest with option <tt>-vga qxl</tt> in order for the mouse driver to work.
</p>
<h1> <span class="mw-headline" id="SPICE_in_COSI"> SPICE in COSI </span></h1>
<p>The <a href="http://docs.cslabs.clarkson.edu/wiki/VDI/Spice_Project" title="VDI/Spice Project">VDI/Spice Project</a>
 is aimed at providing COSI members and students with personalizable 
virtual machines. The project is still in its early stages, but 
development is ongoing; we are looking to integrate with <a href="http://docs.cslabs.clarkson.edu/wiki/OSCKAR" title="OSCKAR">OSCKAR</a> and <a href="http://docs.cslabs.clarkson.edu/wiki/KIOSCKAR" title="KIOSCKAR">KIOSCKAR</a>.
</p>
<h2> <span class="mw-headline" id="External_Resources"> External Resources </span></h2>
<p><a href="http://www.spice-space.org/docs/spice_user_manual.pdf" class="external text" rel="nofollow">SPICE User Manual</a>
</p>
<p><a href="http://www.spice-space.org/" class="external text" rel="nofollow">SPICE Homepage</a></p>
<p>虽然成功了，但运行spicec后没有出现gui界面。后面知道编译时需要加入参数--enable-gui。但加入这个参数后编译，提示缺少cegui库，下载rpm包后安装，又提示缺少libGLU-devel，安装。</p>
<p>刚才查了一下，系统里是有cegui的，但没有cegui-devel，装了以后编译通过。</p>
<p>编译时先看一下./configure --help，会有一些收获的：）</p>
<p>spice wiki上的安装说明：http://www.spice-space.org/page/Building_Instructions</p>
<p>spice-gtk：http://spice-space.org/download/gtk/&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; http://spice-space.org/page/Spice-Gtk</p>
<p>spice的client界面用了cegui和gtk，看一下能不能该一下。</p>

<p>安装过程：</p>
1.
附件是spice的源代码和protocol的rpm包，先装rpm包，再编译安装spice；这两个你就不用去官网下载了。装好rpm包后，参照步骤2先装依赖包，然后再编译spice。<br /><br />2. 第二部参考如下内容（参考步骤4）：<br />
<h2> <span class="mw-headline" id="Installing_Dependencies"> Installing Dependencies </span></h2>
<h3> <span class="mw-headline" id="Spice_protocol_headers"> Spice protocol
headers </span></h3>
<p>The first dependency to install is the spice protocol headers.
</p>
<pre>wget http://spice-space.org/download/releases/spice-protocol-0.6.0.tar.gz
tar xvf spice-protocol-0.6.0.tar.gz
cd spice-protocol-0.6.0/
./configure
make
sudo make install
cd ..
</pre>
<h3> <span class="mw-headline" id="qpixman_and_pixman"> qpixman and pixman
</span></h3>
<p>SPICE requires a special version of pixman unavailable in the Ubuntu
repositories. It is available from the SPICE homepage.
</p>
<pre>wget
http://spice-space.org/download/stable/qpixman-0.13.3-git20090127.tar.bz2
tar xvf qpixman-0.13.3-git20090127.tar.bz2
cd qpixman-0.13.3-git20090127/
./autogen.sh --includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..
</pre>
<p>We must also install a newer version of the normal pixman library, available
from the SPICE project's git repository.
</p>
<pre>git clone git://anongit.freedesktop.org/pixman
cd pixman/
./autogen.sh --includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..
</pre>
<h3> <span class="mw-headline" id="celt"> celt </span></h3>
<p>SPICE requires a specific version of the celt audio codec (0.5.1.3).
Since it is unavailable in the Ubuntu repositories, it must also be
compiled.
</p>
<pre>wget http://downloads.us.xiph.org/releases/celt/celt-0.5.1.3.tar.gz
tar xvf celt-0.5.1.3.tar.gz
cd celt-0.5.1.3/
./configure --includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..
</pre>
<h3> <span class="mw-headline" id="qcairo"> qcairo </span></h3>
<p>SPICE requires a modified version of the cairo graphics library, named
qcairo. Sources are available on the spice homepage.
</p>
<pre>wget
http://spice-space.org/download/stable/qcairo-1.8.7.1-git74d6b5.tar.bz2
tar xvf qcairo-1.8.7.1-git74d6b5.tar.bz2
cd qcairo-1.8.7.1-git74d6b5/
./autogen.sh --disable-xlib --disable-ps --disable-pdf --disable-svg
--includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..<br /><br /></pre>
3.安装spice
<pre>tar xf spice-0.8.0.tar.gz
cd spice-0.8.0/
./configure --includedir=/usr/include --libdir=/usr/lib64
make
sudo make install
cd ..<br /><br /></pre>
4.
这里是我编译spice和依赖包时遇到的一些问题，供参考：<br />
<p>编译qcairo的一个错误是：configure: error: Cairo
requires at least one native
font backend.&nbsp; Please install FreeType and fontconfig and try again.</p>
<p>安装cairo-devel就可以了。</p>

<p>编译spice提示：</p>
<p>configure: error: Package requirements (openssl) were not met</p>
<p>安装openssl-devel</p>

<p>configure: error: Package requirements (xrandr) were not met</p>
<p>安装libXrandr-devel</p>

<p>configure: error: Package requirements (xfixes) were not met</p>
<p>安装libXfixes-devel</p>

<p>configure: error: libjpeg not found</p>
<p>安装libjpeg-devel</p>

<p>在spice make时提示：exec: g++: not found</p>
<p>安装gcc-c++</p>
<p>libtool: link: unsupported hardcode properties<br />libtool: link: See the
libtool documentation for more information.<br />libtool: link: Fatal
configuration error.</p>
<p>重新configure一下即可。</p>
<br />5. 都完成后，为kvm做个软链接：ln -s /usr/libexec/qemu-kvm
/usr/bin/kvm<br />spice server端启动命令：<br />
<pre>kvm -spice
port=5930,disable-ticketing -drive file=/path/to/image -vga qxl -device AC97
-usbdevice tablet -m 1024 -net nic -net user</pre>
spice client端访问命令：<br />spicec
-h hostip -p port<br /></div><div id="MySignature"></div>
<script type="text/javascript">
var isLogined = false;
var cb_blogId = 69263;
var cb_entryId = 1962317;
var cb_blogApp = currentBlogApp;
var cb_blogUserGuid = "cf3fca5c-5048-df11-ba8f-001cf0cd104b";
var cb_entryCreatedDate = '2011/2/23 15:05:00';
var enableGoogleAd = true;
var googletag = googletag || {};
googletag.cmd = googletag.cmd || [];
</script>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>
<script type="text/javascript">
    //SyntaxHighlighter.config.strings.expandSource = '<span><img src="http://static.cnblogs.com/images/expand-code.gif" alt="" class="expand-code-icon"/>View Code</span>';
    $(function () {  
        loadViewCount(cb_entryId);
        fixPostBodyFormat();
        loadAdUnderPost();
        loadBlogSignature();
        LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
        GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);        
        GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);        
    });
</script>
		</div>
		<div class = "postDesc">posted @ <span id="post-date">2011-02-23 15:05</span> <a href='http://www.cnblogs.com/chinacloud/'>chinacloud</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>)  <a href ="http://www.cnblogs.com/chinacloud/admin/EditPosts.aspx?postid=1962317" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(1962317);return false;">收藏</a></div>
	</div>
	<script src="http://counter.cnblogs.com/blog/post/1962317" type="text/javascript"></script>
	
</div><!--end: topics 文章、评论容器-->
<div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" id="lnk_RefreshComments" onclick="return RefreshCommentList();">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
<div id="comment_form_container"></div>

<script type="text/javascript">
    if (typeof commentManager === 'undefined') {
        commentManager = new blogCommentManager();
    }
    commentManager.loadCommentForm();   
</script>

<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="site_nav_under"><a href="http://www.cnblogs.com/" target="_blank" title="程序员的网上家园">博客园首页</a><a href="http://q.cnblogs.com/" target="_blank" title="程序员问答社区">博问</a><a href="http://news.cnblogs.com/" target="_blank" title="IT新闻">新闻</a><a href="http://home.cnblogs.com/ing/" target="_blank">闪存</a><a href="http://job.cnblogs.com/" target="_blank">程序员招聘</a><a href="http://kb.cnblogs.com/" target="_blank">知识库</a></div>
<div id="ad_under_post_holder"></div>
<div id="HistoryToday" class="c_ad_block"></div>
</div>





	</div><!--end: forFlow -->
	</div><!--end: topicList 文章列表容器-->

	<div id="sideBar">
		<div id="sideBarMain">
			
<!--done-->
<div class="newsItem">
<h3 class="catListTitle">公告</h3>
	<div id="blog-news"></div>
</div>

			<div id="calendar"><div id="blog-calendar" style="displya:none"></div></div>
			
			<DIV id="leftcontentcontainer">
				<div id="blog-sidecolumn"></div>
			</DIV>
			
		</div><!--end: sideBarMain -->
	</div><!--end: sideBar 侧边栏容器 -->
	<div class="clear"></div>
	</div><!--end: main -->
	<div class="clear"></div>
	<div id="footer">
	</div><!--end: footer -->
</div><!--end: home 自定义的最大容器 -->
<script type="text/javascript" src="http://common.cnblogs.com/script/google-analytics.js"></script>
</body>
</html>
