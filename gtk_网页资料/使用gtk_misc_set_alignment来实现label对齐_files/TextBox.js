require("core::util","core::util::jQuery",function(a,e){function d(h){this[0]=e(h)[0];this[0].wrapped=this;this.length=1;this.bind("focus",g);this.bind("blur",b);this.bind("keydown",f);this.bind("keyup",c);this.oldVal=this[0].value}a.probe({getText:function(){var h=this[0].value;return h===this.oldVal?"":h},setText:function(h){this.value=this[0].value=h;this.onChange&&this.onChange(h);return this},destroy:function(){this.unbind("focus",g);this.unbind("blur",b);this.unbind("keydown",f);this.unbind("keyup",c);this[0].wrapped=null},moveTo:function(j){var i=this[0].value;if(j==-1){j=i.length}if(this[0].setSelectionRange){this[0].focus();this[0].setSelectionRange(j,j)}else{if(this[0].createTextRange){var h=this[0].createTextRange();h.collapse(true);h.moveEnd("character",j);h.moveStart("character",j);h.select()}}}},d.prototype=new e.fn.init());function g(){this.style.color="#000";if(this.value===this.wrapped.oldVal){this.value="";this.wrapped.onChange&&this.wrapped.onChange("")}this.wrapped.onFocus&&this.wrapped.onFocus()}function b(){if(this.value===""){this.style.color="";this.value=this.wrapped.oldVal}this.wrapped.onBlur&&this.wrapped.onBlur()}function c(j){if(j.keyCode==17){this.ctrl=false}else{var h=this.value;var i=this.wrapped;if(i.value!=h){i.value=h;i.onChange&&i.onChange(h)}}this.wrapped.onKeyup&&this.wrapped.onKeyup()}function f(h){if(h.keyCode==17){this.ctrl=true}else{if(h.keyCode==13&&this.ctrl){this.wrapped.onSend&&this.wrapped.onSend()}}}define("core::ui::TextBox",d)});