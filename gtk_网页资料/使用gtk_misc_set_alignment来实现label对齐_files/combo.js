String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")});window.JSON||loadResource("/mysohu/lang/JSON.js");window.console||(window.console={log:function(){},n:(document.documentElement.onkeydown=function(a){(a||window.event)["keyCode"]==123&&(console.n==5?loadResource("/mysohu/lang/console.js"):console.n++)})&&0});(function(){var a={build:"1.5.0",iphone:/\b(?:iPad|iPhone)\b/i.test(navigator.userAgent),appId:window.$space_config&&$space_config._currentApp,setLocation:function(n){window.load=window.loadResource=window.domReady=null;top.location.href=n},userFace:"http://photo.pic.sohu.com/images/oldblog/person/11111.gif"};if(window.localStorage&&localStorage.getItem("build")!=a.build){localStorage.clear();localStorage.setItem("build",a.build)}window.mysohu=window.MYSOHU=window.MS=a;var i=document.head||document.getElementsByTagName("HEAD")[0];window.loadScript=function(q,r,o,n){var p=f(q);p.onload=p.onreadystatechange=(r||o)&&function(){var s=p.readyState;if(s===undefined||s==="loaded"||s==="complete"){p.onload=p.onreadystatechange=null;o&&p.parentNode&&p.parentNode.removeChild(p);r&&r(n&&l(n));if(n){try{delete window[n]}catch(t){window[n]=null}}}};return p};var j={"plugins::hijacker::ori_forward":"plugins::hijacker::forward","plugins::hijacker::Forward":"plugins::hijacker::forward","plugins::hijacker::video_expand":"plugins::hijacker::preview_expand","plugins::hijacker::mblog.delete":"plugins::hijacker::feed.delete","plugins::hijacker::page":"core::ui::Page","plugins::hijacker::emote":"app::emote","plugins::hijacker::comment.show":"app::discuss"};var h={"core::util::jQuery":["/mysohu/plugins/jquery-lastest.js","jQuery"],"core::util::passport":["/mysohu/base/passport.js","PassportSC"],"core::ui::dialog":["/mysohu/plugins/dialog/jquery.dialog.js","jQuery.dialog"],"core::ui::ppDialog":["/mysohu/plugins/ppdialog/jquery.ppdialog.js","jQuery.ppDialog"],"core::ui::dialog::notice":["/mysohu/plugins/dialog/jquery.dialog.js","jQuery.notice"],"core::ui::dialog::confirm":["/mysohu/plugins/dialog/jquery.dialog.js","jQuery.confirm"],"core::ui::dialog::inform":["/mysohu/plugins/dialog/jquery.dialog.js","jQuery.inform"],"core::ui::dialog::success":["/mysohu/plugins/dialog/jquery.dialog.js","jQuery.notice.success"],"core::ui::dialog::error":["/mysohu/plugins/dialog/jquery.dialog.js","jQuery.notice.error"],"core::util::base64":["/mysohu/base/base64.js","Base64"],"plugins::swfobject":["/mysohu/plugins/swfobject/swfobject.js","swfobject"],"plugins::swfupload":["/mysohu/plugins/swfupload/swfupload.js","SWFUpload"]};function c(p){if(!h[p]){return undefined}var o=h[p][1],n=l(o);if(n){define(p,n)}else{loadResource(h[p][0]||k(p)).ready(function(){n=l(o);if(n){define(p,n)}})}}function l(p){var r=p.split("."),q=window;for(var s=0,o=r.length;s<o;s++){q=q[r[s]];if(!q){break}}return q}var g={};var m={};window.require=function(){var n,o;if(arguments.length===0){n=["#document"];o=null}else{o=arguments[arguments.length-1];if(typeof o==="function"){n=Array.prototype.slice.call(arguments,0,arguments.length-1)}else{o=null;n=Array.prototype.slice.call(arguments,0)}}return new d(n,o)};function f(n){var o=document.createElement("SCRIPT");o.type="text/javascript";o.charset="utf-8";o.src=n;i.appendChild(o);return o}window.define=function(o,q){var p=g[o]||(g[o]={name:o,notReady:0,plug:e.prototype.plug});if(p.value){throw o+" already defined"}p.value=q;if(p.isPlugin){g[o.substr(0,o.lastIndexOf(":")-1)].plug(o.substr(o.lastIndexOf(":")+1),q)}if(p.plugins){for(var n in p.plugins){q[n]=p.plugins[n]}p.plugins=null}p.fireReady&&p.fireReady()};function e(o){if(g[o]){return g[o]}g[o]=this;this.name=o;if(/^#/.test(o)){var q=o.substr(1),p=q=="document"?b?null:document:document.getElementById(q);if(p){this.notReady=0;this.value=p}else{this.notReady=e.nextId++;this.requires=[];m[q]=this}return}if(h[o]){var n=l(h[o][1]);if(n){this.notReady=0;this.value=n;return}}this.notReady=e.nextId++;this.requires=[];document.getElementById("footer")&&this.loadjs()}e.prototype.fireReady=function(){this.fireReady=null;for(var q=0,o=this.requires.length;q<o;q++){var p=this.requires[q];p.notReady-=this.notReady;p.notReady||p.fireReady()}this.notReady=0;this.requires=null};e.prototype.plug=function(q,p){if(this.isInterface){this.value.inits.push(p);var o=this.value.prototype;for(var n in p.prototype){o[n]=p.prototype[n]}}else{(this.value||this.plugins||(this.plugins={}))[q]=p}return this};e.prototype.getPath=function(){return k(this.name)};e.prototype.loadjs=function(){if(h[this.name]){c(this.name)}else{loadResource(this.getPath())}};e.nextId=1;function k(o){var q=(j[o]||o).split("::");var p=q[q.length-1],n=p.lastIndexOf(".");if(n!=-1){q[q.length-1]=p=p.substr(0,n)}if(q[0]=="app"&&q.length==2){q.push(p)}else{if(/^(?:core|plugins|libs)$/.test(q[0])){q.unshift("mysohu")}}return"/"+q.join("/")+".js"}function d(y,x){this.notReady=0;this.callbacks=[];this.mods=[];for(var q=0,u=y.length;q<u;q++){var p=y[q];if(/\[.*\]$/.test(p)){var s=p.substring(p.indexOf("[")+1,p.length-1);p=p.substr(0,p.length-s.length-2);var v=g[p]||new e(p);this.notReady+=v.notReady;v.notReady&&v.requires.push(this);s=s.split(/[,;\|]/g);for(var r=0,t=s.length;r<t;r++){var w=p+"::"+s[r];var o=g[w]||new e(w);if(o.notReady){o.isPlugin=true;this.notReady+=o.notReady;o.requires.push(this)}else{v.plug(s[r],o.value)}}}else{var v=g[p]||new e(p);this.notReady+=v.notReady;v.notReady&&v.requires.push(this)}this.mods.push(p)}x&&this.callbacks.push(x);this.notReady||this.fireReady()}d.prototype.ready=function(n){if(n){if(this.args){n.apply(this,this.args)}else{this.callbacks.push(n)}}return this};d.prototype.fireReady=function(){var p=this,q=this.args=[];for(var s=0,o=this.mods.length;s<o;s++){q.push(g[this.mods[s]].value)}for(var s=0,o=p.callbacks.length;s<o;s++){try{p.callbacks[s].apply(p,q)}catch(r){console.log(r)}}p.callbacks=null};mysohu.debug=function(o){if(o&&g[o]){return g[o]}for(var n in g){console.log(n,g[n].notReady||g[n].value)}};var b=domReady;domReady=function(o){if(typeof o!="string"){o=""}else{if(o.charAt(0)=="#"){o=o.substr(1)}}if(!o||o==="document"){if(!b){return}b();b=null;for(var n in m){var q=m[n];if(!q){continue}q.value=n==="document"?document:document.getElementById(n);q.fireReady()}m={};var p=[];for(var n in g){if(/^#/.test(n)||!g[n].notReady){continue}if(h[n]){c(n);continue}g[n].notReady&&p.push(g[n].getPath())}p.length&&loadResource.apply(null,p)}else{var q=m[o];if(!q){return}m[o]=false;q.value=document.getElementById(o);q.fireReady()}};if(document.addEventListener){document.addEventListener("DOMContentLoaded",domReady,false);window.addEventListener("load",domReady,false)}else{if(document.documentElement.doScroll){if(window.attachEvent){window.attachEvent("onload",domReady)}(function(){try{document.documentElement.doScroll("left")}catch(n){setTimeout(arguments.callee,4);return}domReady()})()}}})();
(function(){if(!String.prototype.trim){var d=/^\s+|\s+$/;String.prototype.trim=function(){return this.replace(d,"")}}var c=document,b=c.createElement("span");var a={uuid:function(f){if(!f||f<1){f=8}var g="";while(g.length<f){g+=(Math.random()*2147483647<<0).toString(36)}return g.substr(0,f)},seed:{valueOf:function(){return"_"+a.uuid(8)}},probe:function(g,h){if(!h){h={}}for(var f in g){if(g.hasOwnProperty(f)&&!h.hasOwnProperty(f)){h[f]=g[f]}}return h},each:function(g,i,f){if("length" in g){for(var h=0;h<g.length;h++){i.call(f,h,g[h])}}else{for(var h in g){i.call(f,h,g[h])}}},toArray:function(i){try{return Array.prototype.slice.call(i,0)}catch(h){for(var j=0,f=i.length,g=new Array(f);j<f;j++){g[j]=i[j]}return g}},toQueryString:function(h){var f=[];for(var g in h){f.push(g+"="+encodeURIComponent(h[g]))}return f.join("&")},refreshCount:function(g,f){if(!g){return}if(f!==undefined){f="("+ +f+")"}g.innerHTML=g.innerHTML.replace(/(?:\((\d+|\??)\))?$/,function(h,i){return f==="(0)"?"":f||(h?"("+(parseInt(i)+1)+")":"(1)")})},parseHTML:function(h){var j=c.createElement("DIV");j.innerHTML=h;for(var i=0,g=j.children.length,f=new Array(g);i<g;i++){f[i]=j.children[i]}return f},toFragment:function(i){b.innerHTML=i;for(var j=0,g=b.children,f=g.length,h=c.createDocumentFragment();j<f;j++){h.appendChild(g[0])}return h},getParentByClassName:function(h,g,f){f||(f=12);while(f&&h&&!a.hasClassName(h,g)){h=h.parentNode;f--}return f&&h},wndTop:function(){return a.ie?document.documentElement.scrollTop:window.scrollY},hasClassName:function(g,f){return g.nodeType==1&&(" "+g.className+" ").indexOf(" "+f+" ")!=-1},addClassName:function(g,f){a.hasClassName(g,f)||(g.className+=" "+f)},removeClassName:function(g,f){g.className=(" "+g.className+" ").split(" "+f+" ").join("").trim()},toggleClassName:function(g,f){g.className=a.hasClassName(g,f)?(" "+g.className+" ").split(" "+f+" ").join("").trim():g.className+" "+f},setClassName:function(h,g,f){h.className=f?(" "+h.className+" ").split(" "+g+" ").join("").trim():a.hasClassName(h,g)||h.className+" "+g},getSibling:function(g,f){if(!e){return g[f+"ElementSibling"]}f=f+"Sibling";while(g=g[f]){if(g.nodeType===1){return g}}return null},range:function(h,f,k,i){i--;var j=i>>1,g=i-j;return i>f-h?[h,f]:k<h+j?[h,h+i]:k>f-g?[f-i,f]:[k-j,k+g]}};var e=/MSIE ([6-9])/.exec(navigator.userAgent);a.ie=e?parseInt(e[1]):false;a.winId=a.uuid();define("core::util",a)})();
require("core::util",function(a){function d(g){if(g.mutex){if(g.mutex.locked){return}g.mutex.locked=true}a.probe(e,g);g.interval||(g.interval=c[g.speed]);var h=(b[g.type]||b.linear)(g.steps),i=0;g.delay?g.pid=setTimeout(f,g.delay):f();return g;function f(){var l=new Date().getTime();if(i===0){g.now=l;g.init&&g.init.call(g.self);i=1}else{if(g.fixFrame){i++}else{i=Math.min(g.steps,((l-g.now)/g.interval+1)<<0)}}if(typeof g.src==="number"){var n=g.src+h[i]*(g.dst-g.src);g.round&&(n<<=0)}else{var n={};for(var j in g.src){n[j]=g.src[j]+h[i]*(g.dst[j]-g.src[j]);g.round&&(n[j]<<=0)}}try{g.callback.call(g.self,n)}catch(m){console.log("Error calling fx callback")}if(i==g.steps){g.mutex&&(g.mutex.locked=false);g.complete&&g.complete.call(g.self)}else{g.pid=setTimeout(arguments.callee,Math.max(g.now+i*g.interval-l,0))}}}var e={speed:"normal",src:0,dst:10,steps:10,type:"linear",fixFrame:true};var b={linear:function(g){var f=new Array(g+1);for(var h=0;h<=g;h++){f[h]=h/g}return f},exp:function(g){var f=b.linear(g);for(var h=1;h<g;h++){f[h]=(Math.exp(f[h])-1)/(Math.E-1)}return f},log:function(g){var f=b.linear(g);var h=Math.log(100);for(var i=1;i<g;i++){f[i]=Math.log(9.9*f[i]+0.1)/h+0.5}return f},p2:function(g){var f=b.linear(g);for(var h=1;h<g;h++){f[h]*=f[h]}return f}};var c={normal:50,slow:200,slowest:1000,fast:10,fastest:1};d.highlight=function(f,g){d({srt:0,dst:200,steps:20,round:true,self:f,callback:function(h){h=h>100?55+h:255-h;this.css("backgroundColor","rgb(255,"+h+","+h+")")},complete:g})};define("core::util::fx",d)});
require("core::util",function(a){var b=window.XMLHttpRequest||function(){return new ActiveXObject("Microsoft.XMLHTTP")};var d={method:"GET",timeout:8000,uuid:"_",async:true,retryTimeout:1200};function c(g){g=a.probe(d,g);var h;e();return h;function f(){if(h.readyState!=4){return}if(g.timeout){g.timeout=clearTimeout(g.pid)}if(h.status>=400||h.status===0&&!g.retries){g.onError&&(g.onError==="onComplete"?g.onComplete():g.onError())}else{if(h.status===0){g.retries--;g.pid&&(g.pid=clearTimeout(g.pid));setTimeout(e,g.retryTimeout)}else{if(g.onComplete){var j=h.responseText;if(g.type=="json"){try{j=JSON.parse(j)}catch(k){try{j=new Function("return "+j.trim())()}catch(k){g.onError&&g.onError();return}}}else{if(g.type=="text"){}else{j=h}}g.onComplete.call(h,j)}}}h=null}function i(){g.pid=0;if(h.readyState==4){return}if(g.retries){g.retries--;setTimeout(e,g.retryTimeout);return}if(g.onTimeout){g.onTimeout()}else{if(g.onError){g.onError()}}}function e(){h?h.abort():(h=new b());var l=g.url;if(g.uuid){l=[l,l.indexOf("?")===-1?"?":"&",g.uuid===true?"_":g.uuid,"=aj",a.uuid()].join("")}h.open(g.method,l,g.async);if(g.headers){for(var j in g.headers){h.setRequestHeader(j,g.headers[j])}}h.onreadystatechange=f;h.send(g.content);g.timeout&&(g.pid=setTimeout(i,g.timeout))}}c.get=function(e,g,f){return c({url:e,onComplete:g,type:f})};c.getJSON=function(e,f){return c.get(e,f,"json")};c.post=function(f,i,j,h,g){var e={method:"POST",url:f,onComplete:j,onError:h,type:g};if(i&&typeof i==="object"){e.content=a.toQueryString(i);e.headers={"Content-Type":"application/x-www-form-urlencoded"}}else{e.content=i}return c(e)};c.postJSON=function(e,g,h,f){return c.post(e,g,h,f,"json")};c.postForm=function(g,j){var l=document.createElement("DIV");var e=[],i="if"+a.uuid();e.push('<iframe name="',i,'" style="display:none;" src="about:blank"></iframe>');e.push('<form method="post" action="',g,'" target="',i,'">');for(var f in j){e.push('<input type="hidden" name="',f,'" />')}e.push("</form>");l.innerHTML=e.join("");e=null;var h=l.lastChild;for(var f in j){h[f].value=j[f]}document.body.appendChild(l);h.submit();setTimeout(function(){document.body.removeChild(l)},6000)};c.jsonp=function(f,j,h,e){var g="j"+a.uuid();var i=loadScript(f+(f.lastIndexOf("?")==-1?"?":"&")+(e||(h?"varname":"callback"))+"="+g,h&&j,true,g);if(!h){window[g]=j}return{abort:function(){if(!h){try{delete window[g]}catch(k){window[g]=undefined}}i.parentNode&&i.parentNode.removeChild(i)}}};define("core::util::ajax",c)});
require("core::util",function(e){var g={adapter:window.localStorage,broadcast:function(l,k,m){this.dispatch(i,l,{type:k,winId:e.winId,data:m});var n=f(k,m);if(n.length+l.length<4000){this.adapter&&this.adapter.setItem("ch__"+l,n)}},listen:function(m,l,k){switch(true){case !i[m]:i[m]={};case !i[m][l]:i[m][l]=[];default:i[m][l].push(k)}},listenOther:function(m,l,k){if(!window.localStorage){return}switch(true){case !h[m]:h[m]={};case !h[m][l]:h[m][l]=[];default:h[m][l].push(k)}if(!d){d=true;if(window.addEventListener){window.addEventListener("storage",b,false)}else{if(document.attachEvent){a.prepare();document.attachEvent("onstorage",function(){setTimeout(a,1)})}}}},listenAll:function(m,l,k){this.listen(m,l,k);this.listenOther(m,l,k)},dispatch:function(q,o,m){var l=q[o]&&q[o][m.type];if(!l){return}for(var p=0,k=l.length;p<k;p++){l[p](m)}}};var d=false;var i={};var h={};var j;function c(l){var k=l.split("::");return{type:k[0],winId:k[1],data:JSON.parse(k[3])}}function f(k,l){return[k,e.winId,e.uuid(),JSON.stringify(l)].join("::")}function a(){for(var m in i){var n="ch__"+m;var o=localStorage.getItem(n);if(!o||j[n]==o){continue}j[n]=o;var l=c(o);if(l.winId==e.winId){continue}g.dispatch(h,m,l)}}a.prepare=function(){j={};for(var l in localStorage){if(/^ch__/.test(l)){j[l]=localStorage[l]}}};function b(l){if(/^ch__/.test(l.key)){var k=c(l.newValue);k.winId!==e.winId&&g.dispatch(h,l.key.substr(4),c(l.newValue))}}define("core::util::channel",g)});
require("core::util",function(d){var c={unick:"未登录",photo:"http://img3.pp.sohu.com/ppp/blog/images/common/nobody.gif"};var f,a,b;var e={getCookie:function(i){var h="; "+document.cookie+"; ";var j=h.indexOf("; "+i+"=");if(j===-1){return null}j+=i.length+3;return h.substring(j,h.indexOf("; ",j))},init:function(){var i=this.getCookie("ppinf")&&this.getCookie("sucaccount");if(i){i=i.split("|");this.xpt=i[0];this.unick=i[1].replace(/%u([0-9a-fA-F]{4})/g,function(k,l){return String.fromCharCode(parseInt(l,16))});this.photo=i[2];(!this.photo||this.photo==="null")&&(this.photo=c.photo);this.uid=i[3];this.upt=i[4];this.ulink="http://i.sohu.com/p/"+this.upt;var h=this.upt;f=h.length;a=new Array(f);for(var j=0;j<f;j++){a[j]=h.charCodeAt(j)}b=a[h.charCodeAt(h.length-1)%f]}else{this.unick=c.unick;this.photo=c.photo;this.xpt=this.ulink=this.upt=this.uid=null}this.onInit&&this.onInit()},reload:function(h){loadScript("http://i.sohu.com/api/accountinfo.do",function(){e.init();h()},true)},isMine:function(){return this.xpt===$space_config._xpt},escape:function g(l,i){for(var p=0,k=l.length,j=new Array(k),m=b;p<k;p++){var h=l.charCodeAt(p),o=a[p%f]+a[m%f];o=i?h+o:h-o;m=i?o:h;j[p]=String.fromCharCode(o)}return j.join("")}};e.init();define("core::util::cookie",e)});
require("core::util[cookie]",function(b){var h=/^(?:string|number|boolean)$/;var a=new Function();a.prototype=window.localStorage&&document.domain==="i.sohu.com"?{load:g,save:f}:{load:a,save:a};var c=new a();b.cookie.onInit=function(){for(var i in c){delete c[i]}c.load()};c.load();define("core::util::userData",c);function e(m){var l=undefined;if(h.test(typeof m)){l=m}else{if(Object.prototype.toString.apply(m)==="[object Array]"){l=new Array(m.length);for(var o=0,i=l.length;o<i;o++){l[o]=e(m[o])}}else{if(Object.prototype.toString.apply(m)==="[object Object]"){l={};for(var j in m){l[j]=e(m[j])}}}}return l}function d(){var j=b.cookie.escape(b.cookie.upt,true);for(var k=4,i=["user_"];k<10;k++){i.push(j.charCodeAt(k).toString(36))}return i.join("")}function g(){if(!b.cookie.upt){return}var i=localStorage.getItem(d());if(!i){return}try{b.probe(JSON.parse("{"+b.cookie.escape(i,false).substring(4,i.length-4)+"}"),this)}catch(j){}}function f(){var j=JSON.stringify(e(this));var i=b.uuid();j=b.cookie.escape(i.substr(4,4)+j.substring(1,j.length-1)+i.substr(0,4),true);localStorage.setItem(d(),j)}});
(function(){var a={serverTime:new Date().getTime(),timeOffset:0,setServerTime:function(b){if(b){this.serverTime=b;this.timeOffset=new Date().getTime()-b}else{this.serverTime=new Date().getTime()-this.timeOffset}return this.serverTime},get_timeago:function(c){var i=a.serverTime,g=i-c;if(g<300000){return"刚刚"}if(g<3600000){return(g/60000<<0)+"分钟前"}if((i/86400000<<0)==(c/86400000<<0)){var j=new Date(c),d=j.getHours(),e=j.getMinutes();return"今日 "+(d<10?0:"")+d+":"+(e<10?0:"")+e}else{var j=new Date(c),b=j.getFullYear(),h=j.getMonth()+1,f=j.getDate(),d=j.getHours(),e=j.getMinutes();return(b==new Date(i).getFullYear()?"":b+"年")+(h<10?0:"")+h+"月"+(f<10?0:"")+f+"日 "+(d<10?0:"")+d+":"+(e<10?0:"")+e}}};define("core::timeUtil",a)})();
