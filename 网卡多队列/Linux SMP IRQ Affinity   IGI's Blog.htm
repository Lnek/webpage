<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="zh-CN">
<head profile="http://gmpg.org/xfn/11">
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>  Linux SMP IRQ Affinity | IGI&#039;s Blog</title>
		<link rel="stylesheet" type="text/css" media="all" href="http://www.igigo.net/wp-content/themes/zbench/style.css" />
	<link rel="pingback" href="http://www.igigo.net/xmlrpc.php" />
	<link rel="alternate" type="application/rss+xml" title="IGI&#039;s Blog &raquo; feed" href="http://www.igigo.net/feed" />
<link rel="alternate" type="application/rss+xml" title="IGI&#039;s Blog &raquo; 评论 feed" href="http://www.igigo.net/comments/feed" />
<link rel="alternate" type="application/rss+xml" title="IGI&#039;s Blog &raquo; Linux SMP IRQ Affinity 评论 feed" href="http://www.igigo.net/archives/231/feed" />
<link rel='stylesheet' id='wp-pagenavi-css'  href='http://www.igigo.net/wp-content/themes/zbench/pagenavi-css.css?ver=2.70' type='text/css' media='all' />
<script type='text/javascript' src='http://www.igigo.net/wp-includes/js/comment-reply.js?ver=20090102'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.igigo.net/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.igigo.net/wp-includes/wlwmanifest.xml" /> 
<link rel='index' title='IGI&#039;s Blog' href='http://www.igigo.net' />
<link rel='start' title='搭建WordPress的点滴' href='http://www.igigo.net/archives/18' />
<link rel='prev' title='Linux内核 RPS/RFS功能详细测试分析' href='http://www.igigo.net/archives/204' />
<link rel='next' title='MegaSAS RAID卡 BBU Learn Cycle周期的影响' href='http://www.igigo.net/archives/251' />
<meta name="generator" content="WordPress 3.0.4" />
<link rel='canonical' href='http://www.igigo.net/archives/231' />
<link rel='shortlink' href='http://www.igigo.net/?p=231' />
	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<meta id="syntaxhighlighteranchor" name="syntaxhighlighter-version" content="3.1.1" />
<!-- wp thread comment 1.4.9.4.002 -->
<style type="text/css" media="screen">
.editComment, .editableComment, .textComment{
	display: inline;
}
.comment-childs{
	border: 1px solid #999;
	margin: 5px 2px 2px 4px;
	padding: 4px 2px 2px 4px;
	background-color: white;
}
.chalt{
	background-color: #E2E2E2;
}
#newcomment{
	border:1px dashed #777;width:90%;
}
#newcommentsubmit{
	color:red;
}
.adminreplycomment{
	border:1px dashed #777;
	width:99%;
	margin:4px;
	padding:4px;
}
.mvccls{
	color: #999;
}
			
</style>
</head>
<body class="single single-post postid-231">
<div id="nav">
	<div id="menus">
		<ul><li><a href="http://www.igigo.net">首页</a></li></ul>
		<div class="menu"><ul><li class="page_item page-item-11"><a href="http://www.igigo.net/myssh" title="Myssh">Myssh</a><ul class='children'><li class="page_item page-item-109"><a href="http://www.igigo.net/myssh/myssh-v1-5" title="Myssh v1.5">Myssh v1.5</a></li><li class="page_item page-item-34"><a href="http://www.igigo.net/myssh/myssh-v1-3" title="Myssh-v1.3">Myssh-v1.3</a></li></ul></li><li class="page_item page-item-62"><a href="http://www.igigo.net/shell%e6%8f%90%e9%97%ae%e6%9d%bf" title="Shell提问板">Shell提问板</a></li><li class="page_item page-item-149"><a href="http://www.igigo.net/cmd" title="有趣的命令">有趣的命令</a></li><li class="page_item page-item-124"><a href="http://www.igigo.net/about" title="关于我">关于我</a></li></ul></div>
	</div>
	<div id="search">
		<form id="searchform" method="get" action="http://www.igigo.net/">
<input type="text" value="站内搜索" onfocus="if (this.value == '站内搜索') {this.value = '';}" onblur="if (this.value == '') {this.value = '站内搜索';}" size="35" maxlength="50" name="s" id="s" />
<input type="submit" id="searchsubmit" value="" />
</form>	</div>
</div>
<div id="wrapper">
	<div id="header">
		<h1><a href="http://www.igigo.net">IGI&#039;s Blog</a></h1>
		<h2></h2>
		<div class="clear"></div>
				<div id="rss"><a href="http://www.igigo.net/feed" rel="nofollow" title="RSS 订阅">RSS 订阅</a></div>
					</div>
<hr />
<div id="content">
	
<!-- Start Of Script Generated By WP-PostViews Plus -->
<script type='text/javascript' src='http://www.igigo.net/wp-includes/js/jquery/jquery.js?ver=1.4.2'></script>
<script type="text/javascript">
/* <![CDATA[ */
/* ]]> */
</script>
<!-- End Of Script Generated By WP-PostViews Plus -->
	<div class="post-231 post type-post hentry category-kernel tag-irq-affinity tag-kernel-2 tag-linux post-single" id="post-231"><!-- post div -->
		<h2 class="title title-single">Linux SMP IRQ Affinity</h2>
		<div class="post-info-top">
			<span class="post-info-date">作者: igi 日期: 2012/05/31 </span>
			<span id="addcomment"><a href="#respond"  rel="nofollow" title="Leave a comment ?">发表评论</a> (3)</span>
			<span id="gotocomments"><a href="#comments"  rel="nofollow" title="Go to comments ?">查看评论</a></span>
		</div>
		<div class="clear"></div>
		<div class="entry">
			<h1>SMP IRQ affinity</h1>
<p>Linux 2.4内核之后引入了将特定中断绑定到指定的CPU的技术，称为SMP IRQ affinity. </p>
<h2>原理</h2>
<p>当一个硬件(如磁盘控制器或者以太网卡), 需要打断CPU的工作时, 它就触发一个中断. 该中断通知CPU发生了某些事情并且CPU应该放下当前的工作去处理这个事情. 为了防止多个设置发送相同的中断, Linux设计了一套中断请求系统, 使得计算机系统中的每个设备被分配了各自的中断号, 以确保它的中断请求的唯一性. 从2.4 内核开始, Linux改进了分配特定中断到指定的处理器(或处理器组)的功能. 这被称为SMP IRQ affinity, 它可以控制系统如何响应各种硬件事件. 允许你限制或者重新分配服务器的工作负载, 从而让服务器更有效的工作. 以网卡中断为例，在没有设置SMP IRQ affinity时， 所有网卡中断都关联到CPU0, 这导致了CPU0负载过高，而无法有效快速的处理网络数据包，导致了瓶颈。 通过SMP IRQ affinity， 把网卡多个中断分配到多个CPU上，可以分散CPU压力，提高数据处理速度。</p>
<ul>
<li>不使用SMP IRQ affinity</li>
<p><a href="http://www.igigo.net/wp-content/uploads/2012/05/IRQ-affintiy1.png"><img src="http://www.igigo.net/wp-content/uploads/2012/05/IRQ-affintiy1.png" alt="" title="IRQ-affintiy1" width="550" class="aligncenter size-full wp-image-232" /></a></p>
<li>使用SMP IRQ affinity</li>
<p><a href="http://www.igigo.net/wp-content/uploads/2012/05/IRQ-affintiy2.png"><img src="http://www.igigo.net/wp-content/uploads/2012/05/IRQ-affintiy2.png" alt="" title="IRQ-affintiy2" width="550" class="aligncenter size-full wp-image-233" /></a>
</ul>
<h2>使用前提</h2>
<ul>
<li>需要多CPU的系统</li>
<li>需要大于等于2.4的Linux 内核</li>
</ul>
<h2>相关设置文件</h2>
<h4>1. /proc/irq/IRQ#/smp_affinity</h4>
<ul>
<li>/proc/irq/IRQ#/smp_affinity 和 /proc/irq/IRQ#/smp_affinity_list 指定了哪些CPU能够关联到一个给定的IRQ源. 这两个文件包含了这些指定cpu的cpu位掩码(smp_affinity)和cpu列表(smp_affinity_list). 不允许关闭所有CPU， 同时如果IRQ控制器不支持中断请求亲和(IRQ affinity)，则这些设置的值将保持不变(既关联到所有CPU). 设置方法如下</li>
<pre class="brush: bash; title: ;" title="">
echo $bitmask &gt; /proc/irq/IRQ#/smp_affinity
</pre>
<li>示例(把44号中断绑定到前4个CPU(CPU0-3)上面)</li>
<pre class="brush: bash; title: ;" title="">
echo f &gt; /proc/irq/44/smp_affinity
</pre>
</ul>
<h4>2. /proc/irq/IRQ#/smp_affinity_list</h4>
<ul>
<li>设置该文件取得的效果与/proc/irq/IRQ#/smp_affinity是一致的，它们两者是联动关系(既设置其中之一，另一个文件也随着改变), 有些系统可能没有该文件, 设置方法如下</li>
<pre class="brush: bash; title: ;" title="">
echo $cpuindex1-$cpuindex2 &gt;/proc/irq/IRQ#/smp_affinity_list
</pre>
<li>示例(把44号中断绑定到前4个CPU(CPU0-3)上面)</li>
<pre class="brush: bash; title: ;" title="">
echo 0-3 &gt; /proc/irq/44/smp_affinity_list
</pre>
</ul>
<h4>3. /proc/irq/default_smp_affinity</h4>
<ul>
<li>/proc/irq/default_smp_affinity 指定了默认情况下未激活的IRQ的中断亲和掩码(affinity mask).一旦IRQ被激活，它将被设置为默认的设置(即default_smp_affinity中记录的设置). 该文件能被修改. 默认设置是0xffffffff.</li>
</ul>
<h2>bitmask计算方法</h2>
<p>首先我们来看看smp_affinity文件的内容</p>
<pre class="brush: bash; title: ;" title="">
root@hostname:/home/igi# cat /proc/irq/76/smp_affinity
ffffff
</pre>
<p>这个bitmask表示了76号中断将被路由到哪个指定处理器. bit mask转换成二进制后，其中的每一位代表了一个CPU. smp_affinity文件中的数值以十六进制显示。为了操作该文件，在设置之前我们需要把CPU位掩码从二进制转换到十六进制。<br />
<br />
上面例子中每一个”f”代表了4个CPU的集合，最靠右边的值是最低位的意思。 以4个CPU的系统为例:</p>
<ul>
<li>“f” 是十六进制的值， 二进制是”1111”. 二进制中的每个位代表了服务器上的每个CPU. 那么能用以下方法表示每个CPU</li>
<pre>
           二进制  十六进制
   CPU 0   0001    1
   CPU 1   0010    2
   CPU 2   0100    4
   CPU 3   1000    8
</pre>
<li>结合这些位掩码(简单来说就是直接对十六进制值做加法), 我们就能一次定位多个CPU。 例如， 我想同时表示CPU0和CPU2, bitmask结果就是:</li>
<pre>
           二进制       十六进制
   CPU 0    0001         1
 + CPU 2    0100         4
   -----------------------
   bitmask  0101         5
</pre>
<li>如果我想一次性表示所有4个CPU，bitmask结果是:</li>
<pre>
           二进制       十六进制
   CPU 0    0001         1
   CPU 1    0010         2
   CPU 2    0100         4
 + CPU 3    1000         8
   -----------------------
   bitmask  1111         f
</pre>
<p>
假如有一个4个CPU的系统， 我们能给一个IRQ分配15种不同的CPU组合(实际上有16种，但我们不能给任何中断分配中断亲和为”0”的值， 即使你这么做，系统也会忽略你的做法)
</ul>
<h2>对比测试</h2>
<table class='inline'>
<tr class='row0'>
<th class='col0 centeralign'>  类别  </th>
<th class='col1 centeralign'>  测试客户端  </th>
<th class='col2 centeralign'>  测试服务端  </th>
</tr>
<tr class='row1'>
<td class='col0 centeralign'>  型号  </td>
<td class='col1 centeralign'>  BladeCenter HS22  </td>
<td class='col2 centeralign'>  BladeCenter HS22  </td>
</tr>
<tr class='row2'>
<td class='col0 centeralign'>  CPU  </td>
<td class='col1 centeralign'>  Xeon E5640  </td>
<td class='col2 centeralign'>  Xeon E5640  </td>
</tr>
<tr class='row3'>
<td class='col0 centeralign'>  网卡  </td>
<td class='col1 centeralign'>  Broadcom NetXtreme II BCM5709S Gigabit Ethernet  </td>
<td class='col2 centeralign'>  Broadcom NetXtreme II BCM5709S Gigabit Ethernet  </td>
</tr>
<tr class='row4'>
<td class='col0 centeralign'>  内核  </td>
<td class='col1 centeralign'>  2.6.38-2-686-bigmem  </td>
<td class='col2 centeralign'>  2.6.38-2-686-bigmem  </td>
</tr>
<tr class='row5'>
<td class='col0 centeralign'>  内存  </td>
<td class='col1 centeralign'>  24GB  </td>
<td class='col2 centeralign'>  24GB  </td>
</tr>
<tr class='row6'>
<td class='col0 centeralign'>  系统  </td>
<td class='col1 centeralign'>  Debian 6.0.3  </td>
<td class='col2 centeralign'>  Debian 6.0.3  </td>
</tr>
<tr class='row7'>
<td class='col0 centeralign'>  驱动  </td>
<td class='col1 centeralign'>  bnx2  </td>
<td class='col2 centeralign'>  bnx2  </td>
</tr>
</table>
<ol>
<li>客户端: netperf</li>
<li>服务端: netserver</li>
<li>测试分类: 不开启IRQ affinity和RPS/RFS, 单独开启IRQ affinity, 单独开启RPS/RFS，同时开启IRQ affinity和RPS/RFS, 不同分类设置值如下</li>
</ol>
<ol>
<li>不开启IRQ affinity和RPS/RFS</li>
<pre>
/proc/irq/74/smp_affinity 00ffff
/proc/irq/75/smp_affinity 00ffff
/proc/irq/76/smp_affinity 00ffff
/proc/irq/77/smp_affinity 00ffff
/proc/irq/78/smp_affinity 00ffff
/proc/irq/79/smp_affinity 00ffff
/proc/irq/80/smp_affinity 00ffff
/proc/irq/81/smp_affinity 00ffff

/sys/class/net/eth0/queues/rx-0/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-1/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-2/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-3/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-4/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-5/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-6/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-7/rps_cpus 00000000

/sys/class/net/eth0/queues/rx-0/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-1/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-2/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-3/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-4/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-5/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-6/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-7/rps_flow_cnt 0

/proc/sys/net/core/rps_sock_flow_entries 0
</pre>
<li>单独开启IRQ affinity</li>
<pre>
/proc/irq/74/smp_affinity 000001
/proc/irq/75/smp_affinity 000002
/proc/irq/76/smp_affinity 000004
/proc/irq/77/smp_affinity 000008
/proc/irq/78/smp_affinity 000010
/proc/irq/79/smp_affinity 000020
/proc/irq/80/smp_affinity 000040
/proc/irq/81/smp_affinity 000080

/sys/class/net/eth0/queues/rx-0/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-1/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-2/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-3/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-4/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-5/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-6/rps_cpus 00000000
/sys/class/net/eth0/queues/rx-7/rps_cpus 00000000

/sys/class/net/eth0/queues/rx-0/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-1/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-2/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-3/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-4/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-5/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-6/rps_flow_cnt 0
/sys/class/net/eth0/queues/rx-7/rps_flow_cnt 0

/proc/sys/net/core/rps_sock_flow_entries 0
</pre>
<li>单独开启RPS/RFS</li>
<pre>
/proc/irq/74/smp_affinity 00ffff
/proc/irq/75/smp_affinity 00ffff
/proc/irq/76/smp_affinity 00ffff
/proc/irq/77/smp_affinity 00ffff
/proc/irq/78/smp_affinity 00ffff
/proc/irq/79/smp_affinity 00ffff
/proc/irq/80/smp_affinity 00ffff
/proc/irq/81/smp_affinity 00ffff

/sys/class/net/eth0/queues/rx-0/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-1/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-2/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-3/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-4/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-5/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-6/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-7/rps_cpus 0000ffff

/sys/class/net/eth0/queues/rx-0/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-1/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-2/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-3/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-4/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-5/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-6/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-7/rps_flow_cnt 4096

/proc/sys/net/core/rps_sock_flow_entries 32768
</pre>
<li>同时开启IRQ affinity和RPS/RFS</li>
<pre>
/proc/irq/74/smp_affinity 000001
/proc/irq/75/smp_affinity 000002
/proc/irq/76/smp_affinity 000004
/proc/irq/77/smp_affinity 000008
/proc/irq/78/smp_affinity 000010
/proc/irq/79/smp_affinity 000020
/proc/irq/80/smp_affinity 000040
/proc/irq/81/smp_affinity 000080

/sys/class/net/eth0/queues/rx-0/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-1/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-2/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-3/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-4/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-5/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-6/rps_cpus 0000ffff
/sys/class/net/eth0/queues/rx-7/rps_cpus 0000ffff

/sys/class/net/eth0/queues/rx-0/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-1/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-2/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-3/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-4/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-5/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-6/rps_flow_cnt 4096
/sys/class/net/eth0/queues/rx-7/rps_flow_cnt 4096

/proc/sys/net/core/rps_sock_flow_entries 32768
</pre>
</ol>
<p>
测试方法: 每种测试类型执行3次，中间睡眠10秒, 每种测试类型分别执行100、500、1500个实例， 每实例测试时间长度为60秒</p>
<ol>
<li>TCP_RR 1 byte: 测试TCP 小数据包 request/response的性能</li>
<pre class="brush: bash; title: ;" title="">
netperf -t TCP_RR -H $serverip -c -C -l 60
</pre>
<li>UDP_RR 1 byte: 测试UDP 小数据包 request/response的性能</li>
<pre class="brush: bash; title: ;" title="">
netperf -t UDP_RR -H $serverip -c -C -l 60
</pre>
<li>TCP_RR 256 byte: 测试TCP 大数据包 request/response的性能</li>
<pre class="brush: bash; title: ;" title="">
netperf -t TCP_RR -H $serverip -c -C -l 60 -- -r256,256
</pre>
<li>UDP_RR 256 byte: 测试UDP 大数据包 request/response的性能</li>
<pre class="brush: bash; title: ;" title="">
netperf -t UDP_RR -H $serverip -c -C -l 60 -- -r256,256
</pre>
</ol>
<h2>测试结果</h2>
<ol>
<li>TCP_RR 1 byte小包测试</li>
<p><a href="http://www.igigo.net/wp-content/uploads/2012/05/image0011.png"><img src="http://www.igigo.net/wp-content/uploads/2012/05/image0011.png" alt="" title="image001" width="550" class="alignleft size-full wp-image-234" /></a>    </p>
<li>TCP_RR 256 byte大包测试</li>
<p><a href="http://www.igigo.net/wp-content/uploads/2012/05/image0091.png"><img src="http://www.igigo.net/wp-content/uploads/2012/05/image0091.png" alt="" title="image009" width="550" class="alignleft size-full wp-image-235" /></a></p>
<li>UDP_RR 1 byte小包测试</li>
<p><a href="http://www.igigo.net/wp-content/uploads/2012/05/image0051.png"><img src="http://www.igigo.net/wp-content/uploads/2012/05/image0051.png" alt="" title="image005" width="550" class="alignleft size-full wp-image-236" /></a></p>
<li>UDP_RR 256 byte大包测试</li>
<p><a href="http://www.igigo.net/wp-content/uploads/2012/05/image0131.png"><img src="http://www.igigo.net/wp-content/uploads/2012/05/image0131.png" alt="" title="image013" width="550" class="alignleft size-full wp-image-237" /></a>
</ol>
<p></p>
<h2>CPU核负载的变化</h2>
<p>以小数据包1500进程测试的CPU(除了明确指明类型，否则这里的负载都是TCP_RR测试的负载)负载数据为示例</p>
<ul>
<li>不开启IRQ affinity和RPS/RFS： 软中断集中在第一个CPU上，导致了性能瓶颈</li>
<pre>
Average:     CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest   %idle
Average:     all    2.15    0.00   11.35    0.00    0.00    5.66    0.00    0.00   80.84
Average:       0    0.12    0.00    0.65    0.00    0.00   90.86    0.00    0.00    8.38
Average:       1    8.36    0.00   37.46    0.00    0.00    0.00    0.00    0.00   54.19
Average:       2    7.92    0.00   32.94    0.00    0.00    0.00    0.00    0.00   59.13
Average:       3    5.68    0.00   23.96    0.00    0.00    0.00    0.00    0.00   70.36
Average:       4    0.78    0.00    9.77    0.07    0.00    0.00    0.00    0.00   89.39
Average:       5    0.67    0.00    8.87    0.00    0.00    0.00    0.00    0.00   90.47
Average:       6    0.77    0.00    6.91    0.00    0.00    0.00    0.00    0.00   92.32
Average:       7    0.50    0.00    5.55    0.02    0.00    0.00    0.00    0.00   93.93
Average:       8    7.29    0.00   37.16    0.00    0.00    0.00    0.00    0.00   55.55
Average:       9    0.35    0.00    2.28    0.00    0.00    0.00    0.00    0.00   97.37
Average:      10    0.27    0.00    2.01    0.00    0.00    0.00    0.00    0.00   97.72
Average:      11    0.25    0.00    1.87    0.00    0.00    0.00    0.00    0.00   97.88
Average:      12    0.23    0.00    2.78    0.00    0.00    0.00    0.00    0.00   96.99
Average:      13    0.27    0.00    2.70    0.00    0.00    0.00    0.00    0.00   97.04
Average:      14    0.55    0.00    3.03    0.02    0.00    0.00    0.00    0.00   96.40
Average:      15    0.10    0.00    2.16    0.00    0.00    0.00    0.00    0.00   97.74
</pre>
<li>单独开启RPS/RFS: 软中断主要集中在CPU0上，但有少许分布在其他CPU上</li>
<pre>
Average:     CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest   %idle
Average:     all    4.65    0.00   34.71    0.01    0.00    7.37    0.00    0.00   53.26
Average:       0    0.02    0.00    0.37    0.00    0.00   99.40    0.00    0.00    0.22
Average:       1    5.60    0.00   38.33    0.02    0.00    2.02    0.00    0.00   54.04
Average:       2    5.57    0.00   37.33    0.03    0.00    1.01    0.00    0.00   56.05
Average:       3    5.11    0.00   36.28    0.00    0.00    0.73    0.00    0.00   57.88
Average:       4    4.78    0.00   37.16    0.00    0.00    2.05    0.00    0.00   56.01
Average:       5    4.45    0.00   37.46    0.00    0.00    0.97    0.00    0.00   57.12
Average:       6    4.34    0.00   36.25    0.00    0.00    0.97    0.00    0.00   58.45
Average:       7    4.28    0.00   35.87    0.00    0.00    0.97    0.00    0.00   58.88
Average:       8    5.47    0.00   37.11    0.02    0.00    1.27    0.00    0.00   56.13
Average:       9    5.58    0.00   37.59    0.03    0.00    2.13    0.00    0.00   54.66
Average:      10    5.98    0.00   37.04    0.00    0.00    1.22    0.00    0.00   55.76
Average:      11    4.99    0.00   34.58    0.00    0.00    0.99    0.00    0.00   59.44
Average:      12    4.46    0.00   37.47    0.00    0.00    0.99    0.00    0.00   57.09
Average:      13    4.83    0.00   36.97    0.00    0.00    1.37    0.00    0.00   56.83
Average:      14    4.60    0.00   38.06    0.00    0.00    1.53    0.00    0.00   55.81
Average:      15    4.36    0.00   37.26    0.00    0.00    1.45    0.00    0.00   56.92
</pre>
<li>单独开启IRQ affinity, TCP_RR测试: 软中断负载比较均匀的分散到前面8个CPU之上(与bitmask设置一致)</li>
<pre>
Average:     CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest   %idle
Average:     all    6.13    0.00   55.66    0.00    0.00   32.04    0.00    0.00    6.17
Average:       0    6.31    0.00   54.49    0.03    0.00    4.19    0.00    0.00   34.98
Average:       1    2.00    0.00   16.65    0.00    0.00   81.35    0.00    0.00    0.00
Average:       2    3.31    0.00   29.36    0.00    0.00   64.58    0.00    0.00    2.76
Average:       3    2.91    0.00   23.11    0.00    0.00   71.40    0.00    0.00    2.58
Average:       4    2.48    0.00   20.82    0.00    0.00   75.30    0.00    0.00    1.40
Average:       5    2.49    0.00   21.90    0.00    0.00   73.30    0.00    0.00    2.31
Average:       6    3.00    0.00   28.87    0.00    0.00   65.96    0.00    0.00    2.17
Average:       7    2.58    0.00   22.95    0.00    0.00   72.46    0.00    0.00    2.01
Average:       8    6.61    0.00   56.48    0.00    0.00    0.00    0.00    0.00   36.90
Average:       9    9.83    0.00   89.28    0.00    0.00    0.05    0.00    0.00    0.83
Average:      10    9.73    0.00   87.18    0.00    0.00    0.00    0.00    0.00    3.08
Average:      11    9.73    0.00   88.08    0.00    0.00    0.05    0.00    0.00    2.14
Average:      12    9.11    0.00   88.71    0.00    0.00    0.05    0.00    0.00    2.12
Average:      13    9.43    0.00   89.53    0.00    0.00    0.03    0.00    0.00    1.00
Average:      14    9.38    0.00   87.58    0.00    0.00    0.03    0.00    0.00    3.00
Average:      15    9.53    0.00   88.97    0.00    0.00    0.07    0.00    0.00    1.43
</pre>
<li>单独开启IRQ affinity, UDP_RR测试: 软中断负载不能均匀的分散到前面8个CPU之上，主要分布在CPU2上，导致了瓶颈，性能下降(下降原因请见本文测试的局限性部分)</li>
<pre>
Average:     CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest   %idle
Average:     all    1.05    0.00    8.21    0.01    0.00    5.83    0.00    0.00   84.90
Average:       0    3.10    0.00   23.25    0.00    0.00    0.33    0.00    0.00   73.31
Average:       1    2.73    0.00   21.15    0.00    0.00    0.37    0.00    0.00   75.75
Average:       2    0.72    0.00    4.93    0.00    0.00   92.35    0.00    0.00    2.00
Average:       3    1.27    0.00    9.81    0.00    0.00    0.10    0.00    0.00   88.82
Average:       4    0.15    0.00    1.87    0.10    0.00    0.07    0.00    0.00   97.82
Average:       5    0.07    0.00    1.04    0.00    0.00    0.07    0.00    0.00   98.82
Average:       6    0.02    0.00    0.53    0.00    0.00    0.03    0.00    0.00   99.42
Average:       7    0.00    0.00    0.23    0.00    0.00    0.00    0.00    0.00   99.77
Average:       8    0.23    0.00    1.96    0.00    0.00    0.00    0.00    0.00   97.81
Average:       9    0.08    0.00    0.60    0.00    0.00    0.00    0.00    0.00   99.32
Average:      10    8.38    0.00   65.07    0.00    0.00    0.00    0.00    0.00   26.56
Average:      11    0.00    0.00    0.36    0.00    0.00    0.00    0.00    0.00   99.64
Average:      12    0.03    0.00    0.23    0.00    0.00    0.00    0.00    0.00   99.73
Average:      13    0.00    0.00    0.19    0.00    0.00    0.00    0.00    0.00   99.81
Average:      14    0.00    0.00    0.12    0.00    0.00    0.00    0.00    0.00   99.88
Average:      15    0.02    0.00    0.10    0.00    0.00    0.00    0.00    0.00   99.88
</pre>
<li>同时开启IRQ affinity和RPS/RFS: 软中断负载比较均匀的分散到各个CPU之上</li>
<pre>
Average:     CPU    %usr   %nice    %sys %iowait    %irq   %soft  %steal  %guest   %idle
Average:     all    6.27    0.00   53.65    0.00    0.00   32.33    0.00    0.00    7.74
Average:       0    7.05    0.00   59.70    0.00    0.00   26.18    0.00    0.00    7.07
Average:       1    5.44    0.00   43.33    0.00    0.00   44.54    0.00    0.00    6.69
Average:       2    5.49    0.00   43.06    0.00    0.00   43.38    0.00    0.00    8.07
Average:       3    5.48    0.00   44.90    0.00    0.00   42.94    0.00    0.00    6.67
Average:       4    4.74    0.00   43.27    0.00    0.00   45.14    0.00    0.00    6.85
Average:       5    4.83    0.00   41.90    0.00    0.00   46.74    0.00    0.00    6.53
Average:       6    5.04    0.00   44.73    0.00    0.00   43.68    0.00    0.00    6.56
Average:       7    4.85    0.00   44.68    0.00    0.00   45.22    0.00    0.00    5.25
Average:       8    7.60    0.00   61.50    0.02    0.00   22.79    0.00    0.00    8.08
Average:       9    7.40    0.00   61.31    0.00    0.00   22.92    0.00    0.00    8.37
Average:      10    7.74    0.00   60.62    0.00    0.00   22.64    0.00    0.00    9.00
Average:      11    8.22    0.00   61.02    0.00    0.00   22.13    0.00    0.00    8.63
Average:      12    6.53    0.00   62.42    0.00    0.00   22.09    0.00    0.00    8.97
Average:      13    6.68    0.00   62.75    0.00    0.00   22.13    0.00    0.00    8.43
Average:      14    6.62    0.00   62.41    0.00    0.00   22.69    0.00    0.00    8.28
Average:      15    6.64    0.00   60.66    0.00    0.00   22.38    0.00    0.00   10.32
</pre>
</ul>
<h2>结果分析</h2>
<h4>1. TCP_RR TPS小数据包性能</h4>
<ul>
<li>单独开启RPS/RFS分别提升60%,145%,200%(依次对应100进程，500进程，1500进程,下同)</li>
<li>单独开启IRQ affinity分别提升135%, 343%, 443%</li>
<li>同时开启RPS/RFS和IRQ affinity分别提升148%, 346%, 372%</li>
</ul>
<h4>2. TCP_RR TPS大数据包性能</h4>
<ul>
<li>单独开启RPS/RFS分别提升76%,77%,89%</li>
<li>单独开启IRQ affinity分别提升79%, 77%, 88%</li>
<li>同时开启RPS/RFS和IRQ affinity分别提升79%, 77%, 88%</li>
</ul>
<h4>3. UDP_RR TPS小数据包性能</h4>
<ul>
<li>单独开启RPS/RFS分别提升44%,103%,94%</li>
<li>单独开启IRQ affinity性能分别下降11%, 8%, 8% (这是此次测试的局限造成, 详细分析见: 测试的局限性)</li>
<li>同时开启RPS/RFS和IRQ affinity分别提升65%, 130%, 137%</li>
</ul>
<h4>4. UDP_RR TPS小数据包性能</h4>
<ul>
<li>单独开启RPS/RFS分别提升55%,53%,61%</li>
<li>单独开启IRQ affinity性能分别下降5%, 4%, 4%</li>
<li>同时开启RPS/RFS和IRQ affinity分别提升55%, 51%, 53%</li>
</ul>
<ol>
<li>TCP 小数据包应用上，单独开启IRQ affinity能获得最大的性能提升，随着进程数的增加，IRQ affinity的优势越加明显. </li>
<li>UDP 小数据包方面，由于此次测试的局限，无法真实体现实际应用中的单独开启IRQ affinity而获得的性能提升, 但用RPS/RFS配合IRQ affinity，也能获得大幅度的性能提升; </li>
<li>TCP 大数据包应用上，单独开启IRQ affinity性能提升没有小数据包那么显著，但也有接近80%的提升, 基本与单独开启RPS/RFS的性能持平， 根据实验的数据计算所得，此时网卡流量约为88MB，还没达到千兆网卡的极限。</li>
<li>UDP 大数据包应用上，也是同样受测试局限性的影响，无法真实体现实际应用中的单独开启IRQ affinity而获得的性能提升, 但用RPS/RFS配合IRQ affinity，也能获得大幅度的性能提升</li>
</ol>
<h2>测试的局限性</h2>
<p>对于UDP测试在IRQ affinity上性能的下降， 查阅了内核源码(drivers/net/bnx2.c)及资料, bnx2 网卡的RSS hash不支持对UDP的端口进行计算，从而导致单独启用IRQ affinity的时候(这时候由硬件进行hash计算), UDP的数据只被hash了IP地址而导致数据包的转发出现集中在某个CPU的现象. 这是此次测试的局限所在，由于测试只是一台服务器端及一台客户端，所有UDP的IP地址都相同，无法体现UDP性能在单独启用IRQ affinity的性能提升. 但RPS/RFS的hash计算不受硬件影响，故而能体现性能提升. 对于实际应用中，服务器与多台客户端交互的情形，应该不受bnx2的RSS hash影响(以上只是针对bnx2网卡的特定问题)</p>
<h2>相关对比测试</h2>
<p>  1. Linux内核 RPS/RFS功能详细测试分析: <a href="http://www.igigo.net/archives/204">http://www.igigo.net/archives/204</a></p>
<h2>参考资料</h2>
<ul>
<li><a href="http://www.kernel.org/doc/Documentation/IRQ-affinity.txt">IRQ affinity</a></li>
<li><a href="http://www.mjmwired.net/kernel/Documentation/networking/scaling.txt">Scaling in the Linux Networking Stack</a></li>
<li><a href="http://www.vpsee.com/2010/07/load-balancing-with-irq-smp-affinity/">Linux 多核下绑定硬件中断到不同 CPU（IRQ Affinity）</a></li>
<li><a href="http://www.vpsee.com/2010/07/smp-irq-affinity/">计算 SMP IRQ Affinity</a></li>
<li><a href="http://git.itanic.dy.fi/?p=linux-stable;a=commitdiff;h=fdc8541d693a04ba3d6c335dace19b8362ac4e83">bnx2 RSS hash</a></li>
<li><a href="http://msdn.microsoft.com/zh-cn/library/ff556942.aspx">Introduction to Receive-Side Scaling</a></li>
</ul>
			分页:		</div><!-- END entry -->
		<div class="add-info">
					</div>
		<div class="post-info-bottom">
			<span class="post-info-category"><a href="http://www.igigo.net/archives/category/kernel" title="查看 Kernel 的全部文章" rel="category tag">Kernel</a></span><span class="post-info-tags"><a href="http://www.igigo.net/archives/tag/irq-affinity" rel="tag">IRQ affinity</a>, <a href="http://www.igigo.net/archives/tag/kernel-2" rel="tag">kernel</a>, <a href="http://www.igigo.net/archives/tag/linux" rel="tag">linux</a></span>
		</div>
		<div id="nav-below">
			<div class="nav-previous"><a href="http://www.igigo.net/archives/204" rel="prev"><span class="meta-nav">&larr;</span> Linux内核 RPS/RFS功能详细测试分析</a></div>
			<div class="nav-next"><a href="http://www.igigo.net/archives/251" rel="next">MegaSAS RAID卡 BBU Learn Cycle周期的影响 <span class="meta-nav">&rarr;</span></a></div>
		</div><!-- #nav-below -->					
	</div><!-- END post -->
	<!-- You can start editing here. -->

				<div id="comments-div"><span id="comments-addcomment"><a href="#respond"  rel="nofollow" title="发表评论？">发表评论？</a></span><h2 id="comments">3 条评论。</h2></div>
			<ol class="commentlist" id="thecomments">
								</ol>
			<div class="navigation"></div>
	
	<script type="text/javascript" language="javascript">
	/* <![CDATA[ */
		function grin(tag) {
			var myField;
			tag = ' ' + tag + ' ';
			if (document.getElementById('comment') && document.getElementById('comment').type == 'textarea') {
				myField = document.getElementById('comment');
			} else {
				return false;
			}
			if (document.selection) {
				myField.focus();
				sel = document.selection.createRange();
				sel.text = tag;
				myField.focus();
			}
			else if (myField.selectionStart || myField.selectionStart == '0') {
				var startPos = myField.selectionStart;
				var endPos = myField.selectionEnd;
				var cursorPos = endPos;
				myField.value = myField.value.substring(0, startPos)
							  + tag
							  + myField.value.substring(endPos, myField.value.length);
				cursorPos += tag.length;
				myField.focus();
				myField.selectionStart = cursorPos;
				myField.selectionEnd = cursorPos;
			}
			else {
				myField.value += tag;
				myField.focus();
			}
		}
	/* ]]> */
	</script>
									<div id="respond">
				<h3 id="reply-title">发表评论 <small><a rel="nofollow" id="cancel-comment-reply-link" href="/archives/231#respond" style="display:none;"><small>取消回复</small></a></small></h3>
									<form action="http://www.igigo.net/wp-comments-post.php" method="post" id="commentform">
																										<p class="comment-form-author"><input id="author" name="author" type="text" value="" size="30" /> <label for="author"><small>昵称</small></label></p>
<p class="comment-form-email"><input id="email" name="email" type="text" value="" size="30" /> <label for="email">邮箱</label></p>
<p class="comment-form-url"><input id="url" name="url" type="text" value="" size="30" /> <label for="url">网址</label></p>
												<p class="smilies">
	<a href="javascript:grin(':?:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_question.gif" alt="" /></a>
	<a href="javascript:grin(':razz:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_razz.gif" alt="" /></a>
	<a href="javascript:grin(':sad:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_sad.gif" alt="" /></a>
	<a href="javascript:grin(':evil:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_evil.gif" alt="" /></a>
	<a href="javascript:grin(':!:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_exclaim.gif" alt="" /></a>
	<a href="javascript:grin(':smile:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_smile.gif" alt="" /></a>
	<a href="javascript:grin(':oops:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_redface.gif" alt="" /></a>
	<a href="javascript:grin(':grin:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_biggrin.gif" alt="" /></a>
	<a href="javascript:grin(':eek:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_surprised.gif" alt="" /></a>
	<a href="javascript:grin(':shock:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_eek.gif" alt="" /></a>
	<a href="javascript:grin(':???:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_confused.gif" alt="" /></a>
	<a href="javascript:grin(':cool:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_cool.gif" alt="" /></a>
	<a href="javascript:grin(':lol:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_lol.gif" alt="" /></a>
	<a href="javascript:grin(':mad:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_mad.gif" alt="" /></a>
	<a href="javascript:grin(':twisted:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_twisted.gif" alt="" /></a>
	<a href="javascript:grin(':roll:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_rolleyes.gif" alt="" /></a>
	<a href="javascript:grin(':wink:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_wink.gif" alt="" /></a>
	<a href="javascript:grin(':idea:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_idea.gif" alt="" /></a>
	<a href="javascript:grin(':arrow:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_arrow.gif" alt="" /></a>
	<a href="javascript:grin(':neutral:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_neutral.gif" alt="" /></a>
	<a href="javascript:grin(':cry:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_cry.gif" alt="" /></a>
	<a href="javascript:grin(':mrgreen:')"><img src="http://www.igigo.net/wp-includes/images/smilies/icon_mrgreen.gif" alt="" /></a>
	<br /></p><p class="comment-form-comment"><textarea id="comment" name="comment" class="comment-textarea"></textarea></p>						<p class="comment-note">注意 - 你可以用以下 <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:<br /> <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="提交" />
							<input type='hidden' name='comment_post_ID' value='231' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="d5a5ab1a2a" /></p><p><input type="hidden" id="comment_reply_ID" name="comment_reply_ID" value="0" /><input type="hidden" id="comment_reply_dp" name="comment_reply_dp" value="0" /></p><div id="cancel_reply" style="display:none;"><a href="javascript:void(0)" onclick="movecfm(null,0,1,null);" style="color:red;">点击取消回复</a></div><script type="text/javascript">
/* <![CDATA[ */
var commentformid = "commentform";
var USERINFO = false;
var atreply = "none";
/* ]]> */
</script>
<script type="text/javascript" src="http://www.igigo.net/wp-content/plugins/wordpress-thread-comment/wp-thread-comment.js.php?jsver=common"></script>
					</form>
							</div><!-- #respond -->
						
			<div class="trackbacks-pingbacks">
			<h3>Trackbacks and Pingbacks:</h3>
			<ul id="pinglist">
								<li id="comment-1388">
					<a href='http://eleveni386.7axu.com/index.php/2013/04/25/%e7%bd%91%e5%8d%a1%e8%bd%af%e4%b8%ad%e6%96%ad%e7%bb%91%e5%ae%9a-%e7%bd%91%e5%8d%a1%e4%b8%ad%e6%96%ad%e4%ba%b2%e5%92%8c%e5%8a%9b/' rel='external nofollow' class='url'>网卡软中断绑定&#8211;网卡中断亲和力 | eleven.i386_blog</a> - Pingback on 2013/04/25/ 12:10				</li>
								<li id="comment-1417">
					<a href='http://blog.chunshengster.me/2013/05/smp_irq_affinity.html' rel='external nofollow' class='url'>SMP IRQ Affinity | 香草的技术博客</a> - Pingback on 2013/05/08/ 21:08				</li>
								<li id="comment-24032">
					<a href='http://huoding.com/2013/10/30/296' rel='external nofollow' class='url'>记录一个软中断问题 | 火丁笔记</a> - Pingback on 2013/10/30/ 16:20				</li>
							</ul>
		</div>
	</div><!--content-->
<div id="sidebar-border">
	<div id="sidebar">

		<div id="recent-posts-4" class="widget widget_recent_entries">		<h3 class="widgettitle">最近文章</h3>		<ul>
		
<!-- Start Of Script Generated By WP-PostViews Plus -->
<script type="text/javascript">
/* <![CDATA[ */
/* ]]> */
</script>
<!-- End Of Script Generated By WP-PostViews Plus -->
		<li><a href="http://www.igigo.net/archives/251" title="MegaSAS RAID卡 BBU Learn Cycle周期的影响">MegaSAS RAID卡 BBU Learn Cycle周期的影响</a></li>
				<li><a href="http://www.igigo.net/archives/231" title="Linux SMP IRQ Affinity">Linux SMP IRQ Affinity</a></li>
				<li><a href="http://www.igigo.net/archives/204" title="Linux内核 RPS/RFS功能详细测试分析">Linux内核 RPS/RFS功能详细测试分析</a></li>
				<li><a href="http://www.igigo.net/archives/199" title="Debian旧版本源同步脚本">Debian旧版本源同步脚本</a></li>
				<li><a href="http://www.igigo.net/archives/192" title="Debian在线升级dell服务器BIOS">Debian在线升级dell服务器BIOS</a></li>
				</ul>
		</div><div id="categories-4" class="widget widget_categories"><h3 class="widgettitle">分类目录</h3>		<ul>
	<li class="cat-item cat-item-29"><a href="http://www.igigo.net/archives/category/bash%e9%82%a3%e7%82%b9%e4%ba%8b" title="查看 bash那点事 下的所有文章">bash那点事</a> (3)
</li>
	<li class="cat-item cat-item-36"><a href="http://www.igigo.net/archives/category/kernel" title="查看 Kernel 下的所有文章">Kernel</a> (2)
</li>
	<li class="cat-item cat-item-3"><a href="http://www.igigo.net/archives/category/python" title="查看 python 下的所有文章">python</a> (1)
</li>
	<li class="cat-item cat-item-4"><a href="http://www.igigo.net/archives/category/shell" title="查看 shell 下的所有文章">shell</a> (5)
</li>
	<li class="cat-item cat-item-5"><a href="http://www.igigo.net/archives/category/%e5%b0%8f%e7%a0%b8%e7%a2%8e" title="查看 小砸碎 下的所有文章">小砸碎</a> (6)
</li>
	<li class="cat-item cat-item-6"><a href="http://www.igigo.net/archives/category/%e5%bc%80%e6%ba%90%e9%95%9c%e5%83%8f" title="查看 开源镜像 下的所有文章">开源镜像</a> (2)
</li>
	<li class="cat-item cat-item-7"><a href="http://www.igigo.net/archives/category/%e7%a1%ac%e4%bb%b6%e6%b5%8b%e8%af%95" title="查看 硬件测试 下的所有文章">硬件测试</a> (1)
</li>
	<li class="cat-item cat-item-8"><a href="http://www.igigo.net/archives/category/%e7%b3%bb%e7%bb%9f%e8%ae%be%e7%bd%ae" title="查看 系统设置 下的所有文章">系统设置</a> (1)
</li>
		</ul>
</div><div id="recent-comments-4" class="widget widget_recent_comments"><h3 class="widgettitle">近期评论</h3><ul id="recentcomments"><li class="recentcomments"><a href='http://www.eunotebook.com/uncategorized/nic-interrupt-optmization' rel='external nofollow' class='url'>网卡中断调优 | 精品笔记</a> 在 <a href="http://www.igigo.net/archives/204#comment-44841">Linux内核 RPS/RFS功能详细测试分析</a> 上的评论</li><li class="recentcomments"><a href='http://huoding.com/2013/10/30/296' rel='external nofollow' class='url'>记录一个软中断问题 | 火丁笔记</a> 在 <a href="http://www.igigo.net/archives/204#comment-24038">Linux内核 RPS/RFS功能详细测试分析</a> 上的评论</li><li class="recentcomments"><a href='http://huoding.com/2013/10/30/296' rel='external nofollow' class='url'>记录一个软中断问题 | 火丁笔记</a> 在 <a href="http://www.igigo.net/archives/231#comment-24032">Linux SMP IRQ Affinity</a> 上的评论</li><li class="recentcomments">十次 在 <a href="http://www.igigo.net/archives/79#comment-22693">bash重定向详解</a> 上的评论</li><li class="recentcomments">sky 在 <a href="http://www.igigo.net/archives/169#comment-4116">Dash与Bash的语法区别</a> 上的评论</li></ul></div><div id="linkcat-2" class="widget widget_links"><h3 class="widgettitle">链接表</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.dcshi.com/">DC的空间</a></li>
<li><a href="http://www.joecen.com/">Joecen的空间</a></li>
<li><a href="http://chenxiaosheng.com/">stutiredboy的空间</a></li>
<li><a href="http://www.hi-suke.com/blog/">vision的blog</a></li>
<li><a href="http://www.i5good.com" title="web集结号">web集结号</a></li>
<li><a href="http://blog.xiaket.org/">Xiaket的空间</a></li>
<li><a href="http://blog.ishutter.net/">丹丹的博客</a></li>
<li><a href="http://www.fatshen.com/">肥婶的空间</a></li>
<li><a href="http://blog.steamedfish.org/">蒸鱼的空间</a></li>
<li><a href="http://blog.flib.me/">超超的空间</a></li>

	</ul>
</div>
<div id="meta-3" class="widget widget_meta"><h3 class="widgettitle">功能</h3>			<ul>
						<li><a href="http://www.igigo.net/wp-login.php">登录</a></li>
			<li><a href="http://www.igigo.net/feed" title="使用 RSS 2.0 同步站点内容">文章 <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://www.igigo.net/comments/feed" title="使用 RSS 同步站点的近期评论">评论 <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://wordpress.org/" title="基于 WordPress，优美的个人信息发布平台。">WordPress.org</a></li>
						</ul>
</div>

	</div><!-- end: #sidebar -->
</div><!-- end: #sidebar-border --></div><!--wrapper-->
<div class="clear"></div>
<div id="footer">
	<div id="footer-inside">
		<p>
			版权所有&nbsp;&copy;&nbsp;2013&nbsp;IGI&#039;s Blog			&nbsp;|&nbsp;Powered by <a href="http://wordpress.org/">WordPress</a> 
			&nbsp;|&nbsp;Theme <a href="http://zww.me" title="designed by zwwooooo">zBench</a>
		</p>
		<span id="back-to-top">&Delta; <a href="#nav" rel="nofollow" title="Back to top">回到顶部</a></span>
	</div>
</div><!--footer-->
<script type='text/javascript' src='http://www.igigo.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.83b'></script>
<script type='text/javascript' src='http://www.igigo.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0.83b'></script>
<script type='text/javascript'>
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://www.igigo.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.83b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://www.igigo.net/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeRDark.css?ver=3.0.83b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '帮助';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = '无法找到Brush：';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush不能设置 html-script选项';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script>
</body>
</html>