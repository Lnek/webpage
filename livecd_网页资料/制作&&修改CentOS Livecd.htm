<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang='zh-CN' xml:lang='zh-CN' xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
  <meta http-equiv="Content-Language" content="zh-CN"/>
  <meta name="robots" content="index, follow" />
  <link rel="shortcut icon" type="image/x-icon" href="/img/favicon.ico" />
  <title>制作&&修改CentOS Livecd -  好脑袋和烂笔头 - 开源中国社区</title>
    <meta name="Keywords" content="centos,livecd"/>
      <meta name="Description" content="制作&&修改CentOS Livecd：      在centos中可以用kickstart进行装机自动化，也可以定制一些软件包，公司的需要的基础系统里面很..."/>
    <link rel="stylesheet/less" href="http://my.oschina.net/guol/styles.less?ver=20120408" type="text/css" media="screen" />
  <link rel="stylesheet" href="/js/2012/poshytip/tip-yellowsimple/tip-yellowsimple.css" type="text/css" />
  <link rel="stylesheet" type="text/css" href="/js/2011/fancybox/jquery.fancybox-1.3.4.css" media="screen" />
  <script type="text/javascript" src="/js/2012/jquery-1.7.1.min.js"></script>
  <script type="text/javascript" src="/js/2012/jquery.form.js"></script>
  <script type="text/javascript" src="/js/2011/fancybox/jquery.fancybox-1.3.4.pack.js"></script>
  <script type="text/javascript" src="/js/2012/poshytip/jquery.poshytip.min.js"></script>
  <script type="text/javascript" src="/js/2011/oschina.js"></script>
  <script type="text/javascript" src="/js/2012/less-1.3.0.min.js"></script>
  <link rel="alternate" type="application/rss+xml" title="guol的空间最新博客" href="http://my.oschina.net/guol/rss" />
  <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://my.oschina.net/action/xmlrpc/rsd?space=123777" />
  <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://my.oschina.net/action/xmlrpc/wlwmanifest?space=123777" /> 
  <style type="text/css">
    body,table,input,textarea,select {font-family:微软雅黑,Verdana,sans-serif,宋体;}	
  </style>
</head>
<body>
<div id="OSC_Screen">
	<div id='OSC_Banner'>
		<div id="OSC_Logo">
        	<a href="http://www.oschina.net/" title="开源中国社区首页">开源中国社区</a>
        </div>
        <div id='OSC_Slogon'>找到您想要的开源软件，分享和交流</div>
        <div id="OSC_Channels">
        	<ul>
        	<li><a href="http://www.oschina.net/project" class='project'>软件</a></li>
        	<li><a href="http://www.oschina.net/question" class='question'>讨论</a></li>
        	<li><a href="http://www.oschina.net/code/list" class='code'>代码</a></li>
        	<li><a href="http://www.oschina.net/news" class='news'>资讯</a></li>
        	<li><a href="http://www.oschina.net/blog" class='space'>博客</a></li>
        	<li><a href="http://www.oschina.net/android" class='space'>Android</a></li>
        	<li><a href="http://www.oschina.net/wp7" class='space'>WP7</a></li>
        	</ul>
        </div>
        <div class='clear'></div>
	</div>
	<div id="OSC_Topbar">
		<div id="VisitorInfo">
		当前访客身份：
				游客 [ <a href="http://www.oschina.net/home/login?goto_page=http%3A%2F%2Fmy.oschina.net%2Fguol">登录</a> | <a href="http://www.oschina.net/home/reg">加入开源中国</a> ]
				<span id="OSC_Notification">			
						<a href="http://www.oschina.net/home/login?goto_page=http%3A%2F%2Fmy.oschina.net%2Fguol" class="msgbox" title="进入我的留言箱">你有<em>0</em>新留言</a>			
								</span>
		</div>
		<div id="SearchBar">
    		<form action="http://www.oschina.net/search">
				<input type='hidden' name='user' value='123777'/>
																<span class="ipt f_l">
    			<input type='text' id='txt_q' name='q' class='SERACH' value='在 20212 款开源软件中搜索' onblur="(this.value=='')?this.value='在 20212 款开源软件中搜索':this.value" onfocus="if(this.value=='在 20212 款开源软件中搜索'){this.value='';};this.select();"/>
				</span>
				                <div class="search-by selectbox">
    				<span class="hide">
    				<select name='scope'>					
                        <option value='project' selected>软件</option>
                        <option value='code'>代码</option>
                        <option value='bbs'>讨论区</option>
                        <option value='news'>新闻</option>
                        <option value='blog'>博客</option>
    				</select>
    				</span>
                  <div class="search_on" id="search-item"><span class="text">软件</span></div>
                  <ul class="search_list">
                     <li class="search-item"><a href="#1">软件</a></li>
                     <li><a href="#2">代码</a></li>
                     <li><a href="#3">讨论区</a></li>
                     <li><a href="#4">新闻</a></li>
                     <li><a href="#5">博客</a></li>
                  </ul>
                </div>
				<input type='submit' value='搜索' class='bnt f_r'/>			
    		</form>
		</div>
		<div class='clear'></div>
	</div>
	<div id="OSC_Content">    


    		

<div id='SpaceLeft'>
<div class='Owner'>
	    <a href="http://my.oschina.net/guol" class='Img'><img src="/img/portrait.gif" align="absmiddle" alt="ThinkG" title="ThinkG" class="LargePortrait"/></a>
    <span class='U'>
        <a href="http://my.oschina.net/guol" class='Name' title='男'>ThinkG</a>
		<span class='opts'>
        			<a href="http://my.oschina.net/guol/admin/profile" class='Gender_1' id='gender_icon'></a>
						<script type='text/javascript'>
var nologin = "<a href='javascript:_follow_nologin()' title='成为TA的粉丝'>关注此人</a>"
var follow0 = "<a href='javascript:_follow_user(123777,true)' title='成为TA的粉丝'>关注此人</a>";
var follow1 = "已关注 | <a href='javascript:_follow_user(123777,false)' title='取消关注后，此人的更新信息将不会出现在你的首页'>取消</a>";
var follow2 = "互相关注 | <a href='javascript:_follow_user(123777,false)' title='取消关注后，此人的更新信息将不会出现在你的首页'>取消</a>";
var follow4 = "<a href='javascript:_follow_user(123777,true)' title='成为TA的粉丝'>+关注此人</a>";

document.write("<span id='_follow_123777_action_'>");
	document.write(nologin);
document.write("</span>");

function _follow_nologin(){
	if(confirm('必须登录后才能关注，是否现在登录？')){
		location.href="http://www.oschina.net/home/login?goto_page="+location.href;
	}
}

function _follow_user(uid, follow){
	var action = follow?"/action/user/follow":"/action/user/unfollow";
	ajax_post(action,"id="+uid,function(result){
		var act = $('#_follow_123777_action_');
		if(result == '0')
			_follow_nologin();
		else if(result == '1')
			act.html(follow0);
		else if(result == '2')
			act.html(follow1);
		else if(result == '3')
			act.html(follow2);
		else if(result == '4')
			act.html(follow4);
	});
}
</script>				</span>
    </span>
    <div class='clear'></div>
    <div class='stat'>
    	<a href="http://my.oschina.net/guol/fellow">关注(0)</a>
    	<a href="http://my.oschina.net/guol/fans">粉丝(1)</a>
    	<a href="http://www.oschina.net/question/3307_20931" title="查看OSCHINA积分规则">积分(20)</a>
    </div>
</div><style>
#MyResume textarea {width:170px;height:60px;font-size:9pt;}
</style>
<div class='Resume' id='MyResume'>
不XX就OO</div>

<div class='Opts clearfix'>
	<a href="javascript:sendmsg(123777, 0)" class='a1 sendmsg'><i>.</i><span>发送留言</span></a>
	<a href="http://www.oschina.net/question/ask?user=123777" class='a2 ask'><i>.</i><span>请教问题</span></a>
</div><div class="Mod" id="BlogCatalogs">
  <strong> 博客分类</strong>
  <ul>
	    	<li><a href="http://my.oschina.net/guol/blog?catalog=127584">系统管理</a><span>(12)</span></li>
		<li><a href="http://my.oschina.net/guol/blog?catalog=127587">操作系统</a><span>(0)</span></li>
		<li><a href="http://my.oschina.net/guol/blog?catalog=128812">学习笔记</a><span>(4)</span></li>
		<li><a href="http://my.oschina.net/guol/blog?catalog=129500">Linux 技巧</a><span>(10)</span></li>
		<li><a href="http://my.oschina.net/guol/blog?catalog=129501">Mysql</a><span>(0)</span></li>
		<li><a href="http://my.oschina.net/guol/blog?catalog=129502">存储</a><span>(0)</span></li>
		<li><a href="http://my.oschina.net/guol/blog?catalog=129509">kernel</a><span>(0)</span></li>
	  </ul>
</div><div class="Mod" id="HotBlogs">
  <strong>阅读排行</strong>
  <ol>
			<li><a href="http://my.oschina.net/guol/blog/36893">1. 制作&&修改CentOS Livecd</a></li>
				<li><a href="http://my.oschina.net/guol/blog/37302">2. Iozone 使用技巧</a></li>
				<li><a href="http://my.oschina.net/guol/blog/37373">3. GRUB2 </a></li>
				<li><a href="http://my.oschina.net/guol/blog/38032">4. 浅谈linux内存管理</a></li>
				<li><a href="http://my.oschina.net/guol/blog/39924">5. Openvpn的搭建</a></li>
				<li><a href="http://my.oschina.net/guol/blog/37303">6. Ext4 学习笔记</a></li>
				<li><a href="http://my.oschina.net/guol/blog/48543">7. TCP/IP 协议状态学习</a></li>
				<li><a href="http://my.oschina.net/guol/blog/39901">8. Linux PAM 之cracklib模块</a></li>
		  </ol>
</div>
<div class="Mod" id="BlogReplies">
  <strong> 最新评论</strong>  
      <ul>
		<li>
		<a href="http://my.oschina.net/openvpn">@疾风自由永恆</a>：leaned
		<a href="/action/tweet/go?obj=266302945&type=18&user=219217">查看&raquo;</a>
	</li>
		<li>
		<a href="http://my.oschina.net/u/137621">@ANDY卢磊</a>：前两天面试的时候问了三次握手，我硬是没有回答出...
		<a href="/action/tweet/go?obj=266276640&type=18&user=137621">查看&raquo;</a>
	</li>
		<li>
		<a href="http://my.oschina.net/meiyear">@丁杨帆</a>：留名保存。
		<a href="/action/tweet/go?obj=265732102&type=18&user=181505">查看&raquo;</a>
	</li>
	  </ul>
  </div><div class='Mod' id='Stat'>
<strong>访客统计</strong>
<ul>
	<li><label>今日访问：</label>4</li>
    <li><label>昨日访问：</label>17</li>
    <li><label>本周访问：</label>181</li>
    <li><label>本月访问：</label>635</li>
    <li><label>所有访问：</label>2535</li>
</ul>
</div></div>


<div class='SpaceList'>
	<div class='TopBar'>
    	<div class='NavPath'>		
    		<a href='http://my.oschina.net/guol'>空间</a> &raquo; <a href='http://my.oschina.net/guol/blog'>博客</a>			
			&raquo; <a href="http://my.oschina.net/guol/blog?catalog=127584">系统管理</a>
			&raquo; 博客正文
    	</div>
	</div>
	
    	<div class='BlogEntity'>		
      <div class='BlogTitle'>
        <h1>制作&&修改CentOS Livecd</h1>
        <div class='BlogStat'>
    		    		    	    <span class='admin'>
								<style>
#favor_form{width:200px;}
#favor_form p {color:#666;}
#favor_form form{height:60px;width:200px;}
#favor_form form ._favor_input{display:block;margin:2px 0;width:199px;}
#favor_form form ._favor_button{float:left;padding:2px 5px;}
.favor_ok {text-align:center;font-size:10.5pt;width:199px;height:60px;margin-top:10px;}
#TagsSwitcher{cursor:pointer;float:right;margin-top:10px;}
#MyTags{display:none;width:199px;}
#MyTags a.tag {float:left; background-color: #E0EAF1;border-bottom: 1px solid #3E6D8E;border-right: 1px solid #7F9FB6;color: #3E6D8E;font-size: 8pt;line-height: 16px;margin: 2px 2px 2px 0;padding: 2px 4px;text-decoration: none;white-space: nowrap;}
</style>
<script type='text/javascript'>
var favor_add = "<a href='javascript:add_to_favor(36893,3)' id='favor_trigger'>我要收藏</a>";
var favor_del = "<a href='javascript:delete_favor(36893,3)' id='favor_trigger' style='color:#a00;'>取消收藏</a>";
var favor_ok = "<p class='favor_ok'>已成功添加到收藏夹<br/><br/> <a href='null/favorites?type=3'>我的收藏夹</a> | <a href='javascript:close_favor()'>关闭</a></p>";
function delete_favor(obi_id, obj_type){
	$('#attention_it').html(favor_add);
	$("#p_attention_count").load("/action/favorite/cancel?type="+obj_type+"&id="+obi_id);
}
function add_to_favor(obj_id, obj_type){
	if(confirm('必须登录后才能收藏，是否现在登录？')){
		location.href="http://www.oschina.net/home/login?goto_page="+location.href;
	}
}
function close_favor(elem_id){
    $('#favor_trigger').poshytip('destroy');
}
function setTag(tv){
	var t = $("._favor_input");
	var value = t.val();
	if(value!="")
		t.val(value+","+tv);
	else
		t.val(tv)
}
</script>
<em id='p_attention_count'>0</em>人收藏此文章,
<span id='attention_it'>
	<script type='text/javascript'>document.write(favor_add);</script>
</span>			</span>
    		    		发表于4个月前 , 
    		已有<strong>541</strong>次阅读  
    		共<strong><a href="#comments">0</a></strong>个评论
    	</div> 
      </div>
	  <div class='BlogContent'><p>&nbsp; &nbsp; &nbsp; <span style="font-weight:normal;"><span style="color:#000000;font-size:14px;font-family:'Microsoft YaHei';">在centos中可以用kickstart</span><span style="font-family:Simsun;"><span style="font-size:14px;line-height:18px;color:#000000;font-family:'Microsoft YaHei';">进行装机自动化，也可以定制一些软件包，公司的需要的基础系统里面很多软件参数、选项、内核都经过优化，所以用</span></span><span style="color:#000000;font-size:14px;font-family:'Microsoft YaHei';">kickstart装起来虽然方便但是后期调整很麻烦，所以打算换种方法，思路如下：</span></span></p> 
<p><span style="font-weight:normal;"><span style="color:#000000;font-size:14px;font-family:'Microsoft YaHei';">&nbsp; &nbsp; 把经过优化的系统整体打包，做成一个原始的tar包，由于linux是文件系统，所以只要在新硬盘上划好分区好以后，解压打好的tar系统包就可以了，然后安装grub，这样一个系统就完成了，但是本人有点懒，分区，grub都不想自己动手，所以可以写个脚本自动执行。</span></span></p> 
<p><span style="font-weight:normal;"><span style="color:#000000;font-size:14px;font-family:'Microsoft YaHei';">&nbsp; &nbsp; 1 打包系统</span></span></p> 
<p></p> 
<p> </p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">tar czvfp Centos5_x86_64.tgz bin/ boot/ dev/ etc/ home/ lib/ lib64/ lost+found/ media/ mnt/ opt/ \
--exclude=proc/* proc/ root/ sbin/ selinux/ srv/ --exclude=tmp/* tmp/ usr/ var/ --exclude=sys/* sys/</pre> 
<p></p> 
<p> </p> 
<p></p> 
<p><span style="font-weight:normal;"><span style="color:#000000;font-size:14px;font-family:'Microsoft YaHei';">&nbsp; &nbsp;2 制作centos livecd</span></span></p> 
<p><span style="font-weight:normal;"><span style="color:#000000;font-size:14px;font-family:'Microsoft YaHei';">&nbsp; &nbsp; &nbsp;2.1 安装制作环境</span></span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;"> yum install livecd-tools syslinux anaconda-runtime</pre> 
<p> </p> 
<p><span style="font-weight:normal;"><span style="color:#000000;font-size:14px;font-family:'Microsoft YaHei';">&nbsp; &nbsp; &nbsp;2.2 编写</span></span><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">kickstart脚本</span><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; &nbsp; &nbsp;&nbsp;</span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">lang en_US.UTF-8
keyboard us
timezone US/Eastern
auth --useshadow --enablemd5
selinux --disabled
firewall --disabled

repo --name=a-base  --baseurl=http://mirrors.163.com/centos/5/os/$basearch/
repo --name=a-addons   --baseurl=http://mirrors.163.com/centos/5/addons/$basearch/
repo --name=a-extras   --baseurl=http://mirrors.163.com/centos/5/extras/$basearch/
repo --name=a-centosplus --baseurl=http://mirrors.163.com/centos/5/centosplus/$basearch/
repo --name=a-contrib  --baseurl=http://mirrors.163.com/centos/5/contrib/$basearch/
repo --name=a-live    --baseurl=http://www.nanotechnologies.qc.ca/propos/linux/centos-live/$basearch/live

%packages
bash
kernel
syslinux
passwd
policycoreutils
perl
chkconfig
authconfig
rootfiles
comps-extras
xkeyboard-config
grub
coreutils
parted</pre> 
<p> </p> 
<p></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; &nbsp; &nbsp;2.3 开始制作Livecd</span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">LANG=C livecd-creator --config=centos-livecd-minimal.ks --cache=/home/livecd/cache --tmpdir=/home/livecd/tmp \
--fslabel=CentOS-minimal</pre> 
<p></p> 
<span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;"><p> </p> </span> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; <span style="font-family:'Microsoft YaHei';">这一步完成后会在当前目录生成一个</span></span><span style="font-size:12px;line-height:21px;white-space:pre;font-family:'Microsoft YaHei';">CentOS-minimal.iso文件，</span><span style="font-size:12px;line-height:21px;white-space:pre;font-family:'Microsoft YaHei';">centos-livecd-minimal.ks是编写好的</span><span style="font-size:14px;line-height:21px;font-family:'Microsoft YaHei';">kickstart脚本，至此Livecd已经生成，接下来开始修改。</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; &nbsp;3 定制Livecd</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; &nbsp; &nbsp;3.1 安装工具</span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">yum install squashfs-tools</pre> 
<p> </p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; &nbsp; 或者使用</span><span style="font-size:14px;line-height:21px;white-space:pre;font-family:'Microsoft YaHei';">squashfs4版本，下载源码包后，进入</span><span style="font-size:14px;line-height:21px;white-space:pre;font-family:'Microsoft YaHei';">squashfs-tools目录，make&amp;&amp;make install 即可安装完成，</span></p> 
<p><span style="font-size:14px;line-height:21px;white-space:pre;font-family:'Microsoft YaHei';">默认命令安装在/usr/local/bin,</span><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;white-space:pre;">可以copy到/bin中。</span></p> 
<p><span style="font-family:'Courier New', Arial;font-size:12px;line-height:21px;white-space:pre;"> <span style="font-family:'Microsoft YaHei';font-size:14px;">3.2 挂载ISO镜像</span></span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">mkdir -p /home/livecd
mount -o loop -t iso9660 CentOS-minimal.iso /home/livecd</pre> 
<p></p> 
<p> </p> 
<p></p> 
<p>&nbsp; &nbsp; &nbsp; &nbsp;<span style="font-size:14px;"> 3.3 &nbsp;copy镜像</span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">mkdir -p /home/img
cp -R /home/livecd/* /home/img</pre> 
<p></p> 
<p> </p> 
<p><span style="font-size:14px;">&nbsp; &nbsp; &nbsp; &nbsp;3.4 &nbsp;解压squashfs.img&nbsp;</span></p> 
<p></p> 
<p></p> 
<p><span style="font-size:14px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 进入/home/img/LiveOS 目录，会看见</span><span style="font-size:14px;line-height:21px;">squashfs.img文件，</span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">unsquashfs squashfs.img</pre> 
<p> </p> 
<p></p> 
<p><span style="font-size:14px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;会产生squashfs-root目录，进入其子目录LiveOS中，会有一个ext3fs.img文件，挂载该文件</span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">mount -o loop,rw ext3fs.img /tmp</pre> 
<p> </p> 
<p><span style="font-size:14px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 在做完各种修改后，卸载该文件，重新回到/home/img/LiveOS目录，生成新的</span><span style="font-size:14px;line-height:21px;">squashfs.img文件</span></p> 
<p><span style="font-size:14px;line-height:21px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;我的需求是：修改rc.local文件，加入一系列划分分区、格式化、挂载、解压命令后，并把前面打的tar包传入/tmp的制定目录下，这样用livecd启动时会执行rc.local中的命令，这样等livecd完全启动后，宿主机的硬盘上就会有一个我们刚才打包好的系统了。</span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">mksquashfs squashfs-root squashfs.img</pre> 
<p> </p> 
<p><span style="font-size:14px;line-height:21px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;删除</span><span style="font-size:14px;line-height:21px;">squashfs-root目录，回到上级目录，生成新的ISO</span></p> 
<p></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">mkisofs -R -b isolinux/isolinux.bin -c isolinux/boot.cat -o /tmp/test.iso -V &quot;CentOS-minima&quot; \</pre>
<pre class="brush:shell; toolbar: true; auto-links: false;">-no-emul-boot -boot-load-size 4 -boot-info-table .</pre> 
<p></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; &nbsp; &nbsp;这样经过修改的镜像文件就会生成，刻入CD中，就可以自动装机了。</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; &nbsp; &nbsp;注：这只是适应我们部分小的需求，也没什么创新，google了几遍文档，糅杂在一起的。</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; &nbsp; &nbsp;相关参照：</span></p> 
<p><span style="font-family:'Microsoft YaHei';font-size:14px;line-height:21px;">&nbsp; &nbsp; &nbsp;<a href="https://projects.centos.org/trac/livecd/" target="_blank" rel="nofollow">https://projects.centos.org/trac/livecd/</a></span></p> 
<pre class="brush:shell; toolbar: true; auto-links: false;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</pre> 
<p> </p> 
<p></p></div>	  
      	        <div class='BlogTags'>
    	<strong>关键字：</strong>
    	    	<a href="http://www.oschina.net/search?scope=blog&q=centos" class="tag">centos</a>
    	    	<a href="http://www.oschina.net/search?scope=blog&q=livecd" class="tag">livecd</a>
    	    	      </div>
	  	  
      <div class='BlogCopyright'>		
	  		声明：OSCHINA 博客文章版权属于作者，受法律保护。未经作者同意不得转载。
	  	  </div>
      <div class='BlogLinks'>
    	<ul>
                        <li class='next'><a href="http://my.oschina.net/guol/blog/37166" title="下一篇：initrd.img、System.map学习札记">initrd.img、System.map学习札记 &raquo;</a></li>    	</ul>
      </div>
	</div>
	<div class='BlogShare'>
	<!-- JiaThis Button BEGIN -->
    <div id="jiathis_style_32x32">
    <a class="jiathis_button_tsina"></a>
    <a class="jiathis_button_tqq"></a>
    <a class="jiathis_button_kaixin001"></a>
    <a class="jiathis_button_renren"></a>
    <a class="jiathis_button_douban"></a>
    <a href="http://www.jiathis.com/share?uid=1567353" class="jiathis jiathis_txt jiathis_separator jtico jtico_jiathis" target="_blank"></a>
    <a class="jiathis_counter_style"></a>
    </div>
    <script type="text/javascript" >
    var jiathis_config={
    	data_track_clickback:true,
    	summary:"",
    	hideMore:false
    }
    </script>
    <script type="text/javascript" src="http://v2.jiathis.com/code/jia.js?uid=1567353" charset="utf-8"></script>
    <!-- JiaThis Button END -->
	<span id='BlogVote'>
    <a href="javascript:vote(36893)">顶</a><span>已有 <em id='vote_count'>0</em>人顶</span>
	</span>
	</div>
	</div>
<div class='SpaceList' style='margin-top:20px;'>
<div class='BlogComments'>
    <h2><a name="comments"></a>共有 0 条网友评论</h2>
			<p class='NoData'>尚无网友评论</p>
		<ul id="BlogComments">
		</ul>
</div>
	</div>

<div id='inline_reply_editor' style='display:none;'>
<div class="BlogCommentForm">
	<form id="form_inline_comment" action="/action/blog/add_comment?blog=36893" method="POST">
	  <input type='hidden' id='inline_reply_id' name='reply_id' value=''/>          
      <textarea name="content" style="width:550px;height:60px;" onkeydown="if(event.ctrlKey&&event.keyCode==13){$('#form_inline_comment').submit();}"></textarea><br/>
	  <input type="submit" value="回复" id="btn_comment" class="SUBMIT"/> 
	  <input type="button" value="关闭" class="SUBMIT" id='btn_close_inline_reply'/> 文明上网，理性发言
    </form>
</div>
</div>

<div class='SpaceList' style='margin-top:20px;'>
  <a name="postform" id="postform"></a>
    <div class="BlogCommentForm">
    <form id="form_comment" action="/action/blog/add_comment?blog=36893" method="POST">          
      <textarea id='ta_post_content' name="content" style="width:550px;height:100px;" onkeydown="if(event.ctrlKey&&event.keyCode==13){$('#form_comment').submit();}"></textarea><br/>
	  <input type="submit" value="发表评论" id="btn_comment" class="SUBMIT" /> 
	  <img id="submiting" style="display:none" src="/img/loading.gif" align="absmiddle"/>
	  <span id='cmt_tip'>文明上网，理性发言</span>
    </form>
	<a href="#" class="more">回到页首</a>&nbsp;|&nbsp;<a href="#comments" class="more">回到评论列表</a>
  </div>
  </div>
	
<div id="RelativeBlogs">
	<strong><a id='btn_close'>关闭</a>相关文章阅读</strong>
	<ul>
			<li>
		<span class='date'>2011/10/24</span>
		<a href="http://my.oschina.net/aiguozhe/blog/33824" title="CentOS 5.5（5.x）设置网络、PPPOE、软件源">CentOS 5.5（5.x）设置网络、PPPOE...</a>
	</li>
				<li>
		<span class='date'>2012/04/19</span>
		<a href="http://my.oschina.net/thon/blog/54318" title="CentOS服务配置——more repositorys">CentOS服务配置——more repository...</a>
	</li>
				<li>
		<span class='date'>2011/10/24</span>
		<a href="http://my.oschina.net/aiguozhe/blog/33826" title="CentOS笔记：yum使用说明">CentOS笔记：yum使用说明</a>
	</li>
				<li>
		<span class='date'>2012/01/03</span>
		<a href="http://my.oschina.net/opaljc/blog/38472" title="centos 的关机命令">centos 的关机命令</a>
	</li>
				<li>
		<span class='date'>2011/08/29</span>
		<a href="http://my.oschina.net/u/159894/blog/30478" title="CentOS磁盘配额">CentOS磁盘配额</a>
	</li>
			</ul>
</div>
<script type="text/javascript" src="/action/visit/blog?id=36893" defer="defer"></script>
<script type="text/javascript" src="/js/syntax-highlighter-2.1.382/scripts/brush.js"></script>
<link type="text/css" rel="stylesheet" href="/js/syntax-highlighter-2.1.382/styles/shCore.css"/>
<link type="text/css" rel="stylesheet" href="/js/syntax-highlighter-2.1.382/styles/shThemeDefault.css"/>
<script type='text/javascript'><!--
$(document).ready(function(){
	SyntaxHighlighter.config.clipboardSwf = '/js/syntax-highlighter-2.1.382/scripts/clipboard.swf';
	SyntaxHighlighter.all();
});
//-->
</script>
<!--[if lt IE 7]>
<script type="text/javascript" src="/js/minmax.js"></script>
<![endif]-->
<script type='text/javascript'>
<!--
var posting = false;
var upprev_closed = false;
var upprev_hidden = true;

$(document).ready(function(){
	$('#form_comment').ajaxForm({
		dataType: 'json',
		bforeSubmit: function(){
			posting = true;
		},
		success: function(json) {
        	if(json.msg){
				///alert(json.msg);
				$('#cmt_tip').html("<span style='color:#C00;'>"+json.msg+"</span>");
				$('#ta_post_content').focus();				
			}else{
				var url = "http://my.oschina.net/guol/blog_post?_cmt_blog="+json.blog+"&_cmt_user="+json.user+"&_cmt_id="+json.id;				
        		jQuery.get(url, function(data){
    				$('.BlogComments .NoData').hide();
        			$('ul#BlogComments').append(data);
        			$('#form_comment').resetForm();
        		}); 
			}
		}
	});	
	$("#submiting").ajaxStart(function(){
	   if(posting){
    	   $('#btn_submit').attr("disabled","disabled");
           $(this).show();
	   }
    });
	$("#submiting").ajaxComplete(function(event,request, settings){
	   if(posting){
           $(this).hide();
    	   $('#btn_submit').attr("disabled","");
	   }
	   posting = false;
    }); 
	
    $(window).scroll(function() {
        var lastScreen;
        if ($("#postform").length > 0)
            lastScreen = getScrollY() + $(window).height() < $("#postform").offset().top * 1 ? false : true;
        else
            lastScreen = getScrollY() + $(window).height() < $(document).height() * 1 ? false : true;
        if (lastScreen && !upprev_closed) {
            $("#RelativeBlogs").stop().animate({right:"0px"});
            upprev_hidden = false;
        }
        else if (upprev_closed && getScrollY() == 0) {
            upprev_closed = false;
        }
        else if (!upprev_hidden) {
            upprev_hidden = true;
            $("#RelativeBlogs").stop().animate({right:"-400px"});
        }
    });
    $("#RelativeBlogs #btn_close").click(function() {
        $("#RelativeBlogs").stop().animate({right:"-400px"});
        upprev_closed = true;
        upprev_hidden = true;
    });
});
function delete_c(nid,uid,cid){
  if(confirm("您确认要删除此篇评论？")){
    var args = "cmt="+cid+"#"+uid+"#"+nid;
    ajax_post("/action/blog/delete_blog_comments?space=123777",args,function(){$("#cmt_"+nid+"_"+uid+"_"+cid).fadeOut();});
  }
}
function ReplyInline(blog,user,reply){
	$('.inline_reply').empty();
	var div_id = '#inline_reply_of_'+blog+'_'+user+'_'+reply;
	$('#inline_reply_id').val(user+'_'+reply);
	$(div_id).html($('#inline_reply_editor').html());
	$('#txt_focus').focus();
	$('#btn_close_inline_reply').click(function(){
		$(div_id).empty();
	});
	$('#form_inline_comment').ajaxForm({
		dataType: 'json',
    	success: function(json) {
        	if(json.msg){
        		alert(json.msg);
        	}
        	else if(json.id){
    			location.reload();
        	}
    	}
	});
}
function edit_catalogs(qid){
	popup("/set-catalogs?parent=1&type=3&id="+qid);
}
function vote(blogid){
	ajax_post("/action/blog/vote","id="+blogid,function(result){
		var json = eval('('+result+')');
		if(json.vote)
			$('#vote_count').html(json.vote);
		else if(json.error == 1)
			alert("用户尚未登录");
		else
			alert(json.msg);
	});
}
function toggle_recomm(blogid){
	ajax_post("/action/blog/toggle_recomm","id="+blogid,function(html){
		if(html == '-1')
			alert("文章不存在");
		else if(html == 0){
			$('#lnk_recomm_'+blogid).removeClass('recommend');
			$('#lnk_recomm_'+blogid).text("未推荐");
		}
		else if(html == 1){
			$('#lnk_recomm_'+blogid).addClass('recommend');
			$('#lnk_recomm_'+blogid).text("已推荐");
		}
	});
}
//-->
</script>    </div>
	<div class='clear'></div>
	<div id="OSC_Footer">&copy; 开源中国社区(OsChina.NET) | <a href="http://www.oschina.net/home/about">关于我们</a> | <a href="mailto:oschina.net@gmail.com">广告联系</a> | <a href="http://my.oschina.net/javayou">站长空间</a> | <a href="http://weibo.com/oschina2010" target="_blank">@新浪微博</a> | <a href="http://m.oschina.net/">开源中国手机版</a> | 粤ICP备12009483号-3
<script type='text/javascript'>
<!--
if (top.location != self.location)top.location=self.location;
//-->
</script></div>
</div>
</body>

<script type="text/javascript" src="/action/visit/space?id=123777"></script>
<script type='text/javascript'>
<!--
$(document).ready(function() {

	SelectStyle("#search-item",".search_list");
	$('.Tweet .photo img').click(function(){
		var T=$(this);
		var t=this;
		var bigImg = T.attr('bi');
		var smallImg = T.attr('si');
		var src = T.attr('src');
		var newsrc = (bigImg == src)?smallImg:bigImg;
		var imgId = T.attr('id');
		if(newsrc == bigImg){
    		var loading=$('<img alt="loading" src="/img/loading.gif"/>');
			var top = T.position().top+T.height()/2-8;
			var left = T.position().left+T.width()/2-8;
			loading.css({
				'position':'absolute',
				'z-index':999,
				'top':top,
				'left':left
			});
    		T.before(loading);
			var tImg=new Image();
			tImg.src=newsrc;
			tImg.onload=function(){afterImgLoad(T,loading,imgId,newsrc,bigImg);};
		}
		else{
			T.attr("src",newsrc);
			$('#img_menu_'+imgId).remove();
		}
		return false;
	});
	
	function afterImgLoad(T,loading,imgId,url,bigImg){
		var lnks = "<div id='img_menu_"+imgId+"' class='ImgMenu'>";
		lnks += "<a href='#' onclick='$(\"#"+imgId+"\").click();return false;'>收起</a>";
		lnks += "<a href='"+bigImg+"' target='_blank'>查看原图</a></div>";			
		loading.remove();
		T.attr("src",url);
		T.before(lnks);
	}
});

function set_fellow_memo(fid,fname){
	popup("/action/ajax/set_fellow_memo","friend="+fid+"&name="+fname);
}

function deleteMsgs(uid, fid, fname){
	if(!confirm("你确认要清除与‘"+fname+"’的所有留言信息吗？"))
		return ;
	var args = "user="+uid+"&friend="+fid;
	ajax_post("/action/msg/delete_user",args,function(html){
		if(html.length > 0)
			alert(html);
		else{
			$('#Msg_'+fid).fadeOut();
		}
	});
}

function follow_user(uid, uname){
	just_follow(uid, uname); //oschina.js
}

function unfollow_user(uid, uname){
	if(confirm("确定不再关注" + uname + "了吗？"))
	just_unfollow(uid,function(){
		alert('已取消对 ' + uname + ' 的关注');
	});
}

function tweet_reply(logid){
	var r = $('#LogReply_'+logid);
	if(!r.is(":hidden")){
		close_tweet_reply(logid);
		return ;
	}
	r.html("<div class='TweetRplsWrapper'><span class='loading'>正在加载评论，请稍候...</span></div>")
	r.show();
	r.load("http://my.oschina.net/guol/tweet-rpls?log="+logid,function(){
		$('#edt_tweet_post_'+logid).focus();
        $('#TweetReplyForm_'+logid).ajaxForm({
        	dataType: 'json',
			beforeSubmit: function(arr, form, options){
				$('#BTN_TweetReply_'+logid).attr('disabled','disabled');
			},
            success: function(json) {
            	if(json.msg){
        			alert(json.msg);
            	}else if(json.log){
					$('#log_reply_count_'+logid).text(json.reply_count);
        			//插入新评论					
					ajax_get("/action/ajax/get_tweet_reply?id=" + json.log,true,function(html){
						$('#LogReply_'+logid+' ul').prepend(html);
					});
					$('#edt_tweet_post_'+logid).val('');
            	}
				$('#BTN_TweetReply_'+logid).removeAttr('disabled');
            }
        });
	});
}
function close_tweet_reply(logid){
	$('#LogReply_'+logid).empty();
	$('#LogReply_'+logid).hide();
	$('#Logs .userlogs li').removeClass('hover');
}
function reply_rtweet(logid, rid, toname){
	var edtPost = $('#edt_tweet_post_' + logid);
	var old_v = edtPost.val();
	if(old_v.length > 0)
		edtPost.val(old_v + ',@'+toname+' ');
	else
		edtPost.val('回复 @'+toname+' : ');
	edtPost.focus();
}
function delete_tweet(logid){
	if(confirm("确认要删除这条信息吗？"))
	ajax_post("/action/tweet/delete?log="+logid,"",function(html){
		if(html.length==0){
			var elem = $('#LI_'+logid);
			if(elem.length > 0)
				$('#LI_'+logid).fadeOut();
			else
				location.reload();
		}
	});
}
function delete_tweet_reply(logid){
	if(confirm("确认要删除这条评论吗？"))
	ajax_post("/action/tweet/delete_reply?id="+logid,"",function(html){
		if(html.length==0)
			$('#TweetReply_'+logid).fadeOut();
	});
}

function delete_blog(blog_id){
    if(!confirm("文章删除后无法恢复，请确认是否删除此篇文章？")) return;
    ajax_post("/action/blog/delete?id="+blog_id,"",function(html){
    	location.href="http://my.oschina.net/guol/blog";
    });
}

function SelectStyle(on,option){
	var currentSort = $(on).attr('id');
	var currentText = $(option+" li."+currentSort+" a").html();
	$(on + " .text").html(currentText);
	$(on + " .text").hover(function(){
		$(this).addClass("hover")
	},function(){
		$(this).removeClass("hover")
	});
	$(option+" li a").each(function(index){
		$(this).click(function(){
			thishtml = $(this).html();
			$(on + " .text").removeClass("on").html(thishtml);		
			$(".selectbox select ").find("option").removeAttr('selected').eq(index).attr("selected","selected");	
			$(option).hide()
			return false;
		});
		
	});		
	
	$(".selectbox").click(function(){		
		$(option).toggle();
		$(on + " .text").toggleClass("on");		
		return false;
	});
	$(document).click(function(){
		$(option).hide();	
		$(on + " .text").removeClass("on");
	});
	$(document).trigger('click');

}

//-->
</script>
</html>
<!-- Generated by OsChina.NET (Sun Apr 22 12:11:15 CST 2012) 93ms -->