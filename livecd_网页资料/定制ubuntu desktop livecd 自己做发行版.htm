<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>定制ubuntu desktop livecd 自己做发行版 _易孚网站系统</title>
<meta name="keywords" content="定制ubuntu desktop livecd 自己做发行版" />
<meta name="description" content="定制ubuntu desktop livecd 自己做发行版" />
<link rel="stylesheet" type="text/css" href="/templates/zh-cn/style/article.css" />
<script type="text/javascript" src="/templates/zh-cn/js/common.js"></script>
<script type="text/javascript" src="/templates/zh-cn/js/jquery.js"></script>
<script type="text/javascript" src="/templates/zh-cn/js/interface.js"></script>
<script type="text/javascript" src="/templates/zh-cn/js/jquery.form.js"></script>
<base target="_self" />
</head>

<body>
<div id="topbar">
<div class="naveifr">
    <div id="topleftlogo">
    	<span id="spd"><a name="pagetop" id="pagetop"></a></span>
    </div>
    <div id="topshowinfo">
    	<script src="panel_login_words.php" type="text/javascript" language="javascript"></script>
    </div>
</div>
</div><div id="wrap">
<!--Content, Left, Right, Middle, Outer, Advertisement--> 
<!--Header-->
<div id="header">
<div id="pagetitle">
<div id="ad_h1" class="ad1banner"><script type="text/javascript"><!--
google_ad_client = "pub-9807678503835540";
/* 728x90, 创建于 09-8-14 */
google_ad_slot = "8019582235";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script></div>
<div id="logo">
<a href="http://www.eifr.com" target="_self"><img id="logo" src="/templates/zh-cn/images/logo.gif" alt="易孚网站系统" style="border: none;" ></a>
</div>
</div><div id="mainmenu">
<ul>
<li><a href="/" target="_self">首页</a></li>
<li><a href='channel.php?id=01' target='_self'>新闻动态</a></li>
<li><a href='channel.php?id=02' target='_self'>易孚网站系统</a></li>
<li><a href='channel.php?id=06' target='_self'>互动交流</a></li>
<li><a href='channel.php?id=10' target='_self'>网址导航</a></li>
<li><a href='channel.php?id=08' target='_self'>技术文章</a></li>
<li><a href='channel.php?id=07' target='_self'>会员中心</a></li>
</ul>
</div><div id="menu">
<ul>
<li><a href="channel.php?id=0801">unix/linux</a></li>
<li><a href="channel.php?id=0802">windows</a></li>
<li><a href="channel.php?id=0808">android</a></li>
<li><a href="channel.php?id=0803">编程</a></li>
<li><a href="channel.php?id=0804">软件</a></li>
<li><a href="channel.php?id=0805">技术知识</a></li>
<li><a href="channel.php?id=0806">美工</a></li>
<li><a href="channel.php?id=0807">硬件</a></li>
<li><a href="channel.php?id=0809">macOSX/iOS</a></li>
</ul>
</div>
<div id="navigation">
<form id="searchform" action="search.php" method="post">
<input type="text" id="searchkey" name="searchkey" >
<select name="searchwhere" id="searchwhere">
<option value="title">标题</option>
<option value="content">内容</option>
<option value="nickname">作者</option>
</select>
<select name="type" id="type">
<option value="">全部</option>
<option value='00' >首页</option>
<option value='01' >新闻动态</option>
<option value='02' >易孚网站系统</option>
<option value='06' >互动交流</option>
<option value='10' >网址导航</option>
<option value='08'  selected>技术文章</option>
<option value='07' >会员中心</option>
</select>
<button type="submit" value="true" name="subjectsearch">搜索</button>
</form>
<p>您的位置：<a href="/" target="_self">首页</a>
&gt;&gt;<a href='channel.php?id=08'>技术文章</a>&gt;&gt;<a href='channel.php?id=0801'>unix/linux</a></p>
</div></div>
<!--/Header-->

<!--Content-->

<!--C1 layout-->
<div class="contentR">
	
<!--C1-R layout-->
<div class="sideL">
<!--C1-R1 layout-->
<div id="hotview" class="sideblock">
<h3>热点文章</h3>
<ul class="msgtitlelist" >
<li><a href='article.php?id=113' target='_self'>How to svn sync lock on probleam</a></li>
<li><a href='article.php?id=1339' target='_self'>破解nook(序列号大于1003)</a></li>
<li><a href='article.php?id=269' target='_self'>ubuntu server 怎么装图形界面</a></li>
<li><a href='article.php?id=1121' target='_self'>Eclipse(javaEE)开发基于SSH项目应用实例 (Spring2.5+Hibernate3+Struts2)</a></li>
<li><a href='article.php?id=28' target='_self'>谈谈基于Kerberos的Windows Network Authentication</a></li>
<li><a href='article.php?id=33' target='_self'>AMule设置</a></li>
<li><a href='article.php?id=104' target='_self'>php cookie/session cart 购物车</a></li>
<li><a href='article.php?id=55' target='_self'>关于Flex</a></li>
<li><a href='article.php?id=273' target='_self'>psp 破解原理通俗讲解</a></li>
<li><a href='article.php?id=26' target='_self'>Kerberos的原理 - MIT</a></li>
</ul>
</div>
<!--/C1-R1 layout-->

<!--C1-R2 layout-->
<div id="newread" class="sideblock" style="margin-top:10px;">
<h3>最新文章</h3>
<ul class="msgtitlelist" >
<li><a href='article.php?id=1753' target='_self'>C++11 FAQ中文版 </a></li>
<li><a href='article.php?id=1752' target='_self'>listen established close_wait time_wait syn_sent</a></li>
<li><a href='article.php?id=1751' target='_self'>Mac OS X shell 颜色配置</a></li>
<li><a href='article.php?id=1750' target='_self'>Install wget on OS X Lion</a></li>
<li><a href='article.php?id=1749' target='_self'> codelite 教程</a></li>
<li><a href='article.php?id=1748' target='_self'>android sdk adt 问题</a></li>
<li><a href='article.php?id=1747' target='_self'>c/c++ Linux下获取程序绝对路径</a></li>
<li><a href='article.php?id=1746' target='_self'>c++内存池</a></li>
<li><a href='article.php?id=1745' target='_self'>谈一谈网络编程学习经验</a></li>
<li><a href='article.php?id=1744' target='_self'>c++ log日志</a></li>
</ul>
</div>
<!--/C1-R2 layout-->

</div>
<!--/C1-R layout-->

<!--C1-L layout-->
<div class="mainarea" style="float: right;">
<div id="articledetail">
<h1 class="articletitle">定制ubuntu desktop livecd 自己做发行版</h1>
<p class="articleinfo smalltxt">发布时间: 2010-10-25 07:37 &nbsp;&nbsp; 来源: <a href='http://xyliu.shell.tor.hu/?p=9985' target='_blank'>xyliu.shell.tor.hu</a> </p>
<div class="article_content_titles">
</div>
<div id="articlebody">
<p>最近看到论坛很多朋友抱怨： 每次重装<a title="Posts tagged with
ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>之后，都要重复安装中文支持，配置系统等工作。如果能定制<a title="Posts tagged with ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>的livecd，事先把这些 工作做了，就可以省下不少时间了。<br />这可以通过定制<a title="Posts tagged with ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>-livecd的iso来实 现，为什么不选alternate，先看它们的区别：<br /><a title="Posts tagged with ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>-8.04-alternate-i386.iso  VS <a title="Posts tagged with ubuntu" rel="nofollow" class="st_tag
internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>-8.04-livecd-i386.iso<br />alternate 里面是一大堆的按顺序排列的包，安装时可以选择desktop，server，然后根据选择安装不同的包。<br />livecd里面最大的文件是一个文件 系统映像，即filesystem.squashfs，其实就是squashfs格式的压缩包。<br />下面以 <a title="Posts tagged with ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>-8.04- desktop-i386.iso为例，在<a title="Posts tagged with
ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>-804测试通过：<br />1。 取出iso里面的所有内容<br />代码:<br />sudo mkdir   oldiso   newiso<br />sudo mount  <a title="Posts tagged with ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>-8.04-desktop-i386.iso   oldiso  -o  loop<br />sudo  cp  oldiso/*   newiso/     -rp<br />sudo   umount  oldiso <br />这个时候，newiso里面就是原来iso的全部内容。<br />2。  解压filesystem.squashfs，必须解压到<a title="Posts tagged with linux" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=linux">linux</a>分区,  它位于newiso/casper/filesystem.squashfs<br />代码:<br />sudo unsquashfs  newiso/casper/filesystem.squashfs<br />耐心等待，解压出来是一个squashfs-root目录，大小约是原来的 3倍左右，新安装的系统是不是差不多是这个大小呢？<br />3。开始定制系统<br />代码:<br />sudo cp  /etc/resolv.conf   squashfs-root/etc   <br />sudo  chroot   squashfs-root     <br />默认的shell可能是sh，输入/bin/bash 就可以了,  这时候可以像在正常系统一样，用apt-get等命令，当然没有图形界面。<br />有些程序需要proc，所以这里先挂载上。<br />代码:<br />mount  none  /proc   -t proc<br />代码:<br />apt-get  update <br />sudo apt-get   install  language-pack-gnome-zh  language-pack-zh   ttf-arphic-uming   ttf-wqy-zenhei  ## 安装中文支持，和中文字体<br />…….<br />还有用apt-get  删除不用的软件，例如oo，游戏等就不多说了，最后记得<br />代码:<br />apt-get clean     ##删除文件列表包<br />autoremove     ##删除旧版本包<br />rm   /etc/resolv.conf   <br />umount  /proc<br />搞定之后，按ctrl+d  退出系统！！！<br />4.生成安装软件列表<br />sudo chroot squashfs-root dpkg-query -W  –showformat=’${Package} ${Version}\n’ | sudo tee  newiso/casper/filesystem.manifest<br />sudo cp -v  newiso/casper/filesystem.manifest{,-desktop}<br />5. 重新压缩映像。<br />删掉原来 newiso/casper/filesystem.squashfs，还是先备份吧。。 </p>
<ol>
    <li>sudo mksquashfs squashfs-root newiso/casper/filesystem.squashfs  ##等待一段时间</li>
</ol>
<p><em>复制代码</em> </p>
<p>6. 编辑diskdefines，这里定义一些版本信息。<br />nano newiso/README.diskdefines<br />$  cat README.diskdefines<br />#define DISKNAME <a title="Posts tagged with ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">Ubuntu</a> 8.04.1  "Hardy Heron" – Release i386<br />#define TYPE binary<br />#define  TYPEbinary 1<br />#define ARCH i386<br />#define ARCHi386 1<br />#define  DISKNUM 1<br />#define DISKNUM1 1<br />#define TOTALNUM 0<br />#define  TOTALNUM0 1<br />7. 生成各个文件的md5值. </p>
<ol>
    <li>sudo -s </li>
    <li>(cd newiso &amp; find . -type f -print0 | xargs -0 md5sum &gt;  md5sum.txt) </li>
    <li>exit</li>
</ol>
<p><em>复制代码</em> </p>
<p>8. 重新制作iso </p>
<ol>
    <li>cd newiso </li>
    <li>sudo mkisofs -r -V "my <a title="Posts tagged with ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>"  -cache-inodes -J -l -b isolinux/isolinux.bin -c isolinux/boot.cat  -no-emul-boot -boot-load-size 4 -boot-info-table -o  "../myubuntu-804-livecd-iso" . </li>
    <li>cd ../ ### 这才是最重要的</li>
</ol>
<p><em>复制代码</em> </p>
<p>定制好的iso文件是：myubuntu-804-livecd-iso, 先用虚拟机器试试吧。。 kvm/qemu用以下命令： </p>
<ol>
    <li>sudo kvm -cdrom myubuntu-804-livecd-iso -localtime -m 300  ##300是分配的内存</li>
</ol>
<p><em>复制代码</em> </p>
<p>我还写过一个帖子，把当前使用的<a title="Posts tagged with
ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>做成livecd/usb，上述步骤只是它的一个部分。从中可以看出制作基于<a title="Posts tagged with ubuntu" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=ubuntu">ubuntu</a>发行版的思路来。 <br /><a href="http://www.inlsd.org/forum/viewtopic.php?t=355">http://www.inlsd.org/forum/viewtopic.php?t=355</a>  </p>
<p>  </p>
<p><font color="#ff0000">注：debian提供一套制作安装cd的机制，有些区别。个人不喜欢 livecd，alternative cd  是好东西。u910在公司的破机器上有问题，需要禁用915G的modesetting特性。一般用户如果遇到那种问题，用livecd是死也装不上的。  boot选项需要加上 i915.modset=0；安装完的<a title="Posts tagged with kernel" rel="nofollow" class="st_tag internal_tag" href="http://xyliu.shell.tor.hu/?tag=kernel">kernel</a>参数也同样需要修改。 grub2刚刚接触，还很不熟。</font></p></div>

<div id="ad_content_m1">
<div style="margin-top:10px;">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-9807678503835540";
/* 728*90 txt */
google_ad_slot = "3262927478";
google_ad_width = 728;
google_ad_height = 90;
//-->
</script>
<script type="text/javascript"
src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div></div>
<script language="javascript">
function doPrint()
{
    window.open('/article.php?id=1162&act=print','print article','menubar=yes,status=no,scrollbars=yes,top=100,left=200,width=700,height=500');
}
</script>
<div id="articlectrl">
<span id="show_favorite" class="btnaddfavorite" target="_self">收藏</span>&nbsp; |
<a href="javascript:doPrint();" class="btnprint" target="_self">打印</a>&nbsp; |
字体:&nbsp;
<a href="javascript:doStrZoom('articlebody',-1);" target="_self">-缩小</a>&nbsp;
<a href="javascript:doStrZoom('articlebody',1);" target="_self">放大+</a>&nbsp; 
&nbsp;&nbsp;
</div> <!--/articlectrl--><div style="position: absolute;">
<!-- window favorite -->
<div id="win_fav">
    <div id="win_fav_handle">			
        <a href="" id="win_close">[ x ]</a>
        请正确填写下面信息
    </div>
    <div id="win_fav_content" >
        <form id="win_fav_form" method="post" action="api/add_fovarite.php">
        <input type="hidden" name="article_id" value="1162">
        <label for="tag">标　签:</label><textarea name="tag">定制ubuntu desktop livecd 自己做发行版</textarea><br/>
        <label for="ratevalue">重量级:</label><input type="textbox" name="ratevalue" /><br/>
        <input type="checkbox" name="is_getsnapshot" value="1" /> 是否保存此网页快照
        <input type="checkbox" name="is_show" value="0" /> 是否公开此收藏<br />
        <input type="submit" name="submit" value="Save" />
        </form>
    </div>
</div>
<!-- /window favorite -->
</div>

<script language="javascript">
$(document).ready(function()
{
    $('#win_fav').Draggable(
            {
                zIndex: 	20,
                ghosting:	false,
                opacity: 	0.7,
                handle:	'#win_fav_handle'
            }
        );	
    $('#win_fav_form').ajaxForm({
        target: '#win_fav_content',
        success: delayhidediv	      
    });			
    $("#win_fav").hide();
                
    $('#show_favorite').click(function()
    {
        $("#win_fav").show();
    });
    
    $('#win_close').click(function()
    {
        $("#win_fav").hide();
    });
});

function delayhidediv()
{
    setTimeout("hidediv()", 2000); 
}
 
function hidediv()
{
    $("#win_fav").hide();
}

</script><script language="javascript">
function submitComment()
{
	if(document.getElementById('comment_action').value=='save')
	{
		var rtn = true;
	  
		if(document.getElementById('comment_content').value=='')			    			
		{
			rtn = false;
			alert("请输入内容!");
		}
		if(rtn)
		{
			document.postcomm.submit();
		}
		
	}
	
}

function setRate(tmpValue)
{
	document.getElementById('ratevalue').value=tmpValue;
	var rateArr=['1','2','3'];
	for(var i=0; i<rateArr.length; i++)
	{
		if(tmpValue==rateArr[i])
		{
			document.getElementById('article-rate'+rateArr[i]).style.background='#BBB';
		}
		else
		{
			document.getElementById('article-rate'+rateArr[i]).style.background='#DDD';
		}
	}
}
</script>
<div id="comment" class="sideblock cleanblock">
<h3><a href="comment.php?article_id=1162" class="more" target="_blank">查看全部评论(0)</a>我来说两句<input type="checkbox" id="comment_chk" value="1" onclick="showDisplayHidden('comment_chk','postcomm')" ></h3>
<form name="postcomm" id="postcomm" action="comment.php" method="post" target="_self" style="display:none" >
<p id="article-rates" class="article-rates0">
<label>评分</label>
<a id="article-rate1" href="javascript:;" onclick="setRate('1');" target="_self">差</a>
<a id="article-rate2" href="javascript:;" onclick="setRate('2');" target="_self">中</a>
<a id="article-rate3" href="javascript:;" onclick="setRate('3');" target="_self">好</a>
</p>
<input type="text" size="30" name="title" id="comment_title" value="请输入标题" onfocus="this.value=''" >&nbsp;
<input type="checkbox" name="is_nickname" id="is_nickname" value="1">匿名发表&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" size="4" name="vcode" id="vcode" value="验证码" onfocus="this.value=''" />&nbsp;<img src="api/imgvcode.php" align="absmiddle" />
<p><label for="message"></label><textarea id="comment_content" name="comment_content" style="vertical-align: text-top; width: 80%; height: 6em;"></textarea></p>
<p><button type="button" id="submitcomm" name="submitcomm" value="submit" style="" onclick="submitComment()">发表评论</button></p>
<input type="hidden" name="article_id" id="article_id" value="1162">
<input type="hidden" name="ratevalue" id="ratevalue" value="0">
<input type="hidden" name="backurl" id="backurl" value="article.php?id=1162">
<input type="hidden" name="act" id="comment_action" value="save">
<p class="txtpadding">
	<b>发表前请仔细阅读下列条款:</b><br>
* 您必须遵守《全国人大常委会关于维护互联网安全的决定》及中华人民共和国其他有关法律法规。<br>
* 承担一切因您的行为而直接或间接导致的民事或刑事法律责任。<br>
* 您发表的文章仅代表个人观点，与本网站无关。<br>
* 本网站评论管理人员有权保留或删除其管辖评论中的任意内容。<br>
* 您在本网站评论系统发表的作品，本网站有权在网站内转载或引用。<br>
* 参与本评论即表明您已经阅读并接受上述条款。 <br>
</p>
</form>

</div>
<!--relation-->
<!--/relation--> 
</div> <!--/articledetail-->
</div>
<!--/C1-L layout-->
<!--C1 layout-->

<!--/Content-->

</div>

<div id="footer">
<p id="copyright">
Powered by <a href="http://www.eifr.com" target="_blank"><strong>EIFR.com</strong></a><em>2012.1</em> 
&nbsp;&nbsp;<a href="http://www.eifr.com" target="_blank">EIFR</a> is Free Software released under the GNU/GPL License.
<br />Email: <a href="mailto:eifr.com@gmail.com">eifr.com@gmail.com</a>
</p>
<div id="gopagetop"><a href="#pagetop">top</a></div>
</div>
 
</body>
</html>
