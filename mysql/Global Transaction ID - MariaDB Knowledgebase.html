<!DOCTYPE html>
<html>
<head data-cookie-domain=""
      data-cookie-path="/">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=8" />
    <link rel="shortcut icon" href="/kb/static/generated/images/v3/mariadb-favicon-821771924f6f27f4915581c8d7e4ec52c9206921.ico" type="image/x-icon" />
    <title>Global Transaction ID - MariaDB Knowledgebase</title>

    <link rel="stylesheet" type="text/css" href="/kb/static/generated/main-26b54c04831ec045441829cde2c9dae7b9dddb65.css" />


    

    <!-- FB Open Graph tags -->
    <meta property="og:title" content="Global Transaction ID" />
    <meta property="og:type" content="article" />
    <meta property="og:url" content="https://mariadb.com/kb/en/global-transaction-id/" />
    <meta property="og:image" content="http://mariadb.comaskmonty-logo.png" />
    <meta property="og:site_name" content="MariaDB KnowledgeBase" />
    <meta property="fb:admins" content="514852603" />
    <meta property="og:description" content="Replication with global transaction ID
" />
</head>
<!--[if lt IE 7 ]> <body class="mpkb ie6 nodes products nodes_view jqui" id="nodes_view"> <![endif]-->
<!--[if IE 7 ]> <body class="mpkb ie7 nodes products nodes_view jqui" id="nodes_view"> <![endif]-->
<!--[if IE 8 ]> <body class="mpkb ie8 nodes products nodes_view jqui" id="nodes_view"> <![endif]-->
<!--[if !IE]>--> <body class="mpkb nodes products nodes_view jqui" id="nodes_view"><!--<![endif]-->
<div id="navbar" class="navbar navbar-medium navbar-inverse navbar-static-top">
    <div class="navbar-inner">
        <div class="container">
            <a id="mariadb-brand" class="brand" href="/"><div id="logo" class="print-background"></div>MariaDB</a>
            
                <form class="search-form navbar-search navbar-search pull-right hidden-print" method="get" action="/kb/en/+search/">
                    <div id="search-toggler" class="pull-right">
                        <i class="icon-search icon-white"></i>
                    </div>
                    <div>
                        <input id="search" placeholder="Search" name="q" type="text" value=""
                               class="search-query form-text noautofocus"
                               data-autocomplete-url="/kb/en/+search/autocomplete/"/>
                    </div>
                    <input type="hidden" name="quick" value="1" />
                    <input class="element-invisible btn btn-primary form-submit" type="submit" name="search" value="Search" />
                </form>
            
            <ul class="nav header-links pull-right hide-when-searching hidden-print">
                <li class="button-blog"><a href="/blog?destination=blog" class="active">Blog</a></li>
                
                    <li class="navbar-text">|</li>
                    
                        <li><a href="/kb/user/login?next=/kb/en/global-transaction-id/">Login</a></li>
                    
                
                <li class="button-call-to-action">
                    
                        <a href="https://www.mariadb.com/user/register" class="btn btn-primary">Create FREE Account</a>
                    
                </li>
            </ul>
            <div class="hidden-print">
            <nav class="nav-collapse collapse" role="navigation">
    <div class="region region-navigation">
        <div id="block-nice-menus-1" class="block block-nice-menus ">


            <div class="content">
                <ul class="nice-menu nice-menu-down nice-menu-main-menu" id="nice-menu-1"><li class="menu-444 menuparent  menu-path-node-17 first odd "><a href="/products">Products</a><ul><li class="menu-1000 menuparent  menu-path-node-563 first odd "><a href="/products/mariadb">MariaDB 10</a><ul><li class="menu-1022 menu-path-node-572 first odd "><a href="/products/mariadb/mariadb-vs-mysql">MariaDB vs. MySQL</a></li>
                    <li class="menu-1021 menu-path-node-571  even "><a href="/products/mariadb/cloud-nosql-optimized">Cloud &amp; NoSQL Optimized</a></li>
                    <li class="menu-1211 menu-path-node-625  odd "><a href="/products/mariadb-10/benchmarks">Benchmarks</a></li>
                    <li class="menu-1223 menu-path-mariadbcom-kb-en-mariadb-binary-packages-  even "><a href="http://mariadb.com/kb/en/mariadb-binary-packages/">Installing MariaDB 10</a></li>
                    <li class="menu-1180 menu-path-smariadbcom-kb-en-upgrading-from-mysql-to-mariadb-  odd last"><a href="https://mariadb.com/kb/en/upgrading-from-mysql-to-mariadb/" title="Upgrading from MySQL to MariaDB">Upgrading from MySQL to MariaDB</a></li>
                </ul></li>
                    <li class="menu-1001 menu-path-node-564  even "><a href="/products/mariadb-enterprise">MariaDB Enterprise</a></li>
                    <li class="menu-736 menuparent  menu-path-node-426  odd "><a href="/products/mariadb-enterprise-cluster">MariaDB Enterprise Cluster</a><ul><li class="menu-738 menu-path-node-428 first odd "><a href="/products/mariadb-enterprise-cluster/screenshots">Screenshots</a></li>
                        <li class="menu-909 menu-path-node-524  even "><a href="/products/mariadb-enterprise-cluster/architecture">Architecture</a></li>
                        <li class="menu-910 menu-path-node-525  odd "><a href="/products/mariadb-enterprise-cluster/scalability">Scalability</a></li>
                        <li class="menu-1222 menu-path-node-580  even last"><a href="/products/mariadb-enterprise-cluster/download">Download</a></li>
                    </ul></li>
                    <li class="menu-911 menu-path-node-526  even "><a href="/products/connectors-plugins">Connectors &amp; Plugins</a></li>
                    <li class="menu-1064 menu-path-node-17  odd last"><a href="/products" title="Subscription Plans">Subscription Plans</a></li>
                </ul></li>
                    <li class="menu-717 menuparent  menu-path-node-411  even "><a href="/services">Services</a><ul><li class="menu-445 menuparent  menu-path-node-18 first odd "><a href="/services/mariadb-consulting">MariaDB Consulting</a><ul><li class="menu-672 menu-path-node-394 first odd "><a href="/services/mariadb-consulting/pay-you-go">Pay-As-You-Go</a></li>
                        <li class="menu-673 menu-path-node-395  even "><a href="/services/mariadb-consulting/mariadb-performance-tuning">MariaDB Performance Tuning</a></li>
                        <li class="menu-674 menu-path-node-396  odd "><a href="/services/mariadb-consulting/mariadb-architecture-design">MariaDB Architecture &amp; Design</a></li>
                        <li class="menu-676 menu-path-node-398  even "><a href="/services/mariadb-consulting/mariadb-database-migration">MariaDB Database Migration</a></li>
                        <li class="menu-675 menu-path-node-397  odd last"><a href="/services/mariadb-consulting/mariadb-high-availability">MariaDB High Availability</a></li>
                    </ul></li>
                        <li class="menu-446 menuparent  menu-path-node-19  even "><a href="/services/mariadb-university">MariaDB University</a><ul><li class="menu-679 menu-path-node-401 first odd "><a href="/services/mariadb-university/administering-mariadb">Administering MariaDB</a></li>
                            <li class="menu-1328 menu-path-node-657  even "><a href="/services/mariadb-university/mariadb-galera-cluster-administration">MariaDB Galera Cluster Administration</a></li>
                            <li class="menu-680 menu-path-node-402  odd "><a href="/services/mariadb-university/performance-tuning-mariadb">Performance Tuning MariaDB</a></li>
                            <li class="menu-682 menu-path-node-404  even "><a href="/services/mariadb-university/developing-applications-mariadb">Developing Applications with MariaDB</a></li>
                            <li class="menu-681 menu-path-node-403  odd "><a href="/services/mariadb-university/high-availability-mariadb">High Availability for MariaDB</a></li>
                            <li class="menu-684 menu-path-node-406  even last"><a href="/services/mariadb-university/class-schedule">Class Schedule</a></li>
                        </ul></li>
                        <li class="menu-678 menu-path-node-400  odd "><a href="/services/mariadb-remote-dba">MariaDB Remote DBA</a></li>
                        <li class="menu-718 menu-path-node-412  even last"><a href="/services/server-feature-development">MariaDB Feature Development</a></li>
                    </ul></li>
                    <li class="menu-361 menuparent  menu-path-smariadbcom-kb-  odd "><a href="https://www.mariadb.com/kb/">Knowledge Base</a><ul><li class="menu-1422 menu-path-smariadbcom-kb-en-mariadb- first odd "><a href="https://mariadb.com/kb/en/mariadb/">MariaDB Manual</a></li>
                        <li class="menu-1423 menu-path-smariadbcom-kb-en-mariadb-enterprise-cluster-  even "><a href="https://mariadb.com/kb/en/mariadb-enterprise-cluster/">MariaDB Enterprise Cluster Manual</a></li>
                        <li class="menu-1424 menu-path-smariadbcom-kb-en-about-  odd last"><a href="https://mariadb.com/kb/en/about/">About the Knowledge Base</a></li>
                    </ul></li>
                    <li class="menu-635 menuparent  menu-path-node-361  even "><a href="/resources">Resources</a><ul><li class="menu-1224 menu-path-node-639 first odd "><a href="/resources/downloads">Downloads</a></li>
                        <li class="menu-1409 menu-path-skysqlcom-about-news-events  even "><a href="http://www.skysql.com/about/news-events" target="_blank">News &amp; Events</a></li>
                        <li class="menu-1408 menu-path-skysqlcom-why-skysql-webinars  odd "><a href="http://www.skysql.com/why-skysql/webinars" target="_blank">Webinars</a></li>
                        <li class="menu-1425 menu-path-node-692  even "><a href="/resources/roadshows">Roadshows</a></li>
                        <li class="menu-961 menu-path-node-537  odd "><a href="/resources/guides-whitepapers">Guides &amp; Whitepapers</a></li>
                        <li class="menu-640 menu-path-node-366  even "><a href="/resources/community-tools">Community Tools</a></li>
                        <li class="menu-826 menu-path-node-498  odd "><a href="/resources/faqs">FAQs</a></li>
                        <li class="menu-1176 menu-path-skysqlcom-downloads-maxscale-mariadb-mysql  even "><a href="http://www.skysql.com/downloads/maxscale-mariadb-mysql" target="_blank">MaxScale</a></li>
                        <li class="menu-999 menu-path-mariadborg  odd "><a href="http://www.mariadb.org" target="_blank">MariaDB.org</a></li>
                        <li class="menu-742 menu-path-node-442  even "><a href="/resources/mariadb-books">MariaDB Books</a></li>
                        <li class="menu-1327 menu-path-node-640  odd "><a href="/resources/report-bug">Report a Bug</a></li>
                        <li class="menu-647 menu-path-skysqlcom-customers-portal  even last"><a href="http://www.skysql.com/customers/portal" target="_blank">SkySQL Customer Portal</a></li>
                    </ul></li>
                    <li class="menu-362 menuparent  menu-path-node-4  odd last"><a href="/about">About</a><ul><li class="menu-376 menu-path-blog first odd "><a href="/blog" title="">Blog</a></li>
                        <li class="menu-653 menu-path-node-377  even "><a href="/about/brand-resources">Brand Resources</a></li>
                        <li class="menu-654 menuparent  menu-path-node-378  odd "><a href="/about/legal">Legal</a><ul><li class="menu-1221 menu-path-node-628 first odd "><a href="/about/legal/evaluation-agreement">Evaluation Agreement</a></li>
                            <li class="menu-694 menu-path-node-407  even "><a href="/about/legal/privacy-policy">Privacy Policy</a></li>
                            <li class="menu-695 menu-path-node-408  odd "><a href="/about/legal/technical-support-policies">Technical Support Policies</a></li>
                            <li class="menu-696 menu-path-node-409  even last"><a href="/about/legal/trademarks">Trademarks</a></li>
                        </ul></li>
                        <li class="menu-697 menu-path-node-410  even last"><a href="/about/contact">Contact</a></li>
                    </ul></li>
                </ul>
            </div>
        </div>
    </div>
</nav>
            </div>
        </div>
    </div>
</div>
<header id="header" class="container-wrapper">
    <div class="container">
        
        <div id="subheader1" class="clearfix">
            <div class="pull-left">
                <div id="breadcrumbs">
                    <a href="/">Home</a>
                    <a href="/resources">Resources</a>
                    <a href="/kb/en/">Knowledge Base</a>
                    


    <a href="/kb/en/mariadb/">MariaDB</a>

    <a href="/kb/en/mariadb-documentation/">MariaDB Documentation</a>

    <a href="/kb/en/replication-cluster-multi-master/">Replication, Cluster, &amp; Multi-Master</a>

    <a href="/kb/en/replication/">Replication</a>


    <a class="node_link" href="/kb/en/global-transaction-id/">Global Transaction ID</a>


                </div>
            </div>
            
                <div id="language_menu" class="btn-group pull-right hidden-print">
                <a href="/kb/languages/" id="choose_language" class="btn btn-small dropdown-toggle">
                    English
                    <span class="caret"></span>
                </a>
                <ul id="language_list" class="dropdown-menu">
                    
                        
                    
                        
                            <li><a href="/kb/it/">italiano</a></li>
                        
                    
                        
                            <li><a href="/kb/pt/">Português</a></li>
                        
                    
                        
                            <li><a href="/kb/pt-br/">Português Brasileiro</a></li>
                        
                    
                        
                            <li><a href="/kb/es/">español</a></li>
                        
                    
                        
                            <li><a href="/kb/ko/">한국어</a></li>
                        
                    
                        
                            <li><a href="/kb/fr/">français</a></li>
                        
                    
                        
                            <li><a href="/kb/ru/">Русский</a></li>
                        
                    
                        
                            <li><a href="/kb/ja/">日本語</a></li>
                        
                    
                        
                            <li><a href="/kb/vi/">Vietnamese</a></li>
                        
                    
                        
                            <li><a href="/kb/zh-cn/">简体中文</a></li>
                        
                    
                        
                            <li><a href="/kb/zh-tw/">繁體中文</a></li>
                        
                    
                </ul>
            
            </div>
        </div>
        
            <h1>Global Transaction ID</h1>
        
    </div>

</header>
<div id="main">
    <div class="container">
        <div class="row">
            
            
                
                <aside id="sidebar-first" class="sidebar span3 hidden-phone hidden-print">
                    
                        
                        <ul id="category_menu" class="nav nav-tabs nav-stacked">
                            <li><a href="/kb/en/">Home</a></li>
                            
                                <li><a href="/kb/en/+questions/">Open Questions</a></li>
                                <li><a href="/kb/en/MariaDB/">MariaDB</a></li>
                                <li><a href="/kb/en/mariadb-enterprise-cluster/">MariaDB Enterprise Cluster</a></li>
                            
                            <li><a href="/kb/en/+all/">All Topics</a></li>
                        </ul>
                    

                    
<div>



<div class="well well-small box actions"><div>

        <a class="btn btn-block btn-info btn-small" href="/kb/en/global-transaction-id/history" rel="nofollow">History</a>
        
        
        <a class="btn btn-block btn-info btn-small" href="/kb/en/global-transaction-id/edit" rel="nofollow">Edit</a>
        
        
        <a class="btn btn-block btn-info btn-small" href="/kb/en/global-transaction-id/source/">Source</a>
        
        <a class="btn btn-block btn-info btn-small flag" href="/kb/en/global-transaction-id/flag"
                data-flag-url="/kb/en/global-transaction-id/flag" rel="nofollow">
                Flag as Spam/Inappropriate</a>
        
        <a class="btn btn-block btn-info btn-small" href="/kb/en/global-transaction-id/translate/">
                Translate</a>
        

</div>
</div>





<div class="well well-small box node_info"><div>

    <dl>
        <dt>Created</dt>
        <dd>

<span class="datetime" title="2013-05-07 09:36">1 year ago</span></dd>

        <dt>Modified</dt>
        <dd>

<span class="datetime" title="2014-03-19 08:53">1 month, 3 weeks ago</span></dd>

        <dt>Type</dt>
        <dd>article</dd>

        <dt>Status</dt>
        <dd>active</dd>

        
    </dl>

    
    <ul class="rss_feeds">
        <li><a href="/kb/en/global-transaction-id/history/feed/">
            History</a>
        </li>
        <li><a href="/kb/en/global-transaction-id/comments/feed/">
            Comments</a>
        </li>
    </ul>
    

</div>
</div>




    
    

<div class="well well-small box links"><div><h5>Links</h5></div><div>

        <ul>
            
                <li><a href="/kb/en/replication-overview/">Replication overview</a></li>
            
                <li><a href="/kb/en/binary-log/">binary log</a></li>
            
                <li><a href="/kb/en/mysqlbinlog/">mysqlbinlog</a></li>
            
                <li><a href="/kb/en/show-binlog-events/">SHOW BINLOG EVENTS</a></li>
            
                <li><a href="/kb/en/myisam-storage-engine/">MyISAM</a></li>
            
                <li><a href="/kb/en/alter-table/">ALTER TABLE</a></li>
            
                <li><a href="/kb/en/xtrabackup-build-instructions/">XtraBackup Build Instructions</a></li>
            
                <li><a href="/kb/en/mysqldump/">mysqldump</a></li>
            
                <li><a href="/kb/en/show-master-status/">SHOW MASTER STATUS</a></li>
            
                <li><a href="#use-with-multi-source-replication-and-other-multi-master-setups">Use with multi-source replication and other multi-master setups</a></li>
            
                <li><a href="/kb/en/change-master-to/">CHANGE MASTER</a></li>
            
                <li><a href="/kb/en/binlog_gtid_pos/">BINLOG_GTID_POS()</a></li>
            
                <li><a href="#gtid_strict_mode">GTID strict mode</a></li>
            
                <li><a href="/kb/en/mysql_upgrade/">mysql_upgrade</a></li>
            
                <li><a href="/kb/en/master_gtid_wait/">MASTER_GTID_WAIT</a></li>
            

            

            
        </ul>
    
</div>
</div>



    
    

<div class="well well-small box attachments"><div><div class="edit_link pull-right"><a href="/kb/en/global-transaction-id/edit/attachments/">Edit</a></div><h5>Attachments</h5></div><div>

        
            <div class="no_data">No attachments exist</div>
        
    
</div>
</div>




    
    



    
    

<div class="well well-small box"><div><h5>Product Versions</h5></div><div>

        <ul id="product_chooser">
            
                <li class="mariadb_from_10_0_2">
                    <label><input type="checkbox" data-product-class="mariadb_from_10_0_2"
                            >MariaDB starting with 10.0.2</label>
                </li>
            
                <li class="mariadb_from_10_0_3">
                    <label><input type="checkbox" data-product-class="mariadb_from_10_0_3"
                            >MariaDB starting with 10.0.3</label>
                </li>
            
                <li class="mariadb_10_0_2">
                    <label><input type="checkbox" data-product-class="mariadb_10_0_2"
                            >MariaDB 10.0.2</label>
                </li>
            
        </ul>
    
</div>
</div>







    


</div>


                    <div id="social">

    <div id="tweet" class="share">
        <a href="https://twitter.com/share" class="twitter-share-button" data-count="horizontal">Tweet</a>
        <script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>
    </div>

    <div id="g_plus" class="share">
        <g:plusone size="medium"></g:plusone>
    </div>

    <div id="facebook" class="share">
        <div id="fb-root"></div>
        <script src="https://connect.facebook.net/en_US/all.js#appId=186631171404592&amp;xfbml=1"></script>
        <fb:like href="" send="false" layout="button_count" width="90" show_faces="false" action="like" font=""></fb:like>
    </div>

    <script type="text/javascript">
      (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
    </script>

</div>
                </aside>
            
            <section id="content" class="limited_width span9 clearfix">
                


                

                <div>
                    
    
    
    
    
    <div class="node creole">
        


    
    <div class="answer formatted">
        <div class="mariadb_from_10_0_2 mariadb from_10_0_2 product"><h5 class="product_title">MariaDB starting with 10.0.2</h5><p>From version 10.0.2, MariaDB supports global transaction IDs for replication.</p>
</div><div class="table_of_contents well well-small">
<h3>Contents</h3>
 <ol class="toc">
    <li class="mariadb_from_10_0_2"><a href="#overview" title="Overview">Overview</a></li>
    <li class="mariadb_from_10_0_2"><a href="#benefits" title="Benefits">Benefits</a></li>
    <li class="mariadb_from_10_0_2"><a href="#implementation" title="Implementation">Implementation</a></li>
    <ol class="toc">
        <li class="mariadb_from_10_0_2"><a href="#the-domain-id" title="The domain ID">The domain ID</a></li>
    </ol>
    <li class="mariadb_from_10_0_2"><a href="#using-global-transaction-ids" title="Using global transaction ID&#39;s">Using global transaction ID&#39;s</a></li>
    <li class="mariadb_from_10_0_2"><a href="#setting-up-a-new-slave-server-with-global-transaction-id" title="Setting up a new slave server with global transaction ID">Setting up a new slave server with global transaction ID</a></li>
    <ol class="toc">
        <li class="mariadb_from_10_0_2"><a href="#starting-with-an-empty-server" title="Starting with an empty server">Starting with an empty server</a></li>
        <li class="mariadb_from_10_0_2"><a href="#setting-up-from-backup" title="Setting up from backup">Setting up from backup</a></li>
        <li class="mariadb_from_10_0_2"><a href="#switching-an-existing-old-style-slave-to-use-gtid" title="Switching an existing old-style slave to use GTID.">Switching an existing old-style slave to use GTID.</a></li>
    </ol>
    <li class="mariadb_from_10_0_2"><a href="#changing-a-slave-to-replicate-from-a-different-master" title="Changing a slave to replicate from a different master">Changing a slave to replicate from a different master</a></li>
    <li class="mariadb_from_10_0_2"><a href="#use-with-multi-source-replication-and-other-multi-master-setups" title="Use with multi-source replication and other multi-master setups">Use with multi-source replication and other multi-master setups</a></li>
    <li class="mariadb_from_10_0_2"><a href="#new-syntax-for-global-transaction-id" title="New syntax for global transaction ID">New syntax for global transaction ID</a></li>
    <ol class="toc">
        <li class="mariadb_from_10_0_2"><a href="#change-master" title="CHANGE MASTER">CHANGE MASTER</a></li>
        <li class="mariadb_from_10_0_2"><a href="#start-slave-until-master_gtid_posxxx" title="START SLAVE UNTIL master_gtid_pos=xxx">START SLAVE UNTIL master_gtid_pos=xxx</a></li>
        <li class="mariadb_from_10_0_2"><a href="#binlog_gtid_pos" title="BINLOG_GTID_POS().">BINLOG_GTID_POS().</a></li>
    </ol>
    <li class="mariadb_from_10_0_2"><a href="#new-function" title="New function">New function</a></li>
    <ol class="toc">
        <li class="mariadb_from_10_0_2"><a href="#master_gtid_wait" title="MASTER_GTID_WAIT">MASTER_GTID_WAIT</a></li>
    </ol>
    <li class="mariadb_from_10_0_2"><a href="#new-system-variables-for-global-transaction-id" title="New system variables for global transaction ID">New system variables for global transaction ID</a></li>
    <ol class="toc">
        <li class="mariadb_from_10_0_2"><a href="#gtid_slave_pos" title="gtid_slave_pos">gtid_slave_pos</a></li>
        <li class="mariadb_from_10_0_2"><a href="#gtid_binlog_pos" title="gtid_binlog_pos">gtid_binlog_pos</a></li>
        <li class="mariadb_from_10_0_2"><a href="#gtid_binlog_state" title="gtid_binlog_state">gtid_binlog_state</a></li>
        <li class="mariadb_from_10_0_2"><a href="#gtid_current_pos" title="gtid_current_pos">gtid_current_pos</a></li>
        <li class="mariadb_from_10_0_2"><a href="#gtid_strict_mode" title="gtid_strict_mode">gtid_strict_mode</a></li>
        <li class="mariadb_from_10_0_2"><a href="#gtid_domain_id" title="gtid_domain_id">gtid_domain_id</a></li>
        <li class="mariadb_from_10_0_2"><a href="#last_gtid" title="last_gtid">last_gtid</a></li>
        <li class="mariadb_from_10_0_2"><a href="#server_id" title="server_id">server_id</a></li>
        <li class="mariadb_from_10_0_2"><a href="#gtid_seq_no" title="gtid_seq_no">gtid_seq_no</a></li>
    </ol>
 </ol>
</div>
<h2 class="anchored_heading" id="overview">Overview</h2>
<p>MariaDB replication in general works as follows (see
<a href="/kb/en/replication-overview/">Replication overview</a> for more information):</p>
<p>On a master server, all updates to the database (DML and DDL) are written into the <a href="/kb/en/binary-log/">binary log</a> as binlog events. A slave server connects to the master and reads the binlog
events, then applies the events locally to replicate the same changes as done
on the master. A server can be both a master and a slave at the same time, and
it is thus possible for binlog events to replicated through multiple levels of
servers.</p>
<p>A slave server keeps track of the position in the master's binlog of the last
event applied on the slave. This allows the slave server to re-connect and
resume from where it left off after replication has been temporarily
stopped. It also allows a slave to disconnect, be cloned and then have the new slave resume replication from the same master.</p>
<p>Global transaction ID introduces a new event attached to each event group in
the binlog. (An event group is a collection of events that are always applied
as a unit. They are best thought of as a "transaction", though they also
include non-transactional DML statements, as well as DDL). As an event group
is replicated from master server to slave server, the global transaction ID is
preserved. Since the ID is globally unique across the entire group of servers,
this makes it easy to uniquely identify the same binlog events on different
servers that replicate each other (this was not easily possible before <a href="/kb/en/mariadb-1002-release-notes/">MariaDB
10.0.2</a>).</p>
<h2 class="anchored_heading" id="benefits">Benefits</h2>
<p>Using global transaction ID provides two main benefits:</p>
<p>1. Easy to change a slave server to connect to and replicate from a different
master server.</p>
<p>    The slave remembers the global transaction ID of the last event group
    applied from the old master. This makes it easy to know where to resume
    replication on the new master, since the global transaction IDs are know
    throughout the entire replication hierarchy. This is not the case when
    using old-style replication; in this case the slave knows only the
    specific file name and offset of the old master server of the last event
    applied. There is no simple way to guess from this the correct file name
    and offset on a new master.</p>
<p>2. The state of the slave is recorded in a crash-safe way.</p>
<p>    The slave keeps track of its current position (the global transaction ID
    of the last transaction applied) in a system table mysql.gtid_slave_pos.
    If this table is using a transactional storage engine (such as InnoDB,
    which is the default), then updates to the state is done in the same
    transaction as the updates to the data. This makes the state crash-safe;
    if the slave server crashes, crash recovery on restart will make sure that
    the recorded replication position matches what changes were actually
    replicated. This is not the case for old-style replication, where the
    state is recorded in a file relay-log.info, which is updated independently
    of the actual data changes and can easily get out of sync if the slave
    server crashes. (This works for DML to transactional tables;
    non-transactional tables and DDL in general are not crash-safe in
    MariaDB.)</p>
<p>Because of these two benefits, it is generally recommended to use global
transaction ID for any replication setups based on <a href="/kb/en/mariadb-1002-release-notes/">MariaDB 10.0.2</a> or later.
However, old-style replication continues to work as always, so there is no
pressing need to change existing setups. Global transaction ID integrates
smoothly with old-style replication, and the two can be used freely together
in the same replication hierarchy. There is no special configuration needed of
the server to start using global transaction ID. However, it must be
explicitly set for a slave server with the appropriate <a href="/kb/en/change-master-to/">CHANGE MASTER</a> option;
by default old-style replication is used by a replication slave, to maintain
backwards compatibility.</p>
<h2 class="anchored_heading" id="implementation">Implementation</h2>
<p>A global transaction ID, or GTID for short, consists of three numbers
separated with dashes '-'. For example:</p>
<p><code class="fixed" style="white-space:pre-wrap">0-1-10</code></p>
<ul><li>The first number 0 is the domain ID, which is specific for global transaction ID (more on this below). It is a 32-bit unsigned integer.
</li><li>The second number is the server ID, the same as is also used in old-style replication. It is a 32-bit unsigned integer.
</li><li>The third number is the sequence number. This is a 64-bit unsigned integer that is monotonically increasing for each new event group logged into the binlog.
</li></ul>
<p>The server ID is set to the server ID of the server where the event group is
first logged into the binlog. The sequence number is increased on a server for
every event group logged. Since server IDs must be unique for every server,
this makes the (server_id, sequence_number) pair, and hence the whole GTID,
globally unique.</p>
<p>Using a 64-bit number provides ample range that there should be no risk of it
overflowing in the foreseeable future. However, one should not artificially
(by setting <code class="fixed" style="white-space:pre-wrap">gtid_seq_no</code>) inject a GTID with a very high
sequence number close to the limit of 64-bit.</p>
<h3 class="anchored_heading" id="the-domain-id">The domain ID</h3>
<p>When events are replicated from a master server to a slave server, the events
are always logged into the slave's binlog in the same order that they were
read from the master's binlog. Thus, if there is only ever a single master
server receiving (non-replication) updates at a time, then the binlog order
will be identical on every server in the replication hierarchy.</p>
<p>This consistent binlog order is used by the slave to keep track of its current
position in the replication. Basically, the slave remembers the GTID of the
last event group replicated from the master. When reconnecting to a master,
whether the same one or a new one, it sends this GTID position to the master,
and the master starts sending events from the first event after the
corresponding event group.</p>
<p>However, if user updates are done independently on multiple servers at the
same time, then in general it is not possible for binlog order to be identical
across all servers. This can happen when using multi-source replication, with
multi-master ring topologies, or just if manual updates are done on a slave
that is replicating from active master. If the binlog order is different on
the new master from the order on the old master, then it is not sufficient for
the slave to keep track of a single GTID to completely record the current
state.</p>
<p>The domain ID, the first component of the GTID, is used to handle this.</p>
<p>In general, the binlog is not a single ordered stream. Rather, it consists of
a number of different streams, each one identified by its own domain
ID. Within each stream, GTIDs always have the same order in every server
binlog. However, different streams can be interleaved in different ways on
different servers.</p>
<p>A slave server then keeps track of its replication position by recording the
last GTID applied within each replication stream. When connecting to a new
master, the slave can start replication from a different point in the binlog
for each domain ID.</p>
<p>For more details on using multi-master setups and multiple domain IDs, see <a href="#use-with-multi-source-replication-and-other-multi-master-setups">Use with multi-source replication and other multi-master setups</a>.</p>
<p>Simple replication setups only have a single master being updated by the
application at any one time. In such setups, there is only a single
replication stream needed. Then domain ID can be ignored, and left as the
default of 0 on all servers.</p>
<h2 class="anchored_heading" id="using-global-transaction-ids">Using global transaction ID's</h2>
<p>From <a href="/kb/en/mariadb-1002-release-notes/">MariaDB 10.0.2</a>, global transaction ID is enabled automatically. Each event
group logged to the binlog receives a GTID event, as can be seen with
<a href="/kb/en/mysqlbinlog/">mysqlbinlog</a> or <a href="/kb/en/show-binlog-events/">SHOW BINLOG EVENTS</a>.</p>
<p>The slave automatically keeps track of the GTID of the last applied event
group, as can be seen from the gtid_slave_pos variable:</p>
<pre class="fixed">SELECT @@GLOBAL.gtid_slave_pos
0-1-1</pre><p>When a slave connects to a master, it can use either global transaction ID or
old-style filename/offset to decide where in the master binlogs to start
replicating from. To use global transaction ID, use the master_use_gtid option
of <a href="/kb/en/change-master-to/">CHANGE MASTER</a>:</p>
<p><code class="fixed" style="white-space:pre-wrap">CHANGE MASTER TO master_use_gtid = { slave_pos | current_pos | no }</code></p>
<p>A slave is configured to use GTID by <code class="fixed" style="white-space:pre-wrap">CHANGE MASTER TO master_use_gtid=slave_pos</code>.
When the slave connects to the master, it will start replication at the
position of the last GTID replicated to the slave, which can be seen in the
variable <code class="fixed" style="white-space:pre-wrap">@@gtid_slave_pos</code>.
Since GTIDs are the same across all replication
servers, the slave can then be pointed to a different master, and the correct
position will be determined automatically.</p>
<p>But suppose that we set up two servers A and B and let A be the master and B
the slave. It runs for a while. Then at some point we take down A, and B
becomes the new master. Then later we want to add A back, this time as a
slave.</p>
<p>Since A was never a slave before, it does not have any prior replicated GTIDs,
and <code class="fixed" style="white-space:pre-wrap">@@gtid_slave_pos</code> will be empty.
To allow A to be added as a slave automatically,
<code class="fixed" style="white-space:pre-wrap">master_use_gtid=current_pos</code> can be used. This will connect
using the value of the variable <code class="fixed" style="white-space:pre-wrap">@@gtid_current_pos</code> instead of
<code class="fixed" style="white-space:pre-wrap">@@gtid_slave_pos</code>, which takes into account also GTIDs written
into the binlog when the server was a master.</p>
<p>Using <code class="fixed" style="white-space:pre-wrap">master_use_gtid=current_pos</code> is probably easiest, as
there is then no need to consider whether a server was a master or a slave
prior to using <code class="fixed" style="white-space:pre-wrap">CHANGE MASTER</code>. But care must be taken not to
inject extra transactions into the binlog on the slave server that are not
intended to be replicated to other servers. If such an extra transaction
is the most recent when the slave starts, it will be used as the
starting point of replication. This will probably fail because that
transaction is not present on the master. To avoid local changes on a slave
server to go into the binlog, set <code class="fixed" style="white-space:pre-wrap">@@sql_log_bin</code> to 0.</p>
<p>If it is undesirable that changes to the binlog on the slave affects the
GTID replication position, then <code class="fixed" style="white-space:pre-wrap">master_use_gtid=slave_pos</code>
should be used. Then the slave will always connect to the master at the
position of the last replicated GTID. This may avoid some surprises for users
that expect behaviour consistent with traditional replication, where the
replication position is never changed by local changes done on a server.</p>
<p>When <a href="#gtid_strict_mode">GTID strict mode</a> is enabled (by setting
<code class="fixed" style="white-space:pre-wrap">@@GLOBAL.gtid_strict_mode</code> to 1), it is normally best to use
<code class="fixed" style="white-space:pre-wrap">current_pos</code>. In strict mode, extra transactions on the master are
disallowed.</p>
<p>If a slave is configured with the binlog disabled,
<code class="fixed" style="white-space:pre-wrap">current_pos</code> and <code class="fixed" style="white-space:pre-wrap">slave_pos</code> are equivalent.</p>
<p>Even when a slave is configured to connect with the old-style binlog filename
and offset (CHANGE MASTER TO master_log_file=..., master_log_pos=...), it will
still keep track of the current GTID position in @@GLOBAL.gtid_slave_pos. This
means that an existing slave previously configured and running can be changed
to connect with GTID (to the same or a new master) simply with:</p>
<p><code class="fixed" style="white-space:pre-wrap">CHANGE MASTER TO master_use_gtid = slave_pos</code></p>
<p>The slave remembers that <code class="fixed" style="white-space:pre-wrap">master_use_gtid=slave_pos|master_pos</code>
was specified and will use it also
for subsequent connects, until it is explicitly changed by specifying
<code class="fixed" style="white-space:pre-wrap">master_log_file/pos=...</code> or
<code class="fixed" style="white-space:pre-wrap">master_use_gtid=no</code>.
The current value can be seen as the field Using_Gtid of SHOW SLAVE STATUS:</p>
<pre class="fixed">SHOW SLAVE STATUS
Using_Gtid: Slave_pos</pre><p>The slave server internally uses the table mysql.gtid_slave_pos to store the
GTID position (and so preserve the value of @@GLOBAL.gtid_slave_pos across
server restarts). After upgrading a server to 10.0, it is necessary to run
<a href="/kb/en/mysql_upgrade/">mysql_upgrade</a> (as always) to get the table created.</p>
<p>In order to be crash-safe, this table must use a transactional storage engine
such as InnoDB. When MariaDB is first installed (or upgraded to 10.0.2+) the
table is created using the default storage engine - which itself defaults to
InnoDB. If there is a need to change the storage engine for this table (to
make it transactional on a system configured with <a href="/kb/en/myisam/">MyISAM</a> as the default
storage engine, for example), use <a href="/kb/en/alter-table/">ALTER TABLE</a>:</p>
<p><code class="fixed" style="white-space:pre-wrap">ALTER TABLE mysql.gtid_slave_pos ENGINE = InnoDB</code></p>
<p>The table mysql.gtid_slave_pos should not be modified in any other way. In
particular, do not try to update the rows in the table to change the slave's
idea of the current GTID position; instead use</p>
<p><code class="fixed" style="white-space:pre-wrap">SET GLOBAL gtid_slave_pos = '0-1-1'</code></p>
<div class="mariadb_10_0_2 mariadb 10_0_2 product"><h5 class="product_title">MariaDB 10.0.2</h5><p>In 10.0.2, the name of the table that stores the GTID position was called
<code class="fixed" style="white-space:pre-wrap">rpl_slave_state</code>.
The syntax <code class="fixed" style="white-space:pre-wrap">master_use_gtid=0|1</code> was used instead of
<code class="fixed" style="white-space:pre-wrap">master_use_gtid=no|current_pos</code>. The
<code class="fixed" style="white-space:pre-wrap">master_use_gtid=slave_pos</code> option did not have any equivalent.</p>
</div><h2 class="anchored_heading" id="setting-up-a-new-slave-server-with-global-transaction-id">Setting up a new slave server with global transaction ID</h2>
<p>Setting up a new replication slave server with global transaction ID is not
much different from setting up an old-style slave. The basic steps are:</p>
<p>1. Setup the new server and load it with the initial data.</p>
<p>2. Start the slave replicating from the appropriate point in the master's
   binlog.</p>
<h3 class="anchored_heading" id="starting-with-an-empty-server">Starting with an empty server</h3>
<p>The simplest way for testing purposes is probably to setup a new, empty slave
server and replicate all of the master's binlogs from the start (this is
usually not feasible in a realistic production setup, as the initial binlog
files will probably have been purged or take too long to apply).</p>
<p>The slave server is installed in the normal way. By default, the GTID position
for a newly installed server is empty, which makes the slave replicate from
the start of the master's binlogs. But if the slave was used for other
purposes before, the initial position can be explicitly set to empty first:</p>
<p><code class="fixed" style="white-space:pre-wrap">SET GLOBAL gtid_slave_pos = &#34;&#34;;</code></p>
<p>Next, point the slave to the master with <a href="/kb/en/change-master-to/">CHANGE MASTER</a>. Specify master_host
etc. as usual. But instead of specifying master_log_file and master_log_pos
manually, use <code class="fixed" style="white-space:pre-wrap">master_use_gtid=current_pos</code> (or
<code class="fixed" style="white-space:pre-wrap">slave_pos</code> to have GTID do it automatically:</p>
<pre class="fixed">CHANGE MASTER TO master_host=&#34;127.0.0.1&#34;, master_port=3310, master_user=&#34;root&#34;, master_use_gtid=current_pos;
START SLAVE;</pre><h3 class="anchored_heading" id="setting-up-from-backup">Setting up from backup</h3>
<p>The normal way to set up a new replication slave is to restore a backup from
an existing server (whether master or slave) as the new server, then point it
to start replication from the appropriate position in the master's binlog.</p>
<p>It is important that the position at which replication is started corresponds
exactly to the state of the data at the point in time that the backup was
taken. Otherwise, the slave can end up with different data than the master
because of transactions missing or duplicated.</p>
<p>Two common ways to take a backup are <a href="/kb/en/xtrabackup/">XtraBackup</a> and <a href="/kb/en/mysqldump/">mysqldump</a>. Both of these
can provide the current binlog position of the backup in a non-blocking
way. Of course, if there are no writes to the server being backed up during
the backup process, then a simple <a href="/kb/en/show-master-status/">SHOW MASTER STATUS</a> will give the correct
position.</p>
<p>Once the current binlog position for the backup has been obtained, in the form
of a binlog file name and offset, the corresponding GTID position can be
obtained from <a href="/kb/en/binlog_gtid_pos/">BINLOG_GTID_POS()</a> on the server that was backed up:</p>
<p><code class="fixed" style="white-space:pre-wrap">SELECT BINLOG_GTID_POS(&#34;master-bin.000001&#34;, 600);</code></p>
<p>The new slave can now be started replicating by setting the correct
@@gtid_slave_pos, issuing CHANGE MASTER to point to the master server, and
starting the slave threads:</p>
<pre class="fixed">SET GLOBAL gtid_slave_pos = &#34;0-1-2&#34;;
CHANGE MASTER TO master_host=&#34;127.0.0.1&#34;, master_port=3310, master_user=&#34;root&#34;, master_use_gtid=slave_pos;
START SLAVE;</pre><p>This method is particularly useful when setting up a new slave from a backup
of the master. Remember to ensure that the value of server_id for the new
server is different from that of any other server (this is set in my.cnf).</p>
<p>If the backup was taken of an existing slave server, then it already has the
correct GTID position stored in the table mysql.gtid_slave_pos (provided that
the backup includes this table and is consistent with changes to other tables,
of course). In this case, there is no need to explicitly look up the GTID
position on the old server and set it on the new slave - it will be already
correctly loaded from mysql.gtid_slave_pos. This however does not work if the
backup was taken of the master - because then the current GTID position is
contained in the binlog, not in mysql.gtid_slave_pos.</p>
<h3 class="anchored_heading" id="switching-an-existing-old-style-slave-to-use-gtid">Switching an existing old-style slave to use GTID.</h3>
<p>If there is already an existing slave running using old-style binlog
filename/offset position, then this can be changed to use GTID directly. This
can be useful for upgrades for example, or where there are already tools to
setup new slaves using old-style binlog positions.</p>
<p>When a slave connects to a master using old-style binlog positions, and the
master supports GTID (ie. is <a href="/kb/en/mariadb-1002-release-notes/">MariaDB 10.0.2</a> or later), then the slave
automatically downloads the GTID position at connect and updates it during
replication. Thus, once a slave has connected to the GTID-aware master at
least once, it can be switched to using GTID without any other actions needed;</p>
<pre class="fixed">STOP SLAVE;
CHANGE MASTER TO master_host=&#34;127.0.0.1&#34;, master_port=3310, master_user=&#34;root&#34;, master_use_gtid=current_pos;
START SLAVE;</pre><p>(A later version will probably add a way to setup the slave so that it will
connect with old-style binlog file/offset the first time, and automatically
switch to using GTID on subsequent connects.)</p>
<h2 class="anchored_heading" id="changing-a-slave-to-replicate-from-a-different-master">Changing a slave to replicate from a different master</h2>
<p>Once replication is running with GTID (master_use_gtid=current_pos|slave_pos),
the slave can be
pointed to a new master simply by specifying in CHANGE MASTER the new
master_host (and if required master_port, master_user, and master_password):</p>
<pre class="fixed">STOP SLAVE;
CHANGE MASTER TO master_host='127.0.0.1', master_port=3312;
START SLAVE;</pre><p>The slave has a record of the GTID of the last applied transaction from the
old master, and since GTIDs are identical across all servers in a replication
hierarchy, the slave will just continue from the appropriate point in the new
master's binlog.</p>
<p>It is important to understand how this change of masters work. The binlog is
an ordered stream of events (or multiple streams, one per replication domain,
(see <a href="#use-with-multi-source-replication-and-other-multi-master-setups">Use with multi-source replication and other multi-master setups</a>). Events within the stream are always applied in
the same order on every slave that replicates it. The MariaDB GTID relies on
this ordering, so that it is sufficient to remember just a single point within
the stream. Since event order is the same on every server, switching to the
point of the same GTID in the binlog of another server will give the same
result.</p>
<p>This translates into some responsibility for the user. The MariaDB GTID
replication is fully asynchronous, and fully flexible in how it can be
configured. This makes it possible to use it in ways where the assumption that
binlog sequence is the same on all servers is violated. In such cases, when
changing master, GTID will still attempt to continue at the point of current
GTID in the new binlog.</p>
<p>The most common way that binlog sequence gets different between servers is
when the user/DBA does updates directly on a slave server (and these updates
are written into the slaves binlog). This results in events in the slaves
binlog that are not present on the master or any other slaves. This can be
avoided by setting the session variable sql_log_bin false while doing such
updates, so they do not go into the binlog.</p>
<p>It is normally best to avoid any differences in binlogs between servers. That
being said, MariaDB replication is designed for maximum flexibility, and there
can be valid reasons for introducing such differences from time to time. It
this case, it just needs to be understood that the GTID position is a single
point in each binlog stream (one per replication domain), and how this affects
the users particular setup.</p>
<p>Differences can also occur when two masters are active at the same time in a
replication hierarchy. This happens when using a multi-master ring. But it can
also occur in a simple master-slave setup, during switch to a new master, if
changes on the old master is not allowed to fully replicate to all slave
servers before switching master. Normally, to switch master, first writes to
the old master should be stopped, then one should wait for all changes to be
replicated to the new master, and only then should writes begin on the new
master. Deliberately using multiple active masters is also supported, this is
described in the next section.</p>
<p>The <a href="#gtid_strict_mode">GTID strict mode</a> can be used to enforce identical binlogs across
servers. When it is enabled, most actions that would cause differences are
rejected with an error.</p>
<h2 class="anchored_heading" id="use-with-multi-source-replication-and-other-multi-master-setups">Use with multi-source replication and other multi-master setups</h2>
<p>MariaDB global transaction ID supports having multiple masters active at the
same time. Typically this happens with either multi-source replication or
multi-master ring setups.</p>
<p>In such setups, each active master must be configured with its own distinct
replication domain ID, gtid_domain_id. The binlog will then in effect consists
of multiple independent streams, one per active master. Within one replication
domain, binlog order is always the same on every server. But two different
streams can be interleaved differently in different server binlogs.</p>
<p>The GTID position of a given slave is then not a single GTID. Rather, it
becomes the GTID of the last event group applied for each value of domain ID,
in effect the position reached in each binlog stream. When the slave connects
to a master, it can continue from one stream in a different binlog position
than another stream. Since order within one stream is consistent across all
servers, this is sufficient to always be able to continue replicationat the
correct point in any new master server(s).</p>
<p>Domain IDs are assigned by the DBA, according to the need of the application.
The default value of @@GLOBAL.gtid_domain_id is 0. This is appropriate for
most replication setups, where only a single master is active at a time. The
MariaDB server will never by itself introduce new domain_id values into the
binlog.</p>
<p>When using multi-source replication, where a single slave connects to multiple
masters at the same time, each such master should be configured with its own
distict domain ID.</p>
<p>Similarly, in a multi-master ring topology, where all master in the ring are
updated by the application concurrently (with some mechanism to avoid
conflicts), a distict domain ID should be configured for each server (In a
multi-master ring where the application is careful to only do updates on one
master at a time, a single domain ID is sufficient).</p>
<p>Normally, a slave server should not receive direct updates (as this creates
binlog differences compared to the master). Thus it does not matter what value
of gtid_domain_id is set on a slave, though it may make sense to make it the
same as the master (if not using multi-master) to make it easy to promote the
slave as a new master. Of course, if a slave is itself an active master, as in
a multi-master ring topology, the domain ID should be set according to the
server's role as active master.</p>
<p>Note that domain ID and server ID are distinct concepts. It is possible to use
a different domain ID on each server, but this is normally not desirable. It
makes the current GTID position (@@global.gtid_slave_pos) more complicated to
understand and work with, and looses the concept of a single ordered binlog
stream across all servers. It is recommended only to configure as many domain
IDs as there are master servers actively being updated by the application at
the same time.</p>
<p>It is not an error in itself to configure domain IDs incorrectly (for example,
not configuring them at all). For example, this will be typical in an upgrade
scenario where a multi-master ring using 5.5 is upgraded to 10.0. The ring
will continue to work as before even though everything is configured to use
the default domain ID 0. It is even possible to use GTID for replication
between the servers. However, care must be taken when switching a slave to a
different master. If the binlog order between the old and the new master
differs, then a single GTID position to start replication from in the new
master's binlog may not be sufficient.</p>
<h2 class="anchored_heading" id="new-syntax-for-global-transaction-id">New syntax for global transaction ID</h2>
<h3 class="anchored_heading" id="change-master">CHANGE MASTER</h3>
<p><a href="/kb/en/change-master-to/">CHANGE MASTER</a> has a new option, master_use_gtid=[current_pos|slave_pos|no]. When enabled (set to
current_pos or slave_pos), the slave will connect to the master using the GTID position. When
disabled (set to "no"), the old-style binlog filename/offset position is used to decide
where to start replicating when connecting.</p>
<p>The value of master_use_gtid is saved across server restarts (in
master.info). The current value can be seen as the field Using_Gtid in the
output of SHOW SLAVE STATUS.</p>
<div class="mariadb_10_0_2 mariadb 10_0_2 product"><h5 class="product_title">MariaDB 10.0.2</h5><p>In <a href="/kb/en/mariadb-1002-release-notes/">MariaDB 10.0.2</a>, the syntax <code class="fixed" style="white-space:pre-wrap">master_use_gtid=0|1</code> was used instead of
<code class="fixed" style="white-space:pre-wrap">master_use_gtid=no|current_pos</code>. The
<code class="fixed" style="white-space:pre-wrap">master_use_gtid=slave_pos</code> option did not have any equivalent.</p>
</div><h3 class="anchored_heading" id="start-slave-until-master_gtid_posxxx">START SLAVE UNTIL master_gtid_pos=xxx</h3>
<p>When starting replication with <code class="fixed" style="white-space:pre-wrap">START SLAVE</code>, it is possible to request the
slave to run only until a specific GTID position is reached. Once that
position is reached, the slave will stop.</p>
<p>The syntax for this is:</p>
<p><code class="fixed" style="white-space:pre-wrap">    START SLAVE UNTIL master_gtid_pos = &lt;GTID position&gt;</code></p>
<p>The slave will start replication from the current GTID position, run up to
and including the event with the GTID specified, and then stop.</p>
<p>If multiple GTIDs are specified, then they must be with distinct replication
domain ID, for example:</p>
<p><code class="fixed" style="white-space:pre-wrap">    START SLAVE UNTIL master_gtid_pos = &#34;1-11-100,2-21-50&#34;</code></p>
<p>With multiple domains in the UNTIL condition, each domain runs only up to and
including the specified position, so it is possible for different domains to
stop at different places in the binlog (each domain will resume from the
stopped position when the slave is started the next time).</p>
<p>Not specifying a replication domain at all in the UNTIL condition means that
the domain is stopped immediately, nothing is replicated from that domain. In
particular, specifying the empty string will stop the slave immediately.</p>
<p>When using <code class="fixed" style="white-space:pre-wrap">START SLAVE UNTIL master_gtid_pos = XXX</code>, if the UNTIL position is
present in the master's binlog then it is permissible for the start position
to be missing on the master. In this case, replication for the associated
domains stop immediately.</p>
<p>Both slave threads must be already stopped when using UNTIL master_gtid_pos,
otherwise an error occurs. It is also an error if the slave is not configured
to use GTID (<code class="fixed" style="white-space:pre-wrap">CHANGE MASTER TO master_use_gtid=current_pos|slave_pos</code>). And both threads must be
started at the same time, the <code class="fixed" style="white-space:pre-wrap">IO_THREAD</code> or <code class="fixed" style="white-space:pre-wrap">SQL_THREAD</code> options can not be used
to start only one of them.</p>
<p><code class="fixed" style="white-space:pre-wrap">START SLAVE UNTIL master_gtid_pos=XXX</code> is particularly useful for promoting a
new master among a set of slaves when the old master goes away and slaves may
have reached different positions in the old master's binlog. The new master
needs to be ahead of all the other slaves to avoid losing events. This can be
achieved by picking one server, say S1, and replicating any missing events
from each other server S2, S3, ..., Sn:</p>
<pre class="fixed">    CHANGE MASTER TO master_host=&#34;S2&#34;;
    START SLAVE UNTIL master_gtid_pos = &#34;&lt;S2 GTID position&gt;&#34;;
    ...
    CHANGE MASTER TO master_host=&#34;Sn&#34;;
    START SLAVE UNTIL master_gtid_pos = &#34;&lt;Sn GTID position&gt;&#34;;</pre><p>Once this is completed, S1 will have all events present on any of the
servers. It can now be selected as the new master, and all the other servers
set to replicate from it.</p>
<div class="mariadb_from_10_0_3 mariadb from_10_0_3 product"><h5 class="product_title">MariaDB starting with 10.0.3</h5><p>Note: START SLAVE UNTIL first appeared in <a href="/kb/en/mariadb-1003-release-notes/">MariaDB 10.0.3</a>.</p>
</div><h3 class="anchored_heading" id="binlog_gtid_pos">BINLOG_GTID_POS().</h3>
<p>The <a href="/kb/en/binlog_gtid_pos/">BINLOG_GTID_POS()</a> function takes as input an old-style <a href="/kb/en/binary-log/">binary log</a> position in the form of a file name and a file offset. It looks up the position in the current binlog, and returns a string representation of the corresponding GTID
position. If the position is not found in the current binlog, NULL is returned.</p>
<h2 class="anchored_heading" id="new-function">New function</h2>
<h3 class="anchored_heading" id="master_gtid_wait">MASTER_GTID_WAIT</h3>
<p>A new function, <a href="/kb/en/master_gtid_wait/">MASTER_GTID_WAIT</a> will be introduced in <a href="/kb/en/mariadb-1009-release-notes/">MariaDB 10.0.9</a>. It is useful in replication for controlling master/slave synchronization, and blocks until the slave has read and applied all updates up to the specified position in the master log.  See <a href="/kb/en/master_gtid_wait/">MASTER_GTID_WAIT</a> for details.</p>
<h2 class="anchored_heading" id="new-system-variables-for-global-transaction-id">New system variables for global transaction ID</h2>
<h4 class="anchored_heading" id="gtid_slave_pos"><code>gtid_slave_pos</code></h4>
<p>This variable is the GTID of the last event group replicated on a slave
server, for each replication domain.</p>
<p>It can be set by the user to change the current replication position. This
requires all slave threads to be stopped first. Note that the position is
shared among all slave connections when using multi-source replication. To set
position for two masters, one using replication domain 1 and another
replication domain 2, set a GTID for both domains, for example:</p>
<p><code class="fixed" style="white-space:pre-wrap">SET GLOBAL gtid_slave_pos = &#34;1-10-100,2-20-500&#34;;</code></p>
<p>The variable value is updated whenever an event group is replicated on a
slave. The value of the variable is used as the starting point for replication
when a slave is configured with
<code class="fixed" style="white-space:pre-wrap">CHANGE MASTER TO master_use_gtid=slave_pos</code>.</p>
<p>If this variable is set to a position that is not more recent than the last
GTID in the binary log on the server, a warning will be given. This helps
protect the user from setting one value for <code class="fixed" style="white-space:pre-wrap">@@gtid_slave_pos</code>,
then being surprised when a slave configured with
<code class="fixed" style="white-space:pre-wrap">CHANGE MASTER TO master_use_gtid=current_pos</code>
starts replicating at the more recent
position found in the binary log. It also helps protect against the case where
a server is rolled back to restart replication from an earlier point in time,
but the user forgets to also use <code class="fixed" style="white-space:pre-wrap">RESET MASTER</code> to roll back
the binary log, thus getting duplicate events in the binlog.</p>
<ul start="1"><li><strong>Scope:</strong> Global
</li><li><strong>Dynamic:</strong> Yes
</li><li><strong>Data Type:</strong> <code>string</code>
</li><li><strong>Introduced:</strong> <code><a href="/kb/en/mariadb-1003-release-notes/">MariaDB 10.0.3</a></code>
</li></ul>
<h4 class="anchored_heading" id="gtid_binlog_pos"><code>gtid_binlog_pos</code></h4>
<p>This variable is the GTID of the last event group written to the binary log,
for each replication domain.</p>
<p>The value is read-only, but it is updated whenever a DML or DDL statement is
written to the binary log.</p>
<ul start="1"><li><strong>Scope:</strong> Global
</li><li><strong>Dynamic:</strong> Read-only
</li><li><strong>Data Type:</strong> <code>string</code>
</li><li><strong>Introduced:</strong> <code><a href="/kb/en/mariadb-1003-release-notes/">MariaDB 10.0.3</a></code>
</li></ul>
<h4 class="anchored_heading" id="gtid_binlog_state"><code>gtid_binlog_state</code></h4>
<p>The variable gtid_binlog_state holds the internal state of the binlog. The
state consists of the last GTID ever logged to the binary log for every
combination of domain_id and server_id. This information is used by the master
to determine whether a given GTID has been logged to the binlog in the past,
even if it has later been deleted due to binlog purge. For each domain_id, the
last entry in @@gtid_binlog_state is the last GTID logged into binlog,
ie. this is the value that appears in @@gtid_binlog_pos.</p>
<p>Normally this internal state is not needed by users, as @@gtid_binlog_pos is
more useful in most cases. The main usage of @@gtid_binlog_state is to restore
the state of the binlog after RESET MASTER (or equivalently if the binlog
files are lost). If the value of @@gtid_binlog_state is saved before RESET
MASTER and restored afterwards, the master will retain information about past
history, same as if PURGE BINARY LOGS had been used (of course the actual
events in the binary logs are still deleted).</p>
<p>Note that to set the value of @@gtid_binlog_state, the binary log must be
empty, that is it must not contain any GTID events and the previous value of
@@gtid_binlog_state must be the empty string. If not, then RESET MASTER must
be used first to erase the binary log first.</p>
<p>The value of @@gtid_binlog_state is preserved by the server across restarts by
writing a file MASTER-BIN.state, where MASTER-BIN is the base name of the
binlog set with the --log-bin option. This file is written at server shutdown,
and re-read at next server start. (In case of a server crash, the data in the
MASTER-BIN.state is not correct, and the server instead recovers the correct
value during binlog crash recovery by scanning the binlog files and recording
each GTID found).</p>
<p>For completeness, note that setting @@gtid_binlog_state internally executes a
RESET MASTER. This is normally not noticable as it can only be changed when
the binlog is empty of GTID events. However, if executed eg. immediately after
upgrading to MariaDB 10, it is possible that the binlog is non-empty but
without any GTID events, in which case all such events will be deleted, just
as if RESET MASTER had been run.</p>
<ul start="1"><li><strong>Scope:</strong> Global
</li><li><strong>Dynamic:</strong> Yes
</li><li><strong>Data Type:</strong> <code>string</code>
</li><li><strong>Introduced:</strong> <code><a href="/kb/en/mariadb-1005-release-notes/">MariaDB 10.0.5</a></code>
</li></ul>
<h4 class="anchored_heading" id="gtid_current_pos"><code>gtid_current_pos</code></h4>
<p>This variable is the GTID of the last change to the database for each
replication domain. Such changes can either be master events (ie. local
changes made by user or application), or replicated events originating from
another master server.</p>
<p>For each replication domain, if the server ID of the corresponding GTID in
<code class="fixed" style="white-space:pre-wrap">@@gtid_binlog_pos</code> is equal to the servers own server_id,
<em>and</em> the sequence number is higher than the corresponding GTID in
<code class="fixed" style="white-space:pre-wrap">@@gtid_slave_position</code>, then the GTID from
<code class="fixed" style="white-space:pre-wrap">@@gtid_binlog_pos</code> will be used. Otherwise the GTID from
<code class="fixed" style="white-space:pre-wrap">@@gtid_slave_position</code> will be used for that domain.</p>
<p>Thus, <code class="fixed" style="white-space:pre-wrap">@@gtid_current_pos</code> contains the most recent GTID
executed on the server, whether this was done as a master or as a slave. This
value is used as the starting point of replication when a slave is configured
with <code class="fixed" style="white-space:pre-wrap">CHANGE MASTER TO master_use_gtid=current_pos</code>.</p>
<p>The value is read-only, but it is updated whenever a DML or DDL statement is
written to the binary log and/or replicated by a slave thread..</p>
<ul start="1"><li><strong>Scope:</strong> Global
</li><li><strong>Dynamic:</strong> Read-only
</li><li><strong>Data Type:</strong> <code>string</code>
</li><li><strong>Introduced:</strong> <code><a href="/kb/en/mariadb-1003-release-notes/">MariaDB 10.0.3</a></code>
</li></ul>
<h4 class="anchored_heading" id="gtid_strict_mode"><code>gtid_strict_mode</code></h4>
<p>The GTID strict mode is an optional setting that can be used to help the DBA
enforce a strict discipline about keeping binlogs identical across multiple
servers replicating using global transaction ID.</p>
<p>When GTID strict mode is enabled, some additional errors are enabled for
situations that could otherwise cause differences between binlogs on different
servers in a replication hierarchy:</p>
<ol start="1"><li>If a slave server tries to replicate a GTID with a sequence number lower than what is already in the binlog for that replication domain, the SQL thread stops with an error (this indicates an extra transaction in the slave binlog not present on the master).
</li><li>Similarly, an attempt to manually binlog a GTID with a lower sequence number (by setting <code class="fixed" style="white-space:pre-wrap">@@SESSION.gtid_seq_no</code>) is rejected with an error.
</li><li>If the slave tries to connect starting at a GTID that is missing in the master's binlog, this is an error in GTID strict mode even if a GTID exists with a higher sequence number (this indicates a GTID on the slave missing on the master). Note that this error is controlled by the setting of GTID strict mode on the connecting slave server.
</li></ol>
<p>GTID mode is off by default; this is needed to preserve backwards
compatibility with existing replication setups (older versions of the server
did not enforce any strict mode for binlog order). Global transaction ID is
designed to work correctly even when strict mode is not enabled. However, with
strict mode enforced, the semantics is simpler and thus easier to understand,
because binlog order is always identical across servers and sequence numbers
are always strictly increasing within each replication domain. This can also
make automated scripting of large replication setups easier to implement
correctly.</p>
<p>When GTID strict mode is enabled, the slave will stop with an error when a
problem is encountered. This allows the DBA to become aware of the problem and
take corrective actions to avoid similar issues in the future. One way to
recover from such an error is to temporarily disable GTID strict mode on the
offending slave, to be able to replicate past the problem point (perhaps using
<code class="fixed" style="white-space:pre-wrap">START SLAVE UNTIL master_gtid_pos=XXX</code>).</p>
<ul start="1"><li><strong>Scope:</strong> Global
</li><li><strong>Dynamic:</strong> Yes
</li><li><strong>Data Type:</strong> <code>boolean</code>
</li><li><strong>Introduced:</strong> <code><a href="/kb/en/mariadb-1003-release-notes/">MariaDB 10.0.3</a></code>
</li></ul>
<hr>
<h4 class="anchored_heading" id="gtid_domain_id"><code>gtid_domain_id</code></h4>
<ul start="1"><li><strong>Description:</strong> This variable is used to decide which replication domain new GTIDs are logged in for a master server. See <a href="#use-with-multi-source-replication-and-other-multi-master-setups">Use with multi-source replication and other multi-master setups</a> for details. This variable can also be set on the session level. This is used by <a href="/kb/en/mysqlbinlog/">mysqlbinlog</a> to preserve the domain ID of GTID events.
</li><li><strong>Scope:</strong> Global, Session
</li><li><strong>Dynamic:</strong> Yes
</li><li><strong>Data Type:</strong> <code>numeric (32-bit unsigned integer)</code>
</li><li><strong>Introduced:</strong> <code><a href="/kb/en/mariadb-1002-release-notes/">MariaDB 10.0.2</a></code>
</li></ul>
<hr>
<h4 class="anchored_heading" id="last_gtid"><code>last_gtid</code></h4>
<ul start="1"><li><strong>Description:</strong> Holds the GTID that was assigned to the last transaction, or statement that was logged to the <a href="/kb/en/binary-log/">binary log</a>. If the binary log is disabled, or if no transaction or statement was executed in the session yet, then the value is an empty string.
</li><li><strong>Scope:</strong> Session
</li><li><strong>Dynamic:</strong> Read-only
</li><li><strong>Data Type:</strong> <code>string</code>
</li><li><strong>Introduced:</strong> <code><a href="/kb/en/mariadb-1009-release-notes/">MariaDB 10.0.9</a></code>
</li></ul>
<hr>
<h4 class="anchored_heading" id="server_id"><code>server_id</code></h4>
<ul start="1"><li><strong>Description:</strong> Server_id can be set on the session level to change which server_id value is logged in binlog events (both GTID and other events). This is used by mysqlbinlog to preserve the server ID of GTID events.
</li><li><strong>Scope:</strong> Global, Session
</li><li><strong>Dynamic:</strong> Yes
</li><li><strong>Data Type:</strong> <code>numeric (32-bit unsigned integer)</code>
</li></ul>
<hr>
<h4 class="anchored_heading" id="gtid_seq_no"><code>gtid_seq_no</code></h4>
<ul start="1"><li><strong>Description:</strong> gtid_seq_no can be set on the session level to change which sequence number is logged in the following GTID event. This is used by mysqlbinlog to preserve the sequence number of GTID events.
</li><li><strong>Scope:</strong> Session
</li><li><strong>Dynamic:</strong> Yes
</li><li><strong>Data Type:</strong> <code>numeric (64-bit unsigned integer)</code>
</li><li><strong>Introduced:</strong> <code><a href="/kb/en/mariadb-1002-release-notes/">MariaDB 10.0.2</a></code>
</li></ul>
<hr>

    </div>


        
            <div id="subscribe" class="well well-small hide hidden-print" data-subscribe-url="/kb/en/global-transaction-id/subscriptions/add">
            </div>
        

        
        <h2>Comments</h2>
        
    
    <div id="comments" data-node-id="3389" data-comments-url="/kb/en/global-transaction-id/comments"
         data-reply-url="/kb/en/global-transaction-id/comments/post/">
        Comments loading...
    </div>

        

    </div>

                </div>
            </section>
        </div>
    </div>
</div>

<div id="pre_footer" class="hidden-print">
    <div class="container">
        <form class="form-inline" enctype="multipart/form-data" action="/kb/en/+newsletter/"
              method="post" accept-charset="UTF-8">
            <p class="pull-left">Signup for our newsletter, for the latest news and product updates</p>
            <div style='display:none'><input type='hidden' name='csrfmiddlewaretoken' value='Q1mwPBcKo2mReKQkAmoOfwdRW57SK34i' /></div>
            <input class="email form-text form-email required" type="email" id="edit-submitted-email"
                   name="email" size="30">
            <input type="hidden" name="redirect" value="/kb/en/global-transaction-id/" />
            <input class="btn btn-primary form-submit" type="submit" id="edit-submit" name="op" value="Sign Up">
        </form>
    </div>
</div>

<footer id="footer" class="container-wrapper">
    <div class="container">
        <div id="footer_toggle"></div>
        <div id="footer_toggle_content">
            <div class="region region-collapse">
    <div id="block-menu-block-2" class="block block-menu-block">
        <div class="content">
            <div class="menu-block-wrapper menu-block-2 menu-name-main-menu parent-mlid-0 menu-level-1">
                <ul class="submenu level1">
                    <li class="first expanded menu-mlid-444"><a href="/products">Products</a><ul class="submenu level2">
                        <li class="first leaf menu-mlid-736"><a href="/products/business-benefits">Business Benefits</a></li><li class="leaf menu-mlid-738"><a href="/products/screenshots">Screenshots</a></li><li class="last leaf menu-mlid-826"><a href="/products/faqs">FAQs</a></li></ul>
                    </li><li class="expanded menu-mlid-717"><a href="/services">Services</a><ul class="submenu level2">
                    <li class="first leaf has-children menu-mlid-445"><a href="/services/mariadb-consulting">MariaDB Consulting</a></li><li class="leaf has-children menu-mlid-446"><a href="/services/mariadb-university">MariaDB University</a></li><li class="leaf menu-mlid-678"><a href="/services/mariadb-remote-dba">MariaDB Remote DBA</a></li><li class="last leaf menu-mlid-718"><a href="/services/server-feature-development">MariaDB Feature Development</a></li></ul>
                </li><li class="expanded menu-mlid-635"><a href="/resources">Resources</a><ul class="submenu level2">
                    <li class="first leaf has-children menu-mlid-360"><a href="/resources/downloads">Downloads</a></li><li class="leaf menu-mlid-361"><a href="https://www.mariadb.com/kb/?__hstc=124209749.9f751494ddf307899aa36e9804ba453e.1370356255424.1384406081522.1384463445953.37&amp;__hssc=124209749.5.1384463445953&amp;__hsfp=2518329044">Knowledge Base</a></li><li class="leaf menu-mlid-640"><a href="/resources/community-tools">Community Tools</a></li><li class="leaf menu-mlid-742"><a href="/resources/mariadb-books">MariaDB Books</a></li><li class="last leaf menu-mlid-647"><a href="http://support.skysql.com">Support Portal</a></li></ul>
                </li><li class="last expanded menu-mlid-362"><a href="/about">About</a><ul class="submenu level2">
                    <li class="first leaf menu-mlid-376"><a href="/blog">Blog</a></li><li class="leaf menu-mlid-653"><a href="/about/brand-resources">Brand Resources</a></li><li class="leaf has-children menu-mlid-654"><a href="/about/legal">Legal</a></li><li class="last leaf menu-mlid-697"><a href="/about/contact">Contact</a></li></ul>
                </li></ul>
            </div>
        </div>
    </div>
    <div id="block-block-33" class="block block-block">
        <div class="content">
            <div class="cta_footer">
                <h4>Need a highly available database clustering solution that's easy to install, manage and monitor?</h4>
                <p>
                    <a href="https://www.mariadb.com/user/register" class="btn btn-primary btn-large">Create FREE Account</a>
                </p>
            </div>
        </div>
    </div>
</div>
        </div>
        <div id="copyright">
            <a class="skysql_logo" href="http://www.skysql.com/" title="SkySQL.com"></a>
            &copy; 2013 - 2014 SkySQL Corporation Ab.
            SkySQL and MariaDB are trademarks or registered trademarks of SkySQL Corporation Ab in the European Union and
            United States of America and/or other countries. MySQL is a trademark of Oracle Corporation Inc.
            <a href="/about/legal/trademarks" title="Trademarks">Trademarks Statement</a>
        </div>
    </div>
</footer>

<div id="ajax_loading">
    <img src="/kb/static/generated/images/ajax-loader-2eb3f9f430fb2a6267e0d252129ef6473d074f37.gif" />
</div>

    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
        try {
            var pageTracker = _gat._getTracker("UA-18791647-1");
            pageTracker._trackPageview();
        } catch(err) {}</script>

</body>

<script type="text/javascript" src="/kb/static/generated/main-a1296e499bc7100bac4b45acd72d52305f25cbcb.js"></script>



    



<!-- Start of Async HubSpot Analytics Code -->
<script type="text/javascript">
    (function(d,s,i,r) {
        if (d.getElementById(i)){return;}
        var n=d.createElement(s),e=d.getElementsByTagName(s)[0];
        n.id=i;n.src='//js.hubspot.com/analytics/'+(Math.ceil(new Date()/r)*r)+'/229877.js';
        e.parentNode.insertBefore(n, e);
    })(document,"script","hs-analytics",300000);
</script>
<!-- End of Async HubSpot Analytics Code -->
<script type="text/javascript">
adroll_adv_id = "2SP6TWUIHVGAFLQSCTH5DO";
adroll_pix_id = "CK4ETNKW3BG7LIYWH4AYMI";
(function () {
var oldonload = window.onload;
window.onload = function(){
   __adroll_loaded=true;
   var scr = document.createElement("script");
   var host = (("https:" == document.location.protocol) ? "https://s.adroll.com" : "http://a.adroll.com");
   scr.setAttribute('async', 'true');
   scr.type = "text/javascript";
   scr.src = host + "/j/roundtrip.js";
   ((document.getElementsByTagName('head') || [null])[0] ||
    document.getElementsByTagName('script')[0].parentNode).appendChild(scr);
   if(oldonload){oldonload()}};
}());
</script>
</html>