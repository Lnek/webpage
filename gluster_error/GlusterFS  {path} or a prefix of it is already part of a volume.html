<!doctype html>

<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ -->
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">

    <title>GlusterFS: {path} or a prefix of it is already part of a volume</title>
    <meta name="keywords" content="glusterfs, howto, brick, volume, extended attributes">
    <meta name="description" content="Starting with GlusterFS 3.3, one change has been the check to see if a directory (or any of it&#39;s ancestors) is already part of a volume. This is causing many support questions in #gluster.">
    <meta name="author" content="">

    <!--  Mobile viewport optimized: j.mp/bplateviewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="alternate" type="application/rss+xml" title="RSS" href="/blog/feeds/rss/">
    <link rel="alternate" type="application/atom+xml" title="Atom" href="/blog/feeds/atom/">

    <!-- Place favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
    <link rel="shortcut icon" href="/media/favicon.ico">
    <link rel="apple-touch-icon" href="/media/apple-touch-icon.png">

    <!-- CSS : implied media="all" -->
    <link rel="stylesheet" type="text/css" href="/media/css/base.css?v=3">
    <link rel="stylesheet" type="text/css" href="/media/css/resume.css?v=3">
    <link rel="stylesheet" type="text/css" href="/media/css/style.css?v=2">
    <link href="http://alexgorbatchev.com/pub/sh/current/styles/shCoreEmacs.css" rel="stylesheet" type="text/css" />

    <!-- Uncomment if you are specifically targeting less enabled mobile browsers
    <link rel="stylesheet" media="handheld" href="/media/css/handheld.css?v=2">  -->

    <!-- All JavaScript at the bottom, except for Modernizr which enables HTML5 elements & feature detects -->
    <script src="/media/js/modernizr-1.7.min.js"></script>
    






<!-- Javascript at the bottom for fast page loading -->


<script type="text/javascript">
  (function() {
    var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
    po.src = 'https://apis.google.com/js/plusone.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=60453274336";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



    
<script type="text/javascript" 
    src="http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js">
</script>
<script type="text/javascript">
    $(function() {
            $('.reply').click(function() {
                $(this).next('.comment').toggle();
                });
            });
        </script>
        

</head>
<body >

    <div id="container">

        <header id="header">
            <div id="logo">
                <h1><a href="/">Joe Julian&#39;s Blog</a></h1>
                <h2></h2>
            </div>

            

            

<nav><ul id="menu-top-nav" class="menu"><li id="primary-menu-index" 
        class=" menu-item"><a href="/index/">Welcome</a></li><li id="primary-menu-location_finder_devel" 
        class=" menu-item"><a href="/location_finder_devel/">Location Finder</a></li><li id="primary-menu-resume" 
        class=" last menu-item"><a href="/resume/">Resume</a></li></ul></nav>

            
            <div id="catnav">
                <nav>
                <ul id="nav">
                    
                    <li><a href="/blog/category/cisco/">Cisco</a></li>
                    
                    <li><a href="/blog/category/dogtag/">Dogtag</a></li>
                    
                    <li><a href="/blog/category/glusterfs/">GlusterFS</a></li>
                    
                    <li><a href="/blog/category/howtos/">Howtos</a></li>
                    
                    <li><a href="/blog/category/ipv6/">IPv6</a></li>
                    
                    <li><a href="/blog/category/joomla-plugins/">Joomla! Plugins</a></li>
                    
                    <li><a href="/blog/category/logstash/">Logstash</a></li>
                    
                    <li><a href="/blog/category/mezzanine/">Mezzanine</a></li>
                    
                    <li><a href="/blog/category/openstack/">OpenStack</a></li>
                    
                    <li><a href="/blog/category/puppet/">Puppet</a></li>
                    
                    <li><a href="/blog/category/rants-amp-raves/">Rants &amp; Raves</a></li>
                    
                </ul>
                </nav>
            </div>

        </header>

        <div>
            
            
<div id="fb-root"></div>
<script>(function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=60453274336";
    fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>


<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

<div class="socialtags">
    <div class="google-plus-link">
        <a href="//plus.google.com/113457525690313682370?prsrc=3" rel="publisher" style="text-decoration:none;display:inline-block;color:#333;text-align:center; font:13px/16px arial,sans-serif;white-space:nowrap;">
            <span style="font-weight:bold;">Joe Julian</span> on 
            <img src="//ssl.gstatic.com/images/icons/gplus-16.png" alt="Google+" style="border:0;width:16px;height:16px;vertical-align:bottom;"/></a>
    </div>

    <a href="https://twitter.com/JoeCyberGuru" class="twitter-follow-button" data-show-count="false" data-size="small">Follow @JoeCyberGuru</a>

    <div class="fb-subscribe" data-href="https://www.facebook.com/joe.julian" data-show-faces="false" data-colorscheme="dark" data-width="200" data-layout="button_count"></div>

    <div class="linkedin-tag">
        <a href="http://www.linkedin.com/pub/joe-julian/56/882/63a">
            <img src="http://www.linkedin.com/img/webpromo/btn_profile_bluetxt_80x15.png" border="0" alt="View Joe Julian's profile on LinkedIn">
        </a>
    </div>
</div>

            <div id="content">
                <h1>
GlusterFS: {path} or a prefix of it is already part of a volume
</h1>
                <div id="breadcrumb-menu">
                    
        <ul>
            <li><a href="/">Home</a> &gt;</li>
            <li><a href="/blog/"></a> &gt;</li>
            <li>GlusterFS: {path} or a prefix of it is already part of a volume</li>
        </ul><br />
        
                </div>
        
                
        <article>
        <p>
        <em>
            Posted by
            <strong>
                
                <a href="/blog/author/jjulian/"
                    >Joe Julian</a>
                
            </strong>
            1 year, 2 months ago
        </em>
        (<a href="#comments">comments</a>)
        </p>

        
        <p>Starting with GlusterFS 3.3, one change has been the check to see if a directory (or any of it's ancestors) is already part of a volume. This is causing many support questions in <a href="irc://irc.freenode.net#gluster">#gluster</a>.</p>
<p>This was implemented because if you remove a brick from a volume and continue to use the volume, you can get file into a state where re-adding a former brick can cause all sort of problems, many of which can result in data loss.</p>
<p>If you're going to reuse a brick, make sure you know what you're doing.</p>
<h2>The Solution</h2>
<p>For the directory (or any parent directories) that was formerly part of a volume, simply:</p>
<pre>setfattr -x trusted.glusterfs.volume-id $brick_path
setfattr -x trusted.gfid $brick_path
rm -rf $brick_path/.glusterfs</pre>
<p>Don't worry if it says that the attribute does not exist. As long as it doesn't exist, you're in good shape.</p>
<p>Finally, restart glusterd to ensure it's not "remembering" the old bricks.</p>
<p>See the <a href="https://bugzilla.redhat.com/show_bug.cgi?id=812214">bugzilla entry</a> for more details and see Jeff Darcy's article for more information about how GlusterFS uses <a href="http://hekafs.org/index.php/2011/04/glusterfs-extended-attributes/" target="_blank">extended attributes</a>.</p>
        

        
        
        <div class="tags">
            Tags: 
            <ul>
                
                <li><a href="/blog/tag//" 
                    class="tag-weight-">glusterfs</a></li>
                
                <li><a href="/blog/tag//" 
                    class="tag-weight-">howto</a></li>
                
                <li><a href="/blog/tag//" 
                    class="tag-weight-">brick</a></li>
                
                <li><a href="/blog/tag//" 
                    class="tag-weight-">volume</a></li>
                
                <li><a href="/blog/tag//" 
                    class="tag-weight-">extended attributes</a></li>
                
            </ul>
        </div>
        
        

        <div class="share">
            
            Share this on: 
            <ul>
                <li><div class="g-plusone" data-size="medium" data-annotation="inline" data-width="183"></div>
</li>
                <li><a href="https://twitter.com/share" class="twitter-share-button">Tweet</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</li>
                <li><div class="fb-like" data-send="true" data-layout="button_count" data-width="183" data-show-faces="false" data-action="recommend" data-colorscheme="dark"></div>
</li>
            </ul>
        </div>
        <div id="comments">
            
<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 'False' == 'True';
    var disqus_url = 'http://joejulian.name/blog/glusterfs-path-or-a-prefix-of-it-is-already-part-of-a-volume/';
    var disqus_title = 'GlusterFS: {path} or a prefix of it is already part of a volume';
    var disqus_identifier = 31;
  (function() {
   var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
   dsq.src = 'http://joejulian.disqus.com/embed.js';
   (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>

   
 
        
        </div>

        </article>
        
            </div>
            <div id="sidebar">
                
    <div>
    <h3>Donation</h3>
    <a href="bitcoin:1JHMLuWvCVP6XLhhhQhef4b1kSD92jfzE7?amount=0.1&amp;label=JoeJulian.name%20Donation">
        <img id="bitcoin" src="/media/img/joejulian.name.donation.png" alt="QR Code for Bitcoin Address" />
    </a>
    <p>If you find any of this useful, please consider donating 0.10 bitcoin for a nice mocha brev&eacute;?</p>
    <p> 1JHMLuWvCVP6XLhhhQhef4b1kSD92jfzE7</p>
</div>

    <div>
        <h3>Recent Posts</h3>
        
        <ul>
            
            <li>
            <h3><a href="/blog/how-to-check-and-fix-indexes-for-elasticsearchlogstash/">How To Check (And Fix) Indexes For Elasticsearch/Logstash</a></h3>
            <p>
            </p>
            </li>
            
            <li>
            <h3><a href="/blog/replacing-a-brick-on-glusterfs-340/">Replacing a brick on GlusterFS 3.4.0</a></h3>
            <p>
            </p>
            </li>
            
            <li>
            <h3><a href="/blog/announcing-the-development-of-my-puppet-module-for-dynamic-glusterfs-volumes/">Announcing the development of my Puppet module for dynamic GlusterFS volumes</a></h3>
            <p>
            </p>
            </li>
            
            <li>
            <h3><a href="/blog/centos-6-upstart-overrides-how-to-make-something-happen-before-something-else/">CentOS 6 upstart overrides: How to make something happen before something else</a></h3>
            <p>
            </p>
            </li>
            
            <li>
            <h3><a href="/blog/fedora-19-with-legacy-glusterfs-33/">Fedora 19 with legacy GlusterFS 3.3</a></h3>
            <p>
            </p>
            </li>
            
        </ul>
    </div>
    <div id="advert"><iframe scrolling="no" style="border: 1px solid #ffffff; width: 120px; height: 240px;background-color: #C0C0C0; padding: 20px;" src="http://coinurl.com/get.php?id=363"></iframe></div>



            </div>
            
        </div>

        <footer id="footer">
            <div class="license">
                <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US"><img alt="Creative Commons License" style="border-width:0" src="http://i.creativecommons.org/l/by-sa/3.0/88x31.png" /></a><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/deed.en_US">Creative Commons Attribution-ShareAlike 3.0 Unported License</a>.
            </div>
            <div class="mezzanine">
                Powered by 
                <a href="http://mezzanine.jupo.org" target="_blank">Mezzanine</a><br />
                <a href="/set_device/mobile/?next=/blog/glusterfs-path-or-a-prefix-of-it-is-already-part-of-a-volume/">View Mobile Site.</a>
            </div>
        </footer>

    </div>








<!-- Javascript at the bottom for fast page loading -->

<!-- Grab Google CDN's jQuery. fall back to local if necessary -->

<script src="js/jquery-1.4.4.min.js"></script>





<!-- scripts concatenated and minified via ant build script-->

<!-- end concatenated and minified scripts-->


<!--[if lt IE 7 ]>
  <script src="/media/js/libs/dd_belatedpng.js"></script>
  <script> DD_belatedPNG.fix('img, .png_bg'); //fix any <img> or .png_bg background-images </script>
<![endif]-->




<!-- asynchronous google analytics: mathiasbynens.be/notes/async-analytics-snippet 
     change the UA-XXXXX-X to be your site's ID -->

<script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30984433-1']);
    _gaq.push(['_trackPageview']);

    (function() {
     var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
     ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
     var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
     })();

</script>


<!-- code syntax highlighter -->
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushPython.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushPhp.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushRuby.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushCpp.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushBash.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js" type="text/javascript"></script>
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shAutoloader.js" type="text/javascript"></script>
<script type="text/javascript"> 
    SyntaxHighlighter.defaults['gutter'] = false;
    SyntaxHighlighter.defaults['toolbar'] = false;
    SyntaxHighlighter.all() 
</script>


</body>
</html>
