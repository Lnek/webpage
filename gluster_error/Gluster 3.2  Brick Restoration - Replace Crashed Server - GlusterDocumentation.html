<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">

<head>
	<script type="text/javascript"> 
		var wgBreakFrames = 0;
	</script>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta name="generator" content="MediaWiki 1.20.2" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/community/documentation/opensearch_desc.php" title="GlusterDocumentation (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://gluster.org/community/documentation/api.php?action=rsd" />
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
<link rel="alternate" type="application/atom+xml" title="GlusterDocumentation Atom feed" href="/community/documentation/index.php?title=Special:RecentChanges&amp;feed=atom" />	<title>Gluster 3.2: Brick Restoration - Replace Crashed Server - GlusterDocumentation</title>
	<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "/community/documentation/skins/gluster/main.css"; /*]]>*/</style>
	<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "/community/documentation/skins/gluster/extensions.css"; /*]]>*/</style>
	<link rel="stylesheet" type="text/css" media="print" href="/community/documentation/skins/common/commonPrint.css" />
		<script type="text/javascript" src="/community/documentation/skins/common/wikibits.js"></script>
			    
    
	<script type="text/javascript" src="http://www.gluster.org/global/milonic_src.js"></script>	
	<script type="text/javascript">
	<!--
	if(ns4)_d.write("<scr"+"ipt type=text/javascript src=http://www.gluster.org/global/mmenuns4.js><\/scr"+"ipt>");		
  	else _d.write("<scr"+"ipt type=text/javascript src=http://www.gluster.org/global/mmenudom.js><\/scr"+"ipt>");
	//-->
</script>

<script type="text/javascript" src="http://www.gluster.org/global/menu_data_wiki.js"></script>

</head>

<body       >

<!-- <div id="internal" style="height: 0px;"></div> -->
<div id="wrapContainer"><div id="gheaderbg">
    <div id="gheader">
    
  <div class="gheaderleft"><a href="http://www.gluster.org"><img src="/community/documentation/skins/gluster/gluster-community-logo.png" alt="Gluster" width="484" height="90" border="0" /></a></div>
      <div class="gheaderright">
			<ul id="gnav">
				<li><a href="/community/documentation/index.php/Main_Page"><img src="/wp-content/themes/gluster1/images/documentation.png" alt="Documentation"></a></li>
				<li><a href="/interact"><img src="/wp-content/themes/gluster1/images/contact.png" alt="Contact"></a></li>
				<li><a href="/about"><img src="/wp-content/themes/gluster1/images/about.png" alt="About"></a></li>
				<li><a href="http://forge.gluster.org/"><img src="/wp-content/themes/gluster1/images/developers.png" alt="Developers"></a></li>
				<li><a href="/download"><img src="/wp-content/themes/gluster1/images/download.png" alt="Download"></a></li>
			</ul>
			<div class="social">
				<div style="width: 85px; float: left;"><iframe src="http://www.facebook.com/plugins/like.php?app_id=110215952409351&amp;href=http%3A%2F%2Fwww.facebook.com%2Fpages%2FGluster%2F80854864899&amp;send=false&amp;layout=button_count&amp;width=450&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:450px; height:21px;" allowTransparency="true"></iframe></div>
				<div style="width: 50px; float: left; margin-top: -2px;"><g:plusone count="false"></g:plusone></div>
				<div style="float: left;"><a href="http://twitter.com/share" class="twitter-share-button" data-count="none">Tweet</a></div>
				
				<script type="text/javascript" src="http://platform.twitter.com/widgets.js"></script>

				<!--  Place this tag after the last plusone tag -->
				<script type="text/javascript">
				  (function() {
					var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
					po.src = 'https://apis.google.com/js/plusone.js';
					var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
				  })();
				</script>
			</div>
      </div>
  </div>
</div>


<div style="width: 990px;height: 20px;"></div>


<div id="container">
		<div id="header">
		<a name="top" id="contentTop"></a>
		<h1><a
	    href="/community/documentation/index.php/Main_Page"
	    title="Main Page">Gluster 3.2: Brick Restoration - Replace Crashed Server</a></h1>
		<ul>
		   	<li
		       class="selected"		       ><a href="/community/documentation/index.php/Gluster_3.2:_Brick_Restoration_-_Replace_Crashed_Server">Page</a></li><li
		       		       ><a href="/community/documentation/index.php/Talk:Gluster_3.2:_Brick_Restoration_-_Replace_Crashed_Server">Discussion</a></li><li
		       		       ><a href="/community/documentation/index.php?title=Gluster_3.2:_Brick_Restoration_-_Replace_Crashed_Server&amp;action=edit">View source</a></li><li
		       		       ><a href="/community/documentation/index.php?title=Gluster_3.2:_Brick_Restoration_-_Replace_Crashed_Server&amp;action=history">History</a></li>		</ul>
		<form name="searchform" action="/community/documentation/index.php/Special:Search" id="search">
			<div>
			<label for="q">Search</label>
			<input id="q" name="search" type="text"
			accesskey="f" value="" />
			<!--<input type="submit" name="go" class="searchButton" id="searchGoButton"
	        value=""
	        />-->&nbsp;<input type="submit" name="fulltext"
	        class="searchButton"
	        value="Search" />
	       </div>
		</form>
	</div>

	<div id="mBody">
	
		<div id="side">
			<ul id="nav">
				<li><span>Personal tools</span>
					<ul>
					<li id="pt-createaccount"><a href="/community/documentation/index.php?title=Special:UserLogin&amp;returnto=Gluster+3.2%3A+Brick+Restoration+-+Replace+Crashed+Server&amp;type=signup">Create account</a></li><li id="pt-login"><a href="/community/documentation/index.php?title=Special:UserLogin&amp;returnto=Gluster+3.2%3A+Brick+Restoration+-+Replace+Crashed+Server">Log in</a></li>					</ul>
				</li>
								<li><span>Navigation</span>
						<ul>
										<li id="n-Docs-Home"><a href="/community/documentation/index.php/Main_Page">Docs Home</a></li>
										<li id="n-GlusterFS-Concepts"><a href="/community/documentation/index.php/GlusterFS_Concepts">GlusterFS Concepts</a></li>
										<li id="n-Developers"><a href="/community/documentation/index.php/Developers">Developers</a></li>
										<li id="n-Participate-and-Plan"><a href="/community/documentation/index.php/GlusterPlanning">Participate and Plan</a></li>
										<li id="n-Archives"><a href="/community/documentation/index.php/Archives">Archives</a></li>
										<li id="n-recentchanges"><a href="/community/documentation/index.php/Special:RecentChanges">Recent changes</a></li>
									</ul>
					</li>
								<li><span>Toolbox</span>
					<ul>
					  					  <li id="t-whatlinkshere"><a href="/community/documentation/index.php/Special:WhatLinksHere/Gluster_3.2:_Brick_Restoration_-_Replace_Crashed_Server">What links here</a></li>
					  					  <li id="t-recentchangeslinked"><a href="/community/documentation/index.php/Special:RecentChangesLinked/Gluster_3.2:_Brick_Restoration_-_Replace_Crashed_Server">Related changes</a></li>
					  				      				      				      				      				      				      				      				      				      <li id="t-specialpages"><a href="/community/documentation/index.php/Special:SpecialPages">Special pages</a></li>				      					</ul>
				</li>
							</ul>
		</div><!-- end of SIDE div -->
		
		<div id="mainContent">
			<div id="toc_holder"> </div>
			<h1>Gluster 3.2: Brick Restoration - Replace Crashed Server</h1>

			<h3 id="siteSub">From GlusterDocumentation</h3>
			<div id="contentSub"></div>
									<!-- start content -->
			<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>This procedure is for replacing a failed server, IF your newly installed server has the same hostname as the failed one:
</p><p>(If your new server will have a different hostname, see <a rel="nofollow" class="external text" href="http://community.gluster.org/q/a-replica-node-has-failed-completely-and-must-be-replaced-with-new-empty-hardware-how-do-i-add-the-new-hardware-and-bricks-back-into-the-replica-pair-and-begin-the-healing-process/">this article</a> instead.)
</p><p>For purposes of this example, the server that crashed will be <i>server3</i> and the other servers will be <i>server1</i> and <i>server2</i>
</p>
<ul>
<li>On both server1 and server2, make sure hostname server3 resolves to the correct IP address of the new replacement server.</li>
<li>On either server1 or server2, do 
<pre>grep server3 /var/lib/glusterd/peers/*</pre>
This will return a uuid followed by ":hostname1=server3"</li>
<li>On server3, make sure glusterd is stopped, then do
<pre>echo UUID={uuid from previous step}&gt;/var/lib/glusterd/glusterd.info</pre>
</li>
<li>On server3:
<ul><li> make sure that all brick directories are created/mounted
</li><li> start glusterd
</li><li> peer probe one of the existing servers
</li><li> restart glusterd, check that full peer list has been populated using <pre>gluster peer status</pre>
</li><li> (if peers are missing, probe them explicitly, then restart glusterd again)
</li><li> check that full volume configuration has been populated using <pre>gluster volume info</pre>
</li><li> if volume configuration is missing, do <br /><pre>gluster volume sync server1 all</pre></li>
</li></ul>
<li>restart glusterd</li>
</ul>
<p>This will restore the configuration for this server.
</p><p>Follow this procedure by <a href="/community/documentation/index.php/Gluster_3.2:_Triggering_Self-Heal_on_Replicate" title="Gluster 3.2: Triggering Self-Heal on Replicate"> Triggering Self-Heal on Replicate</a>
</p><p>Or if the failed server only hosted a fraction of the whole volume, you could use <a rel="nofollow" class="external text" href="http://community.gluster.org/a/howto-targeted-self-heal-repairing-less-than-the-whole-volume/">targeted self heal</a>
</p>
<!-- 
NewPP limit report
Preprocessor visited node count: 16/1000000
Preprocessor generated node count: 104/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 2/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key wikidb-GlusterDocs:pcache:idhash:2699-0!*!0!*!*!*!* and timestamp 20130813174530 -->
<!-- Bad Behavior 2.2.7 run time: 11.867 ms --></div><div class="printfooter">
Retrieved from "<a href="http://gluster.org/community/documentation/index.php?title=Gluster_3.2:_Brick_Restoration_-_Replace_Crashed_Server&amp;oldid=13567">http://gluster.org/community/documentation/index.php?title=Gluster_3.2:_Brick_Restoration_-_Replace_Crashed_Server&amp;oldid=13567</a>"</div>
			<div id="catlinks"><div id='catlinks' class='catlinks catlinks-allhidden'></div></div>			<!-- end content -->

		</div><!-- end of MAINCONTENT div -->	
	
	</div><!-- end of MBODY div -->

	<div id="footer"><table><tr><td align="left" width="1%" nowrap="nowrap">
		<div id="f-copyrightico"><a href="http://www.gnu.org/copyleft/fdl.html"><img src="/community/documentation/skins/common/images/gnu-fdl.png" alt="GNU Free Documentation License 1.3 or Later" width="88" height="31" /></a></div></td><td align="center">
		<span id="f-lastmod"> This page was last modified on 23 July 2013, at 20:10.</span>		<span id="f-viewcount">This page has been accessed 9,353 times. </span>		<ul id="f-list">
						<li id="f-copyright">Content is available under <a class="external" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or Later</a>.</li>			<li id="f-about"><a href="/community/documentation/index.php/GlusterDocumentation:About" title="GlusterDocumentation:About">About GlusterDocumentation</a></li>			<li id="f-disclaimer"><a href="/community/documentation/index.php/GlusterDocumentation:General_disclaimer" title="GlusterDocumentation:General disclaimer">Disclaimers</a></li>		</ul></td><td align="right" width="1%" nowrap="nowrap"><div id="f-poweredbyico"><a href="//www.mediawiki.org/"><img src="/community/documentation/skins/common/images/poweredby_mediawiki_88x31.png" height="31" width="88" alt="Powered by MediaWiki" /></a></div></td></tr></table>
	</div><!-- end of the FOOTER div -->
</div><!-- end of the CONTAINER div -->

<div id="gfooterbg">

    <div id="gfooter">
		<div class="gfooterleft">
        	<p>&nbsp;</p>
        </div>
        <div class="gfooterright">
        	<p>Copyright &copy; <script language="JavaScript"><!--
//document.write(" 2005-");
    today=new Date();
    year0=today.getFullYear();
    document.write(year0);
//-->
    </script> Gluster, Inc. All Rights Reserved. </p>

        </div>
	
    </div>
    <div class="clear"></div>
</div>


</div>
<!-- Served in 0.290 secs. --><script type="text/javascript">
	var toc = document.getElementById('toc');
	var toc_holder = document.getElementById('toc_holder');
	if(toc && toc_holder){
		toc.parentNode.removeChild(toc);
		toc_holder.appendChild(toc);
		}
</script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-10444844-3");
pageTracker._setDomainName(".gluster.org");
pageTracker._trackPageview();
} catch(err) {}</script>
<script type="text/javascript">
jQuery(document).ready(function($) {
	$('#mw-content-text div[style*=ffca45],#mw-content-text p[style*=ffca45],#mw-content-text div[style*=FF0000],#mw-content-text p[style*=FF0000]').css(
				{
					"color":"#777777",
					"background":"#FCF8E3",
					"border":"1px solid #FBEED5",
					"max-width":"440px",
					"padding":"20px",
					"border-radius":"4px",
					"text-align":"center",
					"margin-left":"0"
				}
			).addClass('notification-box');
});
</script>
</body>
<!-- Cached 20130813174530 -->
</html>
