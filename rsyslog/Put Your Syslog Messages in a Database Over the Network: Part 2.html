<html>
<head>
<meta name="baidu-site-verification" content="M73URWQMP43fyT02" />
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META name="y_key" content="10269744d3bf1807" />
<meta name="description" content="中国Linux大学 -- 汇集最新最全的Linux电子书,技术文章,新闻资讯,软件资源,开源书讯,幽默趣图,周报杂志,资源网站链接和内核补丁" />
<meta name="keywords" content="Linux,C,C++,Java,Ajax,XML,perl,php,python,ruby,MySQL,Gnome,KDE,Qt,Gtk,bash,shell,嵌入式,网络,信息安全,操作系统,数据结构,编译原理,社区,入门,下载,教程,命令,新闻,论坛,开源,自由软件" />
<link rel="icon" href="/clu-bookmark.png" type="image/png">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University Courses" href="/courses-rss-feed-2.0.xml">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University News" href="/news-rss-feed-2.0.xml">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University Articles" href="/articles-rss-feed-2.0.xml">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University eBooks and Softwares" href="/ewares-rss-feed-2.0.xml">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University Resource Websites" href="/resourcesites-rss-feed-2.0.xml">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University Issues" href="/issues-rss-feed-2.0.xml">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University LKML Patches" href="/patches-rss-feed-2.0.xml">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University Linux 2.6 Git Patches" href="/gitpatches-rss-feed-2.0.xml">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University Open Source Book News" href="/osbooknews-rss-feed-2.0.xml">
<link rel="alternate" type="application/rss+xml" title="Chinese Linux University Open Source Humor&Interesting Images" href="/ospics-rss-feed-2.0.xml">
<link rel="stylesheet" type="text/css" href="/css/clu.css"/>
<title>Put Your Syslog Messages in a Database Over the Network: Part 2 -- Linux,C,C++,Java,Ajax,XML,perl,php,python,ruby,MySQL,Gnome,KDE,Qt,Gtk,bash,shell,嵌入式,网络,信息安全,操作系统,数据结构,编译原理</title>
</head>
<body>
<center>
<div class=mainpage>
<div class="logo"><img src="/clu-logon-small.jpg" alt="CLU Logo"></div>
<div class="advertise" id="flashcontent">Flash Advertise</div>
<script type="text/javascript" src="/cluflash.js"></script>
<script type="text/javascript">
var fo = new FlashObject("/logo.swf", "mymovie", "600", "150", "7", "#336699");
fo.addParam("quality", "high");
   fo.addParam("wmode", "transparent");
   fo.addParam("salign", "t");
   fo.addParam("scale", "noscale");
fo.addParam("loop", "true");
   fo.write("flashcontent");
</script>
<script type="text/javascript">/*760*90，创建于2013-3-13*/ var cpro_id = "u1202770";</script>
<script src="http://cpro.baidustatic.com/cpro/ui/c.js" type="text/javascript"></script>

<script type="text/javascript">/*侧栏悬浮广告，120*270，创建于2012-7-15*/ var cpro_id = 'u983629';</script><script src="http://cpro.baidu.com/cpro/ui/f.js" type="text/javascript"></script>

<div class="nav"><marquee direction=left align=middle border=1><font color="red">欢迎您进入中国Linux大学, 目前我们的总注册用户数 34663</font></marquee>
</div>
<div class="searchbar">
<!-- Google CSE Search Box Begins -->
  <form id="searchbox_001216326587865095713:uc_bnek8axs" action="/googlesearch.php">
    <table border=0 width=100%><tr align=left>
    <td align=lef>
    <input type="hidden" name="cx" value="001216326587865095713:uc_bnek8axs" />
    <input type="hidden" name="cof" value="FORID:9" />
    Google定制搜索:&nbsp;<input name="q" type="text" size="40" />
    <input type="submit" name="sa" value=" 搜索站内资源 " /></td><td align=right>2013年3月25日 星期一&nbsp;</td>
    </tr></table>
  </form>
<!-- Google CSE Search Box Ends -->
</div>
<div class="searchbar"></div>
<div class="channelbar">
&nbsp;<a href="http://www.chineselinuxuniversity.net/courses/"><font class=channel>Linux大学</font></a>&nbsp;|
<a href="http://www.chineselinuxuniversity.net/resourcesites/"><font class=channel>资源站点</font></a>&nbsp;|
<a href="http://www.chineselinuxuniversity.net/osbooknews/"><font class=channel>开源书讯</font></a>&nbsp;|
<a href="http://www.chineselinuxuniversity.net/ospics/"><font class=channel>幽默趣图</font></a>&nbsp;|
<a href="http://www.chineselinuxuniversity.net/news/"><font class=channel>新闻</font></a>&nbsp;|
<a href="http://www.chineselinuxuniversity.net/articles/"><font class=channel>技术文章</font></a>&nbsp;|
<a href="http://www.chineselinuxuniversity.net/ewares/"><font class=channel>开源软件</font></a>&nbsp;|
<a href="http://www.chineselinuxuniversity.net/issues/"><font class=channel>周报杂志</font></a>&nbsp;|
<a href="http://www.chineselinuxuniversity.net/allpatches/"><font class=channel>内核补丁</font></a>&nbsp;|
<a href="http://www.chineselinuxuniversity.net/freesky/"><font class=channel>自由时空</font></a>
</div>
<div class="searchbar"><div id="rectanglebox" style="float: left; width: 100%; height: 165; clear: both;">
  <div id="top">Linux大学课程导航</div>


<table width="100%" cellspacing=2 cellpadding=0>
<tr bgcolor="#e0e0e0">

<td valign=top width=16%>
<table>
<tr><td>&nbsp;&nbsp;大一课程</td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/c/">C</a>·<a href="/courses/cplusplus/">C++</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/assembly/">汇编语言</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/software/">软件</a>·<a href="/courses/hardware/">硬件</a></td></tr>
</table>
</td>

<td valign=top width=16%>
<table>
<tr><td>&nbsp;&nbsp;大二课程</td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/algorithm/">算法与数据结构</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/compiler/">编译原理</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/os/">操作系统理论</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/network/">计算机网络</a></td></tr>
</table>
</td>

<td valign=top width=16%>
<table>
<tr><td>&nbsp;&nbsp;大三课程</td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/using/">Linux使用</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/application/">Linux应用开发</a></td></tr>
</table>
</td>

<td valign=top width=16%>
<table>
<tr><td>&nbsp;&nbsp;大四课程</td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/kernel/">Linux内核开发</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/embedded/">Linux嵌入式开发</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/courses/netsec/">网络与信息安全</a></td></tr>
</table>
</td>

<td valign=top width=16%>
<table>
<tr><td>&nbsp;&nbsp;实用工具</td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/kerneldocs/index.html">Linux内核文档</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/man-pages/index.html">Linux手册大全</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/linuxdict/">Linux词典</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/mcd5/">微软计算机词典</a></td></tr>
</table>
</td>

<td valign=top width=16%>
<table>
<tr><td>&nbsp;&nbsp;在线书籍</td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/c-primer-plus-5/toc.html">C Primer Plus</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/cplusplus-primer-plus-4/toc.html">C++ Primer Plus</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/cplusplus-primer-4-cn/zhtoc.html">C++ Primer中文</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/thinking-in-java-3/TIJ3fc.htm">Thinking in Java</a></td></tr>
<tr><td>&nbsp;&nbsp;·<a href="/thinking-in-java-cn/index.htm">Java编程思想</a></td></tr>
</table>
</td>

</tr>
</table>
</div>
<div id="rectanglebox" style="float: left; width: 100%; height: 70; clear: both">
  <div id="top">用户注册/登录/注销/贡献资源</div>
<table width="100%" bgcolor=white cellpadding=0 cellspacing=0 style="font-size: 12px;">
<tr><td>
<table style="font-size: 12px;">
<tr><td><font style="font-size: 12px;">注册用户可以享受更多服务, 包括下载电子书籍, 阅读全文, 发布您的资源与别人共享, 搜索站内资源. 注册用户贡献资源可以积累积分, 能下载更多资源.</font></td></tr>
<form  name=login action="http://www.chineselinuxuniversity.net/user_login.php" method="post">
<tr><td valign="middle" style="font-size: 12px;">用户名:<input type="text" name="username" size=8 maxlength=16>&nbsp;&nbsp;密码:&nbsp;&nbsp;<input type="password" name="password" size=8 maxlength=16><input type="submit" value="登录">&nbsp;&nbsp;<input type="submit" value="忘记密码" onclick="Javascript:document.login.action='http://www.chineselinuxuniversity.net/get_password.php'; return true;">&nbsp;&nbsp;<input type="submit" value="用户注册" onclick="Javascript:document.login.action='http://www.chineselinuxuniversity.net/user_register.php'; return true;">
</form>
</td></tr>
</table>
</td></tr>
</table>
</div>
<script type="text/javascript">/*主题链接 728*15，创建于2012-7-15*/ var cpro_id = 'u983741';</script><script src="http://cpro.baidu.com/cpro/ui/c.js" type="text/javascript"></script>
<div width=100% style="background: white; clear: both"><br></div>
</div>
<div class="mainbody">
<div style="bgcolor: #FFFFFF"><table bgcolor="#FFFFFF" width=100% cellpadding=0 cellspacing=0><tr><td align="center"><font class="articletitle">Put Your Syslog Messages in a Database Over the Network: Part 2</font></td></tr><tr><td><hr size=1></td></tr><tr><td align="center">From: <a href="http://ldn.linuxfoundation.org">ldn.linuxfoundation.org</a>&nbsp;&nbsp;read times: 1000</td></tr><tr><td><br><br>Provided by <a href="mailto:yang.y.yi@gmail.com">yangyi</a> at 2009-08-25 23:08:16</td></tr><tr><td><br><br><center>
<script type="text/javascript">/*760*90，创建于2011-4-11，文章正文*/ var cpro_id = 'u442445';</script><script src="http://cpro.baidu.com/cpro/ui/c.js" type="text/javascript"></script>
</center>
<p><a href="http://ldn.linuxfoundation.org/article/how-are-open-source-software-projects-surviving-recession">Last time around</a> we looked at the theory behind the       over-the-network syslog message delivery into a PostgreSQL       database. This time we'll get our hands dirty and make it       happen.</p>      <p>First we'll get the server machine talking to PostgreSQL and       able to send syslog messages generated on the server to it       through a message queue. Then we'll turn to setting up RELP from       the client to the server and a special queue on the client in       case the server drops out temporarily.</p>      <p>First we have to create a PostgreSQL database to store the       messages into. The below commands will create a Syslog database       on the server and a new syslog PostgreSQL user who can insert       data into the system log database but nothing else. Because       there are serial primary keys in both tables, access to the       sequence tables is needed in order to actually insert data into       either SystemEvents or SystemEventsProperties.</p>  <pre>psql &lt; /usr/share/doc/rsyslog-pgsql-3.21.11/createDB.sql
psql Syslog
create user syslog;
alter  user syslog password 'foo';
GRANT INSERT ON TABLE systemevents TO syslog;
GRANT INSERT ON TABLE systemeventsproperties TO syslog;
GRANT UPDATE ON TABLE systemevents_id_seq TO syslog;
GRANT UPDATE ON TABLE systemeventsproperties_id_seq TO syslog;

</pre>      <p>Adding the below lines to your /etc/rsyslog.conf file will start       logging everything that would normally go to /var/log/messages       into your PostgreSQL database too. The call to logger will       generate a syslog message "foo" which you should be able to see       both in your /var/log/messages and in the Syslog.systemevents       table. The latter will also contain two messages informing you       that rsyslog was restarted. The line beginning       with <code>*.info</code> is called a selector in rsyslog       terminology. A selector is used in an if-then block, the first       part checks to see if a message has a desired property and the       then block says what to do with those messages. What you do with       a message is called the Action. In this case, all info messages       are sent to PostgreSQL. rsyslog processes all the selectors in       /etc/rsyslog.conf in order. If you want to stop processing from       continuing you can use the tilde Action which tells rsyslog to       disregard the message.</p>  <pre># emacs /etc/rsyslog.conf
...
$ModLoad ompgsql
*.info;mail.none;authpriv.none;cron.none  :ompgsql:127.0.0.1,Syslog,syslog,foo
...
# /etc/init.d/rsyslog reload
# logger foo
</pre>      <p>So now messages are flowing into our PostgreSQL database, we       should put something in place to handle bursts of messages which       might overwhelm our PostgreSQL server. There are two kinds of       queues that rsyslog supports, a global "main queue" and a queue       which is just for the next Action. In our case, the       final <code>*.info...</code> line contains the action (logging       to postgresql), so the <code>$Action</code> lines setup a       message queue just for that action. If you have other actions       leading the the postgresql database, you should setup queues for       them too, using a different ActionQueueFileName so they don't       stomp on each other.</p><p>......</p><p>Please access the below link to view the full content.</p><p>Original link: <a href="http://ldn.linuxfoundation.org/article/put-your-syslog-messages-a-database-over-network-part-2">http://ldn.linuxfoundation.org/a...</a></p>
</td></tr></table></div></div>
<div class="searchbar"></div>
<div class="footer">
<hr size="1">
<script type="text/javascript">/*760*90页尾，创建于2011-1-16*/ var cpro_id = 'u353380';</script><script src="http://cpro.baidu.com/cpro/ui/c.js" type="text/javascript"></script>
<div class="bottombar">
<a href="http://www.chineselinuxuniversity.net/about_us.shtml" target="_blank">关于我们</a> | <a href="http://www.chineselinuxuniversity.net/contactus.shtml" target="_blank">联系方式</a> | <a href="http://www.chineselinuxuniversity.net/advertise.shtml" target="_blank">投放广告</a> | <a href="http://www.chineselinuxuniversity.net/donate.shtml" target="_blank">赞助我们</a> | <a href="http://www.chineselinuxuniversity.net/feedback.shtml" target="_blank">用户反馈</a> | <a href="http://www.chineselinuxuniversity.net/friendlinks.shtml">友情链接</a>
</div>
www.chineselinuxuniversity.net由一个Linux爱好者创办<br>
Copyright © 2006 Chinese Linux University, All Rights Reserved<br>
ICP备案编号：<a href="http://www.miibeian.gov.cn/share/cx_dwfl_daimabiao.jsp?id=3">京ICP备07002196号</a>
</div>

</div>
</center>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F6afd3573cd8f288948fe8589f75214ca' type='text/javascript'%3E%3C/script%3E"));
</script>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript">
</script>
<script type="text/javascript">
_uacct = "UA-2101722-1";
urchinTracker();
</script>
<div style="text-align: center;"><script type="text/javascript" language="JavaScript" src="http://xslt.alexa.com/site_stats/js/t/c?url=www.chineselinuxuniversity.net"></script></div>
</body>
</html>

