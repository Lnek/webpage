<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
     
    <html xmlns="http://www.w3.org/1999/xhtml">
    
<head>
    <title>C++调用PythonAPI线程状态和全局解释器锁 - 李海波 -- 做影响一亿人的产品
        - 博客频道 - CSDN.NET</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="description" content="&lt;!--		@page { size: 21cm 29.7cm; margin: 2cm }		P { margin-bottom: 0.21cm }		PRE.western { font-family: Courier New, monospace }		PRE.cjk { font-family: 新宋体, monospace }		PRE.ctl { font-" />
    <script src="http://static.blog.csdn.net/scripts/jquery.js" type="text/javascript"></script>
    <script type="text/javascript" src="http://static.blog.csdn.net/scripts/ad.js?v=1.1"></script>
        <!--new top-->
               <link rel="stylesheet" href="http://static.csdn.net/public/common/toolbar/css/index.css">        <!--new top-->

    <link rel="Stylesheet" type="text/css" href="http://static.blog.csdn.net/skin/default/css/style.css?v=1.1" />
    <link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="/marising/rss/list" />
    <link rel="shortcut icon" href="http://csdnimg.cn/public/favicon.ico" />
    <link type="text/css" rel="stylesheet" href="http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/default.css" />
 

</head>
<body>
    
   
      <!--new top-->
    <script id="toolbar-tpl-scriptId" fixed="true" prod="blog" skin="black" src="http://static.csdn.net/public/common/toolbar/js/html.js" type="text/javascript"></script>
     <!--new top-->
    <div id="container">
        <div id="header">
    <div class="header">
        <div id="blog_title">
            <h2>
                <a href="http://blog.csdn.net/marising">李海波 -- 做影响一亿人的产品</a></h2>
            <h3>路漫漫其修远兮，吾将上下而求索 -- weibo.com/haiboli</h3>
            <div class="clear">
            </div>
        </div>
        <div class="clear">
        </div>
    </div>
</div>
<div id="navigator">
    <div class="navigator_bg">
    </div>
    <div class="navigator">
        <ul>
                <li id="btnContents"><a href="http://blog.csdn.net/marising?viewmode=contents"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_mulu'])">
                    <img src="http://static.blog.csdn.net/images/ico_list.gif">目录视图</span></a></li>
                <li id="btnView"><a href="http://blog.csdn.net/marising?viewmode=list"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_zhaiyao'])">
                    <img src="http://static.blog.csdn.net/images/ico_summary.gif">摘要视图</span></a></li>
                <li id="btnRss"><a href="http://blog.csdn.net/marising/rss/list"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_RSS'])">
                    <img src="http://static.blog.csdn.net/images/ico_rss.gif">订阅</span></a></li>
</ul>
    </div>
</div>
<script type="text/javascript">
    var username = "marising";
    var _blogger = username;
    var blog_address = "http://blog.csdn.net/marising";
    var static_host = "http://static.blog.csdn.net";
    var currentUserName = "";
</script>

        <div id="body">
            <div id="main">
                <div class="main">
<div class="notice tracking-ad" data-mod='popu_3' > 

<a href="http://blog.csdn.net/blogdevteam/article/details/24000231"target="_blank">
<font color=red>云计算大会抢票倒计时
</font></a>
&nbsp;&nbsp;&nbsp;&nbsp;

<a href="http://student.csdn.net/mcs/programming_challenges"target="_blank">
<font color=blue>高校俱乐部“我是Coding之星”
</font></a>
&nbsp;&nbsp;&nbsp;&nbsp;

<a href="http://blog.csdn.net/blogdevteam/article/details/24601939"target="_blank">
<font color=red>【公告】博客数据异常已全部恢复 
</font></a>
</div>                    <link href="http://static.blog.csdn.net/css/comment1.css" type="text/css" rel="stylesheet" />
<link href="http://static.blog.csdn.net/css/style1.css" type="text/css" rel="stylesheet" />
<div id="article_details" class="details">
    <div class="article_title">   
         <span class="ico ico_type_Repost"></span>


    <h1>
        <span class="link_title"><a href="/marising/article/details/3032278">
        C++调用PythonAPI线程状态和全局解释器锁
        </a></span>
    </h1>
</div>

    <div class="article_manage">
        <span class="link_categories">
        分类：
            <a href="/marising/article/category/337706" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_fenlei']);">2.Linux/C/Python</a> 
        </span>
    <span class="link_postdate">2008-10-08 11:21</span>
    <span class="link_view" title="阅读次数">1978人阅读</span>
    <span class="link_comments" title="评论次数"><a href="#comments" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_pinglun'])">评论</a>(0)</span>
    <span class="link_collect"><a href="javascript:void(0);" onclick="javascript:_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shoucang']);collectArticle('C++调用PythonAPI线程状态和全局解释器锁','3032278');return false;" title="收藏">收藏</a></span>
    <span class="link_report"><a href="#report"  onclick="javascript:_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_jubao']);report(3032278,2);return false;" title="举报">举报</a></span>
    
</div>
<div class="tag2box"><a href='http://www.csdn.net/tag/c%2b%2b' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">c++</a><a href='http://www.csdn.net/tag/thread' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">thread</a><a href='http://www.csdn.net/tag/python' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">python</a><a href='http://www.csdn.net/tag/function' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">function</a><a href='http://www.csdn.net/tag/structure' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">structure</a><a href='http://www.csdn.net/tag/null' target=_blank onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_tag']);">null</a></div>

    
<div id="article_content" class="article_content">
<p><!--
		@page { size: 21cm 29.7cm; margin: 2cm }
		P { margin-bottom: 0.21cm }
		PRE.western { font-family: "Courier New", monospace }
		PRE.cjk { font-family: "新宋体", monospace }
		PRE.ctl { font-family: "新宋体", monospace }
		H3 { margin-bottom: 0.21cm }
		H3.western { font-family: "Times New Roman", serif }
		H3.cjk { font-family: "宋体"; font-style: normal }
		H3.ctl { font-family: "Tahoma" }
--></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Python官方文档链接如下：</span></span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;"><a href="http://docs.python.org/c-api/init.html#thread-state-and-the-global-interpreter-lock">http://docs.python.org/c-api/init.html#thread-state-and-the-global-interpreter-lock</a></span></span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">本人在网上翻译版本的基础上修改了。</span></span></p>
<p>&nbsp;</p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">The Python interpreter is not fully thread safe. In order to support multi-threaded Python programs, there's a global lock that must be held by the current thread before it can safely access Python objects. Without the lock, even the simplest operations could cause problems in a multi-threaded program: for example, when two threads simultaneously increment the reference count of the same object, the reference count could end up being incremented only once instead of twice. </span></span></p>
<p><span style="font-size: medium;"><span style="font-family: Times New Roman, serif;">Python </span>解释器不是完全线程安全的。为了支持多线程Python程序，当前线程在安全访问Python对象之前，必须持有全局锁（GIL，Global Interpreter Lock，全局解释器锁）。如果没有锁，多线程中甚至最简单的操作都会发生问题。例如，两个线程同时增加一个对象的引用计数，该引用计数可能只增加了一次而非两次。 </span></p>
<p>&nbsp;</p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Therefore, the rule exists that only the thread that has acquired the global interpreter lock may operate on Python objects or call Python/C API functions. In order to support multi-threaded Python programs, the interpreter regularly releases and reacquires the lock -- by default, every 100 bytecode instructions (this can be changed with sys.setcheckinterval()). The lock is also released and reacquired around potentially blocking I/O operations like reading or writing a file, so that other threads can run while the thread that requests the I/O is waiting for the I/O operation to complete. </span></span></p>
<p><span style="font-size: medium;">因此，存在一个规则：只有获得了全局解释器锁的线程才能操作 <span style="font-family: Times New Roman, serif;">Python </span>对象或者调用<span style="font-family: Times New Roman, serif;">Python/C API </span>函数。为了支持多线程 <span style="font-family: Times New Roman, serif;">Python </span>编程，解释器有规律的释放和回收锁&mdash;&mdash;默认情况下，每<span style="font-family: Times New Roman, serif;">100</span>字节指令集循环一次（可以通过<span style="font-family: Times New Roman, serif;">sys.setcheckinterval()</span>设置）。类似文件读写之类的 <span style="font-family: Times New Roman, serif;">i/o </span>片也会随锁释放和回收，这样其它的线程在请求 <span style="font-family: Times New Roman, serif;">I/O </span>操作的线程等待<span style="font-family: Times New Roman, serif;">I/O</span>操作完成的时候也可以运行。 </span></p>
<p>&nbsp;</p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">The Python interpreter needs to keep some bookkeeping information separate per thread -- for this it uses a data structure called PyThreadState. There's one global variable, however: the pointer to the current PyThreadState structure. While most thread packages have a way to store "per-thread global data", Python's internal platform independent thread abstraction doesn't support this yet. Therefore, the current thread state must be manipulated explicitly. </span></span></p>
<p><span style="font-size: medium;"><span style="font-family: Times New Roman, serif;">Python</span>解释器需要为每个独立的线程保留一些薄记信息&mdash;&mdash;为此它使用一个称为<span style="font-family: Times New Roman, serif;">PyThreadState</span>的数据结构。然而，这是一个全局变量：当前 <span style="font-family: Times New Roman, serif;">PyThreadState </span>结构的指针。尽管大多数线程包都有办法保存&ldquo;每线程全局数据&rdquo;，<span style="font-family: Times New Roman, serif;">Python </span>的内置平台无关线程指令还不支持它。因此，必须明确操作当前的线程状态。 </span></p>
<p>&nbsp;</p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This is easy enough in most cases. Most code manipulating the global interpreter lock has the following simple structure: </span></span></p>
<p><span style="font-size: medium;">大多数境况下这都是很简单的。全局解释器锁的操作代码主要是以下结构： </span></p>
<pre class="cjk"><span style="font-size: medium;"><span style="font-family: Courier New, monospace;"><textarea cols="50" rows="15" name="code" class="c-sharp">Save the thread state in a local variable.   
Release the interpreter lock.   
...Do some blocking I/O operation...   
Reacquire the interpreter lock.   
Restore the thread state from the local variable.</textarea> </span></span></pre>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This is so common that a pair of macros exists to simplify it: </span></span></p>
<p><span style="font-size: medium;">这种方式如此通用，我们可以用一对现成的宏来简化它： </span></p>
<pre class="cjk"><span style="font-size: medium;"><span style="font-family: Courier New, monospace;"><textarea cols="50" rows="15" name="code" class="cpp">Py_BEGIN_ALLOW_THREADS   
...Do some blocking I/O operation...   
Py_END_ALLOW_THREADS</textarea> </span></span></pre>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">The Py_BEGIN_ALLOW_THREADS macro opens a new block and declares a hidden local variable; the Py_END_ALLOW_THREADS macro closes the block. Another advantage of using these two macros is that when Python is compiled without thread support, they are defined empty, thus saving the thread state and lock manipulations. </span></span></p>
<p><span style="font-size: medium;"><span style="font-family: Times New Roman, serif;">Py_BEGIN_ALLOW_THREADS </span>宏打开一个新的 <span style="font-family: Times New Roman, serif;">block </span>并且定义一个隐藏的局部变量；<span style="font-family: Times New Roman, serif;">Py_END_ALLOW_THREADS </span>宏关闭这个 <span style="font-family: Times New Roman, serif;">block </span>。这两个宏还有一个高级的用途：如果 <span style="font-family: Times New Roman, serif;">Python </span>编译为不支持线程的版本，他们定义为空，因此保存线程状态并锁定操作。</span></p>
<p><span style="font-size: medium;">&nbsp;</span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">When thread support is enabled, the block above expands to the following code: </span></span></p>
<p><span style="font-size: medium;">如果支持线程，这个 <span style="font-family: Times New Roman, serif;">block </span>就会展开为以下代码：</span></p>
<pre class="cjk"><span style="font-size: medium;"><span style="font-family: Courier New, monospace;"><textarea cols="50" rows="15" name="code" class="cpp">PyThreadState *_save;   
_save = PyEval_SaveThread();
//...Do some blocking I/O operation...   
PyEval_RestoreThread(_save);</textarea> </span></span></pre>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Using even lower level primitives, we can get roughly the same effect as follows: </span></span></p>
<p><span style="font-size: medium;">使用更低级的元素，我们可以获得同样的效果： </span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;"><textarea cols="50" rows="15" name="code" class="c-sharp">PyThreadState *_save;   
_save = PyThreadState_Swap(NULL);   
PyEval_ReleaseLock();   
//...Do some blocking I/O operation...   
PyEval_AcquireLock();   
PyThreadState_Swap(_save);
</textarea> </span></span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">There are some subtle differences; in particular, PyEval_RestoreThread() saves and restores the value of the global variable errno, since the lock manipulation does not guarantee that errno is left alone. Also, when thread support is disabled, PyEval_SaveThread() and PyEval_RestoreThread() don't manipulate the lock; in this case, PyEval_ReleaseLock() and PyEval_AcquireLock() are not available. This is done so that dynamically loaded extensions compiled with thread support enabled can be loaded by an interpreter that was compiled with disabled thread support. </span></span></p>
<p><span style="font-size: medium;">这里有些微妙的不同，细节上，因为锁操作不保证全局变量 <span style="font-family: Times New Roman, serif;">erron </span>的一致，<span style="font-family: Times New Roman, serif;">PyEval_RestoreThread() </span>保存和恢复 <span style="font-family: Times New Roman, serif;">errno</span>。同样，不支持线程时，<span style="font-family: Times New Roman, serif;">PyEval_SaveThread() </span>和 <span style="font-family: Times New Roman, serif;">PyEval_RestoreThread() </span>不操作锁，在这种情况下 <span style="font-family: Times New Roman, serif;">PyEval_ReleaseLock() </span>和 <span style="font-family: Times New Roman, serif;">PyEval_AcquireLock() </span>不可用。这使得不支持线程的解释器可以动态加载支持线程的扩展。 </span></p>
<p>&nbsp;</p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">The global interpreter lock is used to protect the pointer to the current thread state. When releasing the lock and saving the thread state, the current thread state pointer must be retrieved before the lock is released (since another thread could immediately acquire the lock and store its own thread state in the global variable). Conversely, when acquiring the lock and restoring the thread state, the lock must be acquired before storing the thread state pointer. </span></span></p>
<p><span style="font-size: medium;">全局解释器锁用于保护当前线程状态的指针。当释放锁并保存状态的时候，当前线程状态指针必须在锁释放之前回收（因为另一个指针将会随之获取锁并且在全局变量中保存它自己的线程状态）。相反，获取锁并恢复线程状态的时候，锁必须在保存状态指针之前就获得。 </span></p>
<p>&nbsp;</p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Why am I going on with so much detail about this? Because when threads are created from C, they don't have the global interpreter lock, nor is there a thread state data structure for them. Such threads must bootstrap themselves into existence, by first creating a thread state data structure, then acquiring the lock, and finally storing their thread state pointer, before they can start using the Python/C API. When they are done, they should reset the thread state pointer, release the lock, and finally free their thread state data structure. </span></span></p>
<p><span style="font-size: medium;">为什么我要对这些进行详细介绍？因为从 <span style="font-family: Times New Roman, serif;">C </span>中创建线程的时候，它们没有全局解释器锁，也没有对应的线程状态数据结构。这些线程在他们使用 <span style="font-family: Times New Roman, serif;">Python/C API </span>之前必须自举，首先要创建线程状态数据结构，然后获取锁，最后保存它们的线程状态指针。完成工作之后，他们可以重置线程状态指针，释放锁，最后释放他们的线程数据结构。 </span></p>
<p>&nbsp;</p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Beginning with version 2.3, threads can now take advantage of the PyGILState_*() functions to do all of the above automatically. The typical idiom for calling into Python from a C thread is now: </span></span></p>
<p><span style="font-size: medium;">自<span style="font-family: Times New Roman, serif;">2.3</span>版开始，线程可以使用 <span style="font-family: Times New Roman, serif;">PyGILState_*()</span>函数方便的自动获取以上的所有功能。从<span style="font-family: Times New Roman, serif;">C</span>线程中进入 <span style="font-family: Times New Roman, serif;">Python </span>调用的典型方法现在变成： </span></p>
<pre class="cjk">&nbsp;<span style="font-family: Times New Roman, serif;"><span style="font-size: medium;"><textarea cols="50" rows="15" name="code" class="cpp">PyGILState_STATE gstate;
gstate = PyGILState_Ensure();
/*Perform Python actions here.*/
result = CallSomeFunction();
/*evaluate result*/
/*Release the thread. No Python API allowed beyond this point.*/
PyGILState_Release(gstate);</textarea></span></span></pre>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Note that the PyGILState_*() functions assume there is only one global interpreter (created automatically by Py_Initialize()). Python still supports the creation of additional interpreters (using Py_NewInterpreter()), but mixing multiple interpreters and the PyGILState_*() API is unsupported. </span></span></p>
<p><span style="font-size: medium;">注意 <span style="font-family: Times New Roman, serif;">PyGILState_*() </span>函数假定只有一个全局解释器（由 <span style="font-family: Times New Roman, serif;">Py_Initialize() </span>自动创建）。<span style="font-family: Times New Roman, serif;">Python </span>还支持创建附加的解释器（通过 <span style="font-family: Times New Roman, serif;">Py_NewInterpreter()</span>），但是 <span style="font-family: Times New Roman, serif;">PyGILState_*() </span>不支持混合多解释器。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">1. PyInterpreterState</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This data structure represents the state shared by a number of cooperating threads. Threads belonging to the same interpreter share their module administration and a few other internal items. There are no public members in this structure. </span></span></p>
<p><span style="font-size: medium;">这个数据结构描述几个协作线程共享的状态。属于同一个解释器的线程共享它们的模块维护和几个其它的内部子项。这个结构没有公开成员。 </span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Threads belonging to different interpreters initially share nothing, except process state like available memory, open file descriptors and such. The global interpreter lock is also shared by all threads, regardless of to which interpreter they belong. </span></span></p>
<p><span style="font-size: medium;">属于不同解释器的线程除了可用内存、打开的文件描述符之类的进程状态不共享任何东西。全局解释器锁也由所有线程共享，与它们所属的解释器无关。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">2. PyThreadState</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This data structure represents the state of a single thread. The only public data member is PyInterpreterState *interp, which points to this thread's interpreter state. </span></span></p>
<p><span style="font-size: medium;">这个数据结构描述了单个线程的状态。唯一的数据成员是 <span style="font-family: Times New Roman, serif;">PyInterpreterState *interp</span>，这个线程的解释器状态。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">3. void PyEval_InitThreads( )</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Initialize and acquire the global interpreter lock. It should be called in the main thread before creating a second thread or engaging in any other thread operations such as PyEval_ReleaseLock() or PyEval_ReleaseThread(tstate). It is not needed before calling PyEval_SaveThread() or PyEval_RestoreThread(). </span></span></p>
<p><span style="font-size: medium;">初始化和获取全局解释器锁。它应该在主线程中创建，并且应该在第二个线程创建或者类似 <span style="font-family: Times New Roman, serif;">PyEval_ReleaseLock() </span>或 <span style="font-family: Times New Roman, serif;">PyEval_ReleaseThread(tstate) </span>之类的线程操作之前。它不需要在 <span style="font-family: Times New Roman, serif;">PyEval_SaveThread() </span>或 <span style="font-family: Times New Roman, serif;">PyEval_RestoreThread()</span>之前调用。 </span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This is a no-op when called for a second time. It is safe to call this function before calling Py_Initialize(). </span></span></p>
<p><span style="font-size: medium;">第二次调用没有操作（不做任何事情）。它可以在 <span style="font-family: Times New Roman, serif;">Py_Initialize() </span>被调用之前安全调用。 </span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">When only the main thread exists, no lock operations are needed. This is a common situation (most Python programs do not use threads), and the lock operations slow the interpreter down a bit. Therefore, the lock is not created initially. This situation is equivalent to having acquired the lock: when there is only a single thread, all object accesses are safe. Therefore, when this function initializes the lock, it also acquires it. Before the Python thread module creates a new thread, knowing that either it has the lock or the lock hasn't been created yet, it calls PyEval_InitThreads(). When this call returns, it is guaranteed that the lock has been created and that the calling thread has acquired it. </span></span></p>
<p><span style="font-size: medium;">只有一个主线程的时候，不需要锁操作。这是通常的情景（大多数 <span style="font-family: Times New Roman, serif;">Python </span>程序员不用线程），锁操作稍微拖慢了解释器。因此，锁没有从一开始就创建。这种情况等同于已经获取了锁：只有一个线程的时候，所有的对象访问都是安全的。因此，当该函数初始化锁，它也可以获得锁。<span style="font-family: Times New Roman, serif;">Python </span>线程模块创建一个新的线程之前，它调用<span style="font-family: Times New Roman, serif;">PyEval_InitThreads()</span>，了解有锁或者还没有创建锁。当这个调用返回时，它确保锁以被创建，并且调用的线程已经得到它。 </span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">It is not safe to call this function when it is unknown which thread (if any) currently has the global interpreter lock. </span></span></p>
<p><span style="font-size: medium;">当前拥有全局解释器锁的线程（或其它什么）未知时，调用这个函数不安全。<br /></span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This function is not available when thread support is disabled at compile time. </span></span></p>
<p><span style="font-size: medium;">编译时如果不支持线程，这个函数不可用。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">4. int PyEval_ThreadsInitialized( )</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Returns a non-zero value if PyEval_InitThreads() has been called. This function can be called without holding the lock, and therefore can be used to avoid calls to the locking API when running single-threaded. This function is not available when thread support is disabled at compile time. New in version 2.4. </span></span></p>
<p><span style="font-size: medium;">如果 <span style="font-family: Times New Roman, serif;">PyEval_InitThreads() </span>已经被调用，这个函数返回非<span style="font-family: Times New Roman, serif;">0</span>值。因为单线程的时候可以不调用锁 <span style="font-family: Times New Roman, serif;">API</span>，这个函数可以在没有获得锁的情况下使用。这个函数在编译时禁用线程支持的情况下不可用。<span style="font-family: Times New Roman, serif;">2.4</span>版新加入。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">5. void PyEval_AcquireLock( )</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Acquire the global interpreter lock. The lock must have been created earlier. If this thread already has the lock, a deadlock ensues. This function is not available when thread support is disabled at compile time. </span></span></p>
<p><span style="font-size: medium;">获取全局解释器锁。锁必须提前创建。如果线程已经得到锁，会发生死锁。这个函数在编译时禁用线程支持的情况下不可用。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">6. void PyEval_ReleaseLock( )</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Release the global interpreter lock. The lock must have been created earlier. This function is not available when thread support is disabled at compile time. </span></span></p>
<p><span style="font-size: medium;">释放全局解释器锁。锁必须提前创建。这个函数在编译时禁用线程支持的情况下不可用。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">7. void PyEval_AcquireThread( PyThreadState *tstate)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Acquire the global interpreter lock and set the current thread state to tstate, which should not be NULL. The lock must have been created earlier. If this thread already has the lock, deadlock ensues. This function is not available when thread support is disabled at compile time. </span></span></p>
<p><span style="font-size: medium;">获得全局解释器锁并将当前线程状态设定为 <span style="font-family: Times New Roman, serif;">tstate </span>，它不能为<span style="font-family: Times New Roman, serif;">NULL</span>。锁必须提前创建。如果线程已经拥有锁，会发生死锁。这个函数在编译时禁用线程支持的情况下不可用。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">8. void PyEval_ReleaseThread( PyThreadState *tstate)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Reset the current thread state to NULL and release the global interpreter lock. The lock must have been created earlier and must be held by the current thread. The tstate argument, which must not be NULL, is only used to check that it represents the current thread state -- if it isn't, a fatal error is reported. This function is not available when thread support is disabled at compile time. </span></span></p>
<p><span style="font-size: medium;">重置当前线程状态为<span style="font-family: Times New Roman, serif;">NULL</span>并释放全局解释器锁。锁必须提前创建并且以在当前线程中获得。参数 <span style="font-family: Times New Roman, serif;">tstate </span>不能为 <span style="font-family: Times New Roman, serif;">NULL</span>。它只能用于校验它描述的当前线程状态&mdash;&mdash;如果它不对，会报告一个致命错误。这个函数在编译时禁用线程支持的情况下不可用。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">9. PyThreadState* PyEval_SaveThread( )</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Release the interpreter lock (if it has been created and thread support is enabled) and reset the thread state to NULL, returning the previous thread state (which is not NULL). If the lock has been created, the current thread must have acquired it. (This function is available even when thread support is disabled at compile time.) </span></span></p>
<p><span style="font-size: medium;">释放解释器锁（如果它已经被创建而且定义了线程支持）并且将线程状态设为 <span style="font-family: Times New Roman, serif;">NULL </span>，返回前一个线程状态（如果它不为 <span style="font-family: Times New Roman, serif;">NULL </span>）。如果锁已经创建，当前线程必须获取它。（这个函数甚至在编译时不支持线程的情况下也能使用）。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">10. void PyEval_RestoreThread( PyThreadState *tstate)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Acquire the interpreter lock (if it has been created and thread support is enabled) and set the thread state to tstate, which must not be NULL. If the lock has been created, the current thread must not have acquired it, otherwise deadlock ensues. (This function is available even when thread support is disabled at compile time.) </span></span></p>
<p><span style="font-size: medium;">获取解释器锁（如果支持线程并且锁已经创建）并设置线程状态为非空的 <span style="font-family: Times New Roman, serif;">tstate</span>。如果锁已经创建，当前线程必须没有在之前获得它，不然会发生死锁。（这个函数甚至在编译时不支持线程的情况下也能使用）。 </span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">The following macros are normally used without a trailing semicolon; look for example usage in the Python source distribution. </span></span></p>
<p><span style="font-size: medium;">以下的宏通常调用的时候不以分号结尾；可以在发布的 <span style="font-family: Times New Roman, serif;">Python </span>源代码中找到使用的示例。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">11. Py_BEGIN_ALLOW_THREADS</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This macro expands to "{ PyThreadState *_save; _save = PyEval_SaveThread();". Note that it contains an opening brace; it must be matched with a following Py_END_ALLOW_THREADS macro. See above for further discussion of this macro. It is a no-op when thread support is disabled at compile time. </span></span></p>
<p><span style="font-size: medium;">这个宏展开为 <span style="font-family: Times New Roman, serif;">"{ PyThreadState *_save; _save = PyEval_SaveThread();" </span>。注意它包含一个左大括号；它必须在其后匹配 <span style="font-family: Times New Roman, serif;">Py_END_ALLOW_THREADS </span>宏。这个宏的介绍参见后面。当线程支持在编译时被禁用时它是一个 <span style="font-family: Times New Roman, serif;">no-op</span>。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">12. Py_END_ALLOW_THREADS</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This macro expands to "PyEval_RestoreThread(_save); }". Note that it contains a closing brace; it must be matched with an earlier Py_BEGIN_ALLOW_THREADS macro. See above for further discussion of this macro. It is a no-op when thread support is disabled at compile time. </span></span></p>
<p><span style="font-size: medium;">这个宏展开为 <span style="font-family: Times New Roman, serif;">"PyEval_RestoreThread(_save); }" </span>。注意它包含一个右大括号；它必须在之前匹配一个 <span style="font-family: Times New Roman, serif;">Py_BEGIN_ALLOW_THREADS </span>宏。这个宏的介绍参见前面。当线程支持在编译时被禁用时它是一个 <span style="font-family: Times New Roman, serif;">no-op</span>。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">13. Py_BLOCK_THREADS</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This macro expands to "PyEval_RestoreThread(_save);": it is equivalent to Py_END_ALLOW_THREADS without the closing brace. It is a no-op when thread support is disabled at compile time. </span></span></p>
<p><span style="font-size: medium;">这个宏展开为 <span style="font-family: Times New Roman, serif;">"PyEval_RestoreThread(_save);" </span>；它等同于 <span style="font-family: Times New Roman, serif;">Py_END_ALLOW_THREADS </span>去掉右大括号。当线程支持在编译时被禁用时它是一个 <span style="font-family: Times New Roman, serif;">no-op</span>。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">14. Py_UNBLOCK_THREADS</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">This macro expands to "_save = PyEval_SaveThread();": it is equivalent to Py_BEGIN_ALLOW_THREADS without the opening brace and variable declaration. It is a no-op when thread support is disabled at compile time. </span></span></p>
<p><span style="font-size: medium;">这个宏展开为 <span style="font-family: Times New Roman, serif;">"_save = PyEval_SaveThread();" </span>；它是等同于 <span style="font-family: Times New Roman, serif;">Py_BEGIN_ALLOW_THREADS </span>去掉左大括号和变量声明。当线程支持在编译时被禁用时它是一个 <span style="font-family: Times New Roman, serif;">no-op</span>。<br /><br /></span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">All of the following functions are only available when thread support is enabled at compile time, and must be called only when the interpreter lock has been created. </span></span></p>
<p><span style="font-size: medium;">以下所有函数只能在编译时确认支持线程的情况下可用，并且必须在解释器锁创建后被调用。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">15. PyInterpreterState* PyInterpreterState_New( )</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Create a new interpreter state object. The interpreter lock need not be held, but may be held if it is necessary to serialize calls to this function. </span></span></p>
<p><span style="font-size: medium;">创建一个新解释器状态对象。不必要捕获解释器锁，但是当需要同步调用这个函数进行序列化的时候可能需要锁定。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">16. void PyInterpreterState_Clear( PyInterpreterState *interp)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Reset all information in an interpreter state object. The interpreter lock must be held. </span></span></p>
<p><span style="font-size: medium;">重置解释器状态对象中的所有信息。解释器锁必须被获取。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">17. void PyInterpreterState_Delete( PyInterpreterState *interp)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Destroy an interpreter state object. The interpreter lock need not be held. The interpreter state must have been reset with a previous call to PyInterpreterState_Clear(). </span></span></p>
<p><span style="font-size: medium;">析构一个解释器状态对象。解释器锁需要获取。解释器对象必须预先用 <span style="font-family: Times New Roman, serif;">PyInterpreterState_Clear() </span>重置。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">18. PyThreadState* PyThreadState_New( PyInterpreterState *interp)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Create a new thread state object belonging to the given interpreter object. The interpreter lock need not be held, but may be held if it is necessary to serialize calls to this function. </span></span></p>
<p><span style="font-size: medium;">创建一个从属于给定解释器的新线程状态对象。解释器锁不需要捕获，但是需要同步调用该函数时可能需要捕获。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">19. void PyThreadState_Clear( PyThreadState *tstate)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Reset all information in a thread state object. The interpreter lock must be held. </span></span></p>
<p><span style="font-size: medium;">重置指定线程状态对象的所有信息。解释器锁必须捕获。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">20. void PyThreadState_Delete( PyThreadState *tstate)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Destroy a thread state object. The interpreter lock need not be held. The thread state must have been reset with a previous call to PyThreadState_Clear(). </span></span></p>
<p><span style="font-size: medium;">销毁一个线程状态对象。不需要捕获解释器锁。线程状态必须提前调用 <span style="font-family: Times New Roman, serif;">PyThreadState_Clear() </span>进行清除。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">21. PyThreadState* PyThreadState_Get( )</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Return the current thread state. The interpreter lock must be held. When the current thread state is NULL, this issues a fatal error (so that the caller needn't check for NULL). </span></span></p>
<p><span style="font-size: medium;">返回当前解释器状态。必须捕获解释器锁。当前线程状态如果为 <span style="font-family: Times New Roman, serif;">NULL</span>，发生一个致命错误（因此调用者不需要校验<span style="font-family: Times New Roman, serif;">NULL</span>）。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">22. PyThreadState* PyThreadState_Swap( PyThreadState *tstate)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Swap the current thread state with the thread state given by the argument tstate, which may be NULL. The interpreter lock must be held. </span></span></p>
<p><span style="font-size: medium;">将当前线程状态与给定的参数 <span style="font-family: Times New Roman, serif;">tstate </span>交换，<span style="font-family: Times New Roman, serif;">tstate</span>可能为 <span style="font-family: Times New Roman, serif;">NULL</span>。解释器锁必须被捕获。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">23. PyObject* PyThreadState_GetDict( )</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Return value: Borrowed reference. </span></span></p>
<p><span style="font-size: medium;">返回值：托管引用。 </span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Return a dictionary in which extensions can store thread-specific state information. Each extension should use a unique key to use to store state in the dictionary. It is okay to call this function when no current thread state is available. If this function returns NULL, no exception has been raised and the caller should assume no current thread state is available. Changed in version 2.3: Previously this could only be called when a current thread is active, and NULL meant that an exception was raised. </span></span></p>
<p><span style="font-size: medium;">返回可存储线程独立的状态信息的一个扩展字典。每个扩展需要一个唯一键用于在字典中保存状态。当前线程状态不可用的时候它也可以调用。如果这个函数返回 <span style="font-family: Times New Roman, serif;">NULL</span>，没有抛出异常，调用者会假定当前线程状态无效。自 <span style="font-family: Times New Roman, serif;">2.3 </span>版以后的修改：以前它只能在当前线程激活的情况下被调用，如果返回 <span style="font-family: Times New Roman, serif;">NULL </span>就意味着发生了异常。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">24. int PyThreadState_SetAsyncExc( long id, PyObject *exc)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Asynchronously raise an exception in a thread. The id argument is the thread id of the target thread; exc is the exception object to be raised. This function does not steal any references to exc. To prevent naive misuse, you must write your own C extension to call this. Must be called with the GIL held. Returns the number of thread states modified; this is normally one, but will be zero if the thread id isn't found. If exc is NULL, the pending exception (if any) for the thread is cleared. This raises no exceptions. New in version 2.3. </span></span></p>
<p><span style="font-size: medium;">在 线程中异步抛出一个异常。参数 <span style="font-family: Times New Roman, serif;">id </span>是目标线程的线程 <span style="font-family: Times New Roman, serif;">id </span>；<span style="font-family: Times New Roman, serif;">exc </span>是要抛出的异常对象。这个函数不获取 <span style="font-family: Times New Roman, serif;">exc </span>的任何引用。为了防止低级错误，你必须自己编写你的 <span style="font-family: Times New Roman, serif;">C </span>扩展来调用它。调用必须捕获 <span style="font-family: Times New Roman, serif;">GIL</span>。返回线程状态修改数；通常为 <span style="font-family: Times New Roman, serif;">1 </span>，但是如果线程 <span style="font-family: Times New Roman, serif;">id </span>没有找到就会返回<span style="font-family: Times New Roman, serif;">0</span>。如果 <span style="font-family: Times New Roman, serif;">exc </span>是 <span style="font-family: Times New Roman, serif;">NULL</span>，所有异常（任何可能）都会从线程中清除。不抛出异常。<span style="font-family: Times New Roman, serif;">2.3</span>版新加入。<br /></span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">25. PyGILState_STATE PyGILState_Ensure( )</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Ensure that the current thread is ready to call the Python C API regardless of the current state of Python, or of its thread lock. This may be called as many times as desired by a thread as long as each call is matched with a call to PyGILState_Release(). In general, other thread-related APIs may be used between PyGILState_Ensure() and PyGILState_Release() calls as long as the thread state is restored to its previous state before the Release(). For example, normal usage of the Py_BEGIN_ALLOW_THREADS and Py_END_ALLOW_THREADS macros is acceptable. </span></span></p>
<p><span style="font-size: medium;">确保当前线程已经可以调用与当前 <span style="font-family: Times New Roman, serif;">Python </span>状态无关的 <span style="font-family: Times New Roman, serif;">Python C API</span>，或者它的线程锁。当一个线程每次希望匹配到 <span style="font-family: Times New Roman, serif;">PyGILState_Release() </span>调用时可能会反复调用这个函数。通常，在线程状态恢复为 <span style="font-family: Times New Roman, serif;">Release() </span>之前的状态时，其它线程相关的 <span style="font-family: Times New Roman, serif;">API </span>可能会在一对 <span style="font-family: Times New Roman, serif;">PyGILState_Ensure() </span>和 <span style="font-family: Times New Roman, serif;">PyGILState_Release() </span>之间调用。例如，通常可以用于<span style="font-family: Times New Roman, serif;">Py_BEGIN_ALLOW_THREADS </span>宏 <span style="font-family: Times New Roman, serif;">Py_END_ALLOW_THREADS</span>。 </span></p>
<p>&nbsp;</p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">The return value is an opaque "handle" to the thread state when PyGILState_Acquire() was called, and must be passed to PyGILState_Release() to ensure Python is left in the same state. Even though recursive calls are allowed, these handles cannot be shared - each unique call to PyGILState_Ensure must save the handle for its call to PyGILState_Release. </span></span></p>
<p><span style="font-size: medium;"><span style="font-family: Times New Roman, serif;">PyGILState_Acquire ()</span>被调用的时候，返回值是一个不透明的线程状态&ldquo;句柄&rdquo;，<span style="font-family: Times New Roman, serif;">Python</span>离开当前状态时一定会被被传递到 <span style="font-family: Times New Roman, serif;">PyGILState_Release() </span>。甚至尽管允许递归调用，这些句柄也不能共享&mdash;&mdash;每次调用 <span style="font-family: Times New Roman, serif;">PyGILState_Ensure </span>都是唯一的，它们的句柄对应它们的<span style="font-family: Times New Roman, serif;">PyGILState_Release</span>。 </span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">When the function returns, the current thread will hold the GIL. Failure is a fatal error. New in version 2.3. </span></span></p>
<p><span style="font-size: medium;">当函数返回，当前线程将会捕获 <span style="font-family: Times New Roman, serif;">GIL </span>，失败会造成致命错误。<span style="font-family: Times New Roman, serif;">2.3</span>版新增。 </span></p>
<h3 class="cjk"><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">26. void PyGILState_Release( PyGILState_STATE)</span></span></h3>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Release any resources previously acquired. After this call, Python's state will be the same as it was prior to the corresponding PyGILState_Ensure call (but generally this state will be unknown to the caller, hence the use of the GILState API.) </span></span></p>
<p><span style="font-size: medium;">释放所有之前获取的资源。这个调用之后，<span style="font-family: Times New Roman, serif;">Python</span>的状态会与之前 <span style="font-family: Times New Roman, serif;">PyGILState_Ensure </span>调用一致（但是通常这个状态对调用者是未知的，因此使用 <span style="font-family: Times New Roman, serif;">GILState API</span>）。 </span></p>
<p><span style="font-family: Times New Roman, serif;"><span style="font-size: medium;">Every call to PyGILState_Ensure() must be matched by a call to PyGILState_Release() on the same thread. New in version 2.3. </span></span></p>
<p><span style="font-size: medium;">每次调用 <span style="font-family: Times New Roman, serif;">PyGILState_Ensure() </span>都要在同一线程对应调用 <span style="font-family: Times New Roman, serif;">PyGILState_Release() </span>。<span style="font-family: Times New Roman, serif;">2.3</span>版本新增。</span></p>
<p style="margin-bottom: 0cm;"><span style="font-size: medium;">========================================================================</span></p>
<p><a href="http://blog.csdn.net/liguangyi/archive/2007/06/20/1659697.aspx"><span style="font-size: medium;">http://blog.csdn.net/liguangyi/archive/2007/06/20/1659697.aspx</span></a></p>
<p style="margin-bottom: 0cm;"><span style="font-size: large;"><br /></span></p>
<p><span style="font-size: medium;">一、首先定义一个封装类，主要是保证PyGILState_Ensure, PyGILState_Release配对使用，而且这个类是可以嵌套使用的。<br /><br /><textarea cols="50" rows="15" name="code" class="cpp">#include &lt;python.h&gt;
class PyThreadStateLock
{
public:
    PyThreadStateLock(void)
    {
        state = PyGILState_Ensure( );
    }
    ~PyThreadStateLock(void)
    {
         PyGILState_Release( state );
    }
private:
    PyGILState_STATE state;
};</textarea> <br /><br />二、在主线程中，这样处理<br /><textarea cols="50" rows="15" name="code" class="cpp">    // 初始化
    Py_Initialize();
    // 初始化线程支持
    PyEval_InitThreads();
    // 启动子线程前执行，为了释放PyEval_InitThreads获得的全局锁，否则子线程可能无法获取到全局锁。
    PyEval_ReleaseThread(PyThreadState_Get());
    
    // 其他的处理，如启动子线程等
    ......
        
    // 保证子线程调用都结束后
    PyGILState_Ensure();
    Py_Finalize();
    // 之后不能再调用任何python的API
</textarea> <br /></span><tt id="l2h-905" class="cfunction"><span style="font-size: medium;"><br />三、在主线程，或者子线程中，调用python本身函数的都采用如下处理<br /><br /><textarea cols="50" rows="15" name="code" class="c-sharp">    {
        class PyThreadStateLock PyThreadLock; 
        // 调用python的API函数处理
        ......
    }</textarea> <br /><br />四</span></tt><tt id="l2h-905" class="cfunction"><span style="font-size: medium;">、</span></tt><tt id="l2h-905" class="cfunction"><span style="font-size: medium;">另外还有两个和全局锁有关的宏，Py_BEGIN_ALLOW_THREADS 和 Py_END_ALLOW_THREADS。这两个宏是为了在较长时间的C函数调用前，临时释放全局锁，完成后重新获取全局锁，以避免阻塞其他 python的线程继续运行。这两个宏可以这样调用<br /><br /></span></tt></p>
<p style="margin-bottom: 0cm;"><span style="font-size: large;"><textarea cols="50" rows="15" name="code" class="cpp">    {
        class PyThreadStateLock PyThreadLock; 
        // 调用python的API函数处理
        ......

        Py_BEGIN_ALLOW_THREADS
        // 调用需要长时间的C函数
        ......
        Py_END_ALLOW_THREADS

        // 调用python的API函数处理
        ......
    }
</textarea> <br /></span></p>
<p style="margin-bottom: 0cm;"><span style="font-size: medium;">========================================================================</span></p>
<p style="margin-bottom: 0cm;"><span style="font-size: medium;">都来自网上，经本人整理。<br /></span></p>
<p style="margin-bottom: 0cm;"><span style="font-size: medium;">另外，我昨天发现一篇博客，对这个问题也讲得比较清楚，如下，大家可以去看看</span></p>
<p style="margin-bottom: 0cm;"><span style="font-size: medium;"><a class="example2" href="http://apt-blog.net/python_cpython_cython_and_gil" target="_blank"><span style="font-size: large; color: #333333;">Python, C-Python, Cython代码与GIL的交互</span></a></span></p>
<p style="margin-bottom: 0cm;">&nbsp;</p>
</div>



<!-- Baidu Button BEGIN -->
<div id="bdshare" class="bdshare_t bds_tools get-codes-bdshare" style="float: right;">
<a class="bds_qzone"></a>
<a class="bds_tsina"></a>
<a class="bds_tqq"></a>
<a class="bds_renren"></a>
<a class="bds_t163"></a>
<span class="bds_more">更多</span>
<a class="shareCount"></a>
</div>
<!-- Baidu Button END -->


<!--192.168.100.34-->
<ul class="article_next_prev">
            <li class="prev_article"><span  onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian']);location.href='/marising/article/details/2962560';">上一篇</span><a href="/marising/article/details/2962560" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_shangyipian'])">c++和Python互操作高级应用（5）</a></li>
            <li class="next_article"><span onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian']);location.href='/marising/article/details/3034983';">下一篇</span><a href="/marising/article/details/3034983" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_xiayipian'])">郁闷的pidgin 2.5.1安装</a></li>
</ul>

<!-- Baidu Button BEGIN -->
<script type="text/javascript" id="bdshare_js" data="type=tools&amp;uid=1536434" ></script>
<script type="text/javascript" id="bdshell_js"></script>
<script type="text/javascript">
    document.getElementById("bdshell_js").src = "http://bdimg.share.baidu.com/static/js/shell_v2.js?cdnversion=" + Math.ceil(new Date()/3600000)
</script>
<!-- Baidu Button END -->

</div>
      <dl class="blog-associat-tag">
        <dt>主题推荐</dt>
        <dd>
                <a href="http://www.csdn.net/tag/线程" target="_blank" class="blog-tage-red" >线程</a> 
                <a href="http://www.csdn.net/tag/c++" target="_blank" class="blog-tage-red" >c++</a> 
                <a href="http://www.csdn.net/tag/数据结构" target="_blank" class="blog-tage-red" >数据结构</a> 
                <a href="http://www.csdn.net/tag/全局变量" target="_blank" class="blog-tage-red" >全局变量</a> 
                <a href="http://www.csdn.net/tag/线程安全" target="_blank" class="blog-tage-red" >线程安全</a> 
        </dd>
    </dl> 
    <dl class="blog-ass-articl tracking-ad"  data-mod="popu_17">
        <dt><span>博文推荐</span></dt>
            <dd>
                <a href="http://blog.csdn.net/svitter/article/details/24642587" title="sdut2408 pick apples （贪心+背包）山东省第三届ACM省赛" target="_blank">sdut2408 pick apples...</a></dd>
            <dd>
                <a href="http://blog.csdn.net/shixiaoguo90/article/details/24640081" title="sizeof(union) 、sizeof(struct) 和内存对齐技术" target="_blank">sizeof(union) 、sizeo...</a></dd>
            <dd>
                <a href="http://blog.csdn.net/redhat_520/article/details/24640347" title="C++ 实现空心等腰直角三角形打印" target="_blank">C++ 实现空心等腰直角三角形打印</a></dd>
            <dd>
                <a href="http://blog.csdn.net/muzilanlan/article/details/24384337" title="C++primer——const总结4--重载和 const 形参" target="_blank">C++primer——const总结4-...</a></dd>
            <dd>
                <a href="http://blog.csdn.net/manthink2005/article/details/24634605" title="泛型的Binary Search Tree的实现，并与STL map进行操作性能上的比较" target="_blank">泛型的Binary Search Tre...</a></dd>
            <dd>
                <a href="http://blog.csdn.net/u014723115/article/details/24632331" title="C/C++ typedef 陷阱" target="_blank">C/C++ typedef 陷阱</a></dd>
            <dd>
                <a href="http://blog.csdn.net/u012935550/article/details/24622383" title="小楼一阁的数据结构学习笔记（开始篇）" target="_blank">小楼一阁的数据结构学习笔记（开始篇）</a></dd>
            <dd>
                <a href="http://blog.csdn.net/hzqhbc/article/details/24624931" title="多线程锁:事件内核对象(进程锁)" target="_blank">多线程锁:事件内核对象(进程锁)</a></dd>
    </dl>

    <div id="ad_cen">
        <script type="text/javascript">            BAIDU_CLB_SLOT_ID = "117306";</script>
        <script type="text/javascript" src="http://cbjs.baidu.com/js/o.js"></script>
    </div>
    <script type="text/javascript">
        //new Ad(4, 'ad_cen');
    </script>
<div id="comment_title" class="panel_head">
    查看评论<a name="comments"></a></div>
<div id="comment_list">
</div>
<div id="comment_bar">
</div>
<div id="comment_form">
</div>
<div class="announce">
    * 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a name="reply"></a><a name="quote"></a></div>
<script type="text/javascript">
    var fileName = '3032278';
    var commentscount = 0;
    var islock = false
</script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/comment.js"></script>
    <div id="ad_bot">
    </div>
    <script type="text/javascript">
    new Ad(5, 'ad_bot');
    </script>
<div id="report_dialog">
</div>

<div id="d-top"  style="bottom:60px;">
      

       <a id="quick-reply" class="btn btn-top q-reply" title="快速回复" style="display:none;">
            <img src="http://static.blog.csdn.net/images/blog-icon-reply.png" alt="快速回复">
        </a>    

    <a id="d-top-a" class="btn btn-top backtop"  style="display: none;" title="返回顶部" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_huidaodingbu'])" style="">         
         <img src="http://static.blog.csdn.net/images/top.png" alt="TOP">
    </a>
</div>
<script type="text/javascript">
    $(function ()
    {
        if($("#comment_content").length>0)
        {
            $("#quick-reply").show();

            $("#quick-reply").click(function(){
                setEditorFocus();
            });
        }       
     
        var d_top = $('#d-top-a');
        document.onscroll = function ()
        {
            var scrTop = (document.body.scrollTop || document.documentElement.scrollTop);
            if (scrTop > 500)
            {
                d_top.show();
            } else
            {
                d_top.hide();
            }
        }
        $('#d-top-a').click(function ()
        {
            scrollTo(0, 0);
            this.blur();
            return false;
        });
    });
  
</script>
<style type="text/css">
    .tag_list
    {
        background: none repeat scroll 0 0 #FFFFFF;
        border: 1px solid #D7CBC1;
        color: #000000;
        font-size: 12px;
        line-height: 20px;
        list-style: none outside none;
        margin: 10px 2% 0 1%;
        padding: 1px;
    }
    .tag_list h5
    {
        background: none repeat scroll 0 0 #E0DBD3;
        color: #47381C;
        font-size: 12px;
        height: 24px;
        line-height: 24px;
        padding: 0 5px;
        margin: 0;
    }
    .tag_list h5 a
    {
        color: #47381C;
    }
    .classify
    {
        margin: 10px 0;
        padding: 4px 12px 8px;
    }
    .classify a
    {
        margin-right: 20px;
        white-space: nowrap;
    }
</style>
<div class="tag_list">
    <h5>
        <a href="http://www.csdn.net/tag/" target="_blank">核心技术类目</a></h5>
    <div class="classify">
<a title="全部主题" href="http://www.csdn.net/tag" target="_blank" onclick="LogClickCount(this,336);">全部主题</a>
<a title="Java" href="http://www.csdn.net/tag/Java" target="_blank" onclick="LogClickCount(this,336);">Java</a>
<a title="VPN" href="http://www.csdn.net/tag/vpn" target="_blank" onclick="LogClickCount(this,336);">VPN</a>
<a title="Android" href="http://www.csdn.net/tag/android" target="_blank" onclick="LogClickCount(this,336);">Android</a>
<a title="iOS" href="http://www.csdn.net/tag/ios" target="_blank" onclick="LogClickCount(this,336);">iOS</a>
<a title="ERP" href="http://www.csdn.net/tag/erp" target="_blank" onclick="LogClickCount(this,336);">ERP</a>
<a title="IE10" href="http://www.csdn.net/tag/ie10" target="_blank" onclick="LogClickCount(this,336);">IE10</a>
<a title="Eclipse" href="http://www.csdn.net/tag/eclipse" target="_blank" onclick="LogClickCount(this,336);">Eclipse</a>
<a title="CRM" href="http://www.csdn.net/tag/crm" target="_blank" onclick="LogClickCount(this,336);">CRM</a>
<a title="JavaScript" href="http://www.csdn.net/tag/javascript" target="_blank" onclick="LogClickCount(this,336);">JavaScript</a>
<a title="Ubuntu" href="http://www.csdn.net/tag/ubuntu" target="_blank" onclick="LogClickCount(this,336);">Ubuntu</a>
<a title="NFC" href="http://www.csdn.net/tag/nfc" target="_blank" onclick="LogClickCount(this,336);">NFC</a>
<a title="WAP" href="http://www.csdn.net/tag/wap" target="_blank" onclick="LogClickCount(this,336);">WAP</a>
<a title="jQuery" href="http://www.csdn.net/tag/jquery" target="_blank" onclick="LogClickCount(this,336);">jQuery</a>
<a title="数据库" href="http://www.csdn.net/tag/数据库" target="_blank" onclick="LogClickCount(this,336);">数据库</a>
<a title="BI" href="http://www.csdn.net/tag/bi" target="_blank" onclick="LogClickCount(this,336);">BI</a>
<a title="HTML5" href="http://www.csdn.net/tag/html5" target="_blank" onclick="LogClickCount(this,336);">HTML5</a>
<a title="Spring" href="http://www.csdn.net/tag/spring" target="_blank" onclick="LogClickCount(this,336);">Spring</a>
<a title="Apache" href="http://www.csdn.net/tag/apache" target="_blank" onclick="LogClickCount(this,336);">Apache</a>
<a title="Hadoop" href="http://www.csdn.net/tag/hadoop" target="_blank" onclick="LogClickCount(this,336);">Hadoop</a>
<a title=".NET" href="http://www.csdn.net/tag/.net" target="_blank" onclick="LogClickCount(this,336);">.NET</a>
<a title="API" href="http://www.csdn.net/tag/api" target="_blank" onclick="LogClickCount(this,336);">API</a>
<a title="HTML" href="http://www.csdn.net/tag/html" target="_blank" onclick="LogClickCount(this,336);">HTML</a>
<a title="SDK" href="http://www.csdn.net/tag/sdk" target="_blank" onclick="LogClickCount(this,336);">SDK</a>
<a title="IIS" href="http://www.csdn.net/tag/iis" target="_blank" onclick="LogClickCount(this,336);">IIS</a>
<a title="Fedora" href="http://www.csdn.net/tag/fedora" target="_blank" onclick="LogClickCount(this,336);">Fedora</a>
<a title="XML" href="http://www.csdn.net/tag/xml" target="_blank" onclick="LogClickCount(this,336);">XML</a>
<a title="LBS" href="http://www.csdn.net/tag/lbs" target="_blank" onclick="LogClickCount(this,336);">LBS</a>
<a title="Unity" href="http://www.csdn.net/tag/unity" target="_blank" onclick="LogClickCount(this,336);">Unity</a>
<a title="Splashtop" href="http://www.csdn.net/tag/splashtop" target="_blank" onclick="LogClickCount(this,336);">Splashtop</a>
<a title="UML" href="http://www.csdn.net/tag/uml" target="_blank" onclick="LogClickCount(this,336);">UML</a>
<a title="components" href="http://www.csdn.net/tag/components" target="_blank" onclick="LogClickCount(this,336);">components</a>
<a title="Windows Mobile" href="http://www.csdn.net/tag/windowsmobile" target="_blank" onclick="LogClickCount(this,336);">Windows Mobile</a>
<a title="Rails" href="http://www.csdn.net/tag/rails" target="_blank" onclick="LogClickCount(this,336);">Rails</a>
<a title="QEMU" href="http://www.csdn.net/tag/qemu" target="_blank" onclick="LogClickCount(this,336);">QEMU</a>
<a title="KDE" href="http://www.csdn.net/tag/kde" target="_blank" onclick="LogClickCount(this,336);">KDE</a>
<a title="Cassandra" href="http://www.csdn.net/tag/cassandra" target="_blank" onclick="LogClickCount(this,336);">Cassandra</a>
<a title="CloudStack" href="http://www.csdn.net/tag/cloudstack" target="_blank" onclick="LogClickCount(this,336);">CloudStack</a>
<a title="FTC" href="http://www.csdn.net/tag/ftc" target="_blank" onclick="LogClickCount(this,336);">FTC</a>
<a title="coremail" href="http://www.csdn.net/tag/coremail" target="_blank" onclick="LogClickCount(this,336);">coremail</a>
<a title="OPhone " href="http://www.csdn.net/tag/ophone " target="_blank" onclick="LogClickCount(this,336);">OPhone </a>
<a title="CouchBase" href="http://www.csdn.net/tag/couchbase" target="_blank" onclick="LogClickCount(this,336);">CouchBase</a>
<a title="云计算" href="http://www.csdn.net/tag/云计算" target="_blank" onclick="LogClickCount(this,336);">云计算</a>
<a title="iOS6" href="http://www.csdn.net/tag/iOS6" target="_blank" onclick="LogClickCount(this,336);">iOS6</a>
<a title="Rackspace " href="http://www.csdn.net/tag/rackspace " target="_blank" onclick="LogClickCount(this,336);">Rackspace </a>
<a title="Web App" href="http://www.csdn.net/tag/webapp" target="_blank" onclick="LogClickCount(this,336);">Web App</a>
<a title="SpringSide" href="http://www.csdn.net/tag/springside" target="_blank" onclick="LogClickCount(this,336);">SpringSide</a>
<a title="Maemo" href="http://www.csdn.net/tag/maemo" target="_blank" onclick="LogClickCount(this,336);">Maemo</a>
<a title="Compuware" href="http://www.csdn.net/tag/compuware" target="_blank" onclick="LogClickCount(this,336);">Compuware</a>
<a title="大数据" href="http://www.csdn.net/tag/大数据" target="_blank" onclick="LogClickCount(this,336);">大数据</a>
<a title="aptech" href="http://www.csdn.net/tag/aptech" target="_blank" onclick="LogClickCount(this,336);">aptech</a>
<a title="Perl" href="http://www.csdn.net/tag/perl" target="_blank" onclick="LogClickCount(this,336);">Perl</a>
<a title="Tornado" href="http://www.csdn.net/tag/tornado" target="_blank" onclick="LogClickCount(this,336);">Tornado</a>
<a title="Ruby" href="http://www.csdn.net/tag/ruby" target="_blank" onclick="LogClickCount(this,336);">Ruby</a>
<a title="Hibernate" href="http://www.csdn.net/hibernate" target="_blank" onclick="LogClickCount(this,336);">Hibernate</a>
<a title="ThinkPHP" href="http://www.csdn.net/tag/thinkphp" target="_blank" onclick="LogClickCount(this,336);">ThinkPHP</a>
<a title="Spark" href="http://www.csdn.net/tag/spark" target="_blank" onclick="LogClickCount(this,336);">Spark</a>
<a title="HBase" href="http://www.csdn.net/tag/hbase" target="_blank" onclick="LogClickCount(this,336);">HBase</a>
<a title="Pure" href="http://www.csdn.net/tag/pure" target="_blank" onclick="LogClickCount(this,336);">Pure</a>
<a title="Solr" href="http://www.csdn.net/tag/solr" target="_blank" onclick="LogClickCount(this,336);">Solr</a>
<a title="Angular" href="http://www.csdn.net/tag/angular" target="_blank" onclick="LogClickCount(this,336);">Angular</a>
<a title="Cloud Foundry" href="http://www.csdn.net/tag/cloudfoundry" target="_blank" onclick="LogClickCount(this,336);">Cloud Foundry</a>
<a title="Redis" href="http://www.csdn.net/tag/redis" target="_blank" onclick="LogClickCount(this,336);">Redis</a>
<a title="Scala" href="http://www.csdn.net/tag/scala" target="_blank" onclick="LogClickCount(this,336);">Scala</a>
<a title="Django" href="http://www.csdn.net/tag/django" target="_blank" onclick="LogClickCount(this,336);">Django</a>
<a title="Bootstrap" href="http://www.csdn.net/tag/bootstrap" target="_blank" onclick="LogClickCount(this,336);">Bootstrap</a>
    </div>
</div>

                    <div class="clear">
                    </div>
                </div>
            </div>
            <div id="side">
    <div class="side">
<div id="panel_Profile" class="panel">
<ul class="panel_head"><span>个人资料</span></ul>
<ul class="panel_body profile">
<div id="blog_userface">
    <a href="http://my.csdn.net/marising" target="_blank">
    <img src="http://avatar.csdn.net/4/B/B/1_marising.jpg" title="访问我的空间" style="max-width:90%"/>
    </a>
    <br />
    <span><a href="http://my.csdn.net/marising" class="user_name" target="_blank">marising</a></span>
</div>
<div class="interact">
<a href="javascript:void(0);" class="attent" id="span_add_follow" title="[加关注]" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_guanzhu'])"></a>
<a href="javascript:void(0);" class="letter" onclick="loginto(1)" title="[发私信]" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_sixin'])"></a>
</div>
<div id="blog_medal">
</div>
<ul id="blog_rank">
    <li>访问：<span>393418次</span></li>
    <li>积分：<span>4807分</span></li>
    <li>排名：<span>第1380名</span></li>
</ul>
<ul id="blog_statistics">
    <li>原创：<span>113篇</span></li>
    <li>转载：<span>9篇</span></li>
    <li>译文：<span>1篇</span></li>
    <li>评论：<span>287条</span></li>
</ul>
</ul>
</div>


<div class="panel" id="panel_Search">
    <ul class="panel_head"><span>文章搜索</span></ul>
    <ul class="panel_body">
        <form id="frmSearch" action="http://so.csdn.net/search" class="form_search" target="_blank">
        <span><input id="inputSearch" type="text" class="blogsearch" title="请输入关键字" /></span>
        <input id="btnSubmit" type="submit" value="搜索" title="search in blog" />
        <input type="hidden" name="q" id="inputQ" />
        <input type="hidden" name="t" value="blog" />
        <a id="btnSearchBlog" target="_blank"></a>
        </form>
    </ul>
</div><div id="panel_Category" class="panel">
<ul class="panel_head"><span>文章分类</span></ul>
<ul class="panel_body">
             <li>
                <a href="http://blog.csdn.net/marising/article/category/628965" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">1.自然语言处理/机器学习</a><span>(14)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/marising/article/category/337706" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">2.Linux/C/Python</a><span>(47)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/marising/article/category/18561" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">3.软件设计/架构/测试</a><span>(24)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/marising/article/category/306043" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">4.产品研究/点评/创意</a><span>(10)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/marising/article/category/14375" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">5.软件工程/管理</a><span>(20)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/marising/article/category/2199769" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">6.移动广告</a><span>(0)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/marising/article/category/14392" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">7.杂七杂八</a><span>(8)</span>
            </li>
             <li>
                <a href="http://blog.csdn.net/marising/article/category/2199775" onclick="_gaq.push(['_trackEvent','function', 'onclick', 'blog_articles_wenzhangfenlei']); ">6.杂七杂八</a><span>(0)</span>
            </li>
</ul>
</div><div id="panel_Archive" class="panel">
<ul class="panel_head"><span>文章存档</span></ul>
<ul class="panel_body">
<div id="archive_list">
<!--归档统计-->
<li><a href="http://blog.csdn.net/marising/article/month/2012/03">2012年03月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2011/10">2011年10月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2011/09">2011年09月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2011/07">2011年07月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2011/06">2011年06月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2011/05">2011年05月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2011/04">2011年04月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2011/03">2011年03月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2011/02">2011年02月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2011/01">2011年01月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2010/12">2010年12月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2010/11">2010年11月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2010/10">2010年10月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2010/09">2010年09月</a><span>(8)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2010/08">2010年08月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2010/07">2010年07月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2010/06">2010年06月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2010/02">2010年02月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2010/01">2010年01月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/12">2009年12月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/11">2009年11月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/09">2009年09月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/08">2009年08月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/07">2009年07月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/06">2009年06月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/05">2009年05月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/04">2009年04月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/03">2009年03月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/02">2009年02月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2009/01">2009年01月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2008/12">2008年12月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2008/11">2008年11月</a><span>(4)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2008/10">2008年10月</a><span>(6)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2008/09">2008年09月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2008/08">2008年08月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2008/07">2008年07月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2008/03">2008年03月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2008/01">2008年01月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2007/11">2007年11月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2007/10">2007年10月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2007/09">2007年09月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2007/04">2007年04月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2007/02">2007年02月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2006/12">2006年12月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2006/11">2006年11月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2006/08">2006年08月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2006/07">2006年07月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/marising/article/month/2004/07">2004年07月</a><span>(1)</span></li>
</div>
</ul>
</div>
<div id="hotarticls" class="panel">
<ul class="panel_head">
    <span>       
阅读排行    </span>
</ul>

<ul class="panel_body itemlist">
<li>
<a href="/marising/article/details/5182771" title="压力测试衡量CPU的三个指标：CPU Utilization、Load Average和Context Switch Rate">压力测试衡量CPU的三个指标：CPU Utilization、Load Average和Context Switch Rate</a><span>(23551)</span>
</li>
<li>
<a href="/marising/article/details/2845339" title="Python调用c/c++函数（1）">Python调用c/c++函数（1）</a><span>(18033)</span>
</li>
<li>
<a href="/marising/article/details/5186643" title="高性能服务器架构(High-Performance Server Architecture)">高性能服务器架构(High-Performance Server Architecture)</a><span>(17380)</span>
</li>
<li>
<a href="/marising/article/details/2917892" title="C++调用Python(3)">C++调用Python(3)</a><span>(16782)</span>
</li>
<li>
<a href="/marising/article/details/5256910" title="阿凡达架构平台（Avatar Architecture Platform）（一）">阿凡达架构平台（Avatar Architecture Platform）（一）</a><span>(15684)</span>
</li>
<li>
<a href="/marising/article/details/4567531" title="std list/vector sort 排序就这么简单">std list/vector sort 排序就这么简单</a><span>(15291)</span>
</li>
<li>
<a href="/marising/article/details/5160210" title="LoadRunner压力测试时监控服务器Linux的资源情况">LoadRunner压力测试时监控服务器Linux的资源情况</a><span>(14789)</span>
</li>
<li>
<a href="/marising/article/details/6551692" title="Python的subprocess子进程和管道进行交互">Python的subprocess子进程和管道进行交互</a><span>(12194)</span>
</li>
<li>
<a href="/marising/article/details/2962322" title="C++调用Python(4）">C++调用Python(4）</a><span>(11935)</span>
</li>
<li>
<a href="/marising/article/details/6543943" title="信息检索（IR）的评价指标介绍 - 准确率、召回率、F1、mAP、ROC、AUC">信息检索（IR）的评价指标介绍 - 准确率、召回率、F1、mAP、ROC、AUC</a><span>(9554)</span>
</li>
</ul>
</div>
<div id="hotarticls2" class="panel">
<ul class="panel_head"><span>评论排行</span></ul>
<ul class="panel_body itemlist">
<li>
<a href="/marising/article/details/5256910" title="阿凡达架构平台（Avatar Architecture Platform）（一）">阿凡达架构平台（Avatar Architecture Platform）（一）</a><span>(56)</span>
</li>
<li>
<a href="/marising/article/details/5286747" title="阿凡达架构平台（Avatar Architecture Platform）（三）">阿凡达架构平台（Avatar Architecture Platform）（三）</a><span>(19)</span>
</li>
<li>
<a href="/marising/article/details/5844063" title="基于libsvm的中文文本分类原型">基于libsvm的中文文本分类原型</a><span>(17)</span>
</li>
<li>
<a href="/marising/article/details/5186643" title="高性能服务器架构(High-Performance Server Architecture)">高性能服务器架构(High-Performance Server Architecture)</a><span>(14)</span>
</li>
<li>
<a href="/marising/article/details/5264360" title="阿凡达架构平台（Avatar Architecture Platform）（二）">阿凡达架构平台（Avatar Architecture Platform）（二）</a><span>(12)</span>
</li>
<li>
<a href="/marising/article/details/6580529" title="看到新的CSDN的博客界面，泪流满面">看到新的CSDN的博客界面，泪流满面</a><span>(11)</span>
</li>
<li>
<a href="/marising/article/details/4036715" title="Django上传图片用PIL生成缩略图">Django上传图片用PIL生成缩略图</a><span>(7)</span>
</li>
<li>
<a href="/marising/article/details/5713314" title="网站性能测试PV到TPS的转换以及TPS的波动">网站性能测试PV到TPS的转换以及TPS的波动</a><span>(7)</span>
</li>
<li>
<a href="/marising/article/details/1506224" title="为什么第一次调用WebService慢呢？">为什么第一次调用WebService慢呢？</a><span>(7)</span>
</li>
<li>
<a href="/marising/article/details/4027135" title="ADO.net的SqlConnection问题">ADO.net的SqlConnection问题</a><span>(7)</span>
</li>
</ul>
</div>
<div id="homepageArticles" class="panel tracking-ad" data-mod="popu_4">
<ul class="panel_head"><span>推荐文章</span></ul>
<ul class="panel_body" id="ad_commend"></ul>
</div>
<script type="text/javascript">
 new Ad(12, 'ad_commend');
</script><div id="newcomments" class="panel">
<ul class="panel_head"><span>最新评论</span></ul>
<ul class="panel_body itemlist">
    <li>
    <a href="/marising/article/details/3173848#comments">Python 读取键盘输入字符</a>
    <p style="margin:0px;"><a href="/HaoIquanquan" class="user_name">HaoIquanquan</a>:
博主，非常感谢
    </p>
    </li>
    <li>
    <a href="/marising/article/details/5661979#comments">VIPS:基于视觉的页面分割算法[微软下一代搜索引擎核心分页算法]（介绍）</a>
    <p style="margin:0px;"><a href="/wyx_wyx03" class="user_name">wyx_wyx03</a>:
@marising:啊哦！~我现在还菜鸟一个呢。。。╮(╯▽╰)╭
    </p>
    </li>
    <li>
    <a href="/marising/article/details/5661979#comments">VIPS:基于视觉的页面分割算法[微软下一代搜索引擎核心分页算法]（介绍）</a>
    <p style="margin:0px;"><a href="/marising" class="user_name">marising</a>:
@wyx_wyx03:感受优缺点，需要自己写代码测试
    </p>
    </li>
    <li>
    <a href="/marising/article/details/5844063#comments">基于libsvm的中文文本分类原型</a>
    <p style="margin:0px;"><a href="/tianranhe" class="user_name">tianranhe</a>:
8 189:0.171153 253:0.081381 298:0.630345 504:0.135...
    </p>
    </li>
    <li>
    <a href="/marising/article/details/5661979#comments">VIPS:基于视觉的页面分割算法[微软下一代搜索引擎核心分页算法]（介绍）</a>
    <p style="margin:0px;"><a href="/wyx_wyx03" class="user_name">wyx_wyx03</a>:
楼主，那我想借鉴一下主流算法的代码，平时看的一些论文，还是不能感受到那些算法的优缺点，可以帮忙么？
    </p>
    </li>
    <li>
    <a href="/marising/article/details/5286747#comments">阿凡达架构平台（Avatar Architecture Platform）（三）</a>
    <p style="margin:0px;"><a href="/zhegexiaohuozi" class="user_name">zhegexiaohuozi</a>:
@asp190000:怎么感觉你像知道几个名词来装逼的？人家有想法说出来，你不喜欢就一边去呗，抨击人...
    </p>
    </li>
    <li>
    <a href="/marising/article/details/3932938#comments">nginx＋fastcgi+c/c++搭建高性能Web框架</a>
    <p style="margin:0px;"><a href="/tomvstom" class="user_name">tomvstom</a>:
本文提供的helloworld运行失败，我改为fcgi-2.4.1-SNAP-0311112127\...
    </p>
    </li>
    <li>
    <a href="/marising/article/details/2917892#comments">C++调用Python(3)</a>
    <p style="margin:0px;"><a href="/luckjava" class="user_name">luckjava</a>:
大神啊，我用ndk编译成apk后，始终找不到模块？为啥啊。能帮我看看嘛？http://bbs.csd...
    </p>
    </li>
    <li>
    <a href="/marising/article/details/2845339#comments">Python调用c/c++函数（1）</a>
    <p style="margin:0px;"><a href="/linuxgateway" class="user_name">linuxgateway</a>:
不错，虽然我不喜欢python该死的缩进语法。
    </p>
    </li>
    <li>
    <a href="/marising/article/details/3173848#comments">Python 读取键盘输入字符</a>
    <p style="margin:0px;"><a href="/biosman" class="user_name">biosman</a>:
不好意思，我的错。我把termios后面的点看成‘，’了。
    </p>
    </li>
</ul>
</div>
<div id="custom_column_939464" class="panel">
<ul class="panel_head"><span>产品</span></ul>
<ul class="panel_body">
<ul><li><a href="http://www.inspur.com/products/channel_soft/gs_4370.shtml" target=_blank>浪潮GSP(做过的产品)</a></li><li><a href="http://www.cutt.com" target=_blank>简网(做过的产品)</a></li></ul>
</ul>
</div><div id="custom_column_939465" class="panel">
<ul class="panel_head"><span>牛人</span></ul>
<ul class="panel_body">
<ul><li><a href="http://blog.csdn.net/xushiweizh/" target=_blank>许世伟(StdEx作者C++大牛)</a></li><li><a href="http://juqiang.cnblogs.com/" target=_blank>鞠强(.Net Performance的老大)</a></li></ul>
</ul>
</div>    </div>
    <div class="clear">
    </div>
</div>

            <div class="clear">
            </div>
        </div>
        

<script type="text/javascript" src="http://static.blog.csdn.net/scripts/newblog.min.js"></script>
<script type="text/javascript" src="http://medal.blog.csdn.net/showblogmedal.ashx?blogid=5403"></script>
<script type="text/javascript">
    document.write('<script type="text/javascript" src="http://csdnimg.cn/pubfooter/js/publib_footer.js?' + Math.floor(new Date() / 120000).toString(36) + '="></' + 'script>');
</script>
    <script type="text/javascript" src="http://passport.csdn.net/content/loginbox/login.js"></script>
<script type="text/javascript">document.write("<img src=http://counter.csdn.net/pv.aspx?id=24 border=0 width=0 height=0>");</script>
<script type="text/javascript" src="http://www.csdn.net/ui/scripts/Csdn/counter.js"></script>
<script type="text/javascript" src="http://ad.csdn.net/scripts/ad-blog.js"></script>
<script type="text/javascript" src="http://zz.csdn.net/js/count.js"></script>
<script type="text/javascript">
    $(function () {
        function __get_code_toolbar(snippet_id) {
            return $("<a href='https://code.csdn.net/snippets/"
                    + snippet_id
                    + "' target='_blank' title='在CODE上查看代码片' style='text-indent:0;'><img src='https://code.csdn.net/assets/CODE_ico.png' width=12 height=12 alt='在CODE上查看代码片' style='position:relative;top:1px;left:2px;'/></a>"
                    + "<a href='https://code.csdn.net/snippets/"
                    + snippet_id
                    + "/fork' target='_blank' title='派生到我的代码片'  style='text-indent:0;'><img src='https://code.csdn.net/assets/ico_fork.svg' width=12 height=12 alt='派生到我的代码片' style='position:relative;top:2px;left:2px;'/></a>");
        }
        
        $("[code_snippet_id]").each(function () {
            __s_id = $(this).attr("code_snippet_id");
            if (__s_id != null && __s_id != "" && __s_id != 0 && parseInt(__s_id) > 70020) {
                __code_tool = __get_code_toolbar(__s_id);
                $(this).prev().find(".tools").append(__code_tool);
            }
        });
    });
</script>

    </div>
      <!--new top-->
    
    <script id="csdn-toolbar-id" btnId="header_notice_num" wrapId="note1" count="5" subCount="5" type="text/javascript" src="http://static.csdn.net/public/common/toolbar/js/toolbar.js"></script>     <!--new top-->
</body>
</html>
