<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>深入浅出Flashcache（一） - kidd_3的专栏 - 博客频道 - CSDN.NET</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="转载自：http://www.ningoo.net/html/2011/all_things_about_flashcache_1.html&#160;在计算机系统中，cache的魔爪无处不在。CPU中有L1,L2,甚至L3&#160;cache;Linux有pagecache，MySQL有buffer&#160;cache/query&#160;cache;IO系统中Raid卡/磁盘也有cache;在大型互联网系统中，数据库前面一" />
<script src="http://static.blog.csdn.net/scripts/jquery.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/ad.js?v=1.1"></script>
<link rel="Stylesheet" type="text/css" href="http://static.blog.csdn.net/skin/light_blue/css/style.css?v=1.1" />
<link id="RSSLink" title="RSS" type="application/rss+xml" rel="alternate" href="/kidd_3/rss/list" />
<link rel="shortcut icon" href="/favicon.ico" />
<link type="text/css" rel="stylesheet" href="http://static.blog.csdn.net/scripts/SyntaxHighlighter/styles/nobg_code.css" />
</head>
<body>
<script src="http://csdnimg.cn/pubnav/js/pub_topnav_2011.js"type="text/javascript"></script>

<div id="container">
<div id="header">
    <div class="header">
        <div id="blog_title">
            <h1><a href="/kidd_3">kidd_3的专栏</a></h1>
            <h2></h2>
            <div class="clear"></div>
        </div>
        <div class="clear"></div>
    </div>
</div>
<div id="navigator">
    <div class="navigator_bg"></div>
    <div class="navigator">
        <ul>
            <li id="btnContents"><a href="/kidd_3?viewmode=contents"><span><img src="http://static.blog.csdn.net/images/ico_list.gif">目录视图</span></a></li>
            <li id="btnView"><a href="/kidd_3?viewmode=list"><span><img src="http://static.blog.csdn.net/images/ico_summary.gif">摘要视图</span></a></li>
            <li id="btnRss"><a href="/kidd_3/rss/list"><span><img src="http://static.blog.csdn.net/images/ico_rss.gif">订阅</span></a></li>
</ul>
    </div>
</div>
<script type="text/javascript">
    var username = "kidd_3";
    var _blogger = username;
    var blog_address = "http://blog.csdn.net/kidd_3";
    var static_host = "http://static.blog.csdn.net";
    var currentUserName = "";
</script>

<div id="body">
<div id="main">
<div class="main">
<div class="notice"> 

<a href="http://events.csdn.net/DR2013/roadshow/index.html" target="_blank">
<font color=red>【免费】全新海外营销策论分享 
   </font></a>



&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

<a href="http://bbs.csdn.net/topics/390422723" target="_blank"><font color=blue>CSDN社区4月技术大分享活动火爆开始
</font></a>

&nbsp;&nbsp;&nbsp;&nbsp;

<a href="http://blog.csdn.net/blogdevteam/article/details/8699892" target="_blank"><font color=blue>写“书评”赢下载分！ 


</font></a>

<br />





<a href="http://blog.csdn.net/csdnproduct/article/details/8789396"target="_blank">
<font color=blue>公告：CSDN新版首页上线 


 </font></a>

&nbsp;&nbsp;&nbsp;&nbsp;

<a href="http://e.weibo.com/csdnsupport
"target="_blank">
<font color=red>欢迎关注CSDN产品客服微博
 </font></a>



&nbsp;&nbsp;&nbsp;&nbsp;

<a href="http://www.csdn.net/article/2013-04-10/2814826"target="_blank">
<font color=red>专访熊攀峰：HTML5时代 Flash仍是座宝藏

 </font></a>






</div>
<div id="article_details" class="details">
    <div class="article_title">
    <span class="ico ico_type_Repost"></span>
    <h3>
        <span class="link_title"><a href="/kidd_3/article/details/7044160">
        深入浅出Flashcache（一）
        </a></span>
    </h3>
</div>

        
    <div class="article_manage">
        <span class="link_categories">
        分类：
            <a href="/kidd_3/article/category/905673">flashcache</a> 
        </span>
    <span class="link_postdate">2011-12-05 22:47</span>
    <span class="link_view" title="阅读次数">239人阅读</span>
    <span class="link_comments" title="评论次数"><a href="#comments">评论</a>(0)</span>
    <span class="link_collect"><a href="javascript:void(0);" onclick="javascript:collectArticle('深入浅出Flashcache（一）','7044160');return false;" title="收藏">收藏</a></span>
    <span class="link_report"><a href="#report"  onclick="javascript:report(7044160,2);return false;" title="举报">举报</a></span>
    
</div>
<div class="tag2box"><a href='http://blog.csdn.net/tag/details.html?tag=io' target=_blank>io</a><a href='http://blog.csdn.net/tag/details.html?tag=cache' target=_blank>cache</a><a href='http://blog.csdn.net/tag/details.html?tag=struct' target=_blank>struct</a><a href='http://blog.csdn.net/tag/details.html?tag=%e6%95%b0%e6%8d%ae%e5%ba%93' target=_blank>数据库</a><a href='http://blog.csdn.net/tag/details.html?tag=%e5%b7%a5%e5%85%b7' target=_blank>工具</a><a href='http://blog.csdn.net/tag/details.html?tag=linux' target=_blank>linux</a></div>


    
<div id="article_content" class="article_content">

<div>
<p><a href="http://www.ningoo.net/html/2011/all_things_about_flashcache_1.html">转载自：http://www.ningoo.net/html/2011/all_things_about_flashcache_1.html</a>&nbsp;</p>
<p>在计算机系统中，<span style="font-family:Tahoma">cache</span><span style="font-family:宋体">的魔爪无处不在。</span><span style="font-family:Tahoma">CPU</span><span style="font-family:宋体">中有</span><span style="font-family:Tahoma">L1,L2,</span><span style="font-family:宋体">甚至</span><span style="font-family:Tahoma">L3&nbsp;cache;Linux</span><span style="font-family:宋体">有</span><span style="font-family:Tahoma">pagecache</span><span style="font-family:宋体">，</span><span style="font-family:Tahoma">MySQL</span><span style="font-family:宋体">有</span><span style="font-family:Tahoma">buffer&nbsp;cache/query&nbsp;cache;IO</span><span style="font-family:宋体">系统中</span><span style="font-family:Tahoma">Raid</span><span style="font-family:宋体">卡</span><span style="font-family:Tahoma">/</span><span style="font-family:宋体">磁盘也有</span><span style="font-family:Tahoma">cache;</span><span style="font-family:宋体">在大型互联网系统中，数据库前面一般也都有一层</span><span style="font-family:Tahoma">memcache</span><span style="font-family:宋体">。</span><span style="font-family:Tahoma">Cache</span><span style="font-family:宋体">是容量与性能之前取平衡的结果，</span>以更低的成本，获得更高的收益，是系统设计时应该遵循的原则。</p>
<p>传统机械硬盘几十年来，容量不断翻倍的增长，相比较而言，性能的增长就慢的像蜗牛了。对于依赖<span style="font-family:Tahoma">IO</span><span style="font-family:宋体">性能的应用，典型的如数据库，一直在等待新的技术来拯救。在此之前，身躯庞大的高端存储，动辄重达几吨。相比于存储里带的硬盘来说，价&#26684;贵得离谱，而存储的附加价&#20540;，在于</span><span style="font-family:Tahoma">io</span><span style="font-family:宋体">在大量硬盘之间的均衡分布，以及</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">链路的多路容灾，以及部分固件层面的优化和数据保护等。</span></p>
<p>Flash&nbsp;disk(SSD/FusionIO<span style="font-family:宋体">等</span><span style="font-family:Tahoma">)</span><span style="font-family:宋体">的出现，改变了这一切。</span><span style="font-family:Tahoma">Flash&nbsp;disk</span><span style="font-family:宋体">将硬盘从机械产品变成了电气产品，功耗更小，性能更好，时延更优，看起来传统硬盘已经不堪一击，数据库欢欣鼓舞，新的革命&#20284;乎将一夕成功。但新东西也有它致命的缺陷，价&#26684;和经过时间检验的稳定性。</span></p>
<p>所以<span style="font-family:Tahoma">Facebook</span><span style="font-family:宋体">的</span><span style="font-family:Tahoma">Mohan&nbsp;Srinivasan</span><span style="font-family:宋体">在</span><span style="font-family:Tahoma">2010</span><span style="font-family:宋体">年开源了</span><a href="https://github.com/facebook/flashcache">Flashcache</a>，将<span style="font-family:Tahoma">Flash&nbsp;disk</span><span style="font-family:宋体">做为普通硬盘的</span><span style="font-family:Tahoma">cache</span><span style="font-family:宋体">，这个思路，目前一些尝试也在</span><span style="font-family:Tahoma">raid</span><span style="font-family:宋体">卡硬件层面做尝试，例如</span><span style="font-family:Tahoma">LSI</span><span style="font-family:宋体">的</span><a href="http://www.lsi.com/channel/marketing/Pages/LSI-MegaRAID-CacheCade-Pro-2.0-software.aspx">CacheCade&nbsp;Pro</a>，不过之前版本新浪的童鞋测试过&#20284;乎性能没有想象的好。<span style="font-family:Tahoma">Flashcache</span><span style="font-family:宋体">在淘宝一些核心数据库中已经在线运行了大半年，经过调优后的表现稳定。</span><span style="font-family:Tahoma">Flashcache</span><span style="font-family:宋体">利用了</span><span style="font-family:Tahoma">Linux</span><span style="font-family:宋体">的</span><span style="font-family:Tahoma">device&nbsp;mapping</span><span style="font-family:宋体">机制，将</span><span style="font-family:Tahoma">Flash&nbsp;disk</span><span style="font-family:宋体">和普通硬盘的块设备做了一层映射，在</span><span style="font-family:Tahoma">OS</span><span style="font-family:宋体">中变现为一块普通的磁盘，使用简单，是一个&#20540;得推荐的方案。</span><span style="font-family:Tahoma">Flashcache</span><span style="font-family:宋体">最初的实现是</span><span style="font-family:Tahoma">write&nbsp;backup</span><span style="font-family:宋体">机制</span><span style="font-family:Tahoma">cache</span><span style="font-family:宋体">，后来又加入了</span><span style="font-family:Tahoma">write&nbsp;through</span><span style="font-family:宋体">和</span><span style="font-family:Tahoma">write&nbsp;around</span><span style="font-family:宋体">机制：</span></p>
<p>·&nbsp;write&nbsp;backup:&nbsp;<span style="font-family:宋体">先写入到</span><span style="font-family:Tahoma">cahce</span><span style="font-family:宋体">，然后</span><span style="font-family:Tahoma">cache</span><span style="font-family:宋体">中的脏块会由后台定期刷到持久存储。</span></p>
<p>·&nbsp;write&nbsp;through:&nbsp;<span style="font-family:宋体">同步写入到</span><span style="font-family:Tahoma">cache</span><span style="font-family:宋体">和持久存储。</span></p>
<p>·&nbsp;write&nbsp;around:&nbsp;<span style="font-family:宋体">只写入到持久存储。</span></p>
<p>在详细的介绍<span style="font-family:Tahoma">Flashcache</span><span style="font-family:宋体">之前，需要先了解一下</span><span style="font-family:Tahoma">Linux</span><span style="font-family:宋体">的</span><span style="font-family:Tahoma">block&nbsp;device</span><span style="font-family:宋体">和</span><span style="font-family:Tahoma">device&nbsp;mapper</span><span style="font-family:宋体">相关的知识。</span></p>
<p>1.&nbsp;Block&nbsp;Device<br>
块设备最初主要是依据传统硬盘等<span style="font-family:Tahoma">IO</span><span style="font-family:宋体">操作较慢的设备而设计的，所以</span><span style="font-family:Tahoma">Linux</span><span style="font-family:宋体">中为块设备的</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">操作提供了</span><span style="font-family:Tahoma">cache</span><span style="font-family:宋体">层，所以基于块设备的请求一般是</span><span style="font-family:Tahoma">buffer&nbsp;io</span><span style="font-family:宋体">，当然后来由于数据库等自己有</span><span style="font-family:Tahoma">cache</span><span style="font-family:宋体">机制的应用，</span><span style="font-family:Tahoma">os/fs</span><span style="font-family:宋体">层面的</span><span style="font-family:Tahoma">cache</span><span style="font-family:宋体">就成了多余，所以出现了绕过</span><span style="font-family:Tahoma">os/fs</span><span style="font-family:宋体">层</span><span style="font-family:Tahoma">cache</span><span style="font-family:宋体">的</span><span style="font-family:Tahoma">direct&nbsp;io</span><span style="font-family:宋体">。</span></p>
<p>块设备在设备确定层和<span style="font-family:Tahoma">kernel</span><span style="font-family:宋体">之间，为</span><span style="font-family:Tahoma">Kernel</span><span style="font-family:宋体">提供了统一的</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">操作接口，同时隐藏了不同硬件设备的细节。当有多个并发</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">请求到块设备时，请求的顺序会影响</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">的性能，因为普通的机械硬盘需要移动机械臂，所以</span><span style="font-family:Tahoma">kernel</span><span style="font-family:宋体">一般会对</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">做排序等调度后再发送到块设备层。</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">调度算法是一种电梯算法</span><span style="font-family:Tahoma">(elevator&nbsp;algorithm)</span><span style="font-family:宋体">，目前主要有</span><span style="font-family:Tahoma">cfq/deadline/anticipatory/noop</span><span style="font-family:宋体">，其中</span><span style="font-family:Tahoma">cfq</span><span style="font-family:宋体">是</span><span style="font-family:Tahoma">Linux</span><span style="font-family:宋体">的默认策略</span><span style="font-family:Tahoma">;anticipatory</span><span style="font-family:宋体">在新的内核中已经放弃</span><span style="font-family:Tahoma">;deadline</span><span style="font-family:宋体">在大部分</span><span style="font-family:Tahoma">OLTP</span><span style="font-family:宋体">数据库应用中更具优势，</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">的响应时间更稳定些</span><span style="font-family:Tahoma">;noop</span><span style="font-family:宋体">只对</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">请求进行简单的合并，其他不干涉，在</span><span style="font-family:Tahoma">FusionIO</span><span style="font-family:宋体">等</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">性能很好的设备上，</span><span style="font-family:Tahoma">noop</span><span style="font-family:宋体">反而更具优势，所以</span><span style="font-family:Tahoma">FusionIO</span><span style="font-family:宋体">的驱动默认使用了</span><span style="font-family:Tahoma">noop</span><span style="font-family:宋体">。关于</span><span style="font-family:Tahoma">IO&nbsp;Scheduler</span><span style="font-family:宋体">，后文会有更详细的解释。</span></p>
<p>块设备在用户空间是一种特殊的文件类型，由<span style="font-family:Tahoma">(major,minor)</span><span style="font-family:宋体">来标识，</span><span style="font-family:Tahoma">major</span><span style="font-family:宋体">区分</span><span style="font-family:Tahoma">disk</span><span style="font-family:宋体">，</span><span style="font-family:Tahoma">minor</span><span style="font-family:宋体">区分</span><span style="font-family:Tahoma">partition</span><span style="font-family:宋体">。</span><span style="font-family:Tahoma">Linux</span><span style="font-family:宋体">中一般把设备文件放在</span><span style="font-family:Tahoma">/dev</span><span style="font-family:宋体">目录。实际上你完全可以将块设备文件创建到其他地方，只要</span><span style="font-family:Tahoma">(major,minor)</span><span style="font-family:宋体">唯一确定，块设备文件最后访问的起始同一个块设备。</span></p>
<p>$ls&nbsp;-l&nbsp;/dev/sda1<br>
brw-rw<span style="font-family:Times New Roman">—</span><span style="font-family:Tahoma">-&nbsp;1&nbsp;root&nbsp;disk&nbsp;8,&nbsp;1&nbsp;2011-12-03&nbsp;01:00&nbsp;/dev/sda1</span></p>
<p>$sudo&nbsp;mknod&nbsp;/opt/sda1&nbsp;b&nbsp;8&nbsp;1</p>
<p>$ls&nbsp;-l&nbsp;/opt/sda1<br>
brw-r<span style="font-family:Times New Roman">–</span><span style="font-family:Tahoma">r</span><span style="font-family:Times New Roman">–&nbsp;</span><span style="font-family:Tahoma">1&nbsp;root&nbsp;root&nbsp;8,&nbsp;1&nbsp;2011-12-03&nbsp;11:54&nbsp;/opt/sda1</span></p>
<p>由于块设备处于文件系统和物理设备驱动之间，在这一层做一些工作可以对所有<span style="font-family:Tahoma">IO</span><span style="font-family:宋体">产生影响，因此很多优秀的产品都在这一层做文章，除了</span><span style="font-family:Tahoma">Flashcache</span><span style="font-family:宋体">，还有一个比较著名的就是</span><a href="http://www.ningoo.net/html/2011/www.drbd.org">DRBD</a>（<span style="font-family:Tahoma">DRBD</span><span style="font-family:宋体">已经进入</span><span style="font-family:Tahoma">2.6.33</span><span style="font-family:宋体">内核）。</span><br>
</p>
<p>在<span style="font-family:Tahoma">Linux</span><span style="font-family:宋体">内核中定义了一些操作块设备相关的结构体和函数，下面的信息基于</span><span style="font-family:Tahoma">2.6.32.49:</span></p>
<p>1.1&nbsp;gendisk</p>
<p><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/include/linux/genhd.h#L135">gendisk</a>保存了一个具体的<span style="font-family:Tahoma">disk</span><span style="font-family:宋体">的信息，包括该</span><span style="font-family:Tahoma">disk</span><span style="font-family:宋体">上的请求队列，分区列表</span><span style="font-family:Tahoma">/</span><span style="font-family:宋体">第一个分区，块设备操作表等重要信息。</span></p>
<p>struct&nbsp;gendisk&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;request_queue&nbsp;*queue;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;disk_part_tbl&nbsp;*part_tbl;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;hd_struct&nbsp;part0;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;const&nbsp;struct&nbsp;block_device_operations&nbsp;*fops;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>};</p>
<p>1.2&nbsp;hd_struct</p>
<p><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/include/linux/genhd.h#L90">hd_struct</a>保存一个分区信息，包括起始扇区，扇区数，分区号等基本信息。</p>
<p>struct&nbsp;hd_struct&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;sector_t&nbsp;start_sect;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;sector_t&nbsp;nr_sects;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;partno;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>};</p>
<p>1.3&nbsp;disk_part_tbl</p>
<p><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/include/linux/genhd.h#L128">disk_part_tbl</a>保存磁盘分区表的信息</p>
<p>struct&nbsp;disk_part_tbl&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;rcu_head&nbsp;rcu_head;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;len;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;hd_struct&nbsp;*last_lookup;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;hd_struct&nbsp;*part[];</p>
<p>};</p>
<p>1.4&nbsp;block_device</p>
<p><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/include/linux/fs.h#L646">block_device</a>可以是整个磁盘，也可以是一个分区。如果是一个分区块设备，则<span style="font-family:Tahoma">bd_contains</span><span style="font-family:宋体">会指向分区所在磁盘的</span><span style="font-family:Tahoma">block_device</span><span style="font-family:宋体">，</span><span style="font-family:Tahoma">bd_part</span><span style="font-family:宋体">则指向分区信息结构</span><span style="font-family:Tahoma">hd_struct</span><span style="font-family:宋体">。。</span></p>
<p>struct&nbsp;block_device&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;dev_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bd_bdev;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;inode&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*bd_inode;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;list_head&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bd_inodes;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;super_block&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*bd_super;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;block_device&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*bd_contains;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;gendisk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*bd_disk;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;hd_struct&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*bd_part;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;list_head&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bd_list;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;backing_dev_info&nbsp;*bd_inode_backing_dev_info;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>};</p>
<p>1.5&nbsp;buffer_head</p>
<p>顾名思义，在内核层对块设备的<span style="font-family:Tahoma">IO</span><span style="font-family:宋体">请求是以块为单位的。</span><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/include/linux/buffer_head.h#L61">buffer_head</a>是一个块在内存中的元数据信息。<span style="font-family:Tahoma">b_data</span><span style="font-family:宋体">指向该块数据的实际地址。</span><span style="font-family:Tahoma">b_this_page</span><span style="font-family:宋体">则将通过一</span><span style="font-family:Tahoma">page</span><span style="font-family:宋体">中的块连接起来。以前版本的</span><span style="font-family:Tahoma">buffer_head</span><span style="font-family:宋体">是</span><span style="font-family:Tahoma">fs</span><span style="font-family:宋体">到</span><span style="font-family:Tahoma">block&nbsp;device</span><span style="font-family:宋体">的</span><span style="font-family:Tahoma">io</span><span style="font-family:宋体">请求单元，现在已经改为</span><span style="font-family:Tahoma">bio</span><span style="font-family:宋体">了。</span></p>
<p>struct&nbsp;buffer_head&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;long&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;b_state;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;buffer_head&nbsp;&nbsp;&nbsp;*b_this_page;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;char&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*b_data;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;sector_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;blocknr;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;block_device&nbsp;&nbsp;*b_bdev;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bh_end_io_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*b_end_io;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>};</p>
<p>1.6&nbsp;bio</p>
<p><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/include/linux/bio.h#L62">bio</a>封装了一次实际的块设备<span style="font-family:Tahoma">io</span><span style="font-family:宋体">请求。这是块设备</span><span style="font-family:Tahoma">io</span><span style="font-family:宋体">请求的基本单位。</span><span style="font-family:Tahoma">bi_vcnt</span><span style="font-family:宋体">表示</span><span style="font-family:Tahoma">bio_vec</span><span style="font-family:宋体">的数目。</span></p>
<p>struct&nbsp;bio&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;sector_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bi_sector;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;bio&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*bi_next;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;block_device&nbsp;*bi_bdev;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;short&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bi_vcnt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;short&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bi_idx;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;bio_vec&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*bi_io_vec;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>};</p>
<p>1.7&nbsp;bio_vec</p>
<p><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/include/linux/bio.h#L46">bio_vec</a>表示一次<span style="font-family:Tahoma">bio</span><span style="font-family:宋体">涉及到的数据片段</span><span style="font-family:Tahoma">(segment)</span><span style="font-family:宋体">，由所在内存页地址，长度，偏移地址等定位。一次</span><span style="font-family:Tahoma">bio</span><span style="font-family:宋体">一般包含多个</span><span style="font-family:Tahoma">segment</span><span style="font-family:宋体">。</span></p>
<p>struct&nbsp;bio_vec&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;page&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*bv_page;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bv_len;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;unsigned&nbsp;int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;bv_offset;</p>
<p>};</p>
<p>1.8&nbsp;request</p>
<p>块设备层<span style="font-family:Tahoma">IO</span><span style="font-family:宋体">等待请求</span><span style="font-family:Tahoma">(pending&nbsp;I/O&nbsp;</span><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/include/linux/blkdev.h#L158">request</a>)<span style="font-family:宋体">。内核中的</span><span style="font-family:Tahoma">bio</span><span style="font-family:宋体">请求在经过</span><span style="font-family:Tahoma">io</span><span style="font-family:宋体">调度排序后进入块设备层，会尝试合并到已有的</span><span style="font-family:Tahoma">requst</span><span style="font-family:宋体">。</span><span style="font-family:Tahoma">bio</span><span style="font-family:宋体">结构中的</span><span style="font-family:Tahoma">bi_next</span><span style="font-family:宋体">将队列中的</span><span style="font-family:Tahoma">bio</span><span style="font-family:宋体">请求串成一个队列。</span><span style="font-family:Tahoma">bio/biotail</span><span style="font-family:宋体">域指向队列的首尾。</span></p>
<p>struct&nbsp;request&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;list_head&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queuelist;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;bio&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*bio;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;bio&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*biotail;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*elevator_private;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;void&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*elevator_private2;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;gendisk&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*rq_disk;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;request_queue_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*q;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>};</p>
<p>1.8&nbsp;request_queue</p>
<p><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/include/linux/blkdev.h#L324">request_queue</a>维护块设备层<span style="font-family:Tahoma">IO</span><span style="font-family:宋体">请求队列，队列中包含多个</span><span style="font-family:Tahoma">request</span><span style="font-family:宋体">。</span><span style="font-family:Tahoma">request_queue</span><span style="font-family:宋体">同时定义了处理队列的函数接口，不同的设备注册时需要实现这些</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">处理接口。</span></p>
<p>struct&nbsp;request_queue&nbsp;{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;list_head&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;queue_head;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;request&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*lastmerge;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;elevator_t&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*elevator;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;request_list&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;rq;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;request_fn_proc&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*request_fn;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;make_request_fn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*make_request_fn;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;prep_rq_fn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*prep_rq_fn;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;unplug_fn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*unplug_fn;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;merge_bvec_fn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*merge_bvec_fn;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;prepare_flush_fn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*prepare_flush_fn;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;softirq_done_fn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*softirq_done_fn;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;rq_timed_out_fn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*rq_timed_out_fn;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;dma_drain_needed_fn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*dma_drain_needed;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;lld_busy_fn&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*lld_busy_fn;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;blk_trace&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*blk_trace;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>};</p>
<p>1.9&nbsp;submit_bh</p>
<p><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/fs/buffer.c#L2946">submit_bh</a>是内核发送<span style="font-family:Tahoma">IO</span><span style="font-family:宋体">请求给块设备的函数，目前较新版本的内核中该函数会调用</span><span style="font-family:Tahoma">submit_bio</span><span style="font-family:宋体">执行实际请求。</span></p>
<p>int&nbsp;submit_bh(int&nbsp;rw,&nbsp;struct&nbsp;buffer_head&nbsp;*&nbsp;bh)</p>
<p>{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;bio&nbsp;*bio;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;ret&nbsp;=&nbsp;0;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio&nbsp;=&nbsp;bio_alloc(GFP_NOIO,&nbsp;1);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_sector&nbsp;=&nbsp;bh-&gt;b_blocknr&nbsp;*&nbsp;(bh-&gt;b_size&nbsp;&gt;&gt;&nbsp;9);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_bdev&nbsp;=&nbsp;bh-&gt;b_bdev;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_io_vec[0].bv_page&nbsp;=&nbsp;bh-&gt;b_page;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_io_vec[0].bv_len&nbsp;=&nbsp;bh-&gt;b_size;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_io_vec[0].bv_offset&nbsp;=&nbsp;bh_offset(bh);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_vcnt&nbsp;=&nbsp;1;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_idx&nbsp;=&nbsp;0;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_size&nbsp;=&nbsp;bh-&gt;b_size;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_end_io&nbsp;=&nbsp;end_bio_bh_io_sync;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio-&gt;bi_private&nbsp;=&nbsp;bh;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio_get(bio);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;submit_bio(rw,&nbsp;bio);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(bio_flagged(bio,&nbsp;BIO_EOPNOTSUPP))</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;-EOPNOTSUPP;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;bio_put(bio);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;ret;</p>
<p>}</p>
<p>1.10&nbsp;submit_bio</p>
<p><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/block/blk-core.c#L1554">submit_bio</a>函数会调用<a href="http://lxr.linux.no/linux&#43;v2.6.32.49/block/blk-core.c#L1503">generic_make_request</a>执行实际的<span style="font-family:Tahoma">bio</span><span style="font-family:宋体">请求。</span><span style="font-family:Tahoma">generic_make_request</span><span style="font-family:宋体">则循环处理</span><span style="font-family:Tahoma">bio</span><span style="font-family:宋体">链表，针对每个</span><span style="font-family:Tahoma">bio</span><span style="font-family:宋体">调用内联函数</span><a href="http://lxr.linux.no/linux&#43;v2.6.32.49/block/blk-core.c#L1406">__generic_make_request</a>来做处理。<span style="font-family:Tahoma">__generic_make_request</span><span style="font-family:宋体">则最终调用</span><span style="font-family:Tahoma">request_queue</span><span style="font-family:宋体">中的</span><span style="font-family:Tahoma">make_request_fn</span><span style="font-family:宋体">处理函数处理实际的</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">请求。</span></p>
<p>void&nbsp;submit_bio(int&nbsp;rw,&nbsp;struct&nbsp;bio&nbsp;*bio)</p>
<p>{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;generic_make_request(bio);</p>
<p>}</p>
<p>...</p>
<p>static&nbsp;inline&nbsp;void&nbsp;__generic_make_request(struct&nbsp;bio&nbsp;*bio)</p>
<p>{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;struct&nbsp;request_queue&nbsp;*q;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;ret;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;do{</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;q&nbsp;=&nbsp;bdev_get_queue(bio-&gt;bi_bdev);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ret&nbsp;=&nbsp;q-&gt;make_request_fn(q,&nbsp;bio);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;}while(ret);</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;...</p>
<p>}</p>
<p>2.&nbsp;Block&nbsp;device<span style="font-family:宋体">相关的工具</span></p>
<p>Linux<span style="font-family:宋体">提供了一些工具来操作和查看块设备，如果你的系统中没有，可以安装最新版本的</span><a href="ftp://ftp.kernel.org/pub/linux/utils/util-linux-ng/">util-linux-ng</a>来获得，实际上很多常用的工具都是出自整个工具集，本文后续也会用到其中一些有意思的工具。</p>
<p>2.1&nbsp;lsblk</p>
<p>RHEL6.1<span style="font-family:宋体">中已经带有该工具。下面是一台已经配置好</span><span style="font-family:Tahoma">Flashcache</span><span style="font-family:宋体">的机器上执行的结果：</span></p>
<p>$lsblk</p>
<p>NAME&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;MAJ:MIN&nbsp;RM&nbsp;&nbsp;&nbsp;SIZE&nbsp;RO&nbsp;MOUNTPOINT</p>
<p>sda&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8:0&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;200G&nbsp;&nbsp;0</p>
<p>├─sda1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8:1&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;128M&nbsp;&nbsp;0&nbsp;/boot</p>
<p>├─sda2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8:2&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;14.7G&nbsp;&nbsp;0&nbsp;/</p>
<p>├─sda8&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8:8&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2G&nbsp;&nbsp;0&nbsp;[SWAP]</p>
<p>sdb&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8:16&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;1.5T&nbsp;&nbsp;0</p>
<p>└─sdb1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8:17&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;1.5T&nbsp;&nbsp;0</p>
<p>&nbsp;&nbsp;└─cachedev&nbsp;(dm-0)&nbsp;253:0&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;1.5T&nbsp;&nbsp;0&nbsp;/opt</p>
<p>fioa&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;252:0&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;300.4G&nbsp;&nbsp;0</p>
<p>└─cachedev&nbsp;(dm-0)&nbsp;&nbsp;&nbsp;253:0&nbsp;&nbsp;&nbsp;&nbsp;0&nbsp;&nbsp;&nbsp;1.5T&nbsp;&nbsp;0&nbsp;/opt</p>
<p>2.2&nbsp;blkid</p>
<p>blkid<span style="font-family:宋体">可以块设备的属性，不带参数也会列出系统中所有的块设备。</span></p>
<p>$&nbsp;sudo&nbsp;blkid</p>
<p>/dev/sda1:&nbsp;UUID=&quot;0ff3ff63-d214-4d32-8633-66a4333fece9&quot;&nbsp;TYPE=&quot;ext4&quot;</p>
<p>/dev/sda6:&nbsp;UUID=&quot;d328b838-9043-438d-81b8-6a96454def3c&quot;&nbsp;TYPE=&quot;swap&quot;</p>
<p>2.3&nbsp;blockdev<br>
<br>
blockdev<span style="font-family:宋体">，不仅可以查看，也可以设置块设备的一些属性。</span></p>
<p>$&nbsp;blockdev</p>
<p>用法<span style="font-family:Times New Roman">:</span></p>
<p>&nbsp;&nbsp;blockdev&nbsp;-V</p>
<p>&nbsp;&nbsp;blockdev&nbsp;--report&nbsp;[devices]</p>
<p>&nbsp;&nbsp;blockdev&nbsp;[-v|-q]&nbsp;commands&nbsp;devices</p>
<p>可用的命令<span style="font-family:Times New Roman">:</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getsz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">获得</span><span style="font-family:Times New Roman">512</span><span style="font-family:宋体">字节的段大小</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--setro&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">设置只读</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--setrw&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">设置读写</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getro&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">获得只读</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getss&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;logical&nbsp;block&nbsp;(sector)&nbsp;size</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getpbsz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;physical&nbsp;block&nbsp;(sector)&nbsp;size</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getiomin&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;minimum&nbsp;I/O&nbsp;size</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getioopt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;optimal&nbsp;I/O&nbsp;size</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getalignoff&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;alignment&nbsp;offset</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getmaxsect&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;get&nbsp;max&nbsp;sectors&nbsp;per&nbsp;request</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getbsz&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">获得块大小</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--setbsz&nbsp;BLOCKSIZE&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">设置块大小</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getsize&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">获得&nbsp;</span><span style="font-family:Times New Roman">32-bit&nbsp;</span><span style="font-family:宋体">段数量</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getsize64&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">获得字节大小</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--setra&nbsp;READAHEAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">设置&nbsp;</span><span style="font-family:Times New Roman">readahead</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">获取&nbsp;</span><span style="font-family:Times New Roman">readahead</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--setfra&nbsp;FSREADAHEAD&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">设置文件系统&nbsp;</span><span style="font-family:Times New Roman">readahead</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--getfra&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">获取文件系统&nbsp;</span><span style="font-family:Times New Roman">readahead</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--flushbufs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">刷新缓存</span></p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;--rereadpt&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family:宋体">重新读取分区表</span></p>
<p>2.4&nbsp;fdisk</p>
<p>当然常用的<span style="font-family:Tahoma">fdisk</span><span style="font-family:宋体">也是管理块设备的利器。</span></p>
<p>$&nbsp;sudo&nbsp;fdisk&nbsp;-l&nbsp;/dev/sda4</p>
<p>Disk&nbsp;/dev/sda4:&nbsp;136.5&nbsp;GB,&nbsp;136492089344&nbsp;bytes</p>
<p>255&nbsp;heads,&nbsp;63&nbsp;sectors/track,&nbsp;16594&nbsp;cylinders</p>
<p>Units&nbsp;=&nbsp;cylinders&nbsp;of&nbsp;16065&nbsp;*&nbsp;512&nbsp;=&nbsp;8225280&nbsp;bytes</p>
<p>Sector&nbsp;size&nbsp;(logical/physical):&nbsp;512&nbsp;bytes&nbsp;/&nbsp;512&nbsp;bytes</p>
<p>I/O&nbsp;size&nbsp;(minimum/optimal):&nbsp;512&nbsp;bytes&nbsp;/&nbsp;512&nbsp;bytes</p>
<p>Disk&nbsp;identifier:&nbsp;0x00000000</p>
<p>2.5&nbsp;blktrace</p>
<p>blktrace<span style="font-family:宋体">是跟踪块设备</span><span style="font-family:Tahoma">IO</span><span style="font-family:宋体">请求情况的利器。</span></p>
<p>blktrace&nbsp;is&nbsp;a&nbsp;block&nbsp;layer&nbsp;IO&nbsp;tracing&nbsp;mechanism&nbsp;which&nbsp;provides&nbsp;detailed&nbsp;information&nbsp;about&nbsp;request&nbsp;queue&nbsp;operations&nbsp;up&nbsp;to&nbsp;user&nbsp;space.</p>
<p>核心系统部的褚霸童鞋详细的介绍了这个个工具，有兴趣的移步<a href="http://blog.yufeng.info/archives/751">这里</a>，<a href="http://blog.yufeng.info/archives/1786">这里</a>，还有<a href="http://blog.yufeng.info/archives/1112">这里</a>。</p>
<p>2.6&nbsp;lscpu</p>
<p>顺带说一下，<span style="font-family:Tahoma">lscpu</span><span style="font-family:宋体">也是一个很有用的工具，下面是</span><span style="font-family:Tahoma">2</span><span style="font-family:宋体">路</span><span style="font-family:Tahoma">intel&nbsp;L5630</span><span style="font-family:宋体">的主机上打印出来的信息，</span><span style="font-family:Tahoma">L5630</span><span style="font-family:宋体">是</span><span style="font-family:Tahoma">intel</span><span style="font-family:宋体">的低功耗</span><span style="font-family:Tahoma">CPU</span><span style="font-family:宋体">，额定功率只有常用的</span><span style="font-family:Tahoma">x5620</span><span style="font-family:宋体">的一半左右。</span></p>
<p>$sudo&nbsp;lscpu</p>
<p>Architecture:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x86_64</p>
<p>CPU&nbsp;op-mode(s):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32-bit,&nbsp;64-bit</p>
<p>Byte&nbsp;Order:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Little&nbsp;Endian</p>
<p>CPU(s):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;16</p>
<p>On-line&nbsp;CPU(s)&nbsp;list:&nbsp;&nbsp;&nbsp;0-15</p>
<p>Thread(s)&nbsp;per&nbsp;core:&nbsp;&nbsp;&nbsp;&nbsp;2</p>
<p>Core(s)&nbsp;per&nbsp;socket:&nbsp;&nbsp;&nbsp;&nbsp;4</p>
<p>CPU&nbsp;socket(s):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</p>
<p>NUMA&nbsp;node(s):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</p>
<p>Vendor&nbsp;ID:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;GenuineIntel</p>
<p>CPU&nbsp;family:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6</p>
<p>Model:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;44</p>
<p>Stepping:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2</p>
<p>CPU&nbsp;MHz:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2127.973</p>
<p>BogoMIPS:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4255.85</p>
<p>Virtualization:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;VT-x</p>
<p>L1d&nbsp;cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32K</p>
<p>L1i&nbsp;cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;32K</p>
<p>L2&nbsp;cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;256K</p>
<p>L3&nbsp;cache:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;12288K</p>
<p>NUMA&nbsp;node0&nbsp;CPU(s):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,2,4,6,8,10,12,14</p>
<p>NUMA&nbsp;node1&nbsp;CPU(s):&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1,3,5,7,9,11,13,15</p>
<p>未完待续</p>
<p>参考：<br>
[1].&nbsp;<a href="http://www2.comp.ufscar.br/~helio/block/blkdevarch26.html">Linux&nbsp;Block&nbsp;Device&nbsp;Architecture</a><br>
[2].&nbsp;<a href="http://www.mimuw.edu.pl/~vincent/lecture13/13-dm.pdf">Block&nbsp;devices&nbsp;and&nbsp;volume&nbsp;management&nbsp;in&nbsp;Linux</a></p>
</div>
<br>

</div>

<div class="share_buttons" id="sharePanel"></div>
<!--192.168.1.236-->
<div class="article_next_prev">
    <li class="prev_article"><span>上一篇：</span><a href="/kidd_3/article/details/7032909">page cache的感想</a></li>
    <li class="next_article"><span>下一篇：</span><a href="/kidd_3/article/details/7044178">深入浅出flashcache（二）</a></li>
</div>


    
</div>
<div id="ad_cen">
<script type="text/javascript" >BAIDU_CLB_SLOT_ID = "117306";</script>
<script type="text/javascript" src="http://cbjs.baidu.com/js/o.js"></script>
</div>
<script type="text/javascript">
    //new Ad(4, 'ad_cen');
</script>
<div id="comment_title" class="panel_head">查看评论<a name="comments"></a></div>
<div id="comment_list"></div>
<div id="comment_bar"></div>
<div id="comment_form"></div>
<div class="announce">* 以上用户言论只代表其个人观点，不代表CSDN网站的观点或立场<a name="reply"></a><a name="quote"></a></div>
<script type="text/javascript">
    var fileName = '7044160';
    var commentscount = 0;
    var islock = false
</script>
<script type="text/javascript" src="http://static.blog.csdn.net/scripts/comment.js"></script>
<div id="ad_bot"></div>
<script type="text/javascript">
    new Ad(5, 'ad_bot');
</script>
<div id="report_dialog"></div>

<div id="d-top" style="display:none;">
<a id="d-top-a" href="#" title="回到顶部">
<img src="http://static.blog.csdn.net/images/top.png" alt="TOP" /></a>
</div>
<script type="text/javascript">
    $(function(){
        var d_top=$('#d-top');
        document.onscroll=function(){
            var scrTop=(document.body.scrollTop||document.documentElement.scrollTop);
            if(scrTop>500){
                d_top.show();
            }else{
                d_top.hide();
            }
        }
        $('#d-top-a').click(function(){
            scrollTo(0,0);
            this.blur();
            return false;
        });
    });
</script>

<div class="clear"></div>
</div>
</div>

<div id="side">
<div class="side">
<div id="panel_Profile" class="panel">
<ul class="panel_head"><span>个人资料</span></ul>
<ul class="panel_body profile">
<div id="blog_userface">
    <a href="http://my.csdn.net/kidd_3" target="_blank">
    <img src="http://avatar.csdn.net/E/D/D/1_kidd_3.jpg" title="访问我的空间" style="max-width:90%"/>
    </a>
    <br />
    <span><a href="http://my.csdn.net/kidd_3" class="user_name" target="_blank">kidd_3</a></span>
</div>
<div class="interact">
<a href="javascript:void(0);" class="attent" id="span_add_follow" title="[加关注]"></a>
<a href="javascript:void(0);" class="letter" onclick="loginto(1)" title="[发私信]"></a>
</div>
<div id="blog_medal">
</div>
<ul id="blog_rank">
    <li>访问：<span>27042次</span></li>
    <li>积分：<span>881分</span></li>
    <li>排名：<span>第11667名</span></li>
</ul>
<ul id="blog_statistics">
    <li>原创：<span>62篇</span></li>
    <li>转载：<span>27篇</span></li>
    <li>译文：<span>0篇</span></li>
    <li>评论：<span>6条</span></li>
</ul>
</ul>
</div>



<div class="panel" id="panel_Search">
    <ul class="panel_head"><span>文章搜索</span></ul>
    <ul class="panel_body">
        <form id="frmSearch" action="http://so.csdn.net/search" class="form_search" target="_blank">
        <span><input id="inputSearch" type="text" class="blogsearch" title="请输入关键字" /></span>
        <input id="btnSubmit" type="submit" value="搜索" title="search in blog" />
        <input type="hidden" name="q" id="inputQ" />
        <input type="hidden" name="t" value="blog" />
        <a id="btnSearchBlog" target="_blank"></a>
        </form>
    </ul>
</div><div id="panel_Category" class="panel">
<ul class="panel_head"><span>文章分类</span></ul>
<ul class="panel_body">
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/526006">Linux</a><span>(31)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/850362">iscsi</a><span>(4)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/905673">flashcache</a><span>(11)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/916251">重复数据删除</a><span>(1)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/935860">mysql</a><span>(3)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/935899">测试工具</a><span>(1)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/1075084">虚拟化</a><span>(4)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/1155172">GlusterFS</a><span>(3)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/1164671">存储基础</a><span>(14)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/1164673">linux工具</a><span>(2)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/1168497">杂七杂八</a><span>(0)</span>
</li>
<li>
<a href="http://blog.csdn.net/kidd_3/article/category/1262340">云计算</a><span>(4)</span>
</li>
</ul>
</div><div id="panel_Archive" class="panel">
<ul class="panel_head"><span>文章存档</span></ul>
<ul class="panel_body">
<div id="archive_list">
<!--归档统计-->
<li><a href="http://blog.csdn.net/kidd_3/article/month/2012/11">2012年11月</a><span>(10)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2012/10">2012年10月</a><span>(10)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2012/09">2012年09月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2012/08">2012年08月</a><span>(2)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2012/06">2012年06月</a><span>(8)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2012/05">2012年05月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2012/02">2012年02月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2012/01">2012年01月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2011/12">2011年12月</a><span>(9)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2011/11">2011年11月</a><span>(13)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2011/10">2011年10月</a><span>(14)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2011/08">2011年08月</a><span>(3)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2011/07">2011年07月</a><span>(7)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2010/09">2010年09月</a><span>(5)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2009/04">2009年04月</a><span>(1)</span></li><li><a href="http://blog.csdn.net/kidd_3/article/month/2009/03">2009年03月</a><span>(1)</span></li>
</div>
</ul>
</div>
<div id="hotarticls" class="panel">
<ul class="panel_head"><span>阅读排行</span></ul>
<ul class="panel_body itemlist">
<li>
<a href="/kidd_3/article/details/7874794" title="vmware设置桥接上网">vmware设置桥接上网</a><span>(1991)</span>
</li>
<li>
<a href="/kidd_3/article/details/6984822" title="flashcache的实现与分析">flashcache的实现与分析</a><span>(1770)</span>
</li>
<li>
<a href="/kidd_3/article/details/7029267" title="黄金搭档之fio+blktrace--linux下模拟块设备访问方式">黄金搭档之fio+blktrace--linux下模拟块设备访问方式</a><span>(1098)</span>
</li>
<li>
<a href="/kidd_3/article/details/6970573" title="flashcache技术点分析">flashcache技术点分析</a><span>(885)</span>
</li>
<li>
<a href="/kidd_3/article/details/6882992" title="提升磁盘IO性能的几个技巧">提升磁盘IO性能的几个技巧</a><span>(853)</span>
</li>
<li>
<a href="/kidd_3/article/details/6934110" title="flashcache功能分析">flashcache功能分析</a><span>(780)</span>
</li>
<li>
<a href="/kidd_3/article/details/6886681" title="kthread_create和kernel_thread的区别和总结">kthread_create和kernel_thread的区别和总结</a><span>(716)</span>
</li>
<li>
<a href="/kidd_3/article/details/6909097" title="linux IO子系统和文件系统读写流程">linux IO子系统和文件系统读写流程</a><span>(674)</span>
</li>
<li>
<a href="/kidd_3/article/details/8095135" title="云计算及其基础架构的理解">云计算及其基础架构的理解</a><span>(561)</span>
</li>
<li>
<a href="/kidd_3/article/details/6871988" title="专访Fusion-IO：有固态硬盘还要分层存储干吗?">专访Fusion-IO：有固态硬盘还要分层存储干吗?</a><span>(496)</span>
</li>
</ul>
</div>
<div id="hotarticls2" class="panel">
<ul class="panel_head"><span>评论排行</span></ul>
<ul class="panel_body itemlist">
<li>
<a href="/kidd_3/article/details/7893557" title="GlusterFS之文件系统扩展属性">GlusterFS之文件系统扩展属性</a><span>(2)</span>
</li>
<li>
<a href="/kidd_3/article/details/6984822" title="flashcache的实现与分析">flashcache的实现与分析</a><span>(1)</span>
</li>
<li>
<a href="/kidd_3/article/details/8155629" title="pdflush刷盘时机">pdflush刷盘时机</a><span>(1)</span>
</li>
<li>
<a href="/kidd_3/article/details/6871900" title="SSD盘阵，技术成熟了吗？">SSD盘阵，技术成熟了吗？</a><span>(1)</span>
</li>
<li>
<a href="/kidd_3/article/details/6912366" title="device mapper读书笔记">device mapper读书笔记</a><span>(1)</span>
</li>
<li>
<a href="/kidd_3/article/details/7650041" title="loop设备">loop设备</a><span>(0)</span>
</li>
<li>
<a href="/kidd_3/article/details/7650055" title="网络存储的3种形式及各自特点">网络存储的3种形式及各自特点</a><span>(0)</span>
</li>
<li>
<a href="/kidd_3/article/details/7650113" title="云存储概要介绍">云存储概要介绍</a><span>(0)</span>
</li>
<li>
<a href="/kidd_3/article/details/7650186" title="对虚拟化的一些理解">对虚拟化的一些理解</a><span>(0)</span>
</li>
<li>
<a href="/kidd_3/article/details/7650230" title="虚拟化实现技术分析">虚拟化实现技术分析</a><span>(0)</span>
</li>
</ul>
</div>
<div id="homepageArticles" class="panel">
<ul class="panel_head"><span>推荐文章</span></ul>
<ul class="panel_body" id="ad_commend"></ul>
</div>
<script type="text/javascript">
 new Ad(12, 'ad_commend');
</script><div id="newcomments" class="panel">
<ul class="panel_head"><span>最新评论</span></ul>
<ul class="panel_body itemlist">
    <li>
    <a href="/kidd_3/article/details/6871900#comments">SSD盘阵，技术成熟了吗？</a>
    <p style="margin:0px;"><a href="/u010005296" class="user_name">u010005296</a>:
特地注册了一个用户来评论。SSD盘阵具有单个存储容量小和访问速度快的优势，使用副本存储肯定是不合适的...
    </p>
    </li>
    <li>
    <a href="/kidd_3/article/details/7893557#comments">GlusterFS之文件系统扩展属性</a>
    <p style="margin:0px;"><a href="/tgnan123" class="user_name">tgnan123</a>:
受教了，受教了。
    </p>
    </li>
    <li>
    <a href="/kidd_3/article/details/6984822#comments">flashcache的实现与分析</a>
    <p style="margin:0px;"><a href="/hs794502825" class="user_name">hs794502825</a>:
好文！赞！
    </p>
    </li>
    <li>
    <a href="/kidd_3/article/details/8155629#comments">pdflush刷盘时机</a>
    <p style="margin:0px;"><a href="/mengyafei43" class="user_name">mengyafei43</a>:
文章就如你的身板，受的可怜
    </p>
    </li>
    <li>
    <a href="/kidd_3/article/details/7893557#comments">GlusterFS之文件系统扩展属性</a>
    <p style="margin:0px;"><a href="/king34555" class="user_name">king34555</a>:
好文，请教下gluster有没有什么命令可以方便的查看文件的扩展属性？
    </p>
    </li>
    <li>
    <a href="/kidd_3/article/details/6912366#comments">device mapper读书笔记</a>
    <p style="margin:0px;"><a href="/GeorgeBrian" class="user_name">GeorgeBrian</a>:
也在研究这块内容，谢谢喽！
    </p>
    </li>
</ul>
</div>
</div>
<div class="clear"></div>
</div>

<div class="clear"></div>
</div>

<script type="text/javascript" src="http://static.blog.csdn.net/scripts/newblog.min.js?v=1.1"></script>
<script type="text/javascript" src="http://medal.blog.csdn.net/showblogmedal.ashx?blogid=536816"></script>

<script type="text/javascript" src="http://csdnimg.cn/pubfooter/js/publib_footer.js"></script>

<script type="text/javascript" src="http://passport.csdn.net/content/loginbox/login.js"></script>
<script type="text/javascript">document.write("<img src=http://counter.csdn.net/pv.aspx?id=24 border=0 width=0 height=0>");</script>
<script type="text/javascript" src="http://www.csdn.net/ui/scripts/Csdn/counter.js?v=1"></script>


<script type="text/javascript" src="http://ad.csdn.net/scripts/ad-blog.js"></script>

</div>
</body>
</html>