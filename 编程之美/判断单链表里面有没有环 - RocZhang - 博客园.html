<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-cn">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>判断单链表里面有没有环 - RocZhang - 博客园</title>
<link type="text/css" rel="stylesheet" href="/bundles/blog-common.css?v=RFWbSMVn474Meo5c6rKa1DH_M4ldFPuI9Jah-EA-L5Q1"/>
<link id="MainCss" type="text/css" rel="stylesheet" href="/skins/ClearScreen01/bundle-ClearScreen01.css?v=4UXTP9ZStRsZvXp-yHLt-Sj_8XUk5Wp-6PcbbHcz-6A1"/>
<link title="RSS" type="application/rss+xml" rel="alternate" href="http://www.cnblogs.com/zhyg6516/rss"/>
<link title="RSD" type="application/rsd+xml" rel="EditURI" href="http://www.cnblogs.com/zhyg6516/rsd.xml"/>
<link type="application/wlwmanifest+xml" rel="wlwmanifest" href="http://www.cnblogs.com/zhyg6516/wlwmanifest.xml"/>
<script src="http://common.cnblogs.com/script/jquery.js" type="text/javascript"></script>  
<script type="text/javascript">var currentBlogApp = 'zhyg6516', cb_enable_mathjax=false;</script>
<script src="/bundles/blog-common.js?v=NRIlPIHMlVEgoqJZIuk9OQtjtZjNFcz_ov8kYhFFdoM1" type="text/javascript"></script>
</head>
<body>
<a name="top"></a>

<!--done-->
<div id="header">
	
<!--done-->
<div class="header">
	<div class="headerText">
		<a id="Header1_HeaderTitle" class="headermaintitle" href="http://www.cnblogs.com/zhyg6516/">成长日记</a><br>
		爱上Linux
	</div>
</div>

</div>
<div id="mylinks">
<!--done-->
<a id="MyLinks1_HomeLink" class="listitem" href="http://www.cnblogs.com/">博客园</a>&nbsp;&nbsp;::&nbsp;
<a id="MyLinks1_MyHomeLink" class="listitem" href="http://www.cnblogs.com/zhyg6516/">首页</a>&nbsp;&nbsp;::&nbsp;
<a id="MyLinks1_NewPostLink" class="listitem" rel="nofollow" href="http://i.cnblogs.com/EditPosts.aspx?opt=1">新随笔</a>&nbsp;&nbsp;::&nbsp;
<a id="MyLinks1_ContactLink" accesskey="9" class="listitem" rel="nofollow" href="http://space.cnblogs.com/msg/send/RocZhang">联系</a>&nbsp;&nbsp;::&nbsp;
<a id="MyLinks1_Syndication" class="listitem" href="http://www.cnblogs.com/zhyg6516/rss">订阅</a>&nbsp;<a id="MyLinks1_XMLLink" href="http://www.cnblogs.com/zhyg6516/rss"><img src="http://www.cnblogs.com/images/xml.gif" alt="订阅" /></a>&nbsp;&nbsp;::&nbsp;
<a id="MyLinks1_Admin" class="listitem" rel="nofollow" href="http://i.cnblogs.com/">管理</a>
</div>
<div id="mytopmenu">
	
		<DIV id="mystats">
			
<!--done-->
<div class="blogStats">
posts - 93,&nbsp;
comments - 54,&nbsp;
trackbacks - 0

</div></DIV>
	
</div>
<div id="leftcontent">
	
		<DIV id="leftcontentcontainer">
			
<!--done-->
<div class = "news">公告</div>
	<div class="newsItem">
		<div id="blog-news"></div><script type="text/javascript">loadBlogNews();</script>
	</div>
</ul>
			<div id="blog-calendar" style="display:none"></div><script type="text/javascript">loadBlogDefaultCalendar();</script>
			<div id="blog-sidecolumn"></div><script type="text/javascript">loadBlogSideColumn();</script></DIV>
	
</div>
<div id="centercontent">
	

<!--done-->
<div class = "post">
	<div class = "postTitle">
		<a id="cb_post_title_url" class="postTitle2" href="http://www.cnblogs.com/zhyg6516/archive/2011/03/29/1998831.html">判断单链表里面有没有环</a>
	</div>
	<div id="cnblogs_post_body"><p>这题目还是慢有意思的。</p>
<p>题目：0.如何判断单链表里面是否有环？</p>
<p>算法的思想是设定两个指针p, q，其中p每次向前移动一步，q每次向前移动两步。那么如果单链表存在环，则p和q相遇；否则q将首先遇到null。<br />
这里主要理解一个问题，就是为什么当单链表存在环时，p和q一定会相遇呢？</p>
<p><br />
假定单链表的长度为n，并且该单链表是环状的，那么第i次迭代时，p指向元素i mod n，q指向2i mod n。因此当i&equiv;2i(mod 
n)时，p与q相遇。而i&equiv;2i(mod n) =&gt; (2i - i) mod n = 0 =&gt; i mod n = 0 =&gt; 
当i=n时，p与q相遇。这里一个简单的理解是，p和q同时在操场跑步，其中q的速度是p的两倍，当他们两个同时出发时，p跑一圈到达起点，而q此时也刚
好跑完两圈到达起点。<br />
那么当p与q起点不同呢？假定第i次迭代时p指向元素i mod n，q指向k+2i mod n，其中0&lt;k&lt;n。那么i&equiv;(2i+k)(mod n) =&gt; (i+k) mod n = 0 =&gt; 当i=n-k时，p与q相遇。</p>
<p>解决方案：</p>
<p>推广： </p>
<p>1. 如果两个指针的速度不一样，比如p，q，( 0&lt;p&lt;q)二者满足什么样的关系，可以使得两者肯定交与一个节点？</p>
<p>&nbsp;&nbsp;&nbsp; Sp(i) = pi</p>
<p>&nbsp;&nbsp;&nbsp; Sq(i) = k + qi</p>
<p>&nbsp;&nbsp; 如果两个要相交于一个节点，则 Sp(i) = Sq(i) =&gt;&nbsp; (pi) mod n = ( k+ qi ) mod n =&gt;[ (q -p)i + k ]&nbsp; mod n =0 </p>
<p>&nbsp;&nbsp; =&gt;&nbsp; (q-p)i + k&nbsp; = Nn [N 为自然数]</p>
<p>&nbsp;&nbsp; =&gt;&nbsp; i = (Nn -k) /(p-q)</p>
<p>&nbsp;&nbsp; i取自然数，则当 p，q满足上面等式 即 存在一个自然数N，可以满足Nn -k 是 p - q 的倍数时，保证两者相交。</p>
<p>&nbsp;&nbsp; 特例：如果q 是p 的步长的两倍，都从同一个起点开始，即 q = 2p , k =0, 那么等式变为： Nn=i： 即可以理解为，当第i次迭代时，i是圈的整数倍时，两者都可以交，交点就是为起点。</p>
<p>2.如何判断单链表的环的长度？</p>
<p>&nbsp;&nbsp; 这个比较简单，知道q 已经进入到环里，保存该位置。然后由该位置遍历，当再次碰到该q 位置即可，所迭代的次数就是环的长度。</p>
<p>3. 如何找到链表中第一个在环里的节点？</p>
<p>&nbsp;&nbsp; 假设链表长度是L，前半部分长度为k-1，那么第一个再环里的节点是k，环的长度是 n， 那么当q=2p时， 什么时候第一次相交呢？当q指针走到第k个节点时，q指针已经在环的第 k mod n 的位置。即p和q 相差k个元素，从不同的起点开始，则相交的位置为 n-k, 则有了下面的图：</p>
<p><img src="http://pic002.cnblogs.com/images/2011/40351/2011032916252213.jpg" /></p>
<p>从图上可以明显看到，当p从交点的位置（n-k) ,向前遍历k个节点就到到达环的第一个几点，节点k.</p>
<p>算法就很简单： 一个指针从p和q 中的第一次相交的位置起（n-k)，另外一个指针从链表头开始遍历，其交点就是链表中第一个在环里的交点。 </p>
<p>4. 如果判断两个单链表有交？第一个交点在哪里？</p>
<p>&nbsp;&nbsp;&nbsp; 这个问题画出图，就可以很容易转化为前面的题目。</p>
<p>
&nbsp; &nbsp; <img src="http://pic002.cnblogs.com/images/2011/40351/2011032916355746.jpg" width="729" height="280" /> </p>
<p>&nbsp;&nbsp;&nbsp; 将其中一个链表中的尾节点与头节点联系起来，则很容发现问题转化为问题3，求有环的链表的第一个在环里的节点。</p></div><div id="MySignature"></div>
<div class="clear"></div>
<div id="blog_post_info_block">
<div id="BlogPostCategory"></div>
<div id="EntryTag"></div>
<div id="blog_post_info">
</div>
<div class="clear"></div>
<div id="post_next_prev"></div>
</div>


	<div class = "postDesc">posted on <span id="post-date">2011-03-29 16:41</span> <a href='http://www.cnblogs.com/zhyg6516/'>RocZhang</a> 阅读(<span id="post_view_count">...</span>) 评论(<span id="post_comment_count">...</span>)  <a href ="http://i.cnblogs.com/EditPosts.aspx?postid=1998831" rel="nofollow">编辑</a> <a href="#" onclick="AddToWz(1998831);return false;">收藏</a></div>
</div>
<script type="text/javascript">var allowComments=true,isLogined=false,cb_blogId=43930,cb_entryId=1998831,cb_blogApp=currentBlogApp,cb_blogUserGuid='72f2460b-63cf-dd11-9e4d-001cf0cd104b',cb_entryCreatedDate='2011/3/29 16:41:00';loadViewCount(cb_entryId);</script>

<a name="!comments"></a><div id="blog-comments-placeholder"></div><script type="text/javascript">var commentManager = new blogCommentManager();commentManager.renderComments(0);</script>
<div id="comment_form" class="commentform">
<a name="commentform"></a>
<div id="divCommentShow"></div>
<div id="comment_nav"><span id="span_refresh_tips"></span><a href="javascript:void(0);" id="lnk_RefreshComments" onclick="return RefreshCommentList();">刷新评论</a><a href="#" onclick="return RefreshPage();">刷新页面</a><a href="#top">返回顶部</a></div>
<div id="comment_form_container"></div>
<div class="ad_text_commentbox" id="ad_text_under_commentbox"></div>
<div id="site_nav_under"><a href="http://www.cnblogs.com/" target="_blank" title="开发者的网上家园">博客园首页</a><a href="http://q.cnblogs.com/" target="_blank" title="程序员问答社区">博问</a><a href="http://news.cnblogs.com/" target="_blank" title="IT新闻">新闻</a><a href="http://home.cnblogs.com/ing/" target="_blank">闪存</a><a href="http://job.cnblogs.com/" target="_blank">程序员招聘</a><a href="http://kb.cnblogs.com/" target="_blank">知识库</a></div>
<div id="opt_under_post"></div>
<script type="text/javascript">
    var enableGoogleAd = canShowAdsense(); var googletag = googletag || {}; googletag.cmd = googletag.cmd || [];
    fixPostBodyFormat();
</script>
<div id="ad_under_post_holder">
<script type='text/javascript'>
    var googletag = googletag || {};
    googletag.cmd = googletag.cmd || [];
    (function () {
        if (enableGoogleAd) {
            var gads = document.createElement('script');
            gads.async = true;
            gads.type = 'text/javascript';
            var useSSL = 'https:' == document.location.protocol;
            gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';
            var node = document.getElementsByTagName('script')[0];
            node.parentNode.insertBefore(gads, node);
        }
    })();
</script>
<script type='text/javascript'>
    try {
        if (enableGoogleAd) {
            googletag.cmd.push(function () {
                googletag.defineSlot('/1090369/cnblogs_blogpost_C1_sitehome', [300, 250], 'div-gpt-ad-1346480159711-0').addService(googletag.pubads());
                googletag.defineSlot('/1090369/cnblogs_blogpost_C2', [468, 60], 'div-gpt-ad-1410860226396-0').addService(googletag.pubads());
                googletag.pubads().enableSingleRequest();
                googletag.enableServices();
            });
        };
    } catch (e) { }
</script>
<div id="google_ad_c1" class="c_ad_block">
    <div id='div-gpt-ad-1346480159711-0' style='width:300px; height:250px;'>
    <script type='text/javascript'>
        try {
            if (enableGoogleAd) {
                googletag.cmd.push(function () { googletag.display('div-gpt-ad-1346480159711-0'); });            
            } else {
                $('#div-gpt-ad-1346480159711-0').hide();
            }
    } catch (e) { }
    </script>
    </div>
</div>
</div>
<div id="under_post_news"></div>
<div id="google_ad_c2" class="c_ad_block">
<div id='div-gpt-ad-1410860226396-0' style='width:468px; height:60px;'>
<script type='text/javascript'>
try {
    if (enableGoogleAd) {
        googletag.cmd.push(function () { googletag.display('div-gpt-ad-1410860226396-0'); });
    } else {
        $('#div-gpt-ad-1346480159711-0').hide();
    }
} catch (e) { }
</script>
</div>
</div>
<div id="under_post_kb"></div>
<div id="HistoryToday" class="c_ad_block"></div>
<script type="text/javascript">
$(function () {
    loadNewsAndKb();
    loadBlogSignature();
    LoadPostInfoBlock(cb_blogId, cb_entryId, cb_blogApp, cb_blogUserGuid);
    GetPrevNextPost(cb_entryId, cb_blogId, cb_entryCreatedDate);
    loadOptUnderPost();
    GetHistoryToday(cb_blogId, cb_blogApp, cb_entryCreatedDate);
    setTimeout(function () { incrementViewCount(cb_entryId); }, 200);
});
</script>
</div>

</div>

<!--done-->
<div class="footer">
	Powered by: 
	<br />
	
	<a id="Footer1_Hyperlink3" NAME="Hyperlink1" href="http://www.cnblogs.com/" style="font-family:Verdana;font-size:12px;">博客园</a>
	<br />
	Copyright &copy;2015 RocZhang
</div>


</body>
</html>
